function H5(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function uE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dE={exports:{}},Mf={},hE={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mu=Symbol.for("react.element"),W5=Symbol.for("react.portal"),G5=Symbol.for("react.fragment"),q5=Symbol.for("react.strict_mode"),Q5=Symbol.for("react.profiler"),K5=Symbol.for("react.provider"),X5=Symbol.for("react.context"),Y5=Symbol.for("react.forward_ref"),J5=Symbol.for("react.suspense"),Z5=Symbol.for("react.memo"),eN=Symbol.for("react.lazy"),J1=Symbol.iterator;function tN(t){return t===null||typeof t!="object"?null:(t=J1&&t[J1]||t["@@iterator"],typeof t=="function"?t:null)}var fE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mE=Object.assign,pE={};function rl(t,e,n){this.props=t,this.context=e,this.refs=pE,this.updater=n||fE}rl.prototype.isReactComponent={};rl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gE(){}gE.prototype=rl.prototype;function Hx(t,e,n){this.props=t,this.context=e,this.refs=pE,this.updater=n||fE}var Wx=Hx.prototype=new gE;Wx.constructor=Hx;mE(Wx,rl.prototype);Wx.isPureReactComponent=!0;var Z1=Array.isArray,xE=Object.prototype.hasOwnProperty,Gx={current:null},yE={key:!0,ref:!0,__self:!0,__source:!0};function vE(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)xE.call(e,r)&&!yE.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:mu,type:t,key:i,ref:o,props:s,_owner:Gx.current}}function nN(t,e){return{$$typeof:mu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qx(t){return typeof t=="object"&&t!==null&&t.$$typeof===mu}function rN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var e_=/\/+/g;function Ep(t,e){return typeof t=="object"&&t!==null&&t.key!=null?rN(""+t.key):e.toString(36)}function Jd(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case mu:case W5:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Ep(o,0):r,Z1(s)?(n="",t!=null&&(n=t.replace(e_,"$&/")+"/"),Jd(s,e,n,"",function(u){return u})):s!=null&&(qx(s)&&(s=nN(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(e_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Z1(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Ep(i,l);o+=Jd(i,e,n,c,s)}else if(c=tN(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Ep(i,l++),o+=Jd(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function gd(t,e,n){if(t==null)return t;var r=[],s=0;return Jd(t,r,"","",function(i){return e.call(n,i,s++)}),r}function sN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var En={current:null},Zd={transition:null},iN={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:Zd,ReactCurrentOwner:Gx};Ie.Children={map:gd,forEach:function(t,e,n){gd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gd(t,function(){e++}),e},toArray:function(t){return gd(t,function(e){return e})||[]},only:function(t){if(!qx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=rl;Ie.Fragment=G5;Ie.Profiler=Q5;Ie.PureComponent=Hx;Ie.StrictMode=q5;Ie.Suspense=J5;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iN;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=mE({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Gx.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)xE.call(e,c)&&!yE.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:mu,type:t.type,key:s,ref:i,props:r,_owner:o}};Ie.createContext=function(t){return t={$$typeof:X5,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:K5,_context:t},t.Consumer=t};Ie.createElement=vE;Ie.createFactory=function(t){var e=vE.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:Y5,render:t}};Ie.isValidElement=qx;Ie.lazy=function(t){return{$$typeof:eN,_payload:{_status:-1,_result:t},_init:sN}};Ie.memo=function(t,e){return{$$typeof:Z5,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=Zd.transition;Zd.transition={};try{t()}finally{Zd.transition=e}};Ie.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ie.useCallback=function(t,e){return En.current.useCallback(t,e)};Ie.useContext=function(t){return En.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return En.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return En.current.useEffect(t,e)};Ie.useId=function(){return En.current.useId()};Ie.useImperativeHandle=function(t,e,n){return En.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return En.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return En.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return En.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return En.current.useReducer(t,e,n)};Ie.useRef=function(t){return En.current.useRef(t)};Ie.useState=function(t){return En.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return En.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return En.current.useTransition()};Ie.version="18.2.0";hE.exports=Ie;var f=hE.exports;const wE=uE(f),aN=H5({__proto__:null,default:wE},[f]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oN=f,lN=Symbol.for("react.element"),cN=Symbol.for("react.fragment"),uN=Object.prototype.hasOwnProperty,dN=oN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hN={key:!0,ref:!0,__self:!0,__source:!0};function _E(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)uN.call(e,r)&&!hN.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:lN,type:t,key:i,ref:o,props:s,_owner:dN.current}}Mf.Fragment=cN;Mf.jsx=_E;Mf.jsxs=_E;dE.exports=Mf;var a=dE.exports;var $g={},bE={exports:{}},nr={},SE={exports:{}},EE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,Y){var ee=H.length;H.push(Y);e:for(;0<ee;){var ve=ee-1>>>1,Ce=H[ve];if(0<s(Ce,Y))H[ve]=Y,H[ee]=Ce,ee=ve;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Y=H[0],ee=H.pop();if(ee!==Y){H[0]=ee;e:for(var ve=0,Ce=H.length,Ge=Ce>>>1;ve<Ge;){var kr=2*(ve+1)-1,or=H[kr],lr=kr+1,Mn=H[lr];if(0>s(or,ee))lr<Ce&&0>s(Mn,or)?(H[ve]=Mn,H[lr]=ee,ve=lr):(H[ve]=or,H[kr]=ee,ve=kr);else if(lr<Ce&&0>s(Mn,ee))H[ve]=Mn,H[lr]=ee,ve=lr;else break e}}return Y}function s(H,Y){var ee=H.sortIndex-Y.sortIndex;return ee!==0?ee:H.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,m=null,p=3,g=!1,y=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(H){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=H)r(u),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=n(u)}}function R(H){if(v=!1,E(H),!y)if(n(c)!==null)y=!0,te(D);else{var Y=n(u);Y!==null&&Se(R,Y.startTime-H)}}function D(H,Y){y=!1,v&&(v=!1,S(k),k=-1),g=!0;var ee=p;try{for(E(Y),m=n(c);m!==null&&(!(m.expirationTime>Y)||H&&!N());){var ve=m.callback;if(typeof ve=="function"){m.callback=null,p=m.priorityLevel;var Ce=ve(m.expirationTime<=Y);Y=t.unstable_now(),typeof Ce=="function"?m.callback=Ce:m===n(c)&&r(c),E(Y)}else r(c);m=n(c)}if(m!==null)var Ge=!0;else{var kr=n(u);kr!==null&&Se(R,kr.startTime-Y),Ge=!1}return Ge}finally{m=null,p=ee,g=!1}}var F=!1,I=null,k=-1,j=5,C=-1;function N(){return!(t.unstable_now()-C<j)}function P(){if(I!==null){var H=t.unstable_now();C=H;var Y=!0;try{Y=I(!0,H)}finally{Y?A():(F=!1,I=null)}}else F=!1}var A;if(typeof b=="function")A=function(){b(P)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,he=Z.port2;Z.port1.onmessage=P,A=function(){he.postMessage(null)}}else A=function(){_(P,0)};function te(H){I=H,F||(F=!0,A())}function Se(H,Y){k=_(function(){H(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,te(D))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var ee=p;p=Y;try{return H()}finally{p=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,Y){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ee=p;p=H;try{return Y()}finally{p=ee}},t.unstable_scheduleCallback=function(H,Y,ee){var ve=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ve+ee:ve):ee=ve,H){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=ee+Ce,H={id:d++,callback:Y,priorityLevel:H,startTime:ee,expirationTime:Ce,sortIndex:-1},ee>ve?(H.sortIndex=ee,e(u,H),n(c)===null&&H===n(u)&&(v?(S(k),k=-1):v=!0,Se(R,ee-ve))):(H.sortIndex=Ce,e(c,H),y||g||(y=!0,te(D))),H},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(H){var Y=p;return function(){var ee=p;p=Y;try{return H.apply(this,arguments)}finally{p=ee}}}})(EE);SE.exports=EE;var fN=SE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kE=f,Zn=fN;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TE=new Set,Ic={};function Ha(t,e){Oo(t,e),Oo(t+"Capture",e)}function Oo(t,e){for(Ic[t]=e,t=0;t<e.length;t++)TE.add(e[t])}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bg=Object.prototype.hasOwnProperty,mN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,t_={},n_={};function pN(t){return Bg.call(n_,t)?!0:Bg.call(t_,t)?!1:mN.test(t)?n_[t]=!0:(t_[t]=!0,!1)}function gN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function xN(t,e,n,r){if(e===null||typeof e>"u"||gN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wt[t]=new kn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wt[e]=new kn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wt[t]=new kn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wt[t]=new kn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wt[t]=new kn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wt[t]=new kn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wt[t]=new kn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wt[t]=new kn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wt[t]=new kn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Qx=/[\-:]([a-z])/g;function Kx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Qx,Kx);Wt[e]=new kn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Qx,Kx);Wt[e]=new kn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Qx,Kx);Wt[e]=new kn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wt[t]=new kn(t,1,!1,t.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wt[t]=new kn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xx(t,e,n,r){var s=Wt.hasOwnProperty(e)?Wt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(xN(e,n,s,r)&&(n=null),r||s===null?pN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var qs=kE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xd=Symbol.for("react.element"),mo=Symbol.for("react.portal"),po=Symbol.for("react.fragment"),Yx=Symbol.for("react.strict_mode"),zg=Symbol.for("react.profiler"),IE=Symbol.for("react.provider"),CE=Symbol.for("react.context"),Jx=Symbol.for("react.forward_ref"),Ug=Symbol.for("react.suspense"),Vg=Symbol.for("react.suspense_list"),Zx=Symbol.for("react.memo"),ui=Symbol.for("react.lazy"),jE=Symbol.for("react.offscreen"),r_=Symbol.iterator;function Ul(t){return t===null||typeof t!="object"?null:(t=r_&&t[r_]||t["@@iterator"],typeof t=="function"?t:null)}var it=Object.assign,kp;function nc(t){if(kp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);kp=e&&e[1]||""}return`
`+kp+t}var Tp=!1;function Ip(t,e){if(!t||Tp)return"";Tp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Tp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?nc(t):""}function yN(t){switch(t.tag){case 5:return nc(t.type);case 16:return nc("Lazy");case 13:return nc("Suspense");case 19:return nc("SuspenseList");case 0:case 2:case 15:return t=Ip(t.type,!1),t;case 11:return t=Ip(t.type.render,!1),t;case 1:return t=Ip(t.type,!0),t;default:return""}}function Hg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case po:return"Fragment";case mo:return"Portal";case zg:return"Profiler";case Yx:return"StrictMode";case Ug:return"Suspense";case Vg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case CE:return(t.displayName||"Context")+".Consumer";case IE:return(t._context.displayName||"Context")+".Provider";case Jx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zx:return e=t.displayName||null,e!==null?e:Hg(t.type)||"Memo";case ui:e=t._payload,t=t._init;try{return Hg(t(e))}catch{}}return null}function vN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hg(e);case 8:return e===Yx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Li(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function RE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wN(t){var e=RE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yd(t){t._valueTracker||(t._valueTracker=wN(t))}function AE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=RE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function kh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wg(t,e){var n=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function s_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Li(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NE(t,e){e=e.checked,e!=null&&Xx(t,"checked",e,!1)}function Gg(t,e){NE(t,e);var n=Li(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qg(t,e.type,n):e.hasOwnProperty("defaultValue")&&qg(t,e.type,Li(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function i_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function qg(t,e,n){(e!=="number"||kh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var rc=Array.isArray;function Co(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Li(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Qg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function a_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(V(92));if(rc(n)){if(1<n.length)throw Error(V(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Li(n)}}function PE(t,e){var n=Li(e.value),r=Li(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function o_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function FE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?FE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vd,DE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(vd=vd||document.createElement("div"),vd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Cc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_N=["Webkit","ms","Moz","O"];Object.keys(hc).forEach(function(t){_N.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hc[e]=hc[t]})});function LE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hc.hasOwnProperty(t)&&hc[t]?(""+e).trim():e+"px"}function ME(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=LE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var bN=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xg(t,e){if(e){if(bN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function Yg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jg=null;function ey(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Zg=null,jo=null,Ro=null;function l_(t){if(t=xu(t)){if(typeof Zg!="function")throw Error(V(280));var e=t.stateNode;e&&(e=Uf(e),Zg(t.stateNode,t.type,e))}}function OE(t){jo?Ro?Ro.push(t):Ro=[t]:jo=t}function $E(){if(jo){var t=jo,e=Ro;if(Ro=jo=null,l_(t),e)for(t=0;t<e.length;t++)l_(e[t])}}function BE(t,e){return t(e)}function zE(){}var Cp=!1;function UE(t,e,n){if(Cp)return t(e,n);Cp=!0;try{return BE(t,e,n)}finally{Cp=!1,(jo!==null||Ro!==null)&&(zE(),$E())}}function jc(t,e){var n=t.stateNode;if(n===null)return null;var r=Uf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(V(231,e,typeof n));return n}var e0=!1;if(Ls)try{var Vl={};Object.defineProperty(Vl,"passive",{get:function(){e0=!0}}),window.addEventListener("test",Vl,Vl),window.removeEventListener("test",Vl,Vl)}catch{e0=!1}function SN(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var fc=!1,Th=null,Ih=!1,t0=null,EN={onError:function(t){fc=!0,Th=t}};function kN(t,e,n,r,s,i,o,l,c){fc=!1,Th=null,SN.apply(EN,arguments)}function TN(t,e,n,r,s,i,o,l,c){if(kN.apply(this,arguments),fc){if(fc){var u=Th;fc=!1,Th=null}else throw Error(V(198));Ih||(Ih=!0,t0=u)}}function Wa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function VE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function c_(t){if(Wa(t)!==t)throw Error(V(188))}function IN(t){var e=t.alternate;if(!e){if(e=Wa(t),e===null)throw Error(V(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return c_(s),t;if(i===r)return c_(s),e;i=i.sibling}throw Error(V(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?t:e}function HE(t){return t=IN(t),t!==null?WE(t):null}function WE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=WE(t);if(e!==null)return e;t=t.sibling}return null}var GE=Zn.unstable_scheduleCallback,u_=Zn.unstable_cancelCallback,CN=Zn.unstable_shouldYield,jN=Zn.unstable_requestPaint,gt=Zn.unstable_now,RN=Zn.unstable_getCurrentPriorityLevel,ty=Zn.unstable_ImmediatePriority,qE=Zn.unstable_UserBlockingPriority,Ch=Zn.unstable_NormalPriority,AN=Zn.unstable_LowPriority,QE=Zn.unstable_IdlePriority,Of=null,rs=null;function NN(t){if(rs&&typeof rs.onCommitFiberRoot=="function")try{rs.onCommitFiberRoot(Of,t,void 0,(t.current.flags&128)===128)}catch{}}var Dr=Math.clz32?Math.clz32:DN,PN=Math.log,FN=Math.LN2;function DN(t){return t>>>=0,t===0?32:31-(PN(t)/FN|0)|0}var wd=64,_d=4194304;function sc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=sc(l):(i&=o,i!==0&&(r=sc(i)))}else o=n&~s,o!==0?r=sc(o):i!==0&&(r=sc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Dr(e),s=1<<n,r|=t[n],e&=~s;return r}function LN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Dr(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=LN(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function n0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KE(){var t=wd;return wd<<=1,!(wd&4194240)&&(wd=64),t}function jp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function pu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Dr(e),t[e]=n}function ON(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Dr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function ny(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Dr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Oe=0;function XE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var YE,ry,JE,ZE,ek,r0=!1,bd=[],Si=null,Ei=null,ki=null,Rc=new Map,Ac=new Map,hi=[],$N="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function d_(t,e){switch(t){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":Ei=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":Rc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ac.delete(e.pointerId)}}function Hl(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=xu(e),e!==null&&ry(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function BN(t,e,n,r,s){switch(e){case"focusin":return Si=Hl(Si,t,e,n,r,s),!0;case"dragenter":return Ei=Hl(Ei,t,e,n,r,s),!0;case"mouseover":return ki=Hl(ki,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Rc.set(i,Hl(Rc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ac.set(i,Hl(Ac.get(i)||null,t,e,n,r,s)),!0}return!1}function tk(t){var e=ma(t.target);if(e!==null){var n=Wa(e);if(n!==null){if(e=n.tag,e===13){if(e=VE(n),e!==null){t.blockedOn=e,ek(t.priority,function(){JE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function eh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=s0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Jg=r,n.target.dispatchEvent(r),Jg=null}else return e=xu(n),e!==null&&ry(e),t.blockedOn=n,!1;e.shift()}return!0}function h_(t,e,n){eh(t)&&n.delete(e)}function zN(){r0=!1,Si!==null&&eh(Si)&&(Si=null),Ei!==null&&eh(Ei)&&(Ei=null),ki!==null&&eh(ki)&&(ki=null),Rc.forEach(h_),Ac.forEach(h_)}function Wl(t,e){t.blockedOn===e&&(t.blockedOn=null,r0||(r0=!0,Zn.unstable_scheduleCallback(Zn.unstable_NormalPriority,zN)))}function Nc(t){function e(s){return Wl(s,t)}if(0<bd.length){Wl(bd[0],t);for(var n=1;n<bd.length;n++){var r=bd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Si!==null&&Wl(Si,t),Ei!==null&&Wl(Ei,t),ki!==null&&Wl(ki,t),Rc.forEach(e),Ac.forEach(e),n=0;n<hi.length;n++)r=hi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<hi.length&&(n=hi[0],n.blockedOn===null);)tk(n),n.blockedOn===null&&hi.shift()}var Ao=qs.ReactCurrentBatchConfig,Rh=!0;function UN(t,e,n,r){var s=Oe,i=Ao.transition;Ao.transition=null;try{Oe=1,sy(t,e,n,r)}finally{Oe=s,Ao.transition=i}}function VN(t,e,n,r){var s=Oe,i=Ao.transition;Ao.transition=null;try{Oe=4,sy(t,e,n,r)}finally{Oe=s,Ao.transition=i}}function sy(t,e,n,r){if(Rh){var s=s0(t,e,n,r);if(s===null)$p(t,e,r,Ah,n),d_(t,r);else if(BN(s,t,e,n,r))r.stopPropagation();else if(d_(t,r),e&4&&-1<$N.indexOf(t)){for(;s!==null;){var i=xu(s);if(i!==null&&YE(i),i=s0(t,e,n,r),i===null&&$p(t,e,r,Ah,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else $p(t,e,r,null,n)}}var Ah=null;function s0(t,e,n,r){if(Ah=null,t=ey(r),t=ma(t),t!==null)if(e=Wa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=VE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ah=t,null}function nk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RN()){case ty:return 1;case qE:return 4;case Ch:case AN:return 16;case QE:return 536870912;default:return 16}default:return 16}}var vi=null,iy=null,th=null;function rk(){if(th)return th;var t,e=iy,n=e.length,r,s="value"in vi?vi.value:vi.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return th=s.slice(t,1<r?1-r:void 0)}function nh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sd(){return!0}function f_(){return!1}function rr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sd:f_,this.isPropagationStopped=f_,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sd)},persist:function(){},isPersistent:Sd}),e}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ay=rr(sl),gu=it({},sl,{view:0,detail:0}),HN=rr(gu),Rp,Ap,Gl,$f=it({},gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Gl&&(Gl&&t.type==="mousemove"?(Rp=t.screenX-Gl.screenX,Ap=t.screenY-Gl.screenY):Ap=Rp=0,Gl=t),Rp)},movementY:function(t){return"movementY"in t?t.movementY:Ap}}),m_=rr($f),WN=it({},$f,{dataTransfer:0}),GN=rr(WN),qN=it({},gu,{relatedTarget:0}),Np=rr(qN),QN=it({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),KN=rr(QN),XN=it({},sl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YN=rr(XN),JN=it({},sl,{data:0}),p_=rr(JN),ZN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tP[t])?!!e[t]:!1}function oy(){return nP}var rP=it({},gu,{key:function(t){if(t.key){var e=ZN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=nh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oy,charCode:function(t){return t.type==="keypress"?nh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?nh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sP=rr(rP),iP=it({},$f,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),g_=rr(iP),aP=it({},gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oy}),oP=rr(aP),lP=it({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),cP=rr(lP),uP=it({},$f,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dP=rr(uP),hP=[9,13,27,32],ly=Ls&&"CompositionEvent"in window,mc=null;Ls&&"documentMode"in document&&(mc=document.documentMode);var fP=Ls&&"TextEvent"in window&&!mc,sk=Ls&&(!ly||mc&&8<mc&&11>=mc),x_=String.fromCharCode(32),y_=!1;function ik(t,e){switch(t){case"keyup":return hP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ak(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var go=!1;function mP(t,e){switch(t){case"compositionend":return ak(e);case"keypress":return e.which!==32?null:(y_=!0,x_);case"textInput":return t=e.data,t===x_&&y_?null:t;default:return null}}function pP(t,e){if(go)return t==="compositionend"||!ly&&ik(t,e)?(t=rk(),th=iy=vi=null,go=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return sk&&e.locale!=="ko"?null:e.data;default:return null}}var gP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function v_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gP[t.type]:e==="textarea"}function ok(t,e,n,r){OE(r),e=Nh(e,"onChange"),0<e.length&&(n=new ay("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var pc=null,Pc=null;function xP(t){yk(t,0)}function Bf(t){var e=vo(t);if(AE(e))return t}function yP(t,e){if(t==="change")return e}var lk=!1;if(Ls){var Pp;if(Ls){var Fp="oninput"in document;if(!Fp){var w_=document.createElement("div");w_.setAttribute("oninput","return;"),Fp=typeof w_.oninput=="function"}Pp=Fp}else Pp=!1;lk=Pp&&(!document.documentMode||9<document.documentMode)}function __(){pc&&(pc.detachEvent("onpropertychange",ck),Pc=pc=null)}function ck(t){if(t.propertyName==="value"&&Bf(Pc)){var e=[];ok(e,Pc,t,ey(t)),UE(xP,e)}}function vP(t,e,n){t==="focusin"?(__(),pc=e,Pc=n,pc.attachEvent("onpropertychange",ck)):t==="focusout"&&__()}function wP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Bf(Pc)}function _P(t,e){if(t==="click")return Bf(e)}function bP(t,e){if(t==="input"||t==="change")return Bf(e)}function SP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $r=typeof Object.is=="function"?Object.is:SP;function Fc(t,e){if($r(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Bg.call(e,s)||!$r(t[s],e[s]))return!1}return!0}function b_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function S_(t,e){var n=b_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=b_(n)}}function uk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?uk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function dk(){for(var t=window,e=kh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=kh(t.document)}return e}function cy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function EP(t){var e=dk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&uk(n.ownerDocument.documentElement,n)){if(r!==null&&cy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=S_(n,i);var o=S_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kP=Ls&&"documentMode"in document&&11>=document.documentMode,xo=null,i0=null,gc=null,a0=!1;function E_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;a0||xo==null||xo!==kh(r)||(r=xo,"selectionStart"in r&&cy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),gc&&Fc(gc,r)||(gc=r,r=Nh(i0,"onSelect"),0<r.length&&(e=new ay("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=xo)))}function Ed(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yo={animationend:Ed("Animation","AnimationEnd"),animationiteration:Ed("Animation","AnimationIteration"),animationstart:Ed("Animation","AnimationStart"),transitionend:Ed("Transition","TransitionEnd")},Dp={},hk={};Ls&&(hk=document.createElement("div").style,"AnimationEvent"in window||(delete yo.animationend.animation,delete yo.animationiteration.animation,delete yo.animationstart.animation),"TransitionEvent"in window||delete yo.transitionend.transition);function zf(t){if(Dp[t])return Dp[t];if(!yo[t])return t;var e=yo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in hk)return Dp[t]=e[n];return t}var fk=zf("animationend"),mk=zf("animationiteration"),pk=zf("animationstart"),gk=zf("transitionend"),xk=new Map,k_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vi(t,e){xk.set(t,e),Ha(e,[t])}for(var Lp=0;Lp<k_.length;Lp++){var Mp=k_[Lp],TP=Mp.toLowerCase(),IP=Mp[0].toUpperCase()+Mp.slice(1);Vi(TP,"on"+IP)}Vi(fk,"onAnimationEnd");Vi(mk,"onAnimationIteration");Vi(pk,"onAnimationStart");Vi("dblclick","onDoubleClick");Vi("focusin","onFocus");Vi("focusout","onBlur");Vi(gk,"onTransitionEnd");Oo("onMouseEnter",["mouseout","mouseover"]);Oo("onMouseLeave",["mouseout","mouseover"]);Oo("onPointerEnter",["pointerout","pointerover"]);Oo("onPointerLeave",["pointerout","pointerover"]);Ha("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ha("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ha("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ha("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ha("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ha("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CP=new Set("cancel close invalid load scroll toggle".split(" ").concat(ic));function T_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,TN(r,e,void 0,t),t.currentTarget=null}function yk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;T_(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;T_(s,l,u),i=c}}}if(Ih)throw t=t0,Ih=!1,t0=null,t}function Qe(t,e){var n=e[d0];n===void 0&&(n=e[d0]=new Set);var r=t+"__bubble";n.has(r)||(vk(e,t,2,!1),n.add(r))}function Op(t,e,n){var r=0;e&&(r|=4),vk(n,t,r,e)}var kd="_reactListening"+Math.random().toString(36).slice(2);function Dc(t){if(!t[kd]){t[kd]=!0,TE.forEach(function(n){n!=="selectionchange"&&(CP.has(n)||Op(n,!1,t),Op(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kd]||(e[kd]=!0,Op("selectionchange",!1,e))}}function vk(t,e,n,r){switch(nk(e)){case 1:var s=UN;break;case 4:s=VN;break;default:s=sy}n=s.bind(null,e,n,t),s=void 0,!e0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function $p(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ma(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}UE(function(){var u=i,d=ey(n),m=[];e:{var p=xk.get(t);if(p!==void 0){var g=ay,y=t;switch(t){case"keypress":if(nh(n)===0)break e;case"keydown":case"keyup":g=sP;break;case"focusin":y="focus",g=Np;break;case"focusout":y="blur",g=Np;break;case"beforeblur":case"afterblur":g=Np;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=m_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=GN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=oP;break;case fk:case mk:case pk:g=KN;break;case gk:g=cP;break;case"scroll":g=HN;break;case"wheel":g=dP;break;case"copy":case"cut":case"paste":g=YN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=g_}var v=(e&4)!==0,_=!v&&t==="scroll",S=v?p!==null?p+"Capture":null:p;v=[];for(var b=u,E;b!==null;){E=b;var R=E.stateNode;if(E.tag===5&&R!==null&&(E=R,S!==null&&(R=jc(b,S),R!=null&&v.push(Lc(b,R,E)))),_)break;b=b.return}0<v.length&&(p=new g(p,y,null,n,d),m.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==Jg&&(y=n.relatedTarget||n.fromElement)&&(ma(y)||y[Ms]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=n.relatedTarget||n.toElement,g=u,y=y?ma(y):null,y!==null&&(_=Wa(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(v=m_,R="onMouseLeave",S="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(v=g_,R="onPointerLeave",S="onPointerEnter",b="pointer"),_=g==null?p:vo(g),E=y==null?p:vo(y),p=new v(R,b+"leave",g,n,d),p.target=_,p.relatedTarget=E,R=null,ma(d)===u&&(v=new v(S,b+"enter",y,n,d),v.target=E,v.relatedTarget=_,R=v),_=R,g&&y)t:{for(v=g,S=y,b=0,E=v;E;E=io(E))b++;for(E=0,R=S;R;R=io(R))E++;for(;0<b-E;)v=io(v),b--;for(;0<E-b;)S=io(S),E--;for(;b--;){if(v===S||S!==null&&v===S.alternate)break t;v=io(v),S=io(S)}v=null}else v=null;g!==null&&I_(m,p,g,v,!1),y!==null&&_!==null&&I_(m,_,y,v,!0)}}e:{if(p=u?vo(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var D=yP;else if(v_(p))if(lk)D=bP;else{D=wP;var F=vP}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(D=_P);if(D&&(D=D(t,u))){ok(m,D,n,d);break e}F&&F(t,p,u),t==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&qg(p,"number",p.value)}switch(F=u?vo(u):window,t){case"focusin":(v_(F)||F.contentEditable==="true")&&(xo=F,i0=u,gc=null);break;case"focusout":gc=i0=xo=null;break;case"mousedown":a0=!0;break;case"contextmenu":case"mouseup":case"dragend":a0=!1,E_(m,n,d);break;case"selectionchange":if(kP)break;case"keydown":case"keyup":E_(m,n,d)}var I;if(ly)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else go?ik(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(sk&&n.locale!=="ko"&&(go||k!=="onCompositionStart"?k==="onCompositionEnd"&&go&&(I=rk()):(vi=d,iy="value"in vi?vi.value:vi.textContent,go=!0)),F=Nh(u,k),0<F.length&&(k=new p_(k,t,null,n,d),m.push({event:k,listeners:F}),I?k.data=I:(I=ak(n),I!==null&&(k.data=I)))),(I=fP?mP(t,n):pP(t,n))&&(u=Nh(u,"onBeforeInput"),0<u.length&&(d=new p_("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=I))}yk(m,e)})}function Lc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Nh(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=jc(t,n),i!=null&&r.unshift(Lc(t,i,s)),i=jc(t,e),i!=null&&r.push(Lc(t,i,s))),t=t.return}return r}function io(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function I_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=jc(n,i),c!=null&&o.unshift(Lc(n,c,l))):s||(c=jc(n,i),c!=null&&o.push(Lc(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var jP=/\r\n?/g,RP=/\u0000|\uFFFD/g;function C_(t){return(typeof t=="string"?t:""+t).replace(jP,`
`).replace(RP,"")}function Td(t,e,n){if(e=C_(e),C_(t)!==e&&n)throw Error(V(425))}function Ph(){}var o0=null,l0=null;function c0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var u0=typeof setTimeout=="function"?setTimeout:void 0,AP=typeof clearTimeout=="function"?clearTimeout:void 0,j_=typeof Promise=="function"?Promise:void 0,NP=typeof queueMicrotask=="function"?queueMicrotask:typeof j_<"u"?function(t){return j_.resolve(null).then(t).catch(PP)}:u0;function PP(t){setTimeout(function(){throw t})}function Bp(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Nc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Nc(e)}function Ti(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function R_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var il=Math.random().toString(36).slice(2),es="__reactFiber$"+il,Mc="__reactProps$"+il,Ms="__reactContainer$"+il,d0="__reactEvents$"+il,FP="__reactListeners$"+il,DP="__reactHandles$"+il;function ma(t){var e=t[es];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ms]||n[es]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=R_(t);t!==null;){if(n=t[es])return n;t=R_(t)}return e}t=n,n=t.parentNode}return null}function xu(t){return t=t[es]||t[Ms],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function Uf(t){return t[Mc]||null}var h0=[],wo=-1;function Hi(t){return{current:t}}function Xe(t){0>wo||(t.current=h0[wo],h0[wo]=null,wo--)}function He(t,e){wo++,h0[wo]=t.current,t.current=e}var Mi={},ln=Hi(Mi),Pn=Hi(!1),ka=Mi;function $o(t,e){var n=t.type.contextTypes;if(!n)return Mi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Fn(t){return t=t.childContextTypes,t!=null}function Fh(){Xe(Pn),Xe(ln)}function A_(t,e,n){if(ln.current!==Mi)throw Error(V(168));He(ln,e),He(Pn,n)}function wk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(V(108,vN(t)||"Unknown",s));return it({},n,r)}function Dh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mi,ka=ln.current,He(ln,t),He(Pn,Pn.current),!0}function N_(t,e,n){var r=t.stateNode;if(!r)throw Error(V(169));n?(t=wk(t,e,ka),r.__reactInternalMemoizedMergedChildContext=t,Xe(Pn),Xe(ln),He(ln,t)):Xe(Pn),He(Pn,n)}var Ss=null,Vf=!1,zp=!1;function _k(t){Ss===null?Ss=[t]:Ss.push(t)}function LP(t){Vf=!0,_k(t)}function Wi(){if(!zp&&Ss!==null){zp=!0;var t=0,e=Oe;try{var n=Ss;for(Oe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ss=null,Vf=!1}catch(s){throw Ss!==null&&(Ss=Ss.slice(t+1)),GE(ty,Wi),s}finally{Oe=e,zp=!1}}return null}var _o=[],bo=0,Lh=null,Mh=0,dr=[],hr=0,Ta=null,ks=1,Ts="";function la(t,e){_o[bo++]=Mh,_o[bo++]=Lh,Lh=t,Mh=e}function bk(t,e,n){dr[hr++]=ks,dr[hr++]=Ts,dr[hr++]=Ta,Ta=t;var r=ks;t=Ts;var s=32-Dr(r)-1;r&=~(1<<s),n+=1;var i=32-Dr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ks=1<<32-Dr(e)+s|n<<s|r,Ts=i+t}else ks=1<<i|n<<s|r,Ts=t}function uy(t){t.return!==null&&(la(t,1),bk(t,1,0))}function dy(t){for(;t===Lh;)Lh=_o[--bo],_o[bo]=null,Mh=_o[--bo],_o[bo]=null;for(;t===Ta;)Ta=dr[--hr],dr[hr]=null,Ts=dr[--hr],dr[hr]=null,ks=dr[--hr],dr[hr]=null}var Kn=null,Wn=null,et=!1,Ar=null;function Sk(t,e){var n=fr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function P_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Kn=t,Wn=Ti(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Kn=t,Wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ta!==null?{id:ks,overflow:Ts}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Kn=t,Wn=null,!0):!1;default:return!1}}function f0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function m0(t){if(et){var e=Wn;if(e){var n=e;if(!P_(t,e)){if(f0(t))throw Error(V(418));e=Ti(n.nextSibling);var r=Kn;e&&P_(t,e)?Sk(r,n):(t.flags=t.flags&-4097|2,et=!1,Kn=t)}}else{if(f0(t))throw Error(V(418));t.flags=t.flags&-4097|2,et=!1,Kn=t}}}function F_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Kn=t}function Id(t){if(t!==Kn)return!1;if(!et)return F_(t),et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!c0(t.type,t.memoizedProps)),e&&(e=Wn)){if(f0(t))throw Ek(),Error(V(418));for(;e;)Sk(t,e),e=Ti(e.nextSibling)}if(F_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Wn=Ti(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Wn=null}}else Wn=Kn?Ti(t.stateNode.nextSibling):null;return!0}function Ek(){for(var t=Wn;t;)t=Ti(t.nextSibling)}function Bo(){Wn=Kn=null,et=!1}function hy(t){Ar===null?Ar=[t]:Ar.push(t)}var MP=qs.ReactCurrentBatchConfig;function jr(t,e){if(t&&t.defaultProps){e=it({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Oh=Hi(null),$h=null,So=null,fy=null;function my(){fy=So=$h=null}function py(t){var e=Oh.current;Xe(Oh),t._currentValue=e}function p0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function No(t,e){$h=t,fy=So=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Nn=!0),t.firstContext=null)}function pr(t){var e=t._currentValue;if(fy!==t)if(t={context:t,memoizedValue:e,next:null},So===null){if($h===null)throw Error(V(308));So=t,$h.dependencies={lanes:0,firstContext:t}}else So=So.next=t;return e}var pa=null;function gy(t){pa===null?pa=[t]:pa.push(t)}function kk(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,gy(e)):(n.next=s.next,s.next=n),e.interleaved=n,Os(t,r)}function Os(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var di=!1;function xy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ns(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ii(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Os(t,n)}return s=r.interleaved,s===null?(e.next=e,gy(r)):(e.next=s.next,s.next=e),r.interleaved=e,Os(t,n)}function rh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ny(t,n)}}function D_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Bh(t,e,n,r){var s=t.updateQueue;di=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,d=u=c=null,l=i;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,v=l;switch(p=e,g=n,v.tag){case 1:if(y=v.payload,typeof y=="function"){m=y.call(g,m,p);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,p=typeof y=="function"?y.call(g,m,p):y,p==null)break e;m=it({},m,p);break e;case 2:di=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=g,c=m):d=d.next=g,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ca|=o,t.lanes=o,t.memoizedState=m}}function L_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(V(191,s));s.call(r)}}}var Ik=new kE.Component().refs;function g0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:it({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Hf={isMounted:function(t){return(t=t._reactInternals)?Wa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=xn(),s=ji(t),i=Ns(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ii(t,i,s),e!==null&&(Lr(e,t,s,r),rh(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=xn(),s=ji(t),i=Ns(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ii(t,i,s),e!==null&&(Lr(e,t,s,r),rh(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=xn(),r=ji(t),s=Ns(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ii(t,s,r),e!==null&&(Lr(e,t,r,n),rh(e,t,r))}};function M_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Fc(n,r)||!Fc(s,i):!0}function Ck(t,e,n){var r=!1,s=Mi,i=e.contextType;return typeof i=="object"&&i!==null?i=pr(i):(s=Fn(e)?ka:ln.current,r=e.contextTypes,i=(r=r!=null)?$o(t,s):Mi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Hf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function O_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Hf.enqueueReplaceState(e,e.state,null)}function x0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=Ik,xy(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=pr(i):(i=Fn(e)?ka:ln.current,s.context=$o(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(g0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Hf.enqueueReplaceState(s,s.state,null),Bh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ql(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;l===Ik&&(l=s.refs={}),o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,t))}return t}function Cd(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function $_(t){var e=t._init;return e(t._payload)}function jk(t){function e(S,b){if(t){var E=S.deletions;E===null?(S.deletions=[b],S.flags|=16):E.push(b)}}function n(S,b){if(!t)return null;for(;b!==null;)e(S,b),b=b.sibling;return null}function r(S,b){for(S=new Map;b!==null;)b.key!==null?S.set(b.key,b):S.set(b.index,b),b=b.sibling;return S}function s(S,b){return S=Ri(S,b),S.index=0,S.sibling=null,S}function i(S,b,E){return S.index=E,t?(E=S.alternate,E!==null?(E=E.index,E<b?(S.flags|=2,b):E):(S.flags|=2,b)):(S.flags|=1048576,b)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function l(S,b,E,R){return b===null||b.tag!==6?(b=Qp(E,S.mode,R),b.return=S,b):(b=s(b,E),b.return=S,b)}function c(S,b,E,R){var D=E.type;return D===po?d(S,b,E.props.children,R,E.key):b!==null&&(b.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ui&&$_(D)===b.type)?(R=s(b,E.props),R.ref=ql(S,b,E),R.return=S,R):(R=ch(E.type,E.key,E.props,null,S.mode,R),R.ref=ql(S,b,E),R.return=S,R)}function u(S,b,E,R){return b===null||b.tag!==4||b.stateNode.containerInfo!==E.containerInfo||b.stateNode.implementation!==E.implementation?(b=Kp(E,S.mode,R),b.return=S,b):(b=s(b,E.children||[]),b.return=S,b)}function d(S,b,E,R,D){return b===null||b.tag!==7?(b=_a(E,S.mode,R,D),b.return=S,b):(b=s(b,E),b.return=S,b)}function m(S,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Qp(""+b,S.mode,E),b.return=S,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case xd:return E=ch(b.type,b.key,b.props,null,S.mode,E),E.ref=ql(S,null,b),E.return=S,E;case mo:return b=Kp(b,S.mode,E),b.return=S,b;case ui:var R=b._init;return m(S,R(b._payload),E)}if(rc(b)||Ul(b))return b=_a(b,S.mode,E,null),b.return=S,b;Cd(S,b)}return null}function p(S,b,E,R){var D=b!==null?b.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return D!==null?null:l(S,b,""+E,R);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case xd:return E.key===D?c(S,b,E,R):null;case mo:return E.key===D?u(S,b,E,R):null;case ui:return D=E._init,p(S,b,D(E._payload),R)}if(rc(E)||Ul(E))return D!==null?null:d(S,b,E,R,null);Cd(S,E)}return null}function g(S,b,E,R,D){if(typeof R=="string"&&R!==""||typeof R=="number")return S=S.get(E)||null,l(b,S,""+R,D);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case xd:return S=S.get(R.key===null?E:R.key)||null,c(b,S,R,D);case mo:return S=S.get(R.key===null?E:R.key)||null,u(b,S,R,D);case ui:var F=R._init;return g(S,b,E,F(R._payload),D)}if(rc(R)||Ul(R))return S=S.get(E)||null,d(b,S,R,D,null);Cd(b,R)}return null}function y(S,b,E,R){for(var D=null,F=null,I=b,k=b=0,j=null;I!==null&&k<E.length;k++){I.index>k?(j=I,I=null):j=I.sibling;var C=p(S,I,E[k],R);if(C===null){I===null&&(I=j);break}t&&I&&C.alternate===null&&e(S,I),b=i(C,b,k),F===null?D=C:F.sibling=C,F=C,I=j}if(k===E.length)return n(S,I),et&&la(S,k),D;if(I===null){for(;k<E.length;k++)I=m(S,E[k],R),I!==null&&(b=i(I,b,k),F===null?D=I:F.sibling=I,F=I);return et&&la(S,k),D}for(I=r(S,I);k<E.length;k++)j=g(I,S,k,E[k],R),j!==null&&(t&&j.alternate!==null&&I.delete(j.key===null?k:j.key),b=i(j,b,k),F===null?D=j:F.sibling=j,F=j);return t&&I.forEach(function(N){return e(S,N)}),et&&la(S,k),D}function v(S,b,E,R){var D=Ul(E);if(typeof D!="function")throw Error(V(150));if(E=D.call(E),E==null)throw Error(V(151));for(var F=D=null,I=b,k=b=0,j=null,C=E.next();I!==null&&!C.done;k++,C=E.next()){I.index>k?(j=I,I=null):j=I.sibling;var N=p(S,I,C.value,R);if(N===null){I===null&&(I=j);break}t&&I&&N.alternate===null&&e(S,I),b=i(N,b,k),F===null?D=N:F.sibling=N,F=N,I=j}if(C.done)return n(S,I),et&&la(S,k),D;if(I===null){for(;!C.done;k++,C=E.next())C=m(S,C.value,R),C!==null&&(b=i(C,b,k),F===null?D=C:F.sibling=C,F=C);return et&&la(S,k),D}for(I=r(S,I);!C.done;k++,C=E.next())C=g(I,S,k,C.value,R),C!==null&&(t&&C.alternate!==null&&I.delete(C.key===null?k:C.key),b=i(C,b,k),F===null?D=C:F.sibling=C,F=C);return t&&I.forEach(function(P){return e(S,P)}),et&&la(S,k),D}function _(S,b,E,R){if(typeof E=="object"&&E!==null&&E.type===po&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case xd:e:{for(var D=E.key,F=b;F!==null;){if(F.key===D){if(D=E.type,D===po){if(F.tag===7){n(S,F.sibling),b=s(F,E.props.children),b.return=S,S=b;break e}}else if(F.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ui&&$_(D)===F.type){n(S,F.sibling),b=s(F,E.props),b.ref=ql(S,F,E),b.return=S,S=b;break e}n(S,F);break}else e(S,F);F=F.sibling}E.type===po?(b=_a(E.props.children,S.mode,R,E.key),b.return=S,S=b):(R=ch(E.type,E.key,E.props,null,S.mode,R),R.ref=ql(S,b,E),R.return=S,S=R)}return o(S);case mo:e:{for(F=E.key;b!==null;){if(b.key===F)if(b.tag===4&&b.stateNode.containerInfo===E.containerInfo&&b.stateNode.implementation===E.implementation){n(S,b.sibling),b=s(b,E.children||[]),b.return=S,S=b;break e}else{n(S,b);break}else e(S,b);b=b.sibling}b=Kp(E,S.mode,R),b.return=S,S=b}return o(S);case ui:return F=E._init,_(S,b,F(E._payload),R)}if(rc(E))return y(S,b,E,R);if(Ul(E))return v(S,b,E,R);Cd(S,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,b!==null&&b.tag===6?(n(S,b.sibling),b=s(b,E),b.return=S,S=b):(n(S,b),b=Qp(E,S.mode,R),b.return=S,S=b),o(S)):n(S,b)}return _}var zo=jk(!0),Rk=jk(!1),yu={},ss=Hi(yu),Oc=Hi(yu),$c=Hi(yu);function ga(t){if(t===yu)throw Error(V(174));return t}function yy(t,e){switch(He($c,e),He(Oc,t),He(ss,yu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Kg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Kg(e,t)}Xe(ss),He(ss,e)}function Uo(){Xe(ss),Xe(Oc),Xe($c)}function Ak(t){ga($c.current);var e=ga(ss.current),n=Kg(e,t.type);e!==n&&(He(Oc,t),He(ss,n))}function vy(t){Oc.current===t&&(Xe(ss),Xe(Oc))}var nt=Hi(0);function zh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Up=[];function wy(){for(var t=0;t<Up.length;t++)Up[t]._workInProgressVersionPrimary=null;Up.length=0}var sh=qs.ReactCurrentDispatcher,Vp=qs.ReactCurrentBatchConfig,Ia=0,st=null,It=null,Nt=null,Uh=!1,xc=!1,Bc=0,OP=0;function en(){throw Error(V(321))}function _y(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!$r(t[n],e[n]))return!1;return!0}function by(t,e,n,r,s,i){if(Ia=i,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sh.current=t===null||t.memoizedState===null?UP:VP,t=n(r,s),xc){i=0;do{if(xc=!1,Bc=0,25<=i)throw Error(V(301));i+=1,Nt=It=null,e.updateQueue=null,sh.current=HP,t=n(r,s)}while(xc)}if(sh.current=Vh,e=It!==null&&It.next!==null,Ia=0,Nt=It=st=null,Uh=!1,e)throw Error(V(300));return t}function Sy(){var t=Bc!==0;return Bc=0,t}function Jr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?st.memoizedState=Nt=t:Nt=Nt.next=t,Nt}function gr(){if(It===null){var t=st.alternate;t=t!==null?t.memoizedState:null}else t=It.next;var e=Nt===null?st.memoizedState:Nt.next;if(e!==null)Nt=e,It=t;else{if(t===null)throw Error(V(310));It=t,t={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Nt===null?st.memoizedState=Nt=t:Nt=Nt.next=t}return Nt}function zc(t,e){return typeof e=="function"?e(t):e}function Hp(t){var e=gr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=It,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Ia&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,st.lanes|=d,Ca|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,$r(r,e.memoizedState)||(Nn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,st.lanes|=i,Ca|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Wp(t){var e=gr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);$r(i,e.memoizedState)||(Nn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Nk(){}function Pk(t,e){var n=st,r=gr(),s=e(),i=!$r(r.memoizedState,s);if(i&&(r.memoizedState=s,Nn=!0),r=r.queue,Ey(Lk.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Nt!==null&&Nt.memoizedState.tag&1){if(n.flags|=2048,Uc(9,Dk.bind(null,n,r,s,e),void 0,null),Ft===null)throw Error(V(349));Ia&30||Fk(n,e,s)}return s}function Fk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Dk(t,e,n,r){e.value=n,e.getSnapshot=r,Mk(e)&&Ok(t)}function Lk(t,e,n){return n(function(){Mk(e)&&Ok(t)})}function Mk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!$r(t,n)}catch{return!0}}function Ok(t){var e=Os(t,1);e!==null&&Lr(e,t,1,-1)}function B_(t){var e=Jr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zc,lastRenderedState:t},e.queue=t,t=t.dispatch=zP.bind(null,st,t),[e.memoizedState,t]}function Uc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function $k(){return gr().memoizedState}function ih(t,e,n,r){var s=Jr();st.flags|=t,s.memoizedState=Uc(1|e,n,void 0,r===void 0?null:r)}function Wf(t,e,n,r){var s=gr();r=r===void 0?null:r;var i=void 0;if(It!==null){var o=It.memoizedState;if(i=o.destroy,r!==null&&_y(r,o.deps)){s.memoizedState=Uc(e,n,i,r);return}}st.flags|=t,s.memoizedState=Uc(1|e,n,i,r)}function z_(t,e){return ih(8390656,8,t,e)}function Ey(t,e){return Wf(2048,8,t,e)}function Bk(t,e){return Wf(4,2,t,e)}function zk(t,e){return Wf(4,4,t,e)}function Uk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Vk(t,e,n){return n=n!=null?n.concat([t]):null,Wf(4,4,Uk.bind(null,e,t),n)}function ky(){}function Hk(t,e){var n=gr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_y(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Wk(t,e){var n=gr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_y(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Gk(t,e,n){return Ia&21?($r(n,e)||(n=KE(),st.lanes|=n,Ca|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Nn=!0),t.memoizedState=n)}function $P(t,e){var n=Oe;Oe=n!==0&&4>n?n:4,t(!0);var r=Vp.transition;Vp.transition={};try{t(!1),e()}finally{Oe=n,Vp.transition=r}}function qk(){return gr().memoizedState}function BP(t,e,n){var r=ji(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qk(t))Kk(e,n);else if(n=kk(t,e,n,r),n!==null){var s=xn();Lr(n,t,r,s),Xk(n,e,r)}}function zP(t,e,n){var r=ji(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qk(t))Kk(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,$r(l,o)){var c=e.interleaved;c===null?(s.next=s,gy(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=kk(t,e,s,r),n!==null&&(s=xn(),Lr(n,t,r,s),Xk(n,e,r))}}function Qk(t){var e=t.alternate;return t===st||e!==null&&e===st}function Kk(t,e){xc=Uh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Xk(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ny(t,n)}}var Vh={readContext:pr,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},UP={readContext:pr,useCallback:function(t,e){return Jr().memoizedState=[t,e===void 0?null:e],t},useContext:pr,useEffect:z_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ih(4194308,4,Uk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ih(4194308,4,t,e)},useInsertionEffect:function(t,e){return ih(4,2,t,e)},useMemo:function(t,e){var n=Jr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Jr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=BP.bind(null,st,t),[r.memoizedState,t]},useRef:function(t){var e=Jr();return t={current:t},e.memoizedState=t},useState:B_,useDebugValue:ky,useDeferredValue:function(t){return Jr().memoizedState=t},useTransition:function(){var t=B_(!1),e=t[0];return t=$P.bind(null,t[1]),Jr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=st,s=Jr();if(et){if(n===void 0)throw Error(V(407));n=n()}else{if(n=e(),Ft===null)throw Error(V(349));Ia&30||Fk(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,z_(Lk.bind(null,r,i,t),[t]),r.flags|=2048,Uc(9,Dk.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Jr(),e=Ft.identifierPrefix;if(et){var n=Ts,r=ks;n=(r&~(1<<32-Dr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},VP={readContext:pr,useCallback:Hk,useContext:pr,useEffect:Ey,useImperativeHandle:Vk,useInsertionEffect:Bk,useLayoutEffect:zk,useMemo:Wk,useReducer:Hp,useRef:$k,useState:function(){return Hp(zc)},useDebugValue:ky,useDeferredValue:function(t){var e=gr();return Gk(e,It.memoizedState,t)},useTransition:function(){var t=Hp(zc)[0],e=gr().memoizedState;return[t,e]},useMutableSource:Nk,useSyncExternalStore:Pk,useId:qk,unstable_isNewReconciler:!1},HP={readContext:pr,useCallback:Hk,useContext:pr,useEffect:Ey,useImperativeHandle:Vk,useInsertionEffect:Bk,useLayoutEffect:zk,useMemo:Wk,useReducer:Wp,useRef:$k,useState:function(){return Wp(zc)},useDebugValue:ky,useDeferredValue:function(t){var e=gr();return It===null?e.memoizedState=t:Gk(e,It.memoizedState,t)},useTransition:function(){var t=Wp(zc)[0],e=gr().memoizedState;return[t,e]},useMutableSource:Nk,useSyncExternalStore:Pk,useId:qk,unstable_isNewReconciler:!1};function Vo(t,e){try{var n="",r=e;do n+=yN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Gp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function y0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WP=typeof WeakMap=="function"?WeakMap:Map;function Yk(t,e,n){n=Ns(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Wh||(Wh=!0,C0=r),y0(t,e)},n}function Jk(t,e,n){n=Ns(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){y0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){y0(t,e),typeof r!="function"&&(Ci===null?Ci=new Set([this]):Ci.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function U_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=i4.bind(null,t,e,n),e.then(t,t))}function V_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function H_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ns(-1,1),e.tag=2,Ii(n,e,1))),n.lanes|=1),t)}var GP=qs.ReactCurrentOwner,Nn=!1;function mn(t,e,n,r){e.child=t===null?Rk(e,null,n,r):zo(e,t.child,n,r)}function W_(t,e,n,r,s){n=n.render;var i=e.ref;return No(e,s),r=by(t,e,n,r,i,s),n=Sy(),t!==null&&!Nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,$s(t,e,s)):(et&&n&&uy(e),e.flags|=1,mn(t,e,r,s),e.child)}function G_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Py(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Zk(t,e,i,r,s)):(t=ch(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Fc,n(o,r)&&t.ref===e.ref)return $s(t,e,s)}return e.flags|=1,t=Ri(i,r),t.ref=e.ref,t.return=e,e.child=t}function Zk(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Fc(i,r)&&t.ref===e.ref)if(Nn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Nn=!0);else return e.lanes=t.lanes,$s(t,e,s)}return v0(t,e,n,r,s)}function eT(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(ko,Vn),Vn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,He(ko,Vn),Vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,He(ko,Vn),Vn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,He(ko,Vn),Vn|=r;return mn(t,e,s,n),e.child}function tT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function v0(t,e,n,r,s){var i=Fn(n)?ka:ln.current;return i=$o(e,i),No(e,s),n=by(t,e,n,r,i,s),r=Sy(),t!==null&&!Nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,$s(t,e,s)):(et&&r&&uy(e),e.flags|=1,mn(t,e,n,s),e.child)}function q_(t,e,n,r,s){if(Fn(n)){var i=!0;Dh(e)}else i=!1;if(No(e,s),e.stateNode===null)ah(t,e),Ck(e,n,r),x0(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=pr(u):(u=Fn(n)?ka:ln.current,u=$o(e,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&O_(e,o,r,u),di=!1;var p=e.memoizedState;o.state=p,Bh(e,r,o,s),c=e.memoizedState,l!==r||p!==c||Pn.current||di?(typeof d=="function"&&(g0(e,n,d,r),c=e.memoizedState),(l=di||M_(e,n,l,r,p,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Tk(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:jr(e.type,l),o.props=u,m=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=pr(c):(c=Fn(n)?ka:ln.current,c=$o(e,c));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||p!==c)&&O_(e,o,r,c),di=!1,p=e.memoizedState,o.state=p,Bh(e,r,o,s);var y=e.memoizedState;l!==m||p!==y||Pn.current||di?(typeof g=="function"&&(g0(e,n,g,r),y=e.memoizedState),(u=di||M_(e,n,u,r,p,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return w0(t,e,n,r,i,s)}function w0(t,e,n,r,s,i){tT(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&N_(e,n,!1),$s(t,e,i);r=e.stateNode,GP.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=zo(e,t.child,null,i),e.child=zo(e,null,l,i)):mn(t,e,l,i),e.memoizedState=r.state,s&&N_(e,n,!0),e.child}function nT(t){var e=t.stateNode;e.pendingContext?A_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&A_(t,e.context,!1),yy(t,e.containerInfo)}function Q_(t,e,n,r,s){return Bo(),hy(s),e.flags|=256,mn(t,e,n,r),e.child}var _0={dehydrated:null,treeContext:null,retryLane:0};function b0(t){return{baseLanes:t,cachePool:null,transitions:null}}function rT(t,e,n){var r=e.pendingProps,s=nt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),He(nt,s&1),t===null)return m0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Qf(o,r,0,null),t=_a(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=b0(n),e.memoizedState=_0,t):Ty(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return qP(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ri(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ri(l,i):(i=_a(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?b0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=_0,r}return i=t.child,t=i.sibling,r=Ri(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ty(t,e){return e=Qf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jd(t,e,n,r){return r!==null&&hy(r),zo(e,t.child,null,n),t=Ty(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function qP(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Gp(Error(V(422))),jd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Qf({mode:"visible",children:r.children},s,0,null),i=_a(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&zo(e,t.child,null,o),e.child.memoizedState=b0(o),e.memoizedState=_0,i);if(!(e.mode&1))return jd(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(V(419)),r=Gp(i,r,void 0),jd(t,e,o,r)}if(l=(o&t.childLanes)!==0,Nn||l){if(r=Ft,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Os(t,s),Lr(r,t,s,-1))}return Ny(),r=Gp(Error(V(421))),jd(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=a4.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Wn=Ti(s.nextSibling),Kn=e,et=!0,Ar=null,t!==null&&(dr[hr++]=ks,dr[hr++]=Ts,dr[hr++]=Ta,ks=t.id,Ts=t.overflow,Ta=e),e=Ty(e,r.children),e.flags|=4096,e)}function K_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),p0(t.return,e,n)}function qp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function sT(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(mn(t,e,r.children,n),r=nt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&K_(t,n,e);else if(t.tag===19)K_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(He(nt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&zh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),qp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&zh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}qp(e,!0,n,null,i);break;case"together":qp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ah(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $s(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ca|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,n=Ri(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ri(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function QP(t,e,n){switch(e.tag){case 3:nT(e),Bo();break;case 5:Ak(e);break;case 1:Fn(e.type)&&Dh(e);break;case 4:yy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;He(Oh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(He(nt,nt.current&1),e.flags|=128,null):n&e.child.childLanes?rT(t,e,n):(He(nt,nt.current&1),t=$s(t,e,n),t!==null?t.sibling:null);He(nt,nt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return sT(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),He(nt,nt.current),r)break;return null;case 22:case 23:return e.lanes=0,eT(t,e,n)}return $s(t,e,n)}var iT,S0,aT,oT;iT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};S0=function(){};aT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ga(ss.current);var i=null;switch(n){case"input":s=Wg(t,s),r=Wg(t,r),i=[];break;case"select":s=it({},s,{value:void 0}),r=it({},r,{value:void 0}),i=[];break;case"textarea":s=Qg(t,s),r=Qg(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ph)}Xg(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ic.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ic.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Qe("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};oT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ql(t,e){if(!et)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function tn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function KP(t,e,n){var r=e.pendingProps;switch(dy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(e),null;case 1:return Fn(e.type)&&Fh(),tn(e),null;case 3:return r=e.stateNode,Uo(),Xe(Pn),Xe(ln),wy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Id(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ar!==null&&(A0(Ar),Ar=null))),S0(t,e),tn(e),null;case 5:vy(e);var s=ga($c.current);if(n=e.type,t!==null&&e.stateNode!=null)aT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(V(166));return tn(e),null}if(t=ga(ss.current),Id(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[es]=e,r[Mc]=i,t=(e.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(s=0;s<ic.length;s++)Qe(ic[s],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":s_(r,i),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Qe("invalid",r);break;case"textarea":a_(r,i),Qe("invalid",r)}Xg(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Td(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Td(r.textContent,l,t),s=["children",""+l]):Ic.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Qe("scroll",r)}switch(n){case"input":yd(r),i_(r,i,!0);break;case"textarea":yd(r),o_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ph)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=FE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[es]=e,t[Mc]=r,iT(t,e,!1,!1),e.stateNode=t;e:{switch(o=Yg(n,r),n){case"dialog":Qe("cancel",t),Qe("close",t),s=r;break;case"iframe":case"object":case"embed":Qe("load",t),s=r;break;case"video":case"audio":for(s=0;s<ic.length;s++)Qe(ic[s],t);s=r;break;case"source":Qe("error",t),s=r;break;case"img":case"image":case"link":Qe("error",t),Qe("load",t),s=r;break;case"details":Qe("toggle",t),s=r;break;case"input":s_(t,r),s=Wg(t,r),Qe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=it({},r,{value:void 0}),Qe("invalid",t);break;case"textarea":a_(t,r),s=Qg(t,r),Qe("invalid",t);break;default:s=r}Xg(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?ME(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&DE(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Cc(t,c):typeof c=="number"&&Cc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ic.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Qe("scroll",t):c!=null&&Xx(t,i,c,o))}switch(n){case"input":yd(t),i_(t,r,!1);break;case"textarea":yd(t),o_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Li(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Co(t,!!r.multiple,i,!1):r.defaultValue!=null&&Co(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ph)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tn(e),null;case 6:if(t&&e.stateNode!=null)oT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(V(166));if(n=ga($c.current),ga(ss.current),Id(e)){if(r=e.stateNode,n=e.memoizedProps,r[es]=e,(i=r.nodeValue!==n)&&(t=Kn,t!==null))switch(t.tag){case 3:Td(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Td(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[es]=e,e.stateNode=r}return tn(e),null;case 13:if(Xe(nt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(et&&Wn!==null&&e.mode&1&&!(e.flags&128))Ek(),Bo(),e.flags|=98560,i=!1;else if(i=Id(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(V(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(V(317));i[es]=e}else Bo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tn(e),i=!1}else Ar!==null&&(A0(Ar),Ar=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||nt.current&1?Ct===0&&(Ct=3):Ny())),e.updateQueue!==null&&(e.flags|=4),tn(e),null);case 4:return Uo(),S0(t,e),t===null&&Dc(e.stateNode.containerInfo),tn(e),null;case 10:return py(e.type._context),tn(e),null;case 17:return Fn(e.type)&&Fh(),tn(e),null;case 19:if(Xe(nt),i=e.memoizedState,i===null)return tn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ql(i,!1);else{if(Ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=zh(t),o!==null){for(e.flags|=128,Ql(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return He(nt,nt.current&1|2),e.child}t=t.sibling}i.tail!==null&&gt()>Ho&&(e.flags|=128,r=!0,Ql(i,!1),e.lanes=4194304)}else{if(!r)if(t=zh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ql(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!et)return tn(e),null}else 2*gt()-i.renderingStartTime>Ho&&n!==1073741824&&(e.flags|=128,r=!0,Ql(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=gt(),e.sibling=null,n=nt.current,He(nt,r?n&1|2:n&1),e):(tn(e),null);case 22:case 23:return Ay(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vn&1073741824&&(tn(e),e.subtreeFlags&6&&(e.flags|=8192)):tn(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function XP(t,e){switch(dy(e),e.tag){case 1:return Fn(e.type)&&Fh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Uo(),Xe(Pn),Xe(ln),wy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vy(e),null;case 13:if(Xe(nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));Bo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Xe(nt),null;case 4:return Uo(),null;case 10:return py(e.type._context),null;case 22:case 23:return Ay(),null;case 24:return null;default:return null}}var Rd=!1,sn=!1,YP=typeof WeakSet=="function"?WeakSet:Set,K=null;function Eo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ct(t,e,r)}else n.current=null}function E0(t,e,n){try{n()}catch(r){ct(t,e,r)}}var X_=!1;function JP(t,e){if(o0=Rh,t=dk(),cy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,m=t,p=null;t:for(;;){for(var g;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(g=m.firstChild)!==null;)p=m,m=g;for(;;){if(m===t)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===r&&(c=o),(g=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(l0={focusedElem:t,selectionRange:n},Rh=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,_=y.memoizedState,S=e.stateNode,b=S.getSnapshotBeforeUpdate(e.elementType===e.type?v:jr(e.type,v),_);S.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(R){ct(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return y=X_,X_=!1,y}function yc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&E0(e,n,i)}s=s.next}while(s!==r)}}function Gf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function k0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function lT(t){var e=t.alternate;e!==null&&(t.alternate=null,lT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[es],delete e[Mc],delete e[d0],delete e[FP],delete e[DP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function cT(t){return t.tag===5||t.tag===3||t.tag===4}function Y_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||cT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function T0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ph));else if(r!==4&&(t=t.child,t!==null))for(T0(t,e,n),t=t.sibling;t!==null;)T0(t,e,n),t=t.sibling}function I0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(I0(t,e,n),t=t.sibling;t!==null;)I0(t,e,n),t=t.sibling}var $t=null,Rr=!1;function oi(t,e,n){for(n=n.child;n!==null;)uT(t,e,n),n=n.sibling}function uT(t,e,n){if(rs&&typeof rs.onCommitFiberUnmount=="function")try{rs.onCommitFiberUnmount(Of,n)}catch{}switch(n.tag){case 5:sn||Eo(n,e);case 6:var r=$t,s=Rr;$t=null,oi(t,e,n),$t=r,Rr=s,$t!==null&&(Rr?(t=$t,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$t.removeChild(n.stateNode));break;case 18:$t!==null&&(Rr?(t=$t,n=n.stateNode,t.nodeType===8?Bp(t.parentNode,n):t.nodeType===1&&Bp(t,n),Nc(t)):Bp($t,n.stateNode));break;case 4:r=$t,s=Rr,$t=n.stateNode.containerInfo,Rr=!0,oi(t,e,n),$t=r,Rr=s;break;case 0:case 11:case 14:case 15:if(!sn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&E0(n,e,o),s=s.next}while(s!==r)}oi(t,e,n);break;case 1:if(!sn&&(Eo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ct(n,e,l)}oi(t,e,n);break;case 21:oi(t,e,n);break;case 22:n.mode&1?(sn=(r=sn)||n.memoizedState!==null,oi(t,e,n),sn=r):oi(t,e,n);break;default:oi(t,e,n)}}function J_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YP),e.forEach(function(r){var s=o4.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ir(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:$t=l.stateNode,Rr=!1;break e;case 3:$t=l.stateNode.containerInfo,Rr=!0;break e;case 4:$t=l.stateNode.containerInfo,Rr=!0;break e}l=l.return}if($t===null)throw Error(V(160));uT(i,o,s),$t=null,Rr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){ct(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dT(e,t),e=e.sibling}function dT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ir(e,t),qr(t),r&4){try{yc(3,t,t.return),Gf(3,t)}catch(v){ct(t,t.return,v)}try{yc(5,t,t.return)}catch(v){ct(t,t.return,v)}}break;case 1:Ir(e,t),qr(t),r&512&&n!==null&&Eo(n,n.return);break;case 5:if(Ir(e,t),qr(t),r&512&&n!==null&&Eo(n,n.return),t.flags&32){var s=t.stateNode;try{Cc(s,"")}catch(v){ct(t,t.return,v)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&NE(s,i),Yg(l,o);var u=Yg(l,i);for(o=0;o<c.length;o+=2){var d=c[o],m=c[o+1];d==="style"?ME(s,m):d==="dangerouslySetInnerHTML"?DE(s,m):d==="children"?Cc(s,m):Xx(s,d,m,u)}switch(l){case"input":Gg(s,i);break;case"textarea":PE(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Co(s,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?Co(s,!!i.multiple,i.defaultValue,!0):Co(s,!!i.multiple,i.multiple?[]:"",!1))}s[Mc]=i}catch(v){ct(t,t.return,v)}}break;case 6:if(Ir(e,t),qr(t),r&4){if(t.stateNode===null)throw Error(V(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){ct(t,t.return,v)}}break;case 3:if(Ir(e,t),qr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Nc(e.containerInfo)}catch(v){ct(t,t.return,v)}break;case 4:Ir(e,t),qr(t);break;case 13:Ir(e,t),qr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(jy=gt())),r&4&&J_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(sn=(u=sn)||d,Ir(e,t),sn=u):Ir(e,t),qr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(K=t,d=t.child;d!==null;){for(m=K=d;K!==null;){switch(p=K,g=p.child,p.tag){case 0:case 11:case 14:case 15:yc(4,p,p.return);break;case 1:Eo(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){ct(r,n,v)}}break;case 5:Eo(p,p.return);break;case 22:if(p.memoizedState!==null){eb(m);continue}}g!==null?(g.return=p,K=g):eb(m)}d=d.sibling}e:for(d=null,m=t;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=LE("display",o))}catch(v){ct(t,t.return,v)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(v){ct(t,t.return,v)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Ir(e,t),qr(t),r&4&&J_(t);break;case 21:break;default:Ir(e,t),qr(t)}}function qr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(cT(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Cc(s,""),r.flags&=-33);var i=Y_(t);I0(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Y_(t);T0(t,l,o);break;default:throw Error(V(161))}}catch(c){ct(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZP(t,e,n){K=t,hT(t)}function hT(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var s=K,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Rd;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||sn;l=Rd;var u=sn;if(Rd=o,(sn=c)&&!u)for(K=s;K!==null;)o=K,c=o.child,o.tag===22&&o.memoizedState!==null?tb(s):c!==null?(c.return=o,K=c):tb(s);for(;i!==null;)K=i,hT(i),i=i.sibling;K=s,Rd=l,sn=u}Z_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,K=i):Z_(t)}}function Z_(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:sn||Gf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!sn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:jr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&L_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}L_(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Nc(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}sn||e.flags&512&&k0(e)}catch(p){ct(e,e.return,p)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function eb(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function tb(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Gf(4,e)}catch(c){ct(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ct(e,s,c)}}var i=e.return;try{k0(e)}catch(c){ct(e,i,c)}break;case 5:var o=e.return;try{k0(e)}catch(c){ct(e,o,c)}}}catch(c){ct(e,e.return,c)}if(e===t){K=null;break}var l=e.sibling;if(l!==null){l.return=e.return,K=l;break}K=e.return}}var e4=Math.ceil,Hh=qs.ReactCurrentDispatcher,Iy=qs.ReactCurrentOwner,mr=qs.ReactCurrentBatchConfig,Fe=0,Ft=null,bt=null,Vt=0,Vn=0,ko=Hi(0),Ct=0,Vc=null,Ca=0,qf=0,Cy=0,vc=null,Rn=null,jy=0,Ho=1/0,_s=null,Wh=!1,C0=null,Ci=null,Ad=!1,wi=null,Gh=0,wc=0,j0=null,oh=-1,lh=0;function xn(){return Fe&6?gt():oh!==-1?oh:oh=gt()}function ji(t){return t.mode&1?Fe&2&&Vt!==0?Vt&-Vt:MP.transition!==null?(lh===0&&(lh=KE()),lh):(t=Oe,t!==0||(t=window.event,t=t===void 0?16:nk(t.type)),t):1}function Lr(t,e,n,r){if(50<wc)throw wc=0,j0=null,Error(V(185));pu(t,n,r),(!(Fe&2)||t!==Ft)&&(t===Ft&&(!(Fe&2)&&(qf|=n),Ct===4&&fi(t,Vt)),Dn(t,r),n===1&&Fe===0&&!(e.mode&1)&&(Ho=gt()+500,Vf&&Wi()))}function Dn(t,e){var n=t.callbackNode;MN(t,e);var r=jh(t,t===Ft?Vt:0);if(r===0)n!==null&&u_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&u_(n),e===1)t.tag===0?LP(nb.bind(null,t)):_k(nb.bind(null,t)),NP(function(){!(Fe&6)&&Wi()}),n=null;else{switch(XE(r)){case 1:n=ty;break;case 4:n=qE;break;case 16:n=Ch;break;case 536870912:n=QE;break;default:n=Ch}n=wT(n,fT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function fT(t,e){if(oh=-1,lh=0,Fe&6)throw Error(V(327));var n=t.callbackNode;if(Po()&&t.callbackNode!==n)return null;var r=jh(t,t===Ft?Vt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=qh(t,r);else{e=r;var s=Fe;Fe|=2;var i=pT();(Ft!==t||Vt!==e)&&(_s=null,Ho=gt()+500,wa(t,e));do try{r4();break}catch(l){mT(t,l)}while(1);my(),Hh.current=i,Fe=s,bt!==null?e=0:(Ft=null,Vt=0,e=Ct)}if(e!==0){if(e===2&&(s=n0(t),s!==0&&(r=s,e=R0(t,s))),e===1)throw n=Vc,wa(t,0),fi(t,r),Dn(t,gt()),n;if(e===6)fi(t,r);else{if(s=t.current.alternate,!(r&30)&&!t4(s)&&(e=qh(t,r),e===2&&(i=n0(t),i!==0&&(r=i,e=R0(t,i))),e===1))throw n=Vc,wa(t,0),fi(t,r),Dn(t,gt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(V(345));case 2:ca(t,Rn,_s);break;case 3:if(fi(t,r),(r&130023424)===r&&(e=jy+500-gt(),10<e)){if(jh(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){xn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=u0(ca.bind(null,t,Rn,_s),e);break}ca(t,Rn,_s);break;case 4:if(fi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Dr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*e4(r/1960))-r,10<r){t.timeoutHandle=u0(ca.bind(null,t,Rn,_s),r);break}ca(t,Rn,_s);break;case 5:ca(t,Rn,_s);break;default:throw Error(V(329))}}}return Dn(t,gt()),t.callbackNode===n?fT.bind(null,t):null}function R0(t,e){var n=vc;return t.current.memoizedState.isDehydrated&&(wa(t,e).flags|=256),t=qh(t,e),t!==2&&(e=Rn,Rn=n,e!==null&&A0(e)),t}function A0(t){Rn===null?Rn=t:Rn.push.apply(Rn,t)}function t4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!$r(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fi(t,e){for(e&=~Cy,e&=~qf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Dr(e),r=1<<n;t[n]=-1,e&=~r}}function nb(t){if(Fe&6)throw Error(V(327));Po();var e=jh(t,0);if(!(e&1))return Dn(t,gt()),null;var n=qh(t,e);if(t.tag!==0&&n===2){var r=n0(t);r!==0&&(e=r,n=R0(t,r))}if(n===1)throw n=Vc,wa(t,0),fi(t,e),Dn(t,gt()),n;if(n===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ca(t,Rn,_s),Dn(t,gt()),null}function Ry(t,e){var n=Fe;Fe|=1;try{return t(e)}finally{Fe=n,Fe===0&&(Ho=gt()+500,Vf&&Wi())}}function ja(t){wi!==null&&wi.tag===0&&!(Fe&6)&&Po();var e=Fe;Fe|=1;var n=mr.transition,r=Oe;try{if(mr.transition=null,Oe=1,t)return t()}finally{Oe=r,mr.transition=n,Fe=e,!(Fe&6)&&Wi()}}function Ay(){Vn=ko.current,Xe(ko)}function wa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,AP(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(dy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fh();break;case 3:Uo(),Xe(Pn),Xe(ln),wy();break;case 5:vy(r);break;case 4:Uo();break;case 13:Xe(nt);break;case 19:Xe(nt);break;case 10:py(r.type._context);break;case 22:case 23:Ay()}n=n.return}if(Ft=t,bt=t=Ri(t.current,null),Vt=Vn=e,Ct=0,Vc=null,Cy=qf=Ca=0,Rn=vc=null,pa!==null){for(e=0;e<pa.length;e++)if(n=pa[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}pa=null}return t}function mT(t,e){do{var n=bt;try{if(my(),sh.current=Vh,Uh){for(var r=st.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Uh=!1}if(Ia=0,Nt=It=st=null,xc=!1,Bc=0,Iy.current=null,n===null||n.return===null){Ct=1,Vc=e,bt=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Vt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=V_(o);if(g!==null){g.flags&=-257,H_(g,o,l,i,e),g.mode&1&&U_(i,u,e),e=g,c=u;var y=e.updateQueue;if(y===null){var v=new Set;v.add(c),e.updateQueue=v}else y.add(c);break e}else{if(!(e&1)){U_(i,u,e),Ny();break e}c=Error(V(426))}}else if(et&&l.mode&1){var _=V_(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),H_(_,o,l,i,e),hy(Vo(c,l));break e}}i=c=Vo(c,l),Ct!==4&&(Ct=2),vc===null?vc=[i]:vc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var S=Yk(i,c,e);D_(i,S);break e;case 1:l=c;var b=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Ci===null||!Ci.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=Jk(i,l,e);D_(i,R);break e}}i=i.return}while(i!==null)}xT(n)}catch(D){e=D,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(1)}function pT(){var t=Hh.current;return Hh.current=Vh,t===null?Vh:t}function Ny(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Ft===null||!(Ca&268435455)&&!(qf&268435455)||fi(Ft,Vt)}function qh(t,e){var n=Fe;Fe|=2;var r=pT();(Ft!==t||Vt!==e)&&(_s=null,wa(t,e));do try{n4();break}catch(s){mT(t,s)}while(1);if(my(),Fe=n,Hh.current=r,bt!==null)throw Error(V(261));return Ft=null,Vt=0,Ct}function n4(){for(;bt!==null;)gT(bt)}function r4(){for(;bt!==null&&!CN();)gT(bt)}function gT(t){var e=vT(t.alternate,t,Vn);t.memoizedProps=t.pendingProps,e===null?xT(t):bt=e,Iy.current=null}function xT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=XP(n,e),n!==null){n.flags&=32767,bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ct=6,bt=null;return}}else if(n=KP(n,e,Vn),n!==null){bt=n;return}if(e=e.sibling,e!==null){bt=e;return}bt=e=t}while(e!==null);Ct===0&&(Ct=5)}function ca(t,e,n){var r=Oe,s=mr.transition;try{mr.transition=null,Oe=1,s4(t,e,n,r)}finally{mr.transition=s,Oe=r}return null}function s4(t,e,n,r){do Po();while(wi!==null);if(Fe&6)throw Error(V(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(ON(t,i),t===Ft&&(bt=Ft=null,Vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ad||(Ad=!0,wT(Ch,function(){return Po(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=mr.transition,mr.transition=null;var o=Oe;Oe=1;var l=Fe;Fe|=4,Iy.current=null,JP(t,n),dT(n,t),EP(l0),Rh=!!o0,l0=o0=null,t.current=n,ZP(n),jN(),Fe=l,Oe=o,mr.transition=i}else t.current=n;if(Ad&&(Ad=!1,wi=t,Gh=s),i=t.pendingLanes,i===0&&(Ci=null),NN(n.stateNode),Dn(t,gt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Wh)throw Wh=!1,t=C0,C0=null,t;return Gh&1&&t.tag!==0&&Po(),i=t.pendingLanes,i&1?t===j0?wc++:(wc=0,j0=t):wc=0,Wi(),null}function Po(){if(wi!==null){var t=XE(Gh),e=mr.transition,n=Oe;try{if(mr.transition=null,Oe=16>t?16:t,wi===null)var r=!1;else{if(t=wi,wi=null,Gh=0,Fe&6)throw Error(V(331));var s=Fe;for(Fe|=4,K=t.current;K!==null;){var i=K,o=i.child;if(K.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(K=u;K!==null;){var d=K;switch(d.tag){case 0:case 11:case 15:yc(8,d,i)}var m=d.child;if(m!==null)m.return=d,K=m;else for(;K!==null;){d=K;var p=d.sibling,g=d.return;if(lT(d),d===u){K=null;break}if(p!==null){p.return=g,K=p;break}K=g}}}var y=i.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}K=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,K=o;else e:for(;K!==null;){if(i=K,i.flags&2048)switch(i.tag){case 0:case 11:case 15:yc(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,K=S;break e}K=i.return}}var b=t.current;for(K=b;K!==null;){o=K;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,K=E;else e:for(o=b;K!==null;){if(l=K,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Gf(9,l)}}catch(D){ct(l,l.return,D)}if(l===o){K=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,K=R;break e}K=l.return}}if(Fe=s,Wi(),rs&&typeof rs.onPostCommitFiberRoot=="function")try{rs.onPostCommitFiberRoot(Of,t)}catch{}r=!0}return r}finally{Oe=n,mr.transition=e}}return!1}function rb(t,e,n){e=Vo(n,e),e=Yk(t,e,1),t=Ii(t,e,1),e=xn(),t!==null&&(pu(t,1,e),Dn(t,e))}function ct(t,e,n){if(t.tag===3)rb(t,t,n);else for(;e!==null;){if(e.tag===3){rb(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ci===null||!Ci.has(r))){t=Vo(n,t),t=Jk(e,t,1),e=Ii(e,t,1),t=xn(),e!==null&&(pu(e,1,t),Dn(e,t));break}}e=e.return}}function i4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=xn(),t.pingedLanes|=t.suspendedLanes&n,Ft===t&&(Vt&n)===n&&(Ct===4||Ct===3&&(Vt&130023424)===Vt&&500>gt()-jy?wa(t,0):Cy|=n),Dn(t,e)}function yT(t,e){e===0&&(t.mode&1?(e=_d,_d<<=1,!(_d&130023424)&&(_d=4194304)):e=1);var n=xn();t=Os(t,e),t!==null&&(pu(t,e,n),Dn(t,n))}function a4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),yT(t,n)}function o4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(e),yT(t,n)}var vT;vT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Pn.current)Nn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Nn=!1,QP(t,e,n);Nn=!!(t.flags&131072)}else Nn=!1,et&&e.flags&1048576&&bk(e,Mh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ah(t,e),t=e.pendingProps;var s=$o(e,ln.current);No(e,n),s=by(null,e,r,t,s,n);var i=Sy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fn(r)?(i=!0,Dh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,xy(e),s.updater=Hf,e.stateNode=s,s._reactInternals=e,x0(e,r,t,n),e=w0(null,e,r,!0,i,n)):(e.tag=0,et&&i&&uy(e),mn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ah(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=c4(r),t=jr(r,t),s){case 0:e=v0(null,e,r,t,n);break e;case 1:e=q_(null,e,r,t,n);break e;case 11:e=W_(null,e,r,t,n);break e;case 14:e=G_(null,e,r,jr(r.type,t),n);break e}throw Error(V(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jr(r,s),v0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jr(r,s),q_(t,e,r,s,n);case 3:e:{if(nT(e),t===null)throw Error(V(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Tk(t,e),Bh(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Vo(Error(V(423)),e),e=Q_(t,e,r,n,s);break e}else if(r!==s){s=Vo(Error(V(424)),e),e=Q_(t,e,r,n,s);break e}else for(Wn=Ti(e.stateNode.containerInfo.firstChild),Kn=e,et=!0,Ar=null,n=Rk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Bo(),r===s){e=$s(t,e,n);break e}mn(t,e,r,n)}e=e.child}return e;case 5:return Ak(e),t===null&&m0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,c0(r,s)?o=null:i!==null&&c0(r,i)&&(e.flags|=32),tT(t,e),mn(t,e,o,n),e.child;case 6:return t===null&&m0(e),null;case 13:return rT(t,e,n);case 4:return yy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=zo(e,null,r,n):mn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jr(r,s),W_(t,e,r,s,n);case 7:return mn(t,e,e.pendingProps,n),e.child;case 8:return mn(t,e,e.pendingProps.children,n),e.child;case 12:return mn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,He(Oh,r._currentValue),r._currentValue=o,i!==null)if($r(i.value,o)){if(i.children===s.children&&!Pn.current){e=$s(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Ns(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),p0(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(V(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),p0(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}mn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,No(e,n),s=pr(s),r=r(s),e.flags|=1,mn(t,e,r,n),e.child;case 14:return r=e.type,s=jr(r,e.pendingProps),s=jr(r.type,s),G_(t,e,r,s,n);case 15:return Zk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jr(r,s),ah(t,e),e.tag=1,Fn(r)?(t=!0,Dh(e)):t=!1,No(e,n),Ck(e,r,s),x0(e,r,s,n),w0(null,e,r,!0,t,n);case 19:return sT(t,e,n);case 22:return eT(t,e,n)}throw Error(V(156,e.tag))};function wT(t,e){return GE(t,e)}function l4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(t,e,n,r){return new l4(t,e,n,r)}function Py(t){return t=t.prototype,!(!t||!t.isReactComponent)}function c4(t){if(typeof t=="function")return Py(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jx)return 11;if(t===Zx)return 14}return 2}function Ri(t,e){var n=t.alternate;return n===null?(n=fr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ch(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Py(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case po:return _a(n.children,s,i,e);case Yx:o=8,s|=8;break;case zg:return t=fr(12,n,e,s|2),t.elementType=zg,t.lanes=i,t;case Ug:return t=fr(13,n,e,s),t.elementType=Ug,t.lanes=i,t;case Vg:return t=fr(19,n,e,s),t.elementType=Vg,t.lanes=i,t;case jE:return Qf(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case IE:o=10;break e;case CE:o=9;break e;case Jx:o=11;break e;case Zx:o=14;break e;case ui:o=16,r=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=fr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function _a(t,e,n,r){return t=fr(7,t,r,e),t.lanes=n,t}function Qf(t,e,n,r){return t=fr(22,t,r,e),t.elementType=jE,t.lanes=n,t.stateNode={isHidden:!1},t}function Qp(t,e,n){return t=fr(6,t,null,e),t.lanes=n,t}function Kp(t,e,n){return e=fr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function u4(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jp(0),this.expirationTimes=jp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Fy(t,e,n,r,s,i,o,l,c){return t=new u4(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=fr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xy(i),t}function d4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function _T(t){if(!t)return Mi;t=t._reactInternals;e:{if(Wa(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var n=t.type;if(Fn(n))return wk(t,n,e)}return e}function bT(t,e,n,r,s,i,o,l,c){return t=Fy(n,r,!0,t,s,i,o,l,c),t.context=_T(null),n=t.current,r=xn(),s=ji(n),i=Ns(r,s),i.callback=e??null,Ii(n,i,s),t.current.lanes=s,pu(t,s,r),Dn(t,r),t}function Kf(t,e,n,r){var s=e.current,i=xn(),o=ji(s);return n=_T(n),e.context===null?e.context=n:e.pendingContext=n,e=Ns(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ii(s,e,o),t!==null&&(Lr(t,s,o,i),rh(t,s,o)),o}function Qh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Dy(t,e){sb(t,e),(t=t.alternate)&&sb(t,e)}function h4(){return null}var ST=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ly(t){this._internalRoot=t}Xf.prototype.render=Ly.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));Kf(t,e,null,null)};Xf.prototype.unmount=Ly.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ja(function(){Kf(null,t,null,null)}),e[Ms]=null}};function Xf(t){this._internalRoot=t}Xf.prototype.unstable_scheduleHydration=function(t){if(t){var e=ZE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<hi.length&&e!==0&&e<hi[n].priority;n++);hi.splice(n,0,t),n===0&&tk(t)}};function My(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ib(){}function f4(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Qh(o);i.call(u)}}var o=bT(e,r,t,0,null,!1,!1,"",ib);return t._reactRootContainer=o,t[Ms]=o.current,Dc(t.nodeType===8?t.parentNode:t),ja(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Qh(c);l.call(u)}}var c=Fy(t,0,!1,null,null,!1,!1,"",ib);return t._reactRootContainer=c,t[Ms]=c.current,Dc(t.nodeType===8?t.parentNode:t),ja(function(){Kf(e,c,n,r)}),c}function Jf(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Qh(o);l.call(c)}}Kf(e,o,t,s)}else o=f4(n,e,t,s,r);return Qh(o)}YE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=sc(e.pendingLanes);n!==0&&(ny(e,n|1),Dn(e,gt()),!(Fe&6)&&(Ho=gt()+500,Wi()))}break;case 13:ja(function(){var r=Os(t,1);if(r!==null){var s=xn();Lr(r,t,1,s)}}),Dy(t,1)}};ry=function(t){if(t.tag===13){var e=Os(t,134217728);if(e!==null){var n=xn();Lr(e,t,134217728,n)}Dy(t,134217728)}};JE=function(t){if(t.tag===13){var e=ji(t),n=Os(t,e);if(n!==null){var r=xn();Lr(n,t,e,r)}Dy(t,e)}};ZE=function(){return Oe};ek=function(t,e){var n=Oe;try{return Oe=t,e()}finally{Oe=n}};Zg=function(t,e,n){switch(e){case"input":if(Gg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Uf(r);if(!s)throw Error(V(90));AE(r),Gg(r,s)}}}break;case"textarea":PE(t,n);break;case"select":e=n.value,e!=null&&Co(t,!!n.multiple,e,!1)}};BE=Ry;zE=ja;var m4={usingClientEntryPoint:!1,Events:[xu,vo,Uf,OE,$E,Ry]},Kl={findFiberByHostInstance:ma,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},p4={bundleType:Kl.bundleType,version:Kl.version,rendererPackageName:Kl.rendererPackageName,rendererConfig:Kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=HE(t),t===null?null:t.stateNode},findFiberByHostInstance:Kl.findFiberByHostInstance||h4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{Of=Nd.inject(p4),rs=Nd}catch{}}nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m4;nr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!My(e))throw Error(V(200));return d4(t,e,null,n)};nr.createRoot=function(t,e){if(!My(t))throw Error(V(299));var n=!1,r="",s=ST;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Fy(t,1,!1,null,null,n,!1,r,s),t[Ms]=e.current,Dc(t.nodeType===8?t.parentNode:t),new Ly(e)};nr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=HE(e),t=t===null?null:t.stateNode,t};nr.flushSync=function(t){return ja(t)};nr.hydrate=function(t,e,n){if(!Yf(e))throw Error(V(200));return Jf(null,t,e,!0,n)};nr.hydrateRoot=function(t,e,n){if(!My(t))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=ST;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=bT(e,null,t,1,n??null,s,!1,i,o),t[Ms]=e.current,Dc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Xf(e)};nr.render=function(t,e,n){if(!Yf(e))throw Error(V(200));return Jf(null,t,e,!1,n)};nr.unmountComponentAtNode=function(t){if(!Yf(t))throw Error(V(40));return t._reactRootContainer?(ja(function(){Jf(null,null,t,!1,function(){t._reactRootContainer=null,t[Ms]=null})}),!0):!1};nr.unstable_batchedUpdates=Ry;nr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Yf(n))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return Jf(t,e,n,!1,r)};nr.version="18.2.0-next-9e3b772b8-20220608";function ET(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ET)}catch(t){console.error(t)}}ET(),bE.exports=nr;var Ga=bE.exports,ab=Ga;$g.createRoot=ab.createRoot,$g.hydrateRoot=ab.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hc(){return Hc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hc.apply(this,arguments)}var _i;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(_i||(_i={}));const ob="popstate";function g4(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:l="",hash:c=""}=qa(s.location.hash.substr(1));return N0("",{pathname:o,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:Kh(i))}function r(s,i){Zf(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return y4(e,n,r,t)}function yt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Zf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function x4(){return Math.random().toString(36).substr(2,8)}function lb(t,e){return{usr:t.state,key:t.key,idx:e}}function N0(t,e,n,r){return n===void 0&&(n=null),Hc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?qa(e):e,{state:n,key:e&&e.key||r||x4()})}function Kh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function qa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function y4(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=_i.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Hc({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function m(){l=_i.Pop;let _=d(),S=_==null?null:_-u;u=_,c&&c({action:l,location:v.location,delta:S})}function p(_,S){l=_i.Push;let b=N0(v.location,_,S);n&&n(b,_),u=d()+1;let E=lb(b,u),R=v.createHref(b);try{o.pushState(E,"",R)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(R)}i&&c&&c({action:l,location:v.location,delta:1})}function g(_,S){l=_i.Replace;let b=N0(v.location,_,S);n&&n(b,_),u=d();let E=lb(b,u),R=v.createHref(b);o.replaceState(E,"",R),i&&c&&c({action:l,location:v.location,delta:0})}function y(_){let S=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof _=="string"?_:Kh(_);return yt(S,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,S)}let v={get action(){return l},get location(){return t(s,o)},listen(_){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(ob,m),c=_,()=>{s.removeEventListener(ob,m),c=null}},createHref(_){return e(s,_)},createURL:y,encodeLocation(_){let S=y(_);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:p,replace:g,go(_){return o.go(_)}};return v}var cb;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(cb||(cb={}));function v4(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?qa(e):e,s=Oy(r.pathname||"/",n);if(s==null)return null;let i=kT(t);w4(i);let o=null;for(let l=0;o==null&&l<i.length;++l)o=j4(i[l],N4(s));return o}function kT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(yt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ai([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(yt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),kT(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:I4(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of TT(i.path))s(i,o,c)}),e}function TT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=TT(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function w4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:C4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const _4=/^:\w+$/,b4=3,S4=2,E4=1,k4=10,T4=-2,ub=t=>t==="*";function I4(t,e){let n=t.split("/"),r=n.length;return n.some(ub)&&(r+=T4),e&&(r+=S4),n.filter(s=>!ub(s)).reduce((s,i)=>s+(_4.test(i)?b4:i===""?E4:k4),r)}function C4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function j4(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=R4({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let m=l.route;i.push({params:r,pathname:Ai([s,d.pathname]),pathnameBase:L4(Ai([s,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(s=Ai([s,d.pathnameBase]))}return i}function R4(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=A4(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,m)=>{if(d==="*"){let p=l[m]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}return u[d]=P4(l[m]||"",d),u},{}),pathname:i,pathnameBase:o,pattern:t}}function A4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Zf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function N4(t){try{return decodeURI(t)}catch(e){return Zf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function P4(t,e){try{return decodeURIComponent(t)}catch(n){return Zf(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Oy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function F4(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?qa(t):t;return{pathname:n?n.startsWith("/")?n:D4(n,e):e,search:M4(r),hash:O4(s)}}function D4(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Xp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $y(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function By(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=qa(t):(s=Hc({},t),yt(!s.pathname||!s.pathname.includes("?"),Xp("?","pathname","search",s)),yt(!s.pathname||!s.pathname.includes("#"),Xp("#","pathname","hash",s)),yt(!s.search||!s.search.includes("#"),Xp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(r||o==null)l=n;else{let m=e.length-1;if(o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}l=m>=0?e[m]:"/"}let c=F4(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ai=t=>t.join("/").replace(/\/\/+/g,"/"),L4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),M4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,O4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function $4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const IT=["post","put","patch","delete"];new Set(IT);const B4=["get",...IT];new Set(B4);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xh(){return Xh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xh.apply(this,arguments)}const zy=f.createContext(null),z4=f.createContext(null),al=f.createContext(null),em=f.createContext(null),fs=f.createContext({outlet:null,matches:[],isDataRoute:!1}),CT=f.createContext(null);function U4(t,e){let{relative:n}=e===void 0?{}:e;ol()||yt(!1);let{basename:r,navigator:s}=f.useContext(al),{hash:i,pathname:o,search:l}=RT(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Ai([r,o])),s.createHref({pathname:c,search:l,hash:i})}function ol(){return f.useContext(em)!=null}function sr(){return ol()||yt(!1),f.useContext(em).location}function jT(t){f.useContext(al).static||f.useLayoutEffect(t)}function Dt(){let{isDataRoute:t}=f.useContext(fs);return t?r3():V4()}function V4(){ol()||yt(!1);let t=f.useContext(zy),{basename:e,navigator:n}=f.useContext(al),{matches:r}=f.useContext(fs),{pathname:s}=sr(),i=JSON.stringify($y(r).map(c=>c.pathnameBase)),o=f.useRef(!1);return jT(()=>{o.current=!0}),f.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=By(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Ai([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}const H4=f.createContext(null);function W4(t){let e=f.useContext(fs).outlet;return e&&f.createElement(H4.Provider,{value:t},e)}function Gi(){let{matches:t}=f.useContext(fs),e=t[t.length-1];return e?e.params:{}}function RT(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=f.useContext(fs),{pathname:s}=sr(),i=JSON.stringify($y(r).map(o=>o.pathnameBase));return f.useMemo(()=>By(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function G4(t,e){return q4(t,e)}function q4(t,e,n){ol()||yt(!1);let{navigator:r}=f.useContext(al),{matches:s}=f.useContext(fs),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=sr(),u;if(e){var d;let v=typeof e=="string"?qa(e):e;l==="/"||(d=v.pathname)!=null&&d.startsWith(l)||yt(!1),u=v}else u=c;let m=u.pathname||"/",p=l==="/"?m:m.slice(l.length)||"/",g=v4(t,{pathname:p}),y=J4(g&&g.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Ai([l,r.encodeLocation?r.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Ai([l,r.encodeLocation?r.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,n);return e&&y?f.createElement(em.Provider,{value:{location:Xh({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:_i.Pop}},y):y}function Q4(){let t=n3(),e=$4(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),n?f.createElement("pre",{style:s},n):null,i)}const K4=f.createElement(Q4,null);class X4 extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?f.createElement(fs.Provider,{value:this.props.routeContext},f.createElement(CT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Y4(t){let{routeContext:e,match:n,children:r}=t,s=f.useContext(zy);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),f.createElement(fs.Provider,{value:e},r)}function J4(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id]));l>=0||yt(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let d=c.route.id?o==null?void 0:o[c.route.id]:null,m=null;n&&(m=c.route.errorElement||K4);let p=e.concat(i.slice(0,u+1)),g=()=>{let y;return d?y=m:c.route.Component?y=f.createElement(c.route.Component,null):c.route.element?y=c.route.element:y=l,f.createElement(Y4,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:y})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?f.createElement(X4,{location:n.location,revalidation:n.revalidation,component:m,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var P0;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(P0||(P0={}));var Wc;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(Wc||(Wc={}));function Z4(t){let e=f.useContext(zy);return e||yt(!1),e}function e3(t){let e=f.useContext(z4);return e||yt(!1),e}function t3(t){let e=f.useContext(fs);return e||yt(!1),e}function AT(t){let e=t3(),n=e.matches[e.matches.length-1];return n.route.id||yt(!1),n.route.id}function n3(){var t;let e=f.useContext(CT),n=e3(Wc.UseRouteError),r=AT(Wc.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function r3(){let{router:t}=Z4(P0.UseNavigateStable),e=AT(Wc.UseNavigateStable),n=f.useRef(!1);return jT(()=>{n.current=!0}),f.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Xh({fromRouteId:e},i)))},[t,e])}function NT(t){let{to:e,replace:n,state:r,relative:s}=t;ol()||yt(!1);let{matches:i}=f.useContext(fs),{pathname:o}=sr(),l=Dt(),c=By(e,$y(i).map(d=>d.pathnameBase),o,s==="path"),u=JSON.stringify(c);return f.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function tm(t){return W4(t.context)}function Yr(t){yt(!1)}function s3(t){let{basename:e="/",children:n=null,location:r,navigationType:s=_i.Pop,navigator:i,static:o=!1}=t;ol()&&yt(!1);let l=e.replace(/^\/*/,"/"),c=f.useMemo(()=>({basename:l,navigator:i,static:o}),[l,i,o]);typeof r=="string"&&(r=qa(r));let{pathname:u="/",search:d="",hash:m="",state:p=null,key:g="default"}=r,y=f.useMemo(()=>{let v=Oy(u,l);return v==null?null:{location:{pathname:v,search:d,hash:m,state:p,key:g},navigationType:s}},[l,u,d,m,p,g,s]);return y==null?null:f.createElement(al.Provider,{value:c},f.createElement(em.Provider,{children:n,value:y}))}function i3(t){let{children:e,location:n}=t;return G4(F0(e),n)}var db;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(db||(db={}));new Promise(()=>{});function F0(t,e){e===void 0&&(e=[]);let n=[];return f.Children.forEach(t,(r,s)=>{if(!f.isValidElement(r))return;let i=[...e,s];if(r.type===f.Fragment){n.push.apply(n,F0(r.props.children,i));return}r.type!==Yr&&yt(!1),!r.props.index||!r.props.children||yt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=F0(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function D0(){return D0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D0.apply(this,arguments)}function a3(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function o3(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function l3(t,e){return t.button===0&&(!e||e==="_self")&&!o3(t)}function L0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function c3(t,e){let n=L0(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const u3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],d3="startTransition",hb=aN[d3];function h3(t){let{basename:e,children:n,future:r,window:s}=t,i=f.useRef();i.current==null&&(i.current=g4({window:s,v5Compat:!0}));let o=i.current,[l,c]=f.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=f.useCallback(m=>{u&&hb?hb(()=>c(m)):c(m)},[c,u]);return f.useLayoutEffect(()=>o.listen(d),[o,d]),f.createElement(s3,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o})}const f3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",m3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,we=f.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d}=e,m=a3(e,u3),{basename:p}=f.useContext(al),g,y=!1;if(typeof u=="string"&&m3.test(u)&&(g=u,f3))try{let b=new URL(window.location.href),E=u.startsWith("//")?new URL(b.protocol+u):new URL(u),R=Oy(E.pathname,p);E.origin===b.origin&&R!=null?u=R+E.search+E.hash:y=!0}catch{}let v=U4(u,{relative:s}),_=p3(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s});function S(b){r&&r(b),b.defaultPrevented||_(b)}return f.createElement("a",D0({},m,{href:g||v,onClick:y||i?r:S,ref:n,target:c}))});var fb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(fb||(fb={}));var mb;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(mb||(mb={}));function p3(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o}=e===void 0?{}:e,l=Dt(),c=sr(),u=RT(t,{relative:o});return f.useCallback(d=>{if(l3(d,n)){d.preventDefault();let m=r!==void 0?r:Kh(c)===Kh(u);l(t,{replace:m,state:s,preventScrollReset:i,relative:o})}},[c,l,u,r,s,n,t,i,o])}function PT(t){let e=f.useRef(L0(t)),n=f.useRef(!1),r=sr(),s=f.useMemo(()=>c3(r.search,n.current?null:e.current),[r.search]),i=Dt(),o=f.useCallback((l,c)=>{const u=L0(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,o]}function g3(){const[t,e]=f.useState([]),[n,r]=f.useState(),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:o,setPlaylists:l,albums:c,setAlbums:u}}const FT=f.createContext(null);function x3({children:t}){return a.jsx(FT.Provider,{value:g3(),children:t})}function Qs(){const t=f.useContext(FT);if(!t)throw new Error("SingerProvider not provided");return t}function pb({children:t}){return a.jsx(x3,{children:t})}function vu(){const t={container:"pt-[30px] pb-[calc(127px+30px)] md:mt-auto md:pb-[120px] md:flex md:justify-between md:items-center",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm"};return a.jsxs("div",{className:`${t.container}`,children:[a.jsxs("p",{className:t.copyRightText,children:["Make with  ",a.jsx("span",{className:"text-red-500",children:"❤"}),"  by d4t06 ",a.jsx("br",{})," © All rights no reserve ¯\\_(ツ)_/¯"]}),a.jsxs("div",{className:"flex items-center mt-[20px] md:mt-0 space-x-[10px]",children:[a.jsx("a",{href:"mailto:datnh0708@gmail.com",children:a.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:a.jsxs("g",{children:[a.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),a.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:a.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),a.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:a.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}function DT(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=DT(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function y3(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=DT(t))&&(r&&(r+=" "),r+=e);return r}const gb=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,xb=y3,wu=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return xb(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],m=i==null?void 0:i[u];if(d===null)return null;const p=gb(d)||gb(m);return s[u][p]}),l=n&&Object.entries(n).reduce((u,d)=>{let[m,p]=d;return p===void 0||(u[m]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:m,className:p,...g}=d;return Object.entries(g).every(y=>{let[v,_]=y;return Array.isArray(_)?_.includes({...i,...l}[v]):{...i,...l}[v]===_})?[...u,m,p]:u},[]);return xb(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};function v3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const w3=f.forwardRef(v3),nm=w3;function _3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const b3=f.forwardRef(_3),_u=b3;function S3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const E3=f.forwardRef(S3),k3=E3;function T3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const I3=f.forwardRef(T3),LT=I3;function C3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const j3=f.forwardRef(C3),MT=j3;function R3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const A3=f.forwardRef(R3),We=A3;function N3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const P3=f.forwardRef(N3),OT=P3;function F3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const D3=f.forwardRef(F3),L3=D3;function M3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const O3=f.forwardRef(M3),$3=O3;function B3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const z3=f.forwardRef(B3),$T=z3;function U3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const V3=f.forwardRef(U3),Uy=V3;function H3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const W3=f.forwardRef(H3),Vy=W3;function G3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const q3=f.forwardRef(G3),ll=q3;function Q3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const K3=f.forwardRef(Q3),Hy=K3;function X3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const Y3=f.forwardRef(X3),J3=Y3;function Z3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const eF=f.forwardRef(Z3),bu=eF;function tF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const nF=f.forwardRef(tF),BT=nF;function rF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const sF=f.forwardRef(rF),zT=sF;function iF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const aF=f.forwardRef(iF),oF=aF;function lF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const cF=f.forwardRef(lF),uF=cF;function dF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"}))}const hF=f.forwardRef(dF),fF=hF;function mF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const pF=f.forwardRef(mF),UT=pF;function gF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const xF=f.forwardRef(gF),Wy=xF;function yF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const vF=f.forwardRef(yF),Gy=vF;function wF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const _F=f.forwardRef(wF),qy=_F;function bF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const SF=f.forwardRef(bF),rm=SF;function EF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const kF=f.forwardRef(EF),TF=kF;function IF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const CF=f.forwardRef(IF),jF=CF;function RF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const AF=f.forwardRef(RF),Qy=AF;function NF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 3.03v.568c0 .334.148.65.405.864l1.068.89c.442.369.535 1.01.216 1.49l-.51.766a2.25 2.25 0 01-1.161.886l-.143.048a1.107 1.107 0 00-.57 1.664c.369.555.169 1.307-.427 1.605L9 13.125l.423 1.059a.956.956 0 01-1.652.928l-.679-.906a1.125 1.125 0 00-1.906.172L4.5 15.75l-.612.153M12.75 3.031a9 9 0 00-8.862 12.872M12.75 3.031a9 9 0 016.69 14.036m0 0l-.177-.529A2.25 2.25 0 0017.128 15H16.5l-.324-.324a1.453 1.453 0 00-2.328.377l-.036.073a1.586 1.586 0 01-.982.816l-.99.282c-.55.157-.894.702-.8 1.267l.073.438c.08.474.49.821.97.821.846 0 1.598.542 1.865 1.345l.215.643m5.276-3.67a9.012 9.012 0 01-5.276 3.67m0 0a9 9 0 01-10.275-4.835M15.75 9c0 .896-.393 1.7-1.016 2.25"}))}const PF=f.forwardRef(NF),VT=PF;function FF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const DF=f.forwardRef(FF),Su=DF;function LF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const MF=f.forwardRef(LF),Eu=MF;function OF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const $F=f.forwardRef(OF),M0=$F;function BF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const zF=f.forwardRef(BF),UF=zF;function VF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const HF=f.forwardRef(VF),sm=HF;function WF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const GF=f.forwardRef(WF),Ky=GF;function qF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const QF=f.forwardRef(qF),Qa=QF;function KF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const XF=f.forwardRef(KF),YF=XF;function JF({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const ZF=f.forwardRef(JF),O0=ZF;function eD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const tD=f.forwardRef(eD),Xy=tD;function nD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const rD=f.forwardRef(nD),im=rD;function sD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const iD=f.forwardRef(sD),Ks=iD;function aD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const oD=f.forwardRef(aD),cl=oD;function lD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const cD=f.forwardRef(lD),HT=cD;function uD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const dD=f.forwardRef(uD),Gc=dD;function hD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const fD=f.forwardRef(hD),ir=fD;function mD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"}))}const pD=f.forwardRef(mD),gD=pD;function xD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const yD=f.forwardRef(xD),vD=yD;function wD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const _D=f.forwardRef(wD),bD=_D;function SD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const ED=f.forwardRef(SD),WT=ED;function kD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const TD=f.forwardRef(kD),ID=TD;function CD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const jD=f.forwardRef(CD),RD=jD;function AD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const ND=f.forwardRef(AD),GT=ND;function PD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const FD=f.forwardRef(PD),Ln=FD;function DD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const LD=f.forwardRef(DD),$0=LD;function MD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const OD=f.forwardRef(MD),qi=OD,$D=()=>{const[t,e]=f.useState(null),[n,r]=f.useState(!0),s=f.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:o=>{e(l=>l?{...l,...o}:null)},justRegistered:s}},qT=f.createContext(null);function ge(){const t=f.useContext(qT);if(!t)throw new Error("auth context not Provided");return t}function BD({children:t}){return a.jsx(qT.Provider,{value:$D(),children:t})}function zD(){const[t,e]=f.useState({songs:[],playlists:[]}),[n,r]=f.useState([]),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]),d=f.useRef(!0),m=f.useRef(!0),p=f.useRef(!0),g=f.useRef(!0);return{uploadedSongs:n,setUploadedSongs:r,playlists:o,setPlaylists:l,favoriteSongs:s,setFavoriteSongs:i,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:d,shouldFetchUserPlaylists:p,shouldFetchFavoriteSongs:m,updateSong:v=>{const _=[...n],S=_.findIndex(b=>b.id===v.id);if(S!==-1){const b={..._[S]};Object.assign(b,v.song),_[S]=b,r(_)}},singers:c,setSingers:u,shouldFetchUserSingers:g}}const QT=f.createContext(null);function UD({children:t}){return a.jsx(QT.Provider,{value:zD(),children:t})}const Tn=()=>{const t=f.useContext(QT);if(!t)throw new Error("SongContext not provided");return t},Yh=[{name:"Red",id:"red",type:"dark",bottom_player_bg:"bg-[#3b1113]",side_bar_bg:"bg-[#391b1c]",content_text:"text-[#ca4954]",content_hover_text:"hover:text-[#ca4954]",content_border:"border-[#ca4954]",content_hover_border:"hover:border-[#ca4954]",content_bg:"bg-[#ca4954] text-[#fff]",modal_bg:"bg-[#4f171c]",content_code:"#ca4954",content_hover_bg:"hover:!bg-[#ca4954] hover:text-[#fff] ",container:"bg-[#2e0f10]",container_code:"#2e0f10",text_color:""},{name:"Black",id:"black",type:"dark",bottom_player_bg:"bg-[#181818]",side_bar_bg:"bg-[#242424]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585]  text-[#fff]",modal_bg:"bg-[#333]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff] ",container:"bg-[#1e1e1e]",container_code:"#1e1e1e",text_color:""},{name:"Deep blue",id:"deep_blue",type:"dark",bottom_player_bg:"bg-[#111f3b]",side_bar_bg:"bg-[#1b2639]",content_text:"text-[#0c9e85]",content_hover_text:"hover:text-[#0c9e85]",content_border:"border-[#0c9e85]",content_hover_border:"hover:border-[#0c9e85]",content_bg:"bg-[#0c9e85]  text-[#fff]",modal_bg:"bg-[#05473c]",content_code:"#0c9e85",content_hover_bg:"hover:!bg-[#0c9e85] hover:text-[#fff] ",container:"bg-[#0f1a2e]",container_code:"#0f1a2e",text_color:""},{name:"White",id:"white",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},{name:"Light green",id:"green_light",type:"light",bottom_player_bg:"bg-[#c0d8d8]",side_bar_bg:"bg-[#dde5e5]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#ced9d9]",container_code:"#ced9d9",text_color:""},{name:"Brown",id:"gray",type:"light",bottom_player_bg:"bg-[#dedad1]",side_bar_bg:"bg-[#d9d7d4]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-white",container_code:"#fff",text_color:""}],VD={name:"dashboard",id:"dashboard",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#5a9e87]",content_hover_text:"hover:text-[#5a9e87]",content_border:"border-[#5a9e87]",content_hover_border:"hover:border-[#5a9e87]",content_bg:"bg-[#5a9e87] text-[#fff]",modal_bg:"bg-[#417161]",content_code:"#5a9e87",content_hover_bg:"hover:!bg-[#5a9e87] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},KT=[{name:"Tet",id:"tet",type:"light",bottom_player_bg:"bg-[#fdf6e3]",side_bar_bg:"bg-[#fdf6e3]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#f7f0de]",container_code:"#fdf6e3",text_color:"",image:"tet_theme_image.png"}];function XT(t,e){return function(){return t.apply(e,arguments)}}const{toString:HD}=Object.prototype,{getPrototypeOf:Yy}=Object,am=(t=>e=>{const n=HD.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Wr=t=>(t=t.toLowerCase(),e=>am(e)===t),om=t=>e=>typeof e===t,{isArray:ul}=Array,qc=om("undefined");function WD(t){return t!==null&&!qc(t)&&t.constructor!==null&&!qc(t.constructor)&&Xn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const YT=Wr("ArrayBuffer");function GD(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&YT(t.buffer),e}const qD=om("string"),Xn=om("function"),JT=om("number"),lm=t=>t!==null&&typeof t=="object",QD=t=>t===!0||t===!1,uh=t=>{if(am(t)!=="object")return!1;const e=Yy(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},KD=Wr("Date"),XD=Wr("File"),YD=Wr("Blob"),JD=Wr("FileList"),ZD=t=>lm(t)&&Xn(t.pipe),eL=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Xn(t.append)&&((e=am(t))==="formdata"||e==="object"&&Xn(t.toString)&&t.toString()==="[object FormData]"))},tL=Wr("URLSearchParams"),[nL,rL,sL,iL]=["ReadableStream","Request","Response","Headers"].map(Wr),aL=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ku(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),ul(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let l;for(r=0;r<o;r++)l=i[r],e.call(null,t[l],l,t)}}function ZT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const xa=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),eI=t=>!qc(t)&&t!==xa;function B0(){const{caseless:t}=eI(this)&&this||{},e={},n=(r,s)=>{const i=t&&ZT(e,s)||s;uh(e[i])&&uh(r)?e[i]=B0(e[i],r):uh(r)?e[i]=B0({},r):ul(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&ku(arguments[r],n);return e}const oL=(t,e,n,{allOwnKeys:r}={})=>(ku(e,(s,i)=>{n&&Xn(s)?t[i]=XT(s,n):t[i]=s},{allOwnKeys:r}),t),lL=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),cL=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},uL=(t,e,n,r)=>{let s,i,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!r||r(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=n!==!1&&Yy(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},dL=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},hL=t=>{if(!t)return null;if(ul(t))return t;let e=t.length;if(!JT(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},fL=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Yy(Uint8Array)),mL=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},pL=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},gL=Wr("HTMLFormElement"),xL=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),yb=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),yL=Wr("RegExp"),tI=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};ku(n,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(r[i]=o||s)}),Object.defineProperties(t,r)},vL=t=>{tI(t,(e,n)=>{if(Xn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Xn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},wL=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return ul(t)?r(t):r(String(t).split(e)),n},_L=()=>{},bL=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function SL(t){return!!(t&&Xn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const EL=t=>{const e=new Array(10),n=(r,s)=>{if(lm(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=ul(r)?[]:{};return ku(r,(o,l)=>{const c=n(o,s+1);!qc(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},kL=Wr("AsyncFunction"),TL=t=>t&&(lm(t)||Xn(t))&&Xn(t.then)&&Xn(t.catch),nI=((t,e)=>t?setImmediate:e?((n,r)=>(xa.addEventListener("message",({source:s,data:i})=>{s===xa&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),xa.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Xn(xa.postMessage)),IL=typeof queueMicrotask<"u"?queueMicrotask.bind(xa):typeof process<"u"&&process.nextTick||nI,O={isArray:ul,isArrayBuffer:YT,isBuffer:WD,isFormData:eL,isArrayBufferView:GD,isString:qD,isNumber:JT,isBoolean:QD,isObject:lm,isPlainObject:uh,isReadableStream:nL,isRequest:rL,isResponse:sL,isHeaders:iL,isUndefined:qc,isDate:KD,isFile:XD,isBlob:YD,isRegExp:yL,isFunction:Xn,isStream:ZD,isURLSearchParams:tL,isTypedArray:fL,isFileList:JD,forEach:ku,merge:B0,extend:oL,trim:aL,stripBOM:lL,inherits:cL,toFlatObject:uL,kindOf:am,kindOfTest:Wr,endsWith:dL,toArray:hL,forEachEntry:mL,matchAll:pL,isHTMLForm:gL,hasOwnProperty:yb,hasOwnProp:yb,reduceDescriptors:tI,freezeMethods:vL,toObjectSet:wL,toCamelCase:xL,noop:_L,toFiniteNumber:bL,findKey:ZT,global:xa,isContextDefined:eI,isSpecCompliantForm:SL,toJSONObject:EL,isAsyncFn:kL,isThenable:TL,setImmediate:nI,asap:IL};function xe(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}O.inherits(xe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const rI=xe.prototype,sI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{sI[t]={value:t}});Object.defineProperties(xe,sI);Object.defineProperty(rI,"isAxiosError",{value:!0});xe.from=(t,e,n,r,s,i)=>{const o=Object.create(rI);return O.toFlatObject(t,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),xe.call(o,t.message,e,n,r,s),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const CL=null;function z0(t){return O.isPlainObject(t)||O.isArray(t)}function iI(t){return O.endsWith(t,"[]")?t.slice(0,-2):t}function vb(t,e,n){return t?t.concat(e).map(function(s,i){return s=iI(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function jL(t){return O.isArray(t)&&!t.some(z0)}const RL=O.toFlatObject(O,{},null,function(e){return/^is[A-Z]/.test(e)});function cm(t,e,n){if(!O.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=O.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,_){return!O.isUndefined(_[v])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(e);if(!O.isFunction(s))throw new TypeError("visitor must be a function");function u(y){if(y===null)return"";if(O.isDate(y))return y.toISOString();if(!c&&O.isBlob(y))throw new xe("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(y)||O.isTypedArray(y)?c&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function d(y,v,_){let S=y;if(y&&!_&&typeof y=="object"){if(O.endsWith(v,"{}"))v=r?v:v.slice(0,-2),y=JSON.stringify(y);else if(O.isArray(y)&&jL(y)||(O.isFileList(y)||O.endsWith(v,"[]"))&&(S=O.toArray(y)))return v=iI(v),S.forEach(function(E,R){!(O.isUndefined(E)||E===null)&&e.append(o===!0?vb([v],R,i):o===null?v:v+"[]",u(E))}),!1}return z0(y)?!0:(e.append(vb(_,v,i),u(y)),!1)}const m=[],p=Object.assign(RL,{defaultVisitor:d,convertValue:u,isVisitable:z0});function g(y,v){if(!O.isUndefined(y)){if(m.indexOf(y)!==-1)throw Error("Circular reference detected in "+v.join("."));m.push(y),O.forEach(y,function(S,b){(!(O.isUndefined(S)||S===null)&&s.call(e,S,O.isString(b)?b.trim():b,v,p))===!0&&g(S,v?v.concat(b):[b])}),m.pop()}}if(!O.isObject(t))throw new TypeError("data must be an object");return g(t),e}function wb(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Jy(t,e){this._pairs=[],t&&cm(t,this,e)}const aI=Jy.prototype;aI.append=function(e,n){this._pairs.push([e,n])};aI.toString=function(e){const n=e?function(r){return e.call(this,r,wb)}:wb;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function AL(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function oI(t,e,n){if(!e)return t;const r=n&&n.encode||AL;O.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(e,n):i=O.isURLSearchParams(e)?e.toString():new Jy(e,n).toString(r),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class NL{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){O.forEach(this.handlers,function(r){r!==null&&e(r)})}}const _b=NL,lI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},PL=typeof URLSearchParams<"u"?URLSearchParams:Jy,FL=typeof FormData<"u"?FormData:null,DL=typeof Blob<"u"?Blob:null,LL={isBrowser:!0,classes:{URLSearchParams:PL,FormData:FL,Blob:DL},protocols:["http","https","file","blob","url","data"]},Zy=typeof window<"u"&&typeof document<"u",U0=typeof navigator=="object"&&navigator||void 0,ML=Zy&&(!U0||["ReactNative","NativeScript","NS"].indexOf(U0.product)<0),OL=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),$L=Zy&&window.location.href||"http://localhost",BL=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Zy,hasStandardBrowserEnv:ML,hasStandardBrowserWebWorkerEnv:OL,navigator:U0,origin:$L},Symbol.toStringTag,{value:"Module"})),on={...BL,...LL};function zL(t,e){return cm(t,new on.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return on.isNode&&O.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function UL(t){return O.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function VL(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function cI(t){function e(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&O.isArray(s)?s.length:o,c?(O.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!O.isObject(s[o]))&&(s[o]=[]),e(n,r,s[o],i)&&O.isArray(s[o])&&(s[o]=VL(s[o])),!l)}if(O.isFormData(t)&&O.isFunction(t.entries)){const n={};return O.forEachEntry(t,(r,s)=>{e(UL(r),s,n,0)}),n}return null}function HL(t,e,n){if(O.isString(t))try{return(e||JSON.parse)(t),O.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const ev={transitional:lI,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=O.isObject(e);if(i&&O.isHTMLForm(e)&&(e=new FormData(e)),O.isFormData(e))return s?JSON.stringify(cI(e)):e;if(O.isArrayBuffer(e)||O.isBuffer(e)||O.isStream(e)||O.isFile(e)||O.isBlob(e)||O.isReadableStream(e))return e;if(O.isArrayBufferView(e))return e.buffer;if(O.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return zL(e,this.formSerializer).toString();if((l=O.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return cm(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),HL(e)):e}],transformResponse:[function(e){const n=this.transitional||ev.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(O.isResponse(e)||O.isReadableStream(e))return e;if(e&&O.isString(e)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?xe.from(l,xe.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:on.classes.FormData,Blob:on.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],t=>{ev.headers[t]={}});const tv=ev,WL=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),GL=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||e[n]&&WL[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},bb=Symbol("internals");function Xl(t){return t&&String(t).trim().toLowerCase()}function dh(t){return t===!1||t==null?t:O.isArray(t)?t.map(dh):String(t)}function qL(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const QL=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Yp(t,e,n,r,s){if(O.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!O.isString(e)){if(O.isString(r))return e.indexOf(r)!==-1;if(O.isRegExp(r))return r.test(e)}}function KL(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function XL(t,e){const n=O.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}class um{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const d=Xl(c);if(!d)throw new Error("header name must be a non-empty string");const m=O.findKey(s,d);(!m||s[m]===void 0||u===!0||u===void 0&&s[m]!==!1)&&(s[m||c]=dh(l))}const o=(l,c)=>O.forEach(l,(u,d)=>i(u,d,c));if(O.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(O.isString(e)&&(e=e.trim())&&!QL(e))o(GL(e),n);else if(O.isHeaders(e))for(const[l,c]of e.entries())i(c,l,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=Xl(e),e){const r=O.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return qL(s);if(O.isFunction(n))return n.call(this,s,r);if(O.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Xl(e),e){const r=O.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Yp(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(o){if(o=Xl(o),o){const l=O.findKey(r,o);l&&(!n||Yp(r,r[l],l,n))&&(delete r[l],s=!0)}}return O.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||Yp(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return O.forEach(this,(s,i)=>{const o=O.findKey(r,i);if(o){n[o]=dh(s),delete n[i];return}const l=e?KL(i):String(i).trim();l!==i&&delete n[i],n[l]=dh(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return O.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&O.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[bb]=this[bb]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=Xl(o);r[l]||(XL(s,o),r[l]=!0)}return O.isArray(e)?e.forEach(i):i(e),this}}um.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(um.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});O.freezeMethods(um);const Mr=um;function Jp(t,e){const n=this||tv,r=e||n,s=Mr.from(r.headers);let i=r.data;return O.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function uI(t){return!!(t&&t.__CANCEL__)}function dl(t,e,n){xe.call(this,t??"canceled",xe.ERR_CANCELED,e,n),this.name="CanceledError"}O.inherits(dl,xe,{__CANCEL__:!0});function dI(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new xe("Request failed with status code "+n.status,[xe.ERR_BAD_REQUEST,xe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function YL(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function JL(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[i];o||(o=u),n[s]=c,r[s]=u;let m=i,p=0;for(;m!==s;)p+=n[m++],m=m%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-o<e)return;const g=d&&u-d;return g?Math.round(p*1e3/g):void 0}}function ZL(t,e){let n=0,r=1e3/e,s,i;const o=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),m=d-n;m>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-m)))},()=>s&&o(s)]}const Jh=(t,e,n=3)=>{let r=0;const s=JL(50,250);return ZL(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-r,u=s(c),d=o<=l;r=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(m)},n)},Sb=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},Eb=t=>(...e)=>O.asap(()=>t(...e)),e6=on.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,on.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(on.origin),on.navigator&&/(msie|trident)/i.test(on.navigator.userAgent)):()=>!0,t6=on.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const o=[t+"="+encodeURIComponent(e)];O.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),O.isString(r)&&o.push("path="+r),O.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function n6(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function r6(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function hI(t,e,n){let r=!n6(e);return t&&r||n==!1?r6(t,e):e}const kb=t=>t instanceof Mr?{...t}:t;function Ra(t,e){e=e||{};const n={};function r(u,d,m,p){return O.isPlainObject(u)&&O.isPlainObject(d)?O.merge.call({caseless:p},u,d):O.isPlainObject(d)?O.merge({},d):O.isArray(d)?d.slice():d}function s(u,d,m,p){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u,m,p)}else return r(u,d,m,p)}function i(u,d){if(!O.isUndefined(d))return r(void 0,d)}function o(u,d){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,m){if(m in e)return r(u,d);if(m in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,m)=>s(kb(u),kb(d),m,!0)};return O.forEach(Object.keys(Object.assign({},t,e)),function(d){const m=c[d]||s,p=m(t[d],e[d],d);O.isUndefined(p)&&m!==l||(n[d]=p)}),n}const fI=t=>{const e=Ra({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=e;e.headers=o=Mr.from(o),e.url=oI(hI(e.baseURL,e.url),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(O.isFormData(n)){if(on.hasStandardBrowserEnv||on.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(on.hasStandardBrowserEnv&&(r&&O.isFunction(r)&&(r=r(e)),r||r!==!1&&e6(e.url))){const u=s&&i&&t6.read(i);u&&o.set(s,u)}return e},s6=typeof XMLHttpRequest<"u",i6=s6&&function(t){return new Promise(function(n,r){const s=fI(t);let i=s.data;const o=Mr.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,m,p,g,y;function v(){g&&g(),y&&y(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let _=new XMLHttpRequest;_.open(s.method.toUpperCase(),s.url,!0),_.timeout=s.timeout;function S(){if(!_)return;const E=Mr.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),D={data:!l||l==="text"||l==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:E,config:t,request:_};dI(function(I){n(I),v()},function(I){r(I),v()},D),_=null}"onloadend"in _?_.onloadend=S:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(S)},_.onabort=function(){_&&(r(new xe("Request aborted",xe.ECONNABORTED,t,_)),_=null)},_.onerror=function(){r(new xe("Network Error",xe.ERR_NETWORK,t,_)),_=null},_.ontimeout=function(){let R=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const D=s.transitional||lI;s.timeoutErrorMessage&&(R=s.timeoutErrorMessage),r(new xe(R,D.clarifyTimeoutError?xe.ETIMEDOUT:xe.ECONNABORTED,t,_)),_=null},i===void 0&&o.setContentType(null),"setRequestHeader"in _&&O.forEach(o.toJSON(),function(R,D){_.setRequestHeader(D,R)}),O.isUndefined(s.withCredentials)||(_.withCredentials=!!s.withCredentials),l&&l!=="json"&&(_.responseType=s.responseType),u&&([p,y]=Jh(u,!0),_.addEventListener("progress",p)),c&&_.upload&&([m,g]=Jh(c),_.upload.addEventListener("progress",m),_.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(d=E=>{_&&(r(!E||E.type?new dl(null,t,_):E),_.abort(),_=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const b=YL(s.url);if(b&&on.protocols.indexOf(b)===-1){r(new xe("Unsupported protocol "+b+":",xe.ERR_BAD_REQUEST,t));return}_.send(i||null)})},a6=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof xe?d:new dl(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,i(new xe(`timeout ${e} of ms exceeded`,xe.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>O.asap(l),c}},o6=a6,l6=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},c6=async function*(t,e){for await(const n of u6(t))yield*l6(n,e)},u6=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},Tb=(t,e,n,r)=>{const s=c6(t,e);let i=0,o,l=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let m=d.byteLength;if(n){let p=i+=m;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},dm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",mI=dm&&typeof ReadableStream=="function",d6=dm&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),pI=(t,...e)=>{try{return!!t(...e)}catch{return!1}},h6=mI&&pI(()=>{let t=!1;const e=new Request(on.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Ib=64*1024,V0=mI&&pI(()=>O.isReadableStream(new Response("").body)),Zh={stream:V0&&(t=>t.body)};dm&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Zh[e]&&(Zh[e]=O.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new xe(`Response type '${e}' is not supported`,xe.ERR_NOT_SUPPORT,r)})})})(new Response);const f6=async t=>{if(t==null)return 0;if(O.isBlob(t))return t.size;if(O.isSpecCompliantForm(t))return(await new Request(on.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(O.isArrayBufferView(t)||O.isArrayBuffer(t))return t.byteLength;if(O.isURLSearchParams(t)&&(t=t+""),O.isString(t))return(await d6(t)).byteLength},m6=async(t,e)=>{const n=O.toFiniteNumber(t.getContentLength());return n??f6(e)},p6=dm&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:m="same-origin",fetchOptions:p}=fI(t);u=u?(u+"").toLowerCase():"text";let g=o6([s,i&&i.toAbortSignal()],o),y;const v=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let _;try{if(c&&h6&&n!=="get"&&n!=="head"&&(_=await m6(d,r))!==0){let D=new Request(e,{method:"POST",body:r,duplex:"half"}),F;if(O.isFormData(r)&&(F=D.headers.get("content-type"))&&d.setContentType(F),D.body){const[I,k]=Sb(_,Jh(Eb(c)));r=Tb(D.body,Ib,I,k)}}O.isString(m)||(m=m?"include":"omit");const S="credentials"in Request.prototype;y=new Request(e,{...p,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:S?m:void 0});let b=await fetch(y);const E=V0&&(u==="stream"||u==="response");if(V0&&(l||E&&v)){const D={};["status","statusText","headers"].forEach(j=>{D[j]=b[j]});const F=O.toFiniteNumber(b.headers.get("content-length")),[I,k]=l&&Sb(F,Jh(Eb(l),!0))||[];b=new Response(Tb(b.body,Ib,I,()=>{k&&k(),v&&v()}),D)}u=u||"text";let R=await Zh[O.findKey(Zh,u)||"text"](b,t);return!E&&v&&v(),await new Promise((D,F)=>{dI(D,F,{data:R,headers:Mr.from(b.headers),status:b.status,statusText:b.statusText,config:t,request:y})})}catch(S){throw v&&v(),S&&S.name==="TypeError"&&/fetch/i.test(S.message)?Object.assign(new xe("Network Error",xe.ERR_NETWORK,t,y),{cause:S.cause||S}):xe.from(S,S&&S.code,t,y)}}),H0={http:CL,xhr:i6,fetch:p6};O.forEach(H0,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Cb=t=>`- ${t}`,g6=t=>O.isFunction(t)||t===null||t===!1,gI={getAdapter:t=>{t=O.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let o;if(r=n,!g6(n)&&(r=H0[(o=String(n)).toLowerCase()],r===void 0))throw new xe(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(Cb).join(`
`):" "+Cb(i[0]):"as no adapter specified";throw new xe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:H0};function Zp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new dl(null,t)}function jb(t){return Zp(t),t.headers=Mr.from(t.headers),t.data=Jp.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),gI.getAdapter(t.adapter||tv.adapter)(t).then(function(r){return Zp(t),r.data=Jp.call(t,t.transformResponse,r),r.headers=Mr.from(r.headers),r},function(r){return uI(r)||(Zp(t),r&&r.response&&(r.response.data=Jp.call(t,t.transformResponse,r.response),r.response.headers=Mr.from(r.response.headers))),Promise.reject(r)})}const xI="1.8.1",hm={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{hm[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const Rb={};hm.transitional=function(e,n,r){function s(i,o){return"[Axios v"+xI+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(e===!1)throw new xe(s(o," has been removed"+(n?" in "+n:"")),xe.ERR_DEPRECATED);return n&&!Rb[o]&&(Rb[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,l):!0}};hm.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function x6(t,e,n){if(typeof t!="object")throw new xe("options must be an object",xe.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const l=t[i],c=l===void 0||o(l,i,t);if(c!==!0)throw new xe("option "+i+" must be "+c,xe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new xe("Unknown option "+i,xe.ERR_BAD_OPTION)}}const hh={assertOptions:x6,validators:hm},Qr=hh.validators;class ef{constructor(e){this.defaults=e,this.interceptors={request:new _b,response:new _b}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Ra(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&hh.assertOptions(r,{silentJSONParsing:Qr.transitional(Qr.boolean),forcedJSONParsing:Qr.transitional(Qr.boolean),clarifyTimeoutError:Qr.transitional(Qr.boolean)},!1),s!=null&&(O.isFunction(s)?n.paramsSerializer={serialize:s}:hh.assertOptions(s,{encode:Qr.function,serialize:Qr.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),hh.assertOptions(n,{baseUrl:Qr.spelling("baseURL"),withXsrfToken:Qr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&O.merge(i.common,i[n.method]);i&&O.forEach(["delete","get","head","post","put","patch","common"],y=>{delete i[y]}),n.headers=Mr.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(n)===!1||(c=c&&v.synchronous,l.unshift(v.fulfilled,v.rejected))});const u=[];this.interceptors.response.forEach(function(v){u.push(v.fulfilled,v.rejected)});let d,m=0,p;if(!c){const y=[jb.bind(this),void 0];for(y.unshift.apply(y,l),y.push.apply(y,u),p=y.length,d=Promise.resolve(n);m<p;)d=d.then(y[m++],y[m++]);return d}p=l.length;let g=n;for(m=0;m<p;){const y=l[m++],v=l[m++];try{g=y(g)}catch(_){v.call(this,_);break}}try{d=jb.call(this,g)}catch(y){return Promise.reject(y)}for(m=0,p=u.length;m<p;)d=d.then(u[m++],u[m++]);return d}getUri(e){e=Ra(this.defaults,e);const n=hI(e.baseURL,e.url,e.allowAbsoluteUrls);return oI(n,e.params,e.paramsSerializer)}}O.forEach(["delete","get","head","options"],function(e){ef.prototype[e]=function(n,r){return this.request(Ra(r||{},{method:e,url:n,data:(r||{}).data}))}});O.forEach(["post","put","patch"],function(e){function n(r){return function(i,o,l){return this.request(Ra(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ef.prototype[e]=n(),ef.prototype[e+"Form"]=n(!0)});const fh=ef;class nv{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,l){r.reason||(r.reason=new dl(i,o,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new nv(function(s){e=s}),cancel:e}}}const y6=nv;function v6(t){return function(n){return t.apply(null,n)}}function w6(t){return O.isObject(t)&&t.isAxiosError===!0}const W0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(W0).forEach(([t,e])=>{W0[e]=t});const _6=W0;function yI(t){const e=new fh(t),n=XT(fh.prototype.request,e);return O.extend(n,fh.prototype,e,{allOwnKeys:!0}),O.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return yI(Ra(t,s))},n}const kt=yI(tv);kt.Axios=fh;kt.CanceledError=dl;kt.CancelToken=y6;kt.isCancel=uI;kt.VERSION=xI;kt.toFormData=cm;kt.AxiosError=xe;kt.Cancel=kt.CanceledError;kt.all=function(e){return Promise.all(e)};kt.spread=v6;kt.isAxiosError=w6;kt.mergeConfig=Ra;kt.AxiosHeaders=Mr;kt.formToJSON=t=>cI(O.isHTMLForm(t)?new FormData(t):t);kt.getAdapter=gI.getAdapter;kt.HttpStatusCode=_6;kt.default=kt;const b6=kt,vI="HD-MP3",S6=t=>(n=>n.toLocaleLowerCase().replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ắ|ằ|ẳ|ẵ|ặ/g,"a").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ớ|ờ|ở|ỡ|ợ/g,"o").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ỳ|ý|ý|ỷ|ỹ/g,"y").replace(/đ/g,"d"))(t).replace(/[\W_]/g,"-"),wI=b6.create({baseURL:{}.VITE_ENDPOINT||"https://express-zingmp3-awx6.vercel.app"}),gn=()=>JSON.parse(localStorage.getItem(vI)||"{}"),rt=(t,e)=>{const n=gn();return n[t]=e,localStorage.setItem(vI,JSON.stringify(n))},Br=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},cs=async t=>new Promise(e=>setTimeout(e,t)),_I=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},Qc=t=>t?"disable":"",Kc=t=>t?"hidden":"",Ni=(t,e)=>t?e:"";let mh=Yh[3];const E6=gn(),Ab=E6.theme;Ab&&[...Yh,...KT].forEach(t=>{t.id===Ab&&(mh=t)});const k6={theme:{...mh,alpha:mh.type==="light"?"[#000]/5":"[#fff]/5",text_color:mh.type==="light"?"text-[#333]":"text-[#fff]"},isOnMobile:window.innerWidth<768,isDev:!1},T6=(t,e)=>{switch(e.type){case 0:{const n=e.payload.theme;return{...t,theme:{...n,alpha:n.type==="dark"?"[#fff]/5":"[#000]/5",text_color:n.type==="light"?"text-[#333]":"text-[#fff]"}}}}},I6=()=>{const[t,e]=f.useReducer(T6,k6),n=f.useCallback(s=>{console.log("set theme"),e({type:0,payload:{theme:s}})},[]);return{state:t,setTheme:n,themeClass:(s,i)=>t.theme.type==="light"?s:i}},bI=f.createContext(null),C6=({children:t})=>a.jsx(bI.Provider,{value:I6(),children:t}),G=()=>{const t=f.useContext(bI);if(!t)throw new Error("ThemeProvider not provided");const{state:e,...n}=t;return{...e,...n}},j6=()=>{const[t,e]=f.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Somethings went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},SI=f.createContext(null);function R6({children:t}){return a.jsx(SI.Provider,{value:j6(),children:t})}const de=()=>{const t=f.useContext(SI);if(!t)throw new Error("Toast Context not provided");return t},A6=()=>{const[t,e]=f.useState([]),[n,r]=f.useState([]),s=f.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},EI=f.createContext(null),kI=()=>{const t=f.useContext(EI);if(!t)throw new Error("Navigation context not provided");return t};function TI(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=kI(),s=sr(),i=f.useMemo(()=>s.pathname+s.search,[s]),o=f.useRef(!1);return f.useEffect(()=>{if(!o.current){o.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),a.jsx(a.Fragment,{})}function II({children:t}){return a.jsx(EI.Provider,{value:A6(),children:t})}function N6(){const[t,e]=f.useState([]),[n,r]=f.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const CI=f.createContext(null),P6=({children:t})=>a.jsx(CI.Provider,{value:N6(),children:t}),jI=()=>{const t=f.useContext(CI);if(!t)throw new Error("UploadSongProvider not provided");return t},F6=["Songs","Karaoke","Lyric"],D6=["Playing","Lyric"],Yl=gn();function L6(){const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[s,i]=f.useState("Lyric"),[o,l]=f.useState("Lyric"),[c,u]=f.useState(!1),[d,m]=f.useState({lyricSize:Yl.lyricSize||"medium",repeat:Yl.isRepeat||"no",isShuffle:Yl.isShuffle||!1,isCrossFade:Yl.isCrossFade||!1,songBackground:Yl.songBackground||!0,isEnableBeat:!1}),p=f.useRef(!0),g=f.useRef(0),y=f.useRef(!0),v=f.useRef(""),_=f.useRef(!1),S=f.useRef(null),b=f.useRef(null),E=f.useRef(null);return{audioRef:S,themeCodeRef:v,isOpenFullScreen:t,isOpenSongQueue:n,idle:c,setIdle:u,setIsOpenFullScreen:e,setIsOpenSongQueue:r,activeTab:s,setActiveTab:i,desktopTabs:F6,mobileActiveTab:o,setMobileActiveTab:l,mobileTabs:D6,playerConig:d,updatePlayerConfig:D=>{m(F=>({...F,...D}))},firstTimeSongLoaded:p,timelineEleRef:b,currentTimeEleRef:E,startFadeWhenEnd:g,isPlayingNewSong:y,shouldSyncSongDuration:_}}const RI=f.createContext(null);function M6({children:t}){return a.jsx(RI.Provider,{value:L6(),children:t})}function dt(){const t=f.useContext(RI);if(!t)throw new Error("Player Context not provided");return t}const O6=()=>{const[t,e]=f.useState([]),[n,r]=f.useState(!1),s=f.useRef(!0);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,shouldGetLyric:s}},AI=f.createContext(null);function NI({children:t}){return a.jsx(AI.Provider,{value:O6(),children:t})}const rv=()=>{const t=f.useContext(AI);if(!t)throw new Error("Lyric context not found");return t},$6=()=>{const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[s,i]=f.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const d=[...s],m=d.findIndex(p=>p.id===u.id);m===-1?d.push(u):d.splice(m,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},PI=f.createContext(null);function ms({children:t}){return a.jsx(PI.Provider,{value:$6(),children:t})}const Tu=()=>{const t=f.useContext(PI);if(!t)throw new Error("SelectSongContext not provided");return t},B6=wu("inline-flex space-x-1 font-[500] items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"primary",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function z6({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:o,color:l,hover:c,onClick:u,...d},m){const{theme:p}=G();return a.jsxs("button",{ref:m,type:"button",onClick:g=>u?u(g):"",...d,className:`${l==="primary"?p.content_bg:""}  ${B6({variant:n,size:r,hover:c,rounded:o,className:t})}`,disabled:i||s,children:[i?a.jsx(We,{className:"w-6 animate-spin"}):null,!i&&e]})}const ae=f.forwardRef(z6);function sv({close:t}){return a.jsxs(Pe,{children:[a.jsx(ot,{close:t,title:"HD MP3"}),a.jsxs("p",{children:[a.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}function eg({onClick:t,theme:e,active:n}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[a.jsx("div",{onClick:()=>t(e),className:`relative border-l-[20px] ${e.content_border} pt-[100%] rounded-xl ${e.side_bar_bg} ${n?e.content_border:""}`,children:n&&a.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:a.jsx(J3,{className:`${e.content_text} w-[25px]`})})}),a.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function iv({close:t}){const{theme:e,setTheme:n}=G(),r=c=>{rt("theme",c.id),n(c)},s={songItemContainer:`w-full border-b border-${e.alpha} last:border-none`,icon:"w-6 h-6 mr-2 inline",themeContainer:"overflow-y-auto overflow-x-hidden no-scrollbar h-[calc(70vh-60px)]  pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap",linkItem:`py-[10px] border-b border-${e.alpha} last:border-none`},i=Yh.map(c=>{const u=c.id===e.id;if(c.type==="light")return a.jsx(eg,{active:u,theme:c,onClick:r},c.id)}),o=Yh.map(c=>{const u=c.id===e.id;if(c.type==="dark")return a.jsx(eg,{active:u,theme:c,onClick:r},c.id)}),l=KT.map(c=>{const u=c.id===e.id;return a.jsx(eg,{active:u,theme:c,onClick:r},c.id)});return a.jsxs(Pe,{className:"w-[900px]",children:[a.jsx(ot,{close:t,title:"Themes"}),a.jsxs("div",{className:s.themeContainer,children:[a.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Specical"}),a.jsx("div",{className:s.themeList,children:l}),a.jsx("h2",{className:"text-lg font-semibold mb-[10px]",children:"Dark"}),a.jsx("div",{className:s.themeList,children:o}),a.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Light"}),a.jsx("div",{className:s.themeList,children:i})]})]})}function ps({loading:t,callback:e,label:n,children:r,close:s,desc:i="This action cannot be undone"}){const{theme:o}=G();return a.jsxs(Pe,{disable:t,className:"w-[450px]",children:[a.jsx(ot,{close:s,title:n||"Wait a minute"}),i&&a.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),a.jsx("div",{className:"flex space-x-3 mt-5",children:r||a.jsxs(a.Fragment,{children:[a.jsx(ae,{onClick:s,className:"bg-white/10 border border-white/10 rounded-full px-3 py-0.5",variant:"primary",size:"clear",children:"Close"}),a.jsx(ae,{isLoading:t,className:`${o.content_bg} rounded-full px-3`,variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const U6=[3,5,7,10];function FI({closeModal:t,active:e}){const{theme:n}=G(),r={button:`bg-[#fff]/5 ${n.content_hover_bg} ml-2 mt-2 px-3  py-1 rounded-[99px]`},s=o=>{e(o),t()},i=U6.map(o=>a.jsxs("button",{type:"button",onClick:()=>s(o),className:`${r.button} `,children:[o," songs"]},o));return a.jsxs(Pe,{children:[a.jsx(ot,{close:t,title:"Sleep timer"}),a.jsx("div",{children:a.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:i})})]})}function V6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const H6=f.forwardRef(V6),W6=H6;function G6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const q6=f.forwardRef(G6),Q6=q6;function K6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M3.43 2.524A41.29 41.29 0 0110 2c2.236 0 4.43.18 6.57.524 1.437.231 2.43 1.49 2.43 2.902v5.148c0 1.413-.993 2.67-2.43 2.902a41.102 41.102 0 01-3.55.414c-.28.02-.521.18-.643.413l-1.712 3.293a.75.75 0 01-1.33 0l-1.713-3.293a.783.783 0 00-.642-.413 41.108 41.108 0 01-3.55-.414C1.993 13.245 1 11.986 1 10.574V5.426c0-1.413.993-2.67 2.43-2.902z",clipRule:"evenodd"}))}const X6=f.forwardRef(K6),Y6=X6;function J6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const Z6=f.forwardRef(J6),av=Z6;function eM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const tM=f.forwardRef(eM),nM=tM;function rM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z",clipRule:"evenodd"}))}const sM=f.forwardRef(rM),iM=sM;function aM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const oM=f.forwardRef(aM),DI=oM;function lM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const cM=f.forwardRef(lM),hl=cM;function uM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const dM=f.forwardRef(uM),ov=dM;function hM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),f.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const fM=f.forwardRef(hM),mM=fM;function pM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const gM=f.forwardRef(pM),Xc=gM;function xM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const yM=f.forwardRef(xM),Xs=yM;function vM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const wM=f.forwardRef(vM),fm=wM;function ot({close:t,title:e}){return a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("div",{className:"text-xl w-[80%] leading-[2.2] font-playwriteCU",children:e}),a.jsx("button",{onClick:t,children:a.jsx(fm,{className:"w-7"})})]})}function _M({children:t,className:e,persisted:n=!1,...r},s){const i=r.variant||"default",[o,l]=f.useState(i==="default"),[c,u]=f.useState(i==="default"),[d,m]=f.useState(n),p=()=>{c&&u(!1),o||l(!0)},g=()=>{l(!0)},y=()=>{u(!1),m(!1)},v=b=>{m(b)},_=b=>{b.preventDefault(),b.stopPropagation(),!d&&(i==="default"&&r.closeModal&&r.closeModal(),i==="animation"&&y())};f.useImperativeHandle(s,()=>({toggle:p,close:y,open:g,setModalPersist:v})),f.useEffect(()=>{i!=="default"&&(c||setTimeout(()=>{l(!1),r.onClose&&r.onClose()},400))},[c]),f.useEffect(()=>{i!=="default"&&o&&setTimeout(()=>{u(!0)},100)},[o]);const S={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return a.jsx(a.Fragment,{children:o&&Ga.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:_,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${c?S.mountedLayer:S.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${c?S.mountedContent:S.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}function Pe({children:t,noStyle:e,disable:n,className:r="w-[400px]"}){const{theme:s}=G();return a.jsx("div",{className:`max-h-[80vh] max-w-[90vw] flex flex-col  ${n?"disabled":""} ${e?"":"p-3 rounded-xl"} ${location.hash.includes("/dashboard")?"bg-white text-black":s.modal_bg+" text-white"} ${r}`,children:t})}const Ee=f.forwardRef(_M),bM=({appendOnPortal:t})=>{const[e,n]=f.useState(!1),[r,s]=f.useState(!1),i=f.useRef(null),o=f.useRef(null);return{refs:{triggerRef:i,contentRef:o},setTriggerRef:m=>{i.current=m},setContentRef:m=>{o.current=m},state:{isMounted:r,isOpen:e},setIsMounted:s,setIsOpen:n,appendOnPortal:t,close:()=>{s(!1)},toggle:()=>{r&&s(!1),e||n(!0)}}},LI=f.createContext(null),Iu=()=>{const t=f.useContext(LI);return t||{}};function xr({children:t,appendOnPortal:e,className:n="",...r}){return a.jsx(LI.Provider,{value:bM({...r,appendOnPortal:e}),children:e?t:a.jsx("div",{className:`relative ${n}`,children:t})})}function SM(t){const{state:{isOpen:e},refs:n,close:r,appendOnPortal:s}=Iu(),i=f.useRef(null),o=()=>{const{origin:c="top right",position:u,spacer:d=8}=t,m=n.triggerRef.current,p=n.contentRef.current,g=i.current;if(!m||!p)return;const y=m.getBoundingClientRect(),v={top:y.top+m.clientHeight,left:y.left-p.clientWidth-d};if(s){switch(v.top=y.top+m.clientHeight+d,u){case"right-bottom":v.left=y.left+d;break}const _=v.top+p.clientHeight>window.innerHeight-90;if(_){let S=v.top-p.clientHeight-m.clientHeight;S-60<0&&(S=60),v.top=S}if(g){let S=c;_&&(S="bottom right"),g.style.transformOrigin=S}}p.style.left=`${v.left}px`,p.style.top=`${v.top}px`},l=r;return f.useEffect(()=>{if(!s)return;if(e)o();else return;const c=document.querySelector(".main-container");if(c)return c.addEventListener("wheel",l),()=>{c&&c.removeEventListener("wheel",l)}},[e]),{animationRef:i}}const yr=f.forwardRef(function({children:t,needButton:e},n){const{refs:r,setIsMounted:s,setIsOpen:i,close:o,toggle:l,state:{isMounted:c,isOpen:u}}=Iu();return f.useImperativeHandle(n,()=>({close:o})),f.useEffect(()=>{c||setTimeout(()=>{i(!1)},400)},[c]),f.useEffect(()=>(u&&setTimeout(()=>{s(!0)},100),()=>{u||s(!1)}),[u]),f.useEffect(()=>{if(!u)return;const d=m=>{var p,g;!r.contentRef||!r.triggerRef||(p=r.triggerRef.current)!=null&&p.contains(m.target)||(g=r.contentRef.current)!=null&&g.contains(m.target)||s(!1)};return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[u]),!e&&f.isValidElement(t)?f.cloneElement(t,{onClick:l,ref:r.triggerRef}):a.jsx("button",{ref:r.triggerRef,onClick:l,children:t})});function vr(t){const{animationRef:e}=SM(t),{state:{isMounted:n,isOpen:r},appendOnPortal:s,setContentRef:i}=Iu(),o={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},l=a.jsx("div",{ref:i,className:`${s?"fixed z-[99]":"absolute"} ${t.className||""}`,children:a.jsx("div",{ref:e,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${t.animationClassName||""} ${n?o.mountedContent:o.unMountedContent}`,children:t.children})});return r?a.jsx(a.Fragment,{children:s?Ga.createPortal(l,document.getElementById("portals")):l}):a.jsx(a.Fragment,{})}function EM({children:t,className:e=""}){const{close:n}=Iu(),r=f.useRef(null);return f.useEffect(()=>{if(!r.current)return;const s=r.current.querySelectorAll("button");return s.forEach(i=>{i.addEventListener("click",n)}),()=>{s&&s.forEach(i=>{i.removeEventListener("click",n)})}},[]),a.jsx("div",{ref:r,className:`${e}`,children:t})}function fl({children:t,className:e=""}){const n={container:"hover:[&>*:not(div.absolute)]:bg-white/5 [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center [&_svg]:w-6  [&_svg]:flex-shrink-0 [&>*]:items-center [&_span]:font-medium"};return a.jsx(EM,{className:`${n.container} ${e}`,children:t})}function ml({children:t,className:e=""}){const{theme:n}=G();return a.jsx("div",{className:`rounded-md py-2 ${n.modal_bg} text-white ${e}`,children:t})}function ce({className:t}){const{theme:e}=G();return a.jsx("div",{className:`animate-pulse rounded-[4px] ${e.type==="light"?"bg-[#e1e1e1]":"bg-[#808080]"}  ${t}`})}const pl=[...Array(4).keys()].map(t=>a.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[a.jsx(ce,{className:"h-[18px] w-[18px]"}),a.jsx(ce,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx(ce,{className:"h-[20px] mb-[5px] w-[150px]"}),a.jsx(ce,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),kM=()=>a.jsx("div",{className:"py-3",children:a.jsx(ce,{className:"w-full h-[28px]"})}),lv=[...Array(2).keys()].map(t=>a.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[a.jsx(ce,{className:"pt-[100%] rounded-lg"}),a.jsx(ce,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(ce,{className:"h-[13px] mt-1 w-3/4"})]},t));var TM=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],ac=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=TM.indexOf(r);e=e*83+s}return e},tg=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},ng=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},IM=t=>t<0?-1:1,rg=(t,e)=>IM(t)*Math.pow(Math.abs(t),e),Nb=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},CM=t=>{if(!t||t.length<6)throw new Nb("The blurhash string must be at least 6 characters");let e=ac(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new Nb(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},jM=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[tg(e),tg(n),tg(r)]},RM=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[rg((n-9)/9,2)*e,rg((r-9)/9,2)*e,rg((s-9)/9,2)*e]},AM=(t,e,n,r)=>{CM(t),r=r|1;let s=ac(t[0]),i=Math.floor(s/9)+1,o=s%9+1,l=(ac(t[1])+1)/166,c=new Array(o*i);for(let m=0;m<c.length;m++)if(m===0){let p=ac(t.substring(2,6));c[m]=jM(p)}else{let p=ac(t.substring(4+m*2,6+m*2));c[m]=RM(p,l*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let m=0;m<n;m++)for(let p=0;p<e;p++){let g=0,y=0,v=0;for(let E=0;E<i;E++)for(let R=0;R<o;R++){let D=Math.cos(Math.PI*p*R/e)*Math.cos(Math.PI*m*E/n),F=c[R+E*o];g+=F[0]*D,y+=F[1]*D,v+=F[2]*D}let _=ng(g),S=ng(y),b=ng(v);d[4*p+0+m*u]=_,d[4*p+1+m*u]=S,d[4*p+2+m*u]=b,d[4*p+3+m*u]=255}return d},NM=AM,PM=Object.defineProperty,FM=Object.defineProperties,DM=Object.getOwnPropertyDescriptors,tf=Object.getOwnPropertySymbols,MI=Object.prototype.hasOwnProperty,OI=Object.prototype.propertyIsEnumerable,Pb=(t,e,n)=>e in t?PM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,G0=(t,e)=>{for(var n in e||(e={}))MI.call(e,n)&&Pb(t,n,e[n]);if(tf)for(var n of tf(e))OI.call(e,n)&&Pb(t,n,e[n]);return t},q0=(t,e)=>FM(t,DM(e)),$I=(t,e)=>{var n={};for(var r in t)MI.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&tf)for(var r of tf(t))e.indexOf(r)<0&&OI.call(t,r)&&(n[r]=t[r]);return n},BI=class extends f.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:n,width:r}=this.props;if(this.canvas){let s=NM(t,r,e,n),i=this.canvas.getContext("2d"),o=i.createImageData(r,e);o.data.set(s),i.putImageData(o,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:n,width:r}=t,s=$I(t,["hash","height","width"]);return f.createElement("canvas",q0(G0({},s),{height:n,width:r,ref:this.handleRef}))}};BI.defaultProps={height:128,width:128};var LM={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},Cu=class extends f.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:n,width:r,punch:s,resolutionX:i,resolutionY:o,style:l}=t,c=$I(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return f.createElement("div",q0(G0({},c),{style:q0(G0({display:"inline-block",height:n,width:r},l),{position:"relative"})}),f.createElement(BI,{hash:e,height:o,width:i,punch:s,style:LM}))}};Cu.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};function Je({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s}){const[i,o]=f.useState(!1),l=f.useRef(null),c=()=>{o(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},u=()=>{const m=l.current;m.src="https://placehold.co/400",o(!0)},d=()=>{console.log("image error"),s?(s(),u()):u()};return a.jsxs(a.Fragment,{children:[!i&&a.jsx(a.Fragment,{children:r?a.jsx(Cu,{hash:r,height:"100%",width:"100%"}):a.jsx(ce,{className:"w-full h-0"})}),a.jsx("img",{onLoad:c,onError:d,className:`${e} ${n} ${i?"":"hidden"}`,src:t||"https://placehold.co/400",ref:l})]})}function ju({children:t,className:e=""}){return a.jsx("div",{className:`pt-[100%] relative rounded-lg overflow-hidden ${e}`,children:a.jsx("div",{className:"absolute inset-0",children:t})})}const cv="border border-black/10 placeholder:[#888] outline-none py-1.5 px-2",MM=wu("w-full",{variants:{variant:{primary:cv,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function OM({variant:t,className:e="bg-white/10",...n},r){return a.jsx("input",{ref:r,className:` ${MM({variant:t,className:e})}`,...n})}const Gt=f.forwardRef(OM),$M=wu("",{variants:{p:{3:"p-3",2:"p-2",1:"p-1",clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md",sm:"rounded-sm"}},defaultVariants:{p:3,rounded:"xl"}});function mm({children:t,bg:e="primary",theme:n,className:r,p:s,rounded:i}){return a.jsx("div",{className:` ${e==="primary"?n.modal_bg:""} text-white border-[#fff]/5 border-[1px]  ${$M({p:s,rounded:i,className:r})}`,children:t})}const zI="/HD-MP3/assets/simon_empty-95813d48.png";function Ye({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return a.jsx(a.Fragment,{});case"with-home-button":return a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"}),a.jsx("p",{className:"text-center mt-5",children:a.jsx(we,{to:"/",children:a.jsxs(ae,{color:"primary",children:[a.jsx(Eu,{className:"w-6"}),a.jsx("span",{children:"Home"})]})})})]});case"default":return a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"})}};return a.jsxs("div",{className:`${n}`,children:[a.jsx("img",{className:"mx-auto",src:zI,alt:""}),r(),t]})}function qt({children:t}){return a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function Ae({title:t,className:e=""}){return a.jsx("div",{className:`text-xl font-playwriteCU leading-[2.4] ${e}`,children:t})}function UI({colList:t,children:e,className:n=""}){const r={table:"w-full"};return a.jsxs("table",{className:`${r.table} ${n}`,children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map((s,i)=>a.jsx("th",{children:s},i))})}),a.jsx("tbody",{children:e})]})}function Q0(t,e){const[n,r]=f.useState(e),s=f.useRef(!1);return f.useEffect(()=>{const i=gn()[t]||e;r(i)},[]),f.useEffect(()=>{if(!s.current){s.current=!0;return}rt(t,n)},[n]),[n,r]}function BM({audioEle:t,postLocalStorageKey:e}){const[n,r]=Q0(`audio_speed_${e}`,1),[s,i]=Q0(`audio_volume_${e}`,100);return f.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function VI({className:t="",positions:e="right",bg:n="",...r}){const{theme:s}=G(),{speed:i,volume:o,setVolume:l,setSpeed:c}=BM(r);return a.jsxs(xr,{appendOnPortal:!0,children:[a.jsx(yr,{children:a.jsx(ae,{className:`${s.content_bg} rounded-full ${t}`,children:a.jsx(Wy,{className:"w-6"})})}),a.jsx(vr,{...e==="right"?{position:"right-bottom",origin:"top left"}:{position:"left-bottom",origin:"top right"},children:a.jsx(mm,{bg:"clear",className:`w-[240px] ${n||s.modal_bg} `,theme:s,children:a.jsxs("div",{className:"space-y-[6px]",children:[a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),a.jsx("input",{className:"w-full",type:"range",step:.1,min:1,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",o,"%"]}),a.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:o,onChange:u=>l(+u.target.value)})]})]})})})]})}function ph({cb:t,active:e,inActiveBg:n="bg-white/10",size:r="default"}){const{theme:s}=G(),i={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return a.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] 
         ${e?s.content_bg:n} `,children:a.jsx("div",{className:`${i.circle} ${e?i.active:i.inActive}`})})}function gs({setTab:t,render:e,disable:n,tab:r,tabs:s,className:i=""}){const{theme:o}=G(),l={inActiveTab:` hover:bg-${o.alpha}`,activeTab:`${o.content_bg}`};return a.jsx("div",{className:`bg-${o.alpha} ${n?"disable":""} p-1.5 space-x-1 rounded-full ${i}`,children:s.map((c,u)=>a.jsx(ae,{size:"clear",onClick:d=>{t(c),d.target.blur()},className:`py-1 px-4 ${c===r?l.activeTab:l.inActiveTab}`,children:e(c)},u))})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},zM=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},WI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(p=64)),r.push(n[d],n[m],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(HI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):zM(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||m==null)throw new UM;const p=i<<2|l>>4;if(r.push(p),u!==64){const g=l<<4&240|u>>2;if(r.push(g),m!==64){const y=u<<6&192|m;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class UM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const VM=function(t){const e=HI(t);return WI.encodeByteArray(e,!0)},nf=function(t){return VM(t).replace(/\./g,"")},GI=function(t){try{return WI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WM=()=>HM().__FIREBASE_DEFAULTS__,GM=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},qM=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&GI(t[1]);return e&&JSON.parse(e)},pm=()=>{try{return WM()||GM()||qM()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qI=t=>{var e,n;return(n=(e=pm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},QI=t=>{const e=qI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},KI=()=>{var t;return(t=pm())===null||t===void 0?void 0:t.config},XI=t=>{var e;return(e=pm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[nf(JSON.stringify(n)),nf(JSON.stringify(o)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function KM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cn())}function XM(){var t;const e=(t=pm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function JM(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ZM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eO(){const t=cn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function tO(){return!XM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nO(){try{return typeof indexedDB=="object"}catch{return!1}}function rO(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO="FirebaseError";class xs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=sO,Object.setPrototypeOf(this,xs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ru.prototype.create)}}class Ru{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?iO(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new xs(s,l,r)}}function iO(t,e){return t.replace(aO,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const aO=/\{\$([^}]+)}/g;function oO(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function rf(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Fb(i)&&Fb(o)){if(!rf(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Fb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function lO(t,e){const n=new cO(t,e);return n.subscribe.bind(n)}class cO{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");uO(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=sg),s.error===void 0&&(s.error=sg),s.complete===void 0&&(s.complete=sg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uO(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function sg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){return t&&t._delegate?t._delegate:t}class Oi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dO=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new QM;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fO(e))try{this.getOrInitializeService({instanceIdentifier:ua})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ua){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ua){return this.instances.has(e)}getOptions(e=ua){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:hO(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ua){return this.component?this.component.multipleInstances?e:ua:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function hO(t){return t===ua?void 0:t}function fO(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new dO(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(je||(je={}));const pO={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},gO=je.INFO,xO={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},yO=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=xO[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uv{constructor(e){this.name=e,this._logLevel=gO,this._logHandler=yO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const vO=(t,e)=>e.some(n=>t instanceof n);let Db,Lb;function wO(){return Db||(Db=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _O(){return Lb||(Lb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JI=new WeakMap,K0=new WeakMap,ZI=new WeakMap,ig=new WeakMap,dv=new WeakMap;function bO(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Pi(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&JI.set(n,t)}).catch(()=>{}),dv.set(e,t),e}function SO(t){if(K0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});K0.set(t,e)}let X0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return K0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ZI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function EO(t){X0=t(X0)}function kO(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ag(this),e,...n);return ZI.set(r,e.sort?e.sort():[e]),Pi(r)}:_O().includes(t)?function(...e){return t.apply(ag(this),e),Pi(JI.get(this))}:function(...e){return Pi(t.apply(ag(this),e))}}function TO(t){return typeof t=="function"?kO(t):(t instanceof IDBTransaction&&SO(t),vO(t,wO())?new Proxy(t,X0):t)}function Pi(t){if(t instanceof IDBRequest)return bO(t);if(ig.has(t))return ig.get(t);const e=TO(t);return e!==t&&(ig.set(t,e),dv.set(e,t)),e}const ag=t=>dv.get(t);function IO(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Pi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Pi(o.result),c.oldVersion,c.newVersion,Pi(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const CO=["get","getKey","getAll","getAllKeys","count"],jO=["put","add","delete","clear"],og=new Map;function Mb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(og.get(e))return og.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=jO.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||CO.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return og.set(e,i),i}EO(t=>({...t,get:(e,n,r)=>Mb(e,n)||t.get(e,n,r),has:(e,n)=>!!Mb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(AO(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function AO(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Y0="@firebase/app",Ob="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs=new uv("@firebase/app"),NO="@firebase/app-compat",PO="@firebase/analytics-compat",FO="@firebase/analytics",DO="@firebase/app-check-compat",LO="@firebase/app-check",MO="@firebase/auth",OO="@firebase/auth-compat",$O="@firebase/database",BO="@firebase/data-connect",zO="@firebase/database-compat",UO="@firebase/functions",VO="@firebase/functions-compat",HO="@firebase/installations",WO="@firebase/installations-compat",GO="@firebase/messaging",qO="@firebase/messaging-compat",QO="@firebase/performance",KO="@firebase/performance-compat",XO="@firebase/remote-config",YO="@firebase/remote-config-compat",JO="@firebase/storage",ZO="@firebase/storage-compat",e9="@firebase/firestore",t9="@firebase/vertexai-preview",n9="@firebase/firestore-compat",r9="firebase",s9="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="[DEFAULT]",i9={[Y0]:"fire-core",[NO]:"fire-core-compat",[FO]:"fire-analytics",[PO]:"fire-analytics-compat",[LO]:"fire-app-check",[DO]:"fire-app-check-compat",[MO]:"fire-auth",[OO]:"fire-auth-compat",[$O]:"fire-rtdb",[BO]:"fire-data-connect",[zO]:"fire-rtdb-compat",[UO]:"fire-fn",[VO]:"fire-fn-compat",[HO]:"fire-iid",[WO]:"fire-iid-compat",[GO]:"fire-fcm",[qO]:"fire-fcm-compat",[QO]:"fire-perf",[KO]:"fire-perf-compat",[XO]:"fire-rc",[YO]:"fire-rc-compat",[JO]:"fire-gcs",[ZO]:"fire-gcs-compat",[e9]:"fire-fst",[n9]:"fire-fst-compat",[t9]:"fire-vertex","fire-js":"fire-js",[r9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf=new Map,a9=new Map,Z0=new Map;function $b(t,e){try{t.container.addComponent(e)}catch(n){Bs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Aa(t){const e=t.name;if(Z0.has(e))return Bs.debug(`There were multiple attempts to register component ${e}.`),!1;Z0.set(e,t);for(const n of sf.values())$b(n,t);for(const n of a9.values())$b(n,t);return!0}function gm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Is(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fi=new Ru("app","Firebase",o9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Oi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka=s9;function eC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:J0,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Fi.create("bad-app-name",{appName:String(s)});if(n||(n=KI()),!n)throw Fi.create("no-options");const i=sf.get(s);if(i){if(rf(n,i.options)&&rf(r,i.config))return i;throw Fi.create("duplicate-app",{appName:s})}const o=new mO(s);for(const c of Z0.values())o.addComponent(c);const l=new l9(n,r,o);return sf.set(s,l),l}function hv(t=J0){const e=sf.get(t);if(!e&&t===J0&&KI())return eC();if(!e)throw Fi.create("no-app",{appName:t});return e}function is(t,e,n){var r;let s=(r=i9[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bs.warn(l.join(" "));return}Aa(new Oi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9="firebase-heartbeat-database",u9=1,Yc="firebase-heartbeat-store";let lg=null;function tC(){return lg||(lg=IO(c9,u9,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fi.create("idb-open",{originalErrorMessage:t.message})})),lg}async function d9(t){try{const n=(await tC()).transaction(Yc),r=await n.objectStore(Yc).get(nC(t));return await n.done,r}catch(e){if(e instanceof xs)Bs.warn(e.message);else{const n=Fi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bs.warn(n.message)}}}async function Bb(t,e){try{const r=(await tC()).transaction(Yc,"readwrite");await r.objectStore(Yc).put(e,nC(t)),await r.done}catch(n){if(n instanceof xs)Bs.warn(n.message);else{const r=Fi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Bs.warn(r.message)}}}function nC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9=1024,f9=30*24*60*60*1e3;class m9{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new g9(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=zb();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=f9}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Bs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=zb(),{heartbeatsToSend:r,unsentEntries:s}=p9(this._heartbeatsCache.heartbeats),i=nf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Bs.warn(n),""}}}function zb(){return new Date().toISOString().substring(0,10)}function p9(t,e=h9){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ub(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ub(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class g9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nO()?rO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await d9(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Bb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Bb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ub(t){return nf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x9(t){Aa(new Oi("platform-logger",e=>new RO(e),"PRIVATE")),Aa(new Oi("heartbeat",e=>new m9(e),"PRIVATE")),is(Y0,Ob,t),is(Y0,Ob,"esm2017"),is("fire-js","")}x9("");function fv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function rC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const y9=rC,sC=new Ru("auth","Firebase",rC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=new uv("@firebase/auth");function v9(t,...e){af.logLevel<=je.WARN&&af.warn(`Auth (${Ka}): ${t}`,...e)}function gh(t,...e){af.logLevel<=je.ERROR&&af.error(`Auth (${Ka}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(t,...e){throw pv(t,...e)}function Or(t,...e){return pv(t,...e)}function mv(t,e,n){const r=Object.assign(Object.assign({},y9()),{[e]:n});return new Ru("auth","Firebase",r).create(e,{appName:t.name})}function ba(t){return mv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function w9(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&us(t,"argument-error"),mv(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return sC.create(t,...e)}function oe(t,e,...n){if(!t)throw pv(e,...n)}function Cs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw gh(e),new Error(e)}function zs(t,e){t||Cs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function _9(){return Vb()==="http:"||Vb()==="https:"}function Vb(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_9()||JM()||"connection"in navigator)?navigator.onLine:!0}function S9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n){this.shortDelay=e,this.longDelay=n,zs(n>e,"Short delay should be less than long delay!"),this.isMobile=KM()||ZM()}get(){return b9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(t,e){zs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k9=new Nu(3e4,6e4);function xv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function gl(t,e,n,r,s={}){return aC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Au(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return YM()||(u.referrerPolicy="no-referrer"),iC.fetch()(oC(t,t.config.apiHost,n,l),u)})}async function aC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},E9),e);try{const s=new I9(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Pd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pd(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Pd(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Pd(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw mv(t,d,u);us(t,d)}}catch(s){if(s instanceof xs)throw s;us(t,"network-request-failed",{message:String(s)})}}async function T9(t,e,n,r,s={}){const i=await gl(t,e,n,r,s);return"mfaPendingCredential"in i&&us(t,"multi-factor-auth-required",{_serverResponse:i}),i}function oC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?gv(t.config,s):`${t.config.apiScheme}://${s}`}class I9{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Or(this.auth,"network-request-failed")),k9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Pd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Or(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C9(t,e){return gl(t,"POST","/v1/accounts:delete",e)}async function lC(t,e){return gl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function j9(t,e=!1){const n=tt(t),r=await n.getIdToken(e),s=yv(r);oe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:_c(cg(s.auth_time)),issuedAtTime:_c(cg(s.iat)),expirationTime:_c(cg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function cg(t){return Number(t)*1e3}function yv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return gh("JWT malformed, contained fewer than 3 sections"),null;try{const s=GI(n);return s?JSON.parse(s):(gh("Failed to decode base64 JWT payload"),null)}catch(s){return gh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Hb(t){const e=yv(t);return oe(e,"internal-error"),oe(typeof e.exp<"u","internal-error"),oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof xs&&R9(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function R9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=_c(this.lastLoginAt),this.creationTime=_c(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function of(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Jc(t,lC(n,{idToken:r}));oe(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?cC(i.providerUserInfo):[],l=P9(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new tx(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function N9(t){const e=tt(t);await of(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function P9(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function cC(t){return t.map(e=>{var{providerId:n}=e,r=fv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F9(t,e){const n=await aC(t,{},async()=>{const r=Au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=oC(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",iC.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function D9(t,e){return gl(t,"POST","/v2/accounts:revokeToken",xv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oe(e.idToken,"internal-error"),oe(typeof e.idToken<"u","internal-error"),oe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Hb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){oe(e.length!==0,"internal-error");const n=Hb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await F9(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Fo;return r&&(oe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(oe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(oe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fo,this.toJSON())}_performRefresh(){return Cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(t,e){oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class js{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=fv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new A9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new tx(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Jc(this,this.stsTokenManager.getToken(this.auth,e));return oe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return j9(this,e)}reload(){return N9(this)}_assign(e){this!==e&&(oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new js(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await of(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Is(this.auth.app))return Promise.reject(ba(this.auth));const e=await this.getIdToken();return await Jc(this,C9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,g=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,y=(o=n.photoURL)!==null&&o!==void 0?o:void 0,v=(l=n.tenantId)!==null&&l!==void 0?l:void 0,_=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,S=(u=n.createdAt)!==null&&u!==void 0?u:void 0,b=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:E,emailVerified:R,isAnonymous:D,providerData:F,stsTokenManager:I}=n;oe(E&&I,e,"internal-error");const k=Fo.fromJSON(this.name,I);oe(typeof E=="string",e,"internal-error"),li(m,e.name),li(p,e.name),oe(typeof R=="boolean",e,"internal-error"),oe(typeof D=="boolean",e,"internal-error"),li(g,e.name),li(y,e.name),li(v,e.name),li(_,e.name),li(S,e.name),li(b,e.name);const j=new js({uid:E,auth:e,email:p,emailVerified:R,displayName:m,isAnonymous:D,photoURL:y,phoneNumber:g,tenantId:v,stsTokenManager:k,createdAt:S,lastLoginAt:b});return F&&Array.isArray(F)&&(j.providerData=F.map(C=>Object.assign({},C))),_&&(j._redirectEventId=_),j}static async _fromIdTokenResponse(e,n,r=!1){const s=new Fo;s.updateFromServerResponse(n);const i=new js({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await of(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];oe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?cC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Fo;l.updateFromIdToken(r);const c=new js({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new tx(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=new Map;function Rs(t){zs(t instanceof Function,"Expected a class definition");let e=Wb.get(t);return e?(zs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Wb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}uC.type="NONE";const Gb=uC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(t,e,n){return`firebase:${t}:${e}:${n}`}class Do{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=xh(this.userKey,s.apiKey,i),this.fullPersistenceKey=xh("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?js._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Do(Rs(Gb),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Rs(Gb);const o=xh(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){const m=js._fromJSON(e,d);u!==i&&(l=m),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Do(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Do(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(mC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gC(e))return"Blackberry";if(xC(e))return"Webos";if(hC(e))return"Safari";if((e.includes("chrome/")||fC(e))&&!e.includes("edge/"))return"Chrome";if(pC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function dC(t=cn()){return/firefox\//i.test(t)}function hC(t=cn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fC(t=cn()){return/crios\//i.test(t)}function mC(t=cn()){return/iemobile/i.test(t)}function pC(t=cn()){return/android/i.test(t)}function gC(t=cn()){return/blackberry/i.test(t)}function xC(t=cn()){return/webos/i.test(t)}function vv(t=cn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function L9(t=cn()){var e;return vv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function M9(){return eO()&&document.documentMode===10}function yC(t=cn()){return vv(t)||pC(t)||xC(t)||gC(t)||/windows phone/i.test(t)||mC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(t,e=[]){let n;switch(t){case"Browser":n=qb(cn());break;case"Worker":n=`${qb(cn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ka}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $9(t,e={}){return gl(t,"GET","/v2/passwordPolicy",xv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9=6;class z9{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:B9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Qb(this),this.idTokenSubscription=new Qb(this),this.beforeStateQueue=new O9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Rs(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Do.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await lC(this,{idToken:e}),r=await js._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Is(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await of(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=S9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Is(this.app))return Promise.reject(ba(this));const n=e?tt(e):null;return n&&oe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Is(this.app)?Promise.reject(ba(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Is(this.app)?Promise.reject(ba(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $9(this),n=new z9(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ru("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await D9(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Rs(e)||this._popupRedirectResolver;oe(n,this,"argument-error"),this.redirectPersistenceManager=await Do.create(this,[Rs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(oe(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&v9(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function xm(t){return tt(t)}class Qb{constructor(e){this.auth=e,this.observer=null,this.addObserver=lO(n=>this.observer=n)}get next(){return oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function V9(t){wv=t}function H9(t){return wv.loadJS(t)}function W9(){return wv.gapiScript}function G9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q9(t,e){const n=gm(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(rf(i,e??{}))return s;us(s,"already-initialized")}return n.initialize({options:e})}function Q9(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function K9(t,e,n){const r=xm(t);oe(r._canInitEmulator,r,"emulator-config-failed"),oe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=wC(e),{host:o,port:l}=X9(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||Y9()}function wC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function X9(t){const e=wC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Kb(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Kb(o)}}}function Kb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Y9(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Cs("not implemented")}_getIdTokenResponse(e){return Cs("not implemented")}_linkToIdToken(e,n){return Cs("not implemented")}_getReauthenticationResolver(e){return Cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lo(t,e){return T9(t,"POST","/v1/accounts:signInWithIdp",xv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9="http://localhost";class Na extends _C{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Na(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):us("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=fv(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Na(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Lo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Lo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Lo(e,n)}buildRequest(){const e={requestUri:J9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Au(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu extends _v{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends Pu{constructor(){super("facebook.com")}static credential(e){return Na._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Pu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Na._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Es.credential(n,r)}catch{return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com";Es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends Pu{constructor(){super("github.com")}static credential(e){return Na._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.GITHUB_SIGN_IN_METHOD="github.com";pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends Pu{constructor(){super("twitter.com")}static credential(e,n){return Na._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return gi.credential(n,r)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await js._fromIdTokenResponse(e,r,s),o=Xb(r);return new Wo({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Xb(r);return new Wo({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Xb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf extends xs{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,lf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new lf(e,n,r,s)}}function bC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?lf._fromErrorAndOperation(t,i,e,r):i})}async function Z9(t,e,n=!1){const r=await Jc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e$(t,e,n=!1){const{auth:r}=t;if(Is(r.app))return Promise.reject(ba(r));const s="reauthenticate";try{const i=await Jc(t,bC(r,s,e,t),n);oe(i.idToken,r,"internal-error");const o=yv(i.idToken);oe(o,r,"internal-error");const{sub:l}=o;return oe(t.uid===l,r,"user-mismatch"),Wo._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&us(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t$(t,e,n=!1){if(Is(t.app))return Promise.reject(ba(t));const r="signIn",s=await bC(t,r,e),i=await Wo._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function n$(t,e,n,r){return tt(t).onIdTokenChanged(e,n,r)}function r$(t,e,n){return tt(t).beforeAuthStateChanged(e,n)}function s$(t,e,n,r){return tt(t).onAuthStateChanged(e,n,r)}function SC(t){return tt(t).signOut()}const cf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(cf,"1"),this.storage.removeItem(cf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i$=1e3,a$=10;class kC extends EC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);M9()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,a$):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},i$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}kC.type="LOCAL";const o$=kC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC extends EC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}TC.type="SESSION";const IC=TC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new ym(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await l$(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ym.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=bv("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(){return window}function u$(t){as().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(){return typeof as().WorkerGlobalScope<"u"&&typeof as().importScripts=="function"}async function d$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function h$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function f$(){return CC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC="firebaseLocalStorageDb",m$=1,uf="firebaseLocalStorage",RC="fbase_key";class Fu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function vm(t,e){return t.transaction([uf],e?"readwrite":"readonly").objectStore(uf)}function p$(){const t=indexedDB.deleteDatabase(jC);return new Fu(t).toPromise()}function nx(){const t=indexedDB.open(jC,m$);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(uf,{keyPath:RC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(uf)?e(r):(r.close(),await p$(),e(await nx()))})})}async function Yb(t,e,n){const r=vm(t,!0).put({[RC]:e,value:n});return new Fu(r).toPromise()}async function g$(t,e){const n=vm(t,!1).get(e),r=await new Fu(n).toPromise();return r===void 0?null:r.value}function Jb(t,e){const n=vm(t,!0).delete(e);return new Fu(n).toPromise()}const x$=800,y$=3;class AC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>y$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return CC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ym._getInstance(f$()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await d$(),!this.activeServiceWorker)return;this.sender=new c$(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||h$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nx();return await Yb(e,cf,"1"),await Jb(e,cf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Yb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>g$(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Jb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=vm(s,!1).getAll();return new Fu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),x$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}AC.type="LOCAL";const v$=AC;new Nu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(t,e){return e?Rs(e):(oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv extends _C{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Lo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Lo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function w$(t){return t$(t.auth,new Sv(t),t.bypassAuthState)}function _$(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),e$(n,new Sv(t),t.bypassAuthState)}async function b$(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),Z9(n,new Sv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w$;case"linkViaPopup":case"linkViaRedirect":return b$;case"reauthViaPopup":case"reauthViaRedirect":return _$;default:us(this.auth,"internal-error")}}resolve(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S$=new Nu(2e3,1e4);async function E$(t,e,n){if(Is(t.app))return Promise.reject(Or(t,"operation-not-supported-in-this-environment"));const r=xm(t);w9(t,e,_v);const s=NC(r,n);return new ya(r,"signInViaPopup",e,s).executeNotNull()}class ya extends PC{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ya.currentPopupAction&&ya.currentPopupAction.cancel(),ya.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return oe(e,this.auth,"internal-error"),e}async onExecution(){zs(this.filter.length===1,"Popup operations only handle one event");const e=bv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Or(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Or(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ya.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Or(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,S$.get())};e()}}ya.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k$="pendingRedirect",yh=new Map;class T$ extends PC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=yh.get(this.auth._key());if(!e){try{const r=await I$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}yh.set(this.auth._key(),e)}return this.bypassAuthState||yh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function I$(t,e){const n=R$(e),r=j$(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function C$(t,e){yh.set(t._key(),e)}function j$(t){return Rs(t._redirectPersistence)}function R$(t){return xh(k$,t.config.apiKey,t.name)}async function A$(t,e,n=!1){if(Is(t.app))return Promise.reject(ba(t));const r=xm(t),s=NC(r,e),o=await new T$(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N$=10*60*1e3;class P${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!F$(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!FC(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Or(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=N$&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zb(e))}saveEventToCache(e){this.cachedEventUids.add(Zb(e)),this.lastProcessedEventTime=Date.now()}}function Zb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function FC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function F$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return FC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D$(t,e={}){return gl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M$=/^https?/;async function O$(t){if(t.config.emulator)return;const{authorizedDomains:e}=await D$(t);for(const n of e)try{if($$(n))return}catch{}us(t,"unauthorized-domain")}function $$(t){const e=ex(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!M$.test(n))return!1;if(L$.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B$=new Nu(3e4,6e4);function eS(){const t=as().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function z$(t){return new Promise((e,n)=>{var r,s,i;function o(){eS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eS(),n(Or(t,"network-request-failed"))},timeout:B$.get()})}if(!((s=(r=as().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=as().gapi)===null||i===void 0)&&i.load)o();else{const l=G9("iframefcb");return as()[l]=()=>{gapi.load?o():n(Or(t,"network-request-failed"))},H9(`${W9()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw vh=null,e})}let vh=null;function U$(t){return vh=vh||z$(t),vh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V$=new Nu(5e3,15e3),H$="__/auth/iframe",W$="emulator/auth/iframe",G$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Q$(t){const e=t.config;oe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?gv(e,W$):`https://${t.config.authDomain}/${H$}`,r={apiKey:e.apiKey,appName:t.name,v:Ka},s=q$.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Au(r).slice(1)}`}async function K$(t){const e=await U$(t),n=as().gapi;return oe(n,t,"internal-error"),e.open({where:document.body,url:Q$(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:G$,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Or(t,"network-request-failed"),l=as().setTimeout(()=>{i(o)},V$.get());function c(){as().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Y$=500,J$=600,Z$="_blank",e7="http://localhost";class tS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function t7(t,e,n,r=Y$,s=J$){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},X$),{width:r.toString(),height:s.toString(),top:i,left:o}),u=cn().toLowerCase();n&&(l=fC(u)?Z$:n),dC(u)&&(e=e||e7,c.scrollbars="yes");const d=Object.entries(c).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(L9(u)&&l!=="_self")return n7(e||"",l),new tS(null);const m=window.open(e||"",l,d);oe(m,t,"popup-blocked");try{m.focus()}catch{}return new tS(m)}function n7(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7="__/auth/handler",s7="emulator/auth/handler",i7=encodeURIComponent("fac");async function nS(t,e,n,r,s,i){oe(t.config.authDomain,t,"auth-domain-config-required"),oe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ka,eventId:s};if(e instanceof _v){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",oO(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries(i||{}))o[d]=m}if(e instanceof Pu){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${i7}=${encodeURIComponent(c)}`:"";return`${a7(t)}?${Au(l).slice(1)}${u}`}function a7({config:t}){return t.emulator?gv(t,s7):`https://${t.authDomain}/${r7}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="webStorageSupport";class o7{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=IC,this._completeRedirectFn=A$,this._overrideRedirectResult=C$}async _openPopup(e,n,r,s){var i;zs((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await nS(e,n,r,ex(),s);return t7(e,o,bv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await nS(e,n,r,ex(),s);return u$(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(zs(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await K$(e),r=new P$(e);return n.register("authEvent",s=>(oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ug,{type:ug},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[ug];o!==void 0&&n(!!o),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=O$(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return yC()||hC()||vv()}}const l7=o7;var rS="@firebase/auth",sS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c7{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u7(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function d7(t){Aa(new Oi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;oe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vC(t)},u=new U9(r,s,i,c);return Q9(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Aa(new Oi("auth-internal",e=>{const n=xm(e.getProvider("auth").getImmediate());return(r=>new c7(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),is(rS,sS,u7(t)),is(rS,sS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h7=5*60,f7=XI("authIdTokenMaxAge")||h7;let iS=null;const m7=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>f7)return;const s=n==null?void 0:n.token;iS!==s&&(iS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function p7(t=hv()){const e=gm(t,"auth");if(e.isInitialized())return e.getImmediate();const n=q9(t,{popupRedirectResolver:l7,persistence:[v$,o$,IC]}),r=XI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=m7(i.toString());r$(n,o,()=>o(n.currentUser)),n$(n,l=>o(l))}}const s=qI("auth");return s&&K9(n,`http://${s}`),n}function g7(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}V9({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Or("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",g7().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});d7("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function x7(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(m){o(m)}}function c(d){try{u(r.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function y7(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var To=function(){return To=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},To.apply(this,arguments)},DC=function(t){return{loading:t==null,value:t}},v7=function(){return function(t,e){switch(e.type){case"error":return To(To({},t),{error:e.error,loading:!1,value:void 0});case"reset":return DC(e.defaultValue);case"value":return To(To({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},w7=function(t){var e=t?t():void 0,n=f.useReducer(v7(),DC(e)),r=n[0],s=n[1],i=f.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),o=f.useCallback(function(c){s({type:"error",error:c})},[]),l=f.useCallback(function(c){s({type:"value",value:c})},[]);return f.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:o,setValue:l,value:r.value}},[r.error,r.loading,i,o,l,r.value])},Ev=function(t,e){var n=w7(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,o=n.setValue,l=n.value;return f.useEffect(function(){var c=s$(t,function(u){return x7(void 0,void 0,void 0,function(){var d;return y7(this,function(m){switch(m.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return m.sent(),[3,4];case 3:return d=m.sent(),i(d),[3,4];case 4:return o(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]},_7="firebase",b7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */is(_7,b7,"app");var aS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Sa,LC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,k){function j(){}j.prototype=k.prototype,I.D=k.prototype,I.prototype=new j,I.prototype.constructor=I,I.C=function(C,N,P){for(var A=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)A[Z-2]=arguments[Z];return k.prototype[N].apply(C,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,k,j){j||(j=0);var C=Array(16);if(typeof k=="string")for(var N=0;16>N;++N)C[N]=k.charCodeAt(j++)|k.charCodeAt(j++)<<8|k.charCodeAt(j++)<<16|k.charCodeAt(j++)<<24;else for(N=0;16>N;++N)C[N]=k[j++]|k[j++]<<8|k[j++]<<16|k[j++]<<24;k=I.g[0],j=I.g[1],N=I.g[2];var P=I.g[3],A=k+(P^j&(N^P))+C[0]+3614090360&4294967295;k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+C[1]+3905402710&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+C[2]+606105819&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+C[3]+3250441966&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(P^j&(N^P))+C[4]+4118548399&4294967295,k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+C[5]+1200080426&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+C[6]+2821735955&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+C[7]+4249261313&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(P^j&(N^P))+C[8]+1770035416&4294967295,k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+C[9]+2336552879&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+C[10]+4294925233&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+C[11]+2304563134&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(P^j&(N^P))+C[12]+1804603682&4294967295,k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+C[13]+4254626195&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+C[14]+2792965006&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+C[15]+1236535329&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(N^P&(j^N))+C[1]+4129170786&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+C[6]+3225465664&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+C[11]+643717713&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+C[0]+3921069994&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(j^N))+C[5]+3593408605&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+C[10]+38016083&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+C[15]+3634488961&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+C[4]+3889429448&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(j^N))+C[9]+568446438&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+C[14]+3275163606&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+C[3]+4107603335&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+C[8]+1163531501&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(j^N))+C[13]+2850285829&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+C[2]+4243563512&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+C[7]+1735328473&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+C[12]+2368359562&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(j^N^P)+C[5]+4294588738&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+C[8]+2272392833&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+C[11]+1839030562&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+C[14]+4259657740&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(j^N^P)+C[1]+2763975236&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+C[4]+1272893353&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+C[7]+4139469664&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+C[10]+3200236656&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(j^N^P)+C[13]+681279174&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+C[0]+3936430074&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+C[3]+3572445317&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+C[6]+76029189&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(j^N^P)+C[9]+3654602809&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+C[12]+3873151461&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+C[15]+530742520&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+C[2]+3299628645&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(N^(j|~P))+C[0]+4096336452&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+C[7]+1126891415&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+C[14]+2878612391&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+C[5]+4237533241&4294967295,j=N+(A<<21&4294967295|A>>>11),A=k+(N^(j|~P))+C[12]+1700485571&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+C[3]+2399980690&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+C[10]+4293915773&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+C[1]+2240044497&4294967295,j=N+(A<<21&4294967295|A>>>11),A=k+(N^(j|~P))+C[8]+1873313359&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+C[15]+4264355552&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+C[6]+2734768916&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+C[13]+1309151649&4294967295,j=N+(A<<21&4294967295|A>>>11),A=k+(N^(j|~P))+C[4]+4149444226&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+C[11]+3174756917&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+C[2]+718787259&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+k&4294967295,I.g[1]=I.g[1]+(N+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+N&4294967295,I.g[3]=I.g[3]+P&4294967295}r.prototype.u=function(I,k){k===void 0&&(k=I.length);for(var j=k-this.blockSize,C=this.B,N=this.h,P=0;P<k;){if(N==0)for(;P<=j;)s(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<k;)if(C[N++]=I.charCodeAt(P++),N==this.blockSize){s(this,C),N=0;break}}else for(;P<k;)if(C[N++]=I[P++],N==this.blockSize){s(this,C),N=0;break}}this.h=N,this.o+=k},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var k=1;k<I.length-8;++k)I[k]=0;var j=8*this.o;for(k=I.length-8;k<I.length;++k)I[k]=j&255,j/=256;for(this.u(I),I=Array(16),k=j=0;4>k;++k)for(var C=0;32>C;C+=8)I[j++]=this.g[k]>>>C&255;return I};function i(I,k){var j=l;return Object.prototype.hasOwnProperty.call(j,I)?j[I]:j[I]=k(I)}function o(I,k){this.h=k;for(var j=[],C=!0,N=I.length-1;0<=N;N--){var P=I[N]|0;C&&P==k||(j[N]=P,C=!1)}this.g=j}var l={};function c(I){return-128<=I&&128>I?i(I,function(k){return new o([k|0],0>k?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return m;if(0>I)return _(u(-I));for(var k=[],j=1,C=0;I>=j;C++)k[C]=I/j|0,j*=4294967296;return new o(k,0)}function d(I,k){if(I.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(I.charAt(0)=="-")return _(d(I.substring(1),k));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var j=u(Math.pow(k,8)),C=m,N=0;N<I.length;N+=8){var P=Math.min(8,I.length-N),A=parseInt(I.substring(N,N+P),k);8>P?(P=u(Math.pow(k,P)),C=C.j(P).add(u(A))):(C=C.j(j),C=C.add(u(A)))}return C}var m=c(0),p=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(v(this))return-_(this).m();for(var I=0,k=1,j=0;j<this.g.length;j++){var C=this.i(j);I+=(0<=C?C:4294967296+C)*k,k*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(y(this))return"0";if(v(this))return"-"+_(this).toString(I);for(var k=u(Math.pow(I,6)),j=this,C="";;){var N=R(j,k).g;j=S(j,N.j(k));var P=((0<j.g.length?j.g[0]:j.h)>>>0).toString(I);if(j=N,y(j))return P+C;for(;6>P.length;)P="0"+P;C=P+C}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function y(I){if(I.h!=0)return!1;for(var k=0;k<I.g.length;k++)if(I.g[k]!=0)return!1;return!0}function v(I){return I.h==-1}t.l=function(I){return I=S(this,I),v(I)?-1:y(I)?0:1};function _(I){for(var k=I.g.length,j=[],C=0;C<k;C++)j[C]=~I.g[C];return new o(j,~I.h).add(p)}t.abs=function(){return v(this)?_(this):this},t.add=function(I){for(var k=Math.max(this.g.length,I.g.length),j=[],C=0,N=0;N<=k;N++){var P=C+(this.i(N)&65535)+(I.i(N)&65535),A=(P>>>16)+(this.i(N)>>>16)+(I.i(N)>>>16);C=A>>>16,P&=65535,A&=65535,j[N]=A<<16|P}return new o(j,j[j.length-1]&-2147483648?-1:0)};function S(I,k){return I.add(_(k))}t.j=function(I){if(y(this)||y(I))return m;if(v(this))return v(I)?_(this).j(_(I)):_(_(this).j(I));if(v(I))return _(this.j(_(I)));if(0>this.l(g)&&0>I.l(g))return u(this.m()*I.m());for(var k=this.g.length+I.g.length,j=[],C=0;C<2*k;C++)j[C]=0;for(C=0;C<this.g.length;C++)for(var N=0;N<I.g.length;N++){var P=this.i(C)>>>16,A=this.i(C)&65535,Z=I.i(N)>>>16,he=I.i(N)&65535;j[2*C+2*N]+=A*he,b(j,2*C+2*N),j[2*C+2*N+1]+=P*he,b(j,2*C+2*N+1),j[2*C+2*N+1]+=A*Z,b(j,2*C+2*N+1),j[2*C+2*N+2]+=P*Z,b(j,2*C+2*N+2)}for(C=0;C<k;C++)j[C]=j[2*C+1]<<16|j[2*C];for(C=k;C<2*k;C++)j[C]=0;return new o(j,0)};function b(I,k){for(;(I[k]&65535)!=I[k];)I[k+1]+=I[k]>>>16,I[k]&=65535,k++}function E(I,k){this.g=I,this.h=k}function R(I,k){if(y(k))throw Error("division by zero");if(y(I))return new E(m,m);if(v(I))return k=R(_(I),k),new E(_(k.g),_(k.h));if(v(k))return k=R(I,_(k)),new E(_(k.g),k.h);if(30<I.g.length){if(v(I)||v(k))throw Error("slowDivide_ only works with positive integers.");for(var j=p,C=k;0>=C.l(I);)j=D(j),C=D(C);var N=F(j,1),P=F(C,1);for(C=F(C,2),j=F(j,2);!y(C);){var A=P.add(C);0>=A.l(I)&&(N=N.add(j),P=A),C=F(C,1),j=F(j,1)}return k=S(I,N.j(k)),new E(N,k)}for(N=m;0<=I.l(k);){for(j=Math.max(1,Math.floor(I.m()/k.m())),C=Math.ceil(Math.log(j)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),P=u(j),A=P.j(k);v(A)||0<A.l(I);)j-=C,P=u(j),A=P.j(k);y(P)&&(P=p),N=N.add(P),I=S(I,A)}return new E(N,I)}t.A=function(I){return R(this,I).h},t.and=function(I){for(var k=Math.max(this.g.length,I.g.length),j=[],C=0;C<k;C++)j[C]=this.i(C)&I.i(C);return new o(j,this.h&I.h)},t.or=function(I){for(var k=Math.max(this.g.length,I.g.length),j=[],C=0;C<k;C++)j[C]=this.i(C)|I.i(C);return new o(j,this.h|I.h)},t.xor=function(I){for(var k=Math.max(this.g.length,I.g.length),j=[],C=0;C<k;C++)j[C]=this.i(C)^I.i(C);return new o(j,this.h^I.h)};function D(I){for(var k=I.g.length+1,j=[],C=0;C<k;C++)j[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(j,I.h)}function F(I,k){var j=k>>5;k%=32;for(var C=I.g.length-j,N=[],P=0;P<C;P++)N[P]=0<k?I.i(P+j)>>>k|I.i(P+j+1)<<32-k:I.i(P+j);return new o(N,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,LC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Sa=o}).apply(typeof aS<"u"?aS:typeof self<"u"?self:typeof window<"u"?window:{});var Fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var MC,oc,OC,wh,rx,$C,BC,zC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,x,w){return h==Array.prototype||h==Object.prototype||(h[x]=w.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fd=="object"&&Fd];for(var x=0;x<h.length;++x){var w=h[x];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=n(this);function s(h,x){if(x)e:{var w=r;h=h.split(".");for(var T=0;T<h.length-1;T++){var L=h[T];if(!(L in w))break e;w=w[L]}h=h[h.length-1],T=w[h],x=x(T),x!=T&&x!=null&&e(w,h,{configurable:!0,writable:!0,value:x})}}function i(h,x){h instanceof String&&(h+="");var w=0,T=!1,L={next:function(){if(!T&&w<h.length){var M=w++;return{value:x(M,h[M]),done:!1}}return T=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(h){return h||function(){return i(this,function(x,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(h){var x=typeof h;return x=x!="object"?x:h?Array.isArray(h)?"array":x:"null",x=="array"||x=="object"&&typeof h.length=="number"}function u(h){var x=typeof h;return x=="object"&&h!=null||x=="function"}function d(h,x,w){return h.call.apply(h.bind,arguments)}function m(h,x,w){if(!h)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,T),h.apply(x,L)}}return function(){return h.apply(x,arguments)}}function p(h,x,w){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,p.apply(null,arguments)}function g(h,x){var w=Array.prototype.slice.call(arguments,1);return function(){var T=w.slice();return T.push.apply(T,arguments),h.apply(this,T)}}function y(h,x){function w(){}w.prototype=x.prototype,h.aa=x.prototype,h.prototype=new w,h.prototype.constructor=h,h.Qb=function(T,L,M){for(var W=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)W[Ue-2]=arguments[Ue];return x.prototype[L].apply(T,W)}}function v(h){const x=h.length;if(0<x){const w=Array(x);for(let T=0;T<x;T++)w[T]=h[T];return w}return[]}function _(h,x){for(let w=1;w<arguments.length;w++){const T=arguments[w];if(c(T)){const L=h.length||0,M=T.length||0;h.length=L+M;for(let W=0;W<M;W++)h[L+W]=T[W]}else h.push(T)}}class S{constructor(x,w){this.i=x,this.j=w,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function b(h){return/^[\s\xa0]*$/.test(h)}function E(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function R(h){return R[" "](h),h}R[" "]=function(){};var D=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function F(h,x,w){for(const T in h)x.call(w,h[T],T,h)}function I(h,x){for(const w in h)x.call(void 0,h[w],w,h)}function k(h){const x={};for(const w in h)x[w]=h[w];return x}const j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(h,x){let w,T;for(let L=1;L<arguments.length;L++){T=arguments[L];for(w in T)h[w]=T[w];for(let M=0;M<j.length;M++)w=j[M],Object.prototype.hasOwnProperty.call(T,w)&&(h[w]=T[w])}}function N(h){var x=1;h=h.split(":");const w=[];for(;0<x&&h.length;)w.push(h.shift()),x--;return h.length&&w.push(h.join(":")),w}function P(h){l.setTimeout(()=>{throw h},0)}function A(){var h=Y;let x=null;return h.g&&(x=h.g,h.g=h.g.next,h.g||(h.h=null),x.next=null),x}class Z{constructor(){this.h=this.g=null}add(x,w){const T=he.get();T.set(x,w),this.h?this.h.next=T:this.g=T,this.h=T}}var he=new S(()=>new te,h=>h.reset());class te{constructor(){this.next=this.g=this.h=null}set(x,w){this.h=x,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let Se,H=!1,Y=new Z,ee=()=>{const h=l.Promise.resolve(void 0);Se=()=>{h.then(ve)}};var ve=()=>{for(var h;h=A();){try{h.h.call(h.g)}catch(w){P(w)}var x=he;x.j(h),100>x.h&&(x.h++,h.next=x.g,x.g=h)}H=!1};function Ce(){this.s=this.s,this.C=this.C}Ce.prototype.s=!1,Ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ge(h,x){this.type=h,this.g=this.target=x,this.defaultPrevented=!1}Ge.prototype.h=function(){this.defaultPrevented=!0};var kr=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,x=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};l.addEventListener("test",w,x),l.removeEventListener("test",w,x)}catch{}return h}();function or(h,x){if(Ge.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var w=this.type=h.type,T=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=x,x=h.relatedTarget){if(D){e:{try{R(x.nodeName);var L=!0;break e}catch{}L=!1}L||(x=null)}}else w=="mouseover"?x=h.fromElement:w=="mouseout"&&(x=h.toElement);this.relatedTarget=x,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:lr[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&or.aa.h.call(this)}}y(or,Ge);var lr={2:"touch",3:"pen",4:"mouse"};or.prototype.h=function(){or.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Mn="closure_listenable_"+(1e6*Math.random()|0),Ju=0;function Zu(h,x,w,T,L){this.listener=h,this.proxy=null,this.src=x,this.type=w,this.capture=!!T,this.ha=L,this.key=++Ju,this.da=this.fa=!1}function Zi(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function be(h){this.src=h,this.g={},this.h=0}be.prototype.add=function(h,x,w,T,L){var M=h.toString();h=this.g[M],h||(h=this.g[M]=[],this.h++);var W=wt(h,x,T,L);return-1<W?(x=h[W],w||(x.fa=!1)):(x=new Zu(x,this.src,M,!!T,L),x.fa=w,h.push(x)),x};function vt(h,x){var w=x.type;if(w in h.g){var T=h.g[w],L=Array.prototype.indexOf.call(T,x,void 0),M;(M=0<=L)&&Array.prototype.splice.call(T,L,1),M&&(Zi(x),h.g[w].length==0&&(delete h.g[w],h.h--))}}function wt(h,x,w,T){for(var L=0;L<h.length;++L){var M=h[L];if(!M.da&&M.listener==x&&M.capture==!!w&&M.ha==T)return L}return-1}var On="closure_lm_"+(1e6*Math.random()|0),jn={};function Cl(h,x,w,T,L){if(T&&T.once)return e1(h,x,w,T,L);if(Array.isArray(x)){for(var M=0;M<x.length;M++)Cl(h,x[M],w,T,L);return null}return w=op(w),h&&h[Mn]?h.K(x,w,u(T)?!!T.capture:!!T,L):Zw(h,x,w,!1,T,L)}function Zw(h,x,w,T,L,M){if(!x)throw Error("Invalid event type");var W=u(L)?!!L.capture:!!L,Ue=ip(h);if(Ue||(h[On]=Ue=new be(h)),w=Ue.add(x,w,T,W,M),w.proxy)return w;if(T=g5(),w.proxy=T,T.src=h,T.listener=w,h.addEventListener)kr||(L=W),L===void 0&&(L=!1),h.addEventListener(x.toString(),T,L);else if(h.attachEvent)h.attachEvent(n1(x.toString()),T);else if(h.addListener&&h.removeListener)h.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return w}function g5(){function h(w){return x.call(h.src,h.listener,w)}const x=x5;return h}function e1(h,x,w,T,L){if(Array.isArray(x)){for(var M=0;M<x.length;M++)e1(h,x[M],w,T,L);return null}return w=op(w),h&&h[Mn]?h.L(x,w,u(T)?!!T.capture:!!T,L):Zw(h,x,w,!0,T,L)}function t1(h,x,w,T,L){if(Array.isArray(x))for(var M=0;M<x.length;M++)t1(h,x[M],w,T,L);else T=u(T)?!!T.capture:!!T,w=op(w),h&&h[Mn]?(h=h.i,x=String(x).toString(),x in h.g&&(M=h.g[x],w=wt(M,w,T,L),-1<w&&(Zi(M[w]),Array.prototype.splice.call(M,w,1),M.length==0&&(delete h.g[x],h.h--)))):h&&(h=ip(h))&&(x=h.g[x.toString()],h=-1,x&&(h=wt(x,w,T,L)),(w=-1<h?x[h]:null)&&sp(w))}function sp(h){if(typeof h!="number"&&h&&!h.da){var x=h.src;if(x&&x[Mn])vt(x.i,h);else{var w=h.type,T=h.proxy;x.removeEventListener?x.removeEventListener(w,T,h.capture):x.detachEvent?x.detachEvent(n1(w),T):x.addListener&&x.removeListener&&x.removeListener(T),(w=ip(x))?(vt(w,h),w.h==0&&(w.src=null,x[On]=null)):Zi(h)}}}function n1(h){return h in jn?jn[h]:jn[h]="on"+h}function x5(h,x){if(h.da)h=!0;else{x=new or(x,this);var w=h.listener,T=h.ha||h.src;h.fa&&sp(h),h=w.call(T,x)}return h}function ip(h){return h=h[On],h instanceof be?h:null}var ap="__closure_events_fn_"+(1e9*Math.random()>>>0);function op(h){return typeof h=="function"?h:(h[ap]||(h[ap]=function(x){return h.handleEvent(x)}),h[ap])}function Yt(){Ce.call(this),this.i=new be(this),this.M=this,this.F=null}y(Yt,Ce),Yt.prototype[Mn]=!0,Yt.prototype.removeEventListener=function(h,x,w,T){t1(this,h,x,w,T)};function un(h,x){var w,T=h.F;if(T)for(w=[];T;T=T.F)w.push(T);if(h=h.M,T=x.type||x,typeof x=="string")x=new Ge(x,h);else if(x instanceof Ge)x.target=x.target||h;else{var L=x;x=new Ge(T,h),C(x,L)}if(L=!0,w)for(var M=w.length-1;0<=M;M--){var W=x.g=w[M];L=ed(W,T,!0,x)&&L}if(W=x.g=h,L=ed(W,T,!0,x)&&L,L=ed(W,T,!1,x)&&L,w)for(M=0;M<w.length;M++)W=x.g=w[M],L=ed(W,T,!1,x)&&L}Yt.prototype.N=function(){if(Yt.aa.N.call(this),this.i){var h=this.i,x;for(x in h.g){for(var w=h.g[x],T=0;T<w.length;T++)Zi(w[T]);delete h.g[x],h.h--}}this.F=null},Yt.prototype.K=function(h,x,w,T){return this.i.add(String(h),x,!1,w,T)},Yt.prototype.L=function(h,x,w,T){return this.i.add(String(h),x,!0,w,T)};function ed(h,x,w,T){if(x=h.i.g[String(x)],!x)return!0;x=x.concat();for(var L=!0,M=0;M<x.length;++M){var W=x[M];if(W&&!W.da&&W.capture==w){var Ue=W.listener,Mt=W.ha||W.src;W.fa&&vt(h.i,W),L=Ue.call(Mt,T)!==!1&&L}}return L&&!T.defaultPrevented}function r1(h,x,w){if(typeof h=="function")w&&(h=p(h,w));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:l.setTimeout(h,x||0)}function s1(h){h.g=r1(()=>{h.g=null,h.i&&(h.i=!1,s1(h))},h.l);const x=h.h;h.h=null,h.m.apply(null,x)}class y5 extends Ce{constructor(x,w){super(),this.m=x,this.l=w,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:s1(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jl(h){Ce.call(this),this.h=h,this.g={}}y(jl,Ce);var i1=[];function a1(h){F(h.g,function(x,w){this.g.hasOwnProperty(w)&&sp(x)},h),h.g={}}jl.prototype.N=function(){jl.aa.N.call(this),a1(this)},jl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var lp=l.JSON.stringify,v5=l.JSON.parse,w5=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function cp(){}cp.prototype.h=null;function o1(h){return h.h||(h.h=h.i())}function l1(){}var Rl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function up(){Ge.call(this,"d")}y(up,Ge);function dp(){Ge.call(this,"c")}y(dp,Ge);var ea={},c1=null;function td(){return c1=c1||new Yt}ea.La="serverreachability";function u1(h){Ge.call(this,ea.La,h)}y(u1,Ge);function Al(h){const x=td();un(x,new u1(x))}ea.STAT_EVENT="statevent";function d1(h,x){Ge.call(this,ea.STAT_EVENT,h),this.stat=x}y(d1,Ge);function dn(h){const x=td();un(x,new d1(x,h))}ea.Ma="timingevent";function h1(h,x){Ge.call(this,ea.Ma,h),this.size=x}y(h1,Ge);function Nl(h,x){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},x)}function Pl(){this.g=!0}Pl.prototype.xa=function(){this.g=!1};function _5(h,x,w,T,L,M){h.info(function(){if(h.g)if(M)for(var W="",Ue=M.split("&"),Mt=0;Mt<Ue.length;Mt++){var De=Ue[Mt].split("=");if(1<De.length){var Jt=De[0];De=De[1];var Zt=Jt.split("_");W=2<=Zt.length&&Zt[1]=="type"?W+(Jt+"="+De+"&"):W+(Jt+"=redacted&")}}else W=null;else W=M;return"XMLHTTP REQ ("+T+") [attempt "+L+"]: "+x+`
`+w+`
`+W})}function b5(h,x,w,T,L,M,W){h.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+L+"]: "+x+`
`+w+`
`+M+" "+W})}function to(h,x,w,T){h.info(function(){return"XMLHTTP TEXT ("+x+"): "+E5(h,w)+(T?" "+T:"")})}function S5(h,x){h.info(function(){return"TIMEOUT: "+x})}Pl.prototype.info=function(){};function E5(h,x){if(!h.g)return x;if(!x)return null;try{var w=JSON.parse(x);if(w){for(h=0;h<w.length;h++)if(Array.isArray(w[h])){var T=w[h];if(!(2>T.length)){var L=T[1];if(Array.isArray(L)&&!(1>L.length)){var M=L[0];if(M!="noop"&&M!="stop"&&M!="close")for(var W=1;W<L.length;W++)L[W]=""}}}}return lp(w)}catch{return x}}var nd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},f1={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},hp;function rd(){}y(rd,cp),rd.prototype.g=function(){return new XMLHttpRequest},rd.prototype.i=function(){return{}},hp=new rd;function si(h,x,w,T){this.j=h,this.i=x,this.l=w,this.R=T||1,this.U=new jl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new m1}function m1(){this.i=null,this.g="",this.h=!1}var p1={},fp={};function mp(h,x,w){h.L=1,h.v=od(ys(x)),h.m=w,h.P=!0,g1(h,null)}function g1(h,x){h.F=Date.now(),sd(h),h.A=ys(h.v);var w=h.A,T=h.R;Array.isArray(T)||(T=[String(T)]),R1(w.i,"t",T),h.C=0,w=h.j.J,h.h=new m1,h.g=Q1(h.j,w?x:null,!h.m),0<h.O&&(h.M=new y5(p(h.Y,h,h.g),h.O)),x=h.U,w=h.g,T=h.ca;var L="readystatechange";Array.isArray(L)||(L&&(i1[0]=L.toString()),L=i1);for(var M=0;M<L.length;M++){var W=Cl(w,L[M],T||x.handleEvent,!1,x.h||x);if(!W)break;x.g[W.key]=W}x=h.H?k(h.H):{},h.m?(h.u||(h.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,x)):(h.u="GET",h.g.ea(h.A,h.u,null,x)),Al(),_5(h.i,h.u,h.A,h.l,h.R,h.m)}si.prototype.ca=function(h){h=h.target;const x=this.M;x&&vs(h)==3?x.j():this.Y(h)},si.prototype.Y=function(h){try{if(h==this.g)e:{const Zt=vs(this.g);var x=this.g.Ba();const so=this.g.Z();if(!(3>Zt)&&(Zt!=3||this.g&&(this.h.h||this.g.oa()||M1(this.g)))){this.J||Zt!=4||x==7||(x==8||0>=so?Al(3):Al(2)),pp(this);var w=this.g.Z();this.X=w;t:if(x1(this)){var T=M1(this.g);h="";var L=T.length,M=vs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ta(this),Fl(this);var W="";break t}this.h.i=new l.TextDecoder}for(x=0;x<L;x++)this.h.h=!0,h+=this.h.i.decode(T[x],{stream:!(M&&x==L-1)});T.length=0,this.h.g+=h,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=w==200,b5(this.i,this.u,this.A,this.l,this.R,Zt,w),this.o){if(this.T&&!this.K){t:{if(this.g){var Ue,Mt=this.g;if((Ue=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Ue)){var De=Ue;break t}}De=null}if(w=De)to(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gp(this,w);else{this.o=!1,this.s=3,dn(12),ta(this),Fl(this);break e}}if(this.P){w=!0;let Tr;for(;!this.J&&this.C<W.length;)if(Tr=k5(this,W),Tr==fp){Zt==4&&(this.s=4,dn(14),w=!1),to(this.i,this.l,null,"[Incomplete Response]");break}else if(Tr==p1){this.s=4,dn(15),to(this.i,this.l,W,"[Invalid Chunk]"),w=!1;break}else to(this.i,this.l,Tr,null),gp(this,Tr);if(x1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||W.length!=0||this.h.h||(this.s=1,dn(16),w=!1),this.o=this.o&&w,!w)to(this.i,this.l,W,"[Invalid Chunked Response]"),ta(this),Fl(this);else if(0<W.length&&!this.W){this.W=!0;var Jt=this.j;Jt.g==this&&Jt.ba&&!Jt.M&&(Jt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),bp(Jt),Jt.M=!0,dn(11))}}else to(this.i,this.l,W,null),gp(this,W);Zt==4&&ta(this),this.o&&!this.J&&(Zt==4?H1(this.j,this):(this.o=!1,sd(this)))}else U5(this.g),w==400&&0<W.indexOf("Unknown SID")?(this.s=3,dn(12)):(this.s=0,dn(13)),ta(this),Fl(this)}}}catch{}finally{}};function x1(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function k5(h,x){var w=h.C,T=x.indexOf(`
`,w);return T==-1?fp:(w=Number(x.substring(w,T)),isNaN(w)?p1:(T+=1,T+w>x.length?fp:(x=x.slice(T,T+w),h.C=T+w,x)))}si.prototype.cancel=function(){this.J=!0,ta(this)};function sd(h){h.S=Date.now()+h.I,y1(h,h.I)}function y1(h,x){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Nl(p(h.ba,h),x)}function pp(h){h.B&&(l.clearTimeout(h.B),h.B=null)}si.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(S5(this.i,this.A),this.L!=2&&(Al(),dn(17)),ta(this),this.s=2,Fl(this)):y1(this,this.S-h)};function Fl(h){h.j.G==0||h.J||H1(h.j,h)}function ta(h){pp(h);var x=h.M;x&&typeof x.ma=="function"&&x.ma(),h.M=null,a1(h.U),h.g&&(x=h.g,h.g=null,x.abort(),x.ma())}function gp(h,x){try{var w=h.j;if(w.G!=0&&(w.g==h||xp(w.h,h))){if(!h.K&&xp(w.h,h)&&w.G==3){try{var T=w.Da.g.parse(x)}catch{T=null}if(Array.isArray(T)&&T.length==3){var L=T;if(L[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<h.F)fd(w),dd(w);else break e;_p(w),dn(18)}}else w.za=L[1],0<w.za-w.T&&37500>L[2]&&w.F&&w.v==0&&!w.C&&(w.C=Nl(p(w.Za,w),6e3));if(1>=_1(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else ra(w,11)}else if((h.K||w.g==h)&&fd(w),!b(x))for(L=w.Da.g.parse(x),x=0;x<L.length;x++){let De=L[x];if(w.T=De[0],De=De[1],w.G==2)if(De[0]=="c"){w.K=De[1],w.ia=De[2];const Jt=De[3];Jt!=null&&(w.la=Jt,w.j.info("VER="+w.la));const Zt=De[4];Zt!=null&&(w.Aa=Zt,w.j.info("SVER="+w.Aa));const so=De[5];so!=null&&typeof so=="number"&&0<so&&(T=1.5*so,w.L=T,w.j.info("backChannelRequestTimeoutMs_="+T)),T=w;const Tr=h.g;if(Tr){const pd=Tr.g?Tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pd){var M=T.h;M.g||pd.indexOf("spdy")==-1&&pd.indexOf("quic")==-1&&pd.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(yp(M,M.h),M.h=null))}if(T.D){const Sp=Tr.g?Tr.g.getResponseHeader("X-HTTP-Session-Id"):null;Sp&&(T.ya=Sp,qe(T.I,T.D,Sp))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-h.F,w.j.info("Handshake RTT: "+w.R+"ms")),T=w;var W=h;if(T.qa=q1(T,T.J?T.ia:null,T.W),W.K){b1(T.h,W);var Ue=W,Mt=T.L;Mt&&(Ue.I=Mt),Ue.B&&(pp(Ue),sd(Ue)),T.g=W}else U1(T);0<w.i.length&&hd(w)}else De[0]!="stop"&&De[0]!="close"||ra(w,7);else w.G==3&&(De[0]=="stop"||De[0]=="close"?De[0]=="stop"?ra(w,7):wp(w):De[0]!="noop"&&w.l&&w.l.ta(De),w.v=0)}}Al(4)}catch{}}var T5=class{constructor(h,x){this.g=h,this.map=x}};function v1(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function w1(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function _1(h){return h.h?1:h.g?h.g.size:0}function xp(h,x){return h.h?h.h==x:h.g?h.g.has(x):!1}function yp(h,x){h.g?h.g.add(x):h.h=x}function b1(h,x){h.h&&h.h==x?h.h=null:h.g&&h.g.has(x)&&h.g.delete(x)}v1.prototype.cancel=function(){if(this.i=S1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function S1(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let x=h.i;for(const w of h.g.values())x=x.concat(w.D);return x}return v(h.i)}function I5(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var x=[],w=h.length,T=0;T<w;T++)x.push(h[T]);return x}x=[],w=0;for(T in h)x[w++]=h[T];return x}function C5(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var x=[];h=h.length;for(var w=0;w<h;w++)x.push(w);return x}x=[],w=0;for(const T in h)x[w++]=T;return x}}}function E1(h,x){if(h.forEach&&typeof h.forEach=="function")h.forEach(x,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,x,void 0);else for(var w=C5(h),T=I5(h),L=T.length,M=0;M<L;M++)x.call(void 0,T[M],w&&w[M],h)}var k1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function j5(h,x){if(h){h=h.split("&");for(var w=0;w<h.length;w++){var T=h[w].indexOf("="),L=null;if(0<=T){var M=h[w].substring(0,T);L=h[w].substring(T+1)}else M=h[w];x(M,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function na(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof na){this.h=h.h,id(this,h.j),this.o=h.o,this.g=h.g,ad(this,h.s),this.l=h.l;var x=h.i,w=new Ml;w.i=x.i,x.g&&(w.g=new Map(x.g),w.h=x.h),T1(this,w),this.m=h.m}else h&&(x=String(h).match(k1))?(this.h=!1,id(this,x[1]||"",!0),this.o=Dl(x[2]||""),this.g=Dl(x[3]||"",!0),ad(this,x[4]),this.l=Dl(x[5]||"",!0),T1(this,x[6]||"",!0),this.m=Dl(x[7]||"")):(this.h=!1,this.i=new Ml(null,this.h))}na.prototype.toString=function(){var h=[],x=this.j;x&&h.push(Ll(x,I1,!0),":");var w=this.g;return(w||x=="file")&&(h.push("//"),(x=this.o)&&h.push(Ll(x,I1,!0),"@"),h.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&h.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(Ll(w,w.charAt(0)=="/"?N5:A5,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",Ll(w,F5)),h.join("")};function ys(h){return new na(h)}function id(h,x,w){h.j=w?Dl(x,!0):x,h.j&&(h.j=h.j.replace(/:$/,""))}function ad(h,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);h.s=x}else h.s=null}function T1(h,x,w){x instanceof Ml?(h.i=x,D5(h.i,h.h)):(w||(x=Ll(x,P5)),h.i=new Ml(x,h.h))}function qe(h,x,w){h.i.set(x,w)}function od(h){return qe(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Dl(h,x){return h?x?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ll(h,x,w){return typeof h=="string"?(h=encodeURI(h).replace(x,R5),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function R5(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var I1=/[#\/\?@]/g,A5=/[#\?:]/g,N5=/[#\?]/g,P5=/[#\?@]/g,F5=/#/g;function Ml(h,x){this.h=this.g=null,this.i=h||null,this.j=!!x}function ii(h){h.g||(h.g=new Map,h.h=0,h.i&&j5(h.i,function(x,w){h.add(decodeURIComponent(x.replace(/\+/g," ")),w)}))}t=Ml.prototype,t.add=function(h,x){ii(this),this.i=null,h=no(this,h);var w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(x),this.h+=1,this};function C1(h,x){ii(h),x=no(h,x),h.g.has(x)&&(h.i=null,h.h-=h.g.get(x).length,h.g.delete(x))}function j1(h,x){return ii(h),x=no(h,x),h.g.has(x)}t.forEach=function(h,x){ii(this),this.g.forEach(function(w,T){w.forEach(function(L){h.call(x,L,T,this)},this)},this)},t.na=function(){ii(this);const h=Array.from(this.g.values()),x=Array.from(this.g.keys()),w=[];for(let T=0;T<x.length;T++){const L=h[T];for(let M=0;M<L.length;M++)w.push(x[T])}return w},t.V=function(h){ii(this);let x=[];if(typeof h=="string")j1(this,h)&&(x=x.concat(this.g.get(no(this,h))));else{h=Array.from(this.g.values());for(let w=0;w<h.length;w++)x=x.concat(h[w])}return x},t.set=function(h,x){return ii(this),this.i=null,h=no(this,h),j1(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[x]),this.h+=1,this},t.get=function(h,x){return h?(h=this.V(h),0<h.length?String(h[0]):x):x};function R1(h,x,w){C1(h,x),0<w.length&&(h.i=null,h.g.set(no(h,x),v(w)),h.h+=w.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],x=Array.from(this.g.keys());for(var w=0;w<x.length;w++){var T=x[w];const M=encodeURIComponent(String(T)),W=this.V(T);for(T=0;T<W.length;T++){var L=M;W[T]!==""&&(L+="="+encodeURIComponent(String(W[T]))),h.push(L)}}return this.i=h.join("&")};function no(h,x){return x=String(x),h.j&&(x=x.toLowerCase()),x}function D5(h,x){x&&!h.j&&(ii(h),h.i=null,h.g.forEach(function(w,T){var L=T.toLowerCase();T!=L&&(C1(this,T),R1(this,L,w))},h)),h.j=x}function L5(h,x){const w=new Pl;if(l.Image){const T=new Image;T.onload=g(ai,w,"TestLoadImage: loaded",!0,x,T),T.onerror=g(ai,w,"TestLoadImage: error",!1,x,T),T.onabort=g(ai,w,"TestLoadImage: abort",!1,x,T),T.ontimeout=g(ai,w,"TestLoadImage: timeout",!1,x,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=h}else x(!1)}function M5(h,x){const w=new Pl,T=new AbortController,L=setTimeout(()=>{T.abort(),ai(w,"TestPingServer: timeout",!1,x)},1e4);fetch(h,{signal:T.signal}).then(M=>{clearTimeout(L),M.ok?ai(w,"TestPingServer: ok",!0,x):ai(w,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(L),ai(w,"TestPingServer: error",!1,x)})}function ai(h,x,w,T,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),T(w)}catch{}}function O5(){this.g=new w5}function $5(h,x,w){const T=w||"";try{E1(h,function(L,M){let W=L;u(L)&&(W=lp(L)),x.push(T+M+"="+encodeURIComponent(W))})}catch(L){throw x.push(T+"type="+encodeURIComponent("_badmap")),L}}function ld(h){this.l=h.Ub||null,this.j=h.eb||!1}y(ld,cp),ld.prototype.g=function(){return new cd(this.l,this.j)},ld.prototype.i=function(h){return function(){return h}}({});function cd(h,x){Yt.call(this),this.D=h,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(cd,Yt),t=cd.prototype,t.open=function(h,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=x,this.readyState=1,$l(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(x.body=h),(this.D||l).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ol(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,$l(this)),this.g&&(this.readyState=3,$l(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;A1(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function A1(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var x=h.value?h.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!h.done}))&&(this.response=this.responseText+=x)}h.done?Ol(this):$l(this),this.readyState==3&&A1(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Ol(this))},t.Qa=function(h){this.g&&(this.response=h,Ol(this))},t.ga=function(){this.g&&Ol(this)};function Ol(h){h.readyState=4,h.l=null,h.j=null,h.v=null,$l(h)}t.setRequestHeader=function(h,x){this.u.append(h,x)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],x=this.h.entries();for(var w=x.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=x.next();return h.join(`\r
`)};function $l(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(cd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function N1(h){let x="";return F(h,function(w,T){x+=T,x+=":",x+=w,x+=`\r
`}),x}function vp(h,x,w){e:{for(T in w){var T=!1;break e}T=!0}T||(w=N1(w),typeof h=="string"?w!=null&&encodeURIComponent(String(w)):qe(h,x,w))}function lt(h){Yt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(lt,Yt);var B5=/^https?$/i,z5=["POST","PUT"];t=lt.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,x,w,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);x=x?x.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():hp.g(),this.v=this.o?o1(this.o):o1(hp),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(x,String(h),!0),this.B=!1}catch(M){P1(this,M);return}if(h=w||"",w=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var L in T)w.set(L,T[L]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())w.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(w.keys()).find(M=>M.toLowerCase()=="content-type"),L=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(z5,x,void 0))||T||L||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,W]of w)this.g.setRequestHeader(M,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{L1(this),this.u=!0,this.g.send(h),this.u=!1}catch(M){P1(this,M)}};function P1(h,x){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=x,h.m=5,F1(h),ud(h)}function F1(h){h.A||(h.A=!0,un(h,"complete"),un(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,un(this,"complete"),un(this,"abort"),ud(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ud(this,!0)),lt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?D1(this):this.bb())},t.bb=function(){D1(this)};function D1(h){if(h.h&&typeof o<"u"&&(!h.v[1]||vs(h)!=4||h.Z()!=2)){if(h.u&&vs(h)==4)r1(h.Ea,0,h);else if(un(h,"readystatechange"),vs(h)==4){h.h=!1;try{const W=h.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var w;if(!(w=x)){var T;if(T=W===0){var L=String(h.D).match(k1)[1]||null;!L&&l.self&&l.self.location&&(L=l.self.location.protocol.slice(0,-1)),T=!B5.test(L?L.toLowerCase():"")}w=T}if(w)un(h,"complete"),un(h,"success");else{h.m=6;try{var M=2<vs(h)?h.g.statusText:""}catch{M=""}h.l=M+" ["+h.Z()+"]",F1(h)}}finally{ud(h)}}}}function ud(h,x){if(h.g){L1(h);const w=h.g,T=h.v[0]?()=>{}:null;h.g=null,h.v=null,x||un(h,"ready");try{w.onreadystatechange=T}catch{}}}function L1(h){h.I&&(l.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function vs(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<vs(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var x=this.g.responseText;return h&&x.indexOf(h)==0&&(x=x.substring(h.length)),v5(x)}};function M1(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function U5(h){const x={};h=(h.g&&2<=vs(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<h.length;T++){if(b(h[T]))continue;var w=N(h[T]);const L=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const M=x[L]||[];x[L]=M,M.push(w)}I(x,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bl(h,x,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||x}function O1(h){this.Aa=0,this.i=[],this.j=new Pl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Bl("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Bl("baseRetryDelayMs",5e3,h),this.cb=Bl("retryDelaySeedMs",1e4,h),this.Wa=Bl("forwardChannelMaxRetries",2,h),this.wa=Bl("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new v1(h&&h.concurrentRequestLimit),this.Da=new O5,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=O1.prototype,t.la=8,t.G=1,t.connect=function(h,x,w,T){dn(0),this.W=h,this.H=x||{},w&&T!==void 0&&(this.H.OSID=w,this.H.OAID=T),this.F=this.X,this.I=q1(this,null,this.W),hd(this)};function wp(h){if($1(h),h.G==3){var x=h.U++,w=ys(h.I);if(qe(w,"SID",h.K),qe(w,"RID",x),qe(w,"TYPE","terminate"),zl(h,w),x=new si(h,h.j,x),x.L=2,x.v=od(ys(w)),w=!1,l.navigator&&l.navigator.sendBeacon)try{w=l.navigator.sendBeacon(x.v.toString(),"")}catch{}!w&&l.Image&&(new Image().src=x.v,w=!0),w||(x.g=Q1(x.j,null),x.g.ea(x.v)),x.F=Date.now(),sd(x)}G1(h)}function dd(h){h.g&&(bp(h),h.g.cancel(),h.g=null)}function $1(h){dd(h),h.u&&(l.clearTimeout(h.u),h.u=null),fd(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function hd(h){if(!w1(h.h)&&!h.s){h.s=!0;var x=h.Ga;Se||ee(),H||(Se(),H=!0),Y.add(x,h),h.B=0}}function V5(h,x){return _1(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=x.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Nl(p(h.Ga,h,x),W1(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const L=new si(this,this.j,h);let M=this.o;if(this.S&&(M?(M=k(M),C(M,this.S)):M=this.S),this.m!==null||this.O||(L.H=M,M=null),this.P)e:{for(var x=0,w=0;w<this.i.length;w++){t:{var T=this.i[w];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(x+=T,4096<x){x=w;break e}if(x===4096||w===this.i.length-1){x=w+1;break e}}x=1e3}else x=1e3;x=z1(this,L,x),w=ys(this.I),qe(w,"RID",h),qe(w,"CVER",22),this.D&&qe(w,"X-HTTP-Session-Id",this.D),zl(this,w),M&&(this.O?x="headers="+encodeURIComponent(String(N1(M)))+"&"+x:this.m&&vp(w,this.m,M)),yp(this.h,L),this.Ua&&qe(w,"TYPE","init"),this.P?(qe(w,"$req",x),qe(w,"SID","null"),L.T=!0,mp(L,w,null)):mp(L,w,x),this.G=2}}else this.G==3&&(h?B1(this,h):this.i.length==0||w1(this.h)||B1(this))};function B1(h,x){var w;x?w=x.l:w=h.U++;const T=ys(h.I);qe(T,"SID",h.K),qe(T,"RID",w),qe(T,"AID",h.T),zl(h,T),h.m&&h.o&&vp(T,h.m,h.o),w=new si(h,h.j,w,h.B+1),h.m===null&&(w.H=h.o),x&&(h.i=x.D.concat(h.i)),x=z1(h,w,1e3),w.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),yp(h.h,w),mp(w,T,x)}function zl(h,x){h.H&&F(h.H,function(w,T){qe(x,T,w)}),h.l&&E1({},function(w,T){qe(x,T,w)})}function z1(h,x,w){w=Math.min(h.i.length,w);var T=h.l?p(h.l.Na,h.l,h):null;e:{var L=h.i;let M=-1;for(;;){const W=["count="+w];M==-1?0<w?(M=L[0].g,W.push("ofs="+M)):M=0:W.push("ofs="+M);let Ue=!0;for(let Mt=0;Mt<w;Mt++){let De=L[Mt].g;const Jt=L[Mt].map;if(De-=M,0>De)M=Math.max(0,L[Mt].g-100),Ue=!1;else try{$5(Jt,W,"req"+De+"_")}catch{T&&T(Jt)}}if(Ue){T=W.join("&");break e}}}return h=h.i.splice(0,w),x.D=h,T}function U1(h){if(!h.g&&!h.u){h.Y=1;var x=h.Fa;Se||ee(),H||(Se(),H=!0),Y.add(x,h),h.v=0}}function _p(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Nl(p(h.Fa,h),W1(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,V1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Nl(p(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,dn(10),dd(this),V1(this))};function bp(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function V1(h){h.g=new si(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var x=ys(h.qa);qe(x,"RID","rpc"),qe(x,"SID",h.K),qe(x,"AID",h.T),qe(x,"CI",h.F?"0":"1"),!h.F&&h.ja&&qe(x,"TO",h.ja),qe(x,"TYPE","xmlhttp"),zl(h,x),h.m&&h.o&&vp(x,h.m,h.o),h.L&&(h.g.I=h.L);var w=h.g;h=h.ia,w.L=1,w.v=od(ys(x)),w.m=null,w.P=!0,g1(w,h)}t.Za=function(){this.C!=null&&(this.C=null,dd(this),_p(this),dn(19))};function fd(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function H1(h,x){var w=null;if(h.g==x){fd(h),bp(h),h.g=null;var T=2}else if(xp(h.h,x))w=x.D,b1(h.h,x),T=1;else return;if(h.G!=0){if(x.o)if(T==1){w=x.m?x.m.length:0,x=Date.now()-x.F;var L=h.B;T=td(),un(T,new h1(T,w)),hd(h)}else U1(h);else if(L=x.s,L==3||L==0&&0<x.X||!(T==1&&V5(h,x)||T==2&&_p(h)))switch(w&&0<w.length&&(x=h.h,x.i=x.i.concat(w)),L){case 1:ra(h,5);break;case 4:ra(h,10);break;case 3:ra(h,6);break;default:ra(h,2)}}}function W1(h,x){let w=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(w*=2),w*x}function ra(h,x){if(h.j.info("Error code "+x),x==2){var w=p(h.fb,h),T=h.Xa;const L=!T;T=new na(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||id(T,"https"),od(T),L?L5(T.toString(),w):M5(T.toString(),w)}else dn(2);h.G=0,h.l&&h.l.sa(x),G1(h),$1(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),dn(2)):(this.j.info("Failed to ping google.com"),dn(1))};function G1(h){if(h.G=0,h.ka=[],h.l){const x=S1(h.h);(x.length!=0||h.i.length!=0)&&(_(h.ka,x),_(h.ka,h.i),h.h.i.length=0,v(h.i),h.i.length=0),h.l.ra()}}function q1(h,x,w){var T=w instanceof na?ys(w):new na(w);if(T.g!="")x&&(T.g=x+"."+T.g),ad(T,T.s);else{var L=l.location;T=L.protocol,x=x?x+"."+L.hostname:L.hostname,L=+L.port;var M=new na(null);T&&id(M,T),x&&(M.g=x),L&&ad(M,L),w&&(M.l=w),T=M}return w=h.D,x=h.ya,w&&x&&qe(T,w,x),qe(T,"VER",h.la),zl(h,T),T}function Q1(h,x,w){if(x&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=h.Ca&&!h.pa?new lt(new ld({eb:w})):new lt(h.pa),x.Ha(h.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function K1(){}t=K1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function md(){}md.prototype.g=function(h,x){return new $n(h,x)};function $n(h,x){Yt.call(this),this.g=new O1(x),this.l=h,this.h=x&&x.messageUrlParams||null,h=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(h?h["X-WebChannel-Content-Type"]=x.messageContentType:h={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(h?h["X-WebChannel-Client-Profile"]=x.va:h={"X-WebChannel-Client-Profile":x.va}),this.g.S=h,(h=x&&x.Sb)&&!b(h)&&(this.g.m=h),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!b(x)&&(this.g.D=x,h=this.h,h!==null&&x in h&&(h=this.h,x in h&&delete h[x])),this.j=new ro(this)}y($n,Yt),$n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){wp(this.g)},$n.prototype.o=function(h){var x=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.u&&(w={},w.__data__=lp(h),h=w);x.i.push(new T5(x.Ya++,h)),x.G==3&&hd(x)},$n.prototype.N=function(){this.g.l=null,delete this.j,wp(this.g),delete this.g,$n.aa.N.call(this)};function X1(h){up.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var x=h.__sm__;if(x){e:{for(const w in x){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,x=x!==null&&h in x?x[h]:void 0),this.data=x}else this.data=h}y(X1,up);function Y1(){dp.call(this),this.status=1}y(Y1,dp);function ro(h){this.g=h}y(ro,K1),ro.prototype.ua=function(){un(this.g,"a")},ro.prototype.ta=function(h){un(this.g,new X1(h))},ro.prototype.sa=function(h){un(this.g,new Y1)},ro.prototype.ra=function(){un(this.g,"b")},md.prototype.createWebChannel=md.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,zC=function(){return new md},BC=function(){return td()},$C=ea,rx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},nd.NO_ERROR=0,nd.TIMEOUT=8,nd.HTTP_ERROR=6,wh=nd,f1.COMPLETE="complete",OC=f1,l1.EventType=Rl,Rl.OPEN="a",Rl.CLOSE="b",Rl.ERROR="c",Rl.MESSAGE="d",Yt.prototype.listen=Yt.prototype.K,oc=l1,lt.prototype.listenOnce=lt.prototype.L,lt.prototype.getLastError=lt.prototype.Ka,lt.prototype.getLastErrorCode=lt.prototype.Ba,lt.prototype.getStatus=lt.prototype.Z,lt.prototype.getResponseJson=lt.prototype.Oa,lt.prototype.getResponseText=lt.prototype.oa,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Ha,MC=lt}).apply(typeof Fd<"u"?Fd:typeof self<"u"?self:typeof window<"u"?window:{});const oS="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rn.UNAUTHENTICATED=new rn(null),rn.GOOGLE_CREDENTIALS=new rn("google-credentials-uid"),rn.FIRST_PARTY=new rn("first-party-uid"),rn.MOCK_USER=new rn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=new uv("@firebase/firestore");function Jl(){return Pa.logLevel}function X(t,...e){if(Pa.logLevel<=je.DEBUG){const n=e.map(kv);Pa.debug(`Firestore (${xl}): ${t}`,...n)}}function Us(t,...e){if(Pa.logLevel<=je.ERROR){const n=e.map(kv);Pa.error(`Firestore (${xl}): ${t}`,...n)}}function Go(t,...e){if(Pa.logLevel<=je.WARN){const n=e.map(kv);Pa.warn(`Firestore (${xl}): ${t}`,...n)}}function kv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t="Unexpected state"){const e=`FIRESTORE (${xl}) INTERNAL ASSERTION FAILED: `+t;throw Us(e),new Error(e)}function $e(t,e){t||le()}function me(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends xs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class S7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(rn.UNAUTHENTICATED))}shutdown(){}}class E7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class k7{constructor(e){this.t=e,this.currentUser=rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){$e(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Ps;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ps,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{X("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(X("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ps)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(X("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e(typeof r.accessToken=="string"),new UC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string"),new rn(e)}}class T7{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=rn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class I7{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new T7(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(rn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class C7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class j7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){$e(this.o===void 0);const r=i=>{i.error!=null&&X("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,X("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{X("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):X("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($e(typeof n.token=="string"),this.R=n.token,new C7(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=R7(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Le(t,e){return t<e?-1:t>e?1:0}function qo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return jt.fromMillis(Date.now())}static fromDate(e){return jt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new jt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fe(e)}static min(){return new fe(new jt(0,0))}static max(){return new fe(new jt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(),r===void 0?r=e.length-n:r>e.length-n&&le(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Zc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Zc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ke extends Zc{construct(e,n,r){return new Ke(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new q(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ke(n)}static emptyPath(){return new Ke([])}}const A7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ut extends Zc{construct(e,n,r){return new Ut(e,n,r)}static isValidIdentifier(e){return A7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ut.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ut(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new q(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new q(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new q(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ut(n)}static emptyPath(){return new Ut([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.path=e}static fromPath(e){return new ne(Ke.fromString(e))}static fromName(e){return new ne(Ke.fromString(e).popFirst(5))}static empty(){return new ne(Ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ke.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new Ke(e.slice()))}}function N7(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new jt(n+1,0):new jt(n,r));return new $i(s,ne.empty(),e)}function P7(t){return new $i(t.readTime,t.key,-1)}class $i{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new $i(fe.min(),ne.empty(),-1)}static max(){return new $i(fe.max(),ne.empty(),-1)}}function F7(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ne.comparator(t.documentKey,e.documentKey),n!==0?n:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class L7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Du(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==D7)throw t;X("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function M7(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Lu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Tv.oe=-1;function wm(t){return t==null}function df(t){return t===0&&1/t==-1/0}function O7(t){return typeof t=="number"&&Number.isInteger(t)&&!df(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Xa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function HC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){this.comparator=e,this.root=n||zt.EMPTY}insert(e,n){return new at(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,zt.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dd(this.root,e,this.comparator,!0)}}class Dd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??zt.RED,this.left=s??zt.EMPTY,this.right=i??zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new zt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return zt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw le();const e=this.left.check();if(e!==this.right.check())throw le();return e+(this.isRed()?0:1)}}zt.EMPTY=null,zt.RED=!0,zt.BLACK=!1;zt.EMPTY=new class{constructor(){this.size=0}get key(){throw le()}get value(){throw le()}get color(){throw le()}get left(){throw le()}get right(){throw le()}copy(e,n,r,s,i){return this}insert(e,n,r){return new zt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new cS(this.data.getIterator())}getIteratorFrom(e){return new cS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ht(this.comparator);return n.data=e,n}}class cS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.fields=e,e.sort(Ut.comparator)}static empty(){return new Gn([])}unionWith(e){let n=new Ht(Ut.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return qo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new WC("Invalid base64 string: "+i):i}}(e);return new Qt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Qt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qt.EMPTY_BYTE_STRING=new Qt("");const $7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bi(t){if($e(!!t),typeof t=="string"){let e=0;const n=$7.exec(t);if($e(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pt(t.seconds),nanos:pt(t.nanos)}}function pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Fa(t){return typeof t=="string"?Qt.fromBase64String(t):Qt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Cv(t){const e=t.mapValue.fields.__previous_value__;return Iv(e)?Cv(e):e}function eu(t){const e=Bi(t.mapValue.fields.__local_write_time__.timestampValue);return new jt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e,n,r,s,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class tu{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new tu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof tu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Da(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Iv(t)?4:U7(t)?9007199254740991:z7(t)?10:11:le()}function ds(t,e){if(t===e)return!0;const n=Da(t);if(n!==Da(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return eu(t).isEqual(eu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Bi(s.timestampValue),l=Bi(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Fa(s.bytesValue).isEqual(Fa(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return pt(s.geoPointValue.latitude)===pt(i.geoPointValue.latitude)&&pt(s.geoPointValue.longitude)===pt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return pt(s.integerValue)===pt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=pt(s.doubleValue),l=pt(i.doubleValue);return o===l?df(o)===df(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return qo(t.arrayValue.values||[],e.arrayValue.values||[],ds);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(lS(o)!==lS(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ds(o[c],l[c])))return!1;return!0}(t,e);default:return le()}}function nu(t,e){return(t.values||[]).find(n=>ds(n,e))!==void 0}function Qo(t,e){if(t===e)return 0;const n=Da(t),r=Da(e);if(n!==r)return Le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=pt(i.integerValue||i.doubleValue),c=pt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return uS(t.timestampValue,e.timestampValue);case 4:return uS(eu(t),eu(e));case 5:return Le(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Fa(i),c=Fa(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Le(l[u],c[u]);if(d!==0)return d}return Le(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Le(pt(i.latitude),pt(o.latitude));return l!==0?l:Le(pt(i.longitude),pt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return dS(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const m=i.fields||{},p=o.fields||{},g=(l=m.value)===null||l===void 0?void 0:l.arrayValue,y=(c=p.value)===null||c===void 0?void 0:c.arrayValue,v=Le(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return v!==0?v:dS(g,y)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ld.mapValue&&o===Ld.mapValue)return 0;if(i===Ld.mapValue)return 1;if(o===Ld.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let m=0;m<c.length&&m<d.length;++m){const p=Le(c[m],d[m]);if(p!==0)return p;const g=Qo(l[c[m]],u[d[m]]);if(g!==0)return g}return Le(c.length,d.length)}(t.mapValue,e.mapValue);default:throw le()}}function uS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const n=Bi(t),r=Bi(e),s=Le(n.seconds,r.seconds);return s!==0?s:Le(n.nanos,r.nanos)}function dS(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Qo(n[s],r[s]);if(i)return i}return Le(n.length,r.length)}function Ko(t){return sx(t)}function sx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Bi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Fa(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ne.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=sx(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${sx(n.fields[o])}`;return s+"}"}(t.mapValue):le()}function hS(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ix(t){return!!t&&"integerValue"in t}function jv(t){return!!t&&"arrayValue"in t}function fS(t){return!!t&&"nullValue"in t}function mS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _h(t){return!!t&&"mapValue"in t}function z7(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function bc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Xa(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=bc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=bc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function U7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.value=e}static empty(){return new An({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!_h(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=bc(n)}setAll(e){let n=Ut.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=bc(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());_h(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ds(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];_h(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Xa(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new An(bc(this.value))}}function GC(t){const e=[];return Xa(t.fields,(n,r)=>{const s=new Ut([n]);if(_h(r)){const i=GC(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new an(e,0,fe.min(),fe.min(),fe.min(),An.empty(),0)}static newFoundDocument(e,n,r,s){return new an(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new an(e,2,n,fe.min(),fe.min(),An.empty(),0)}static newUnknownDocument(e,n){return new an(e,3,n,fe.min(),fe.min(),An.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=An.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=An.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof an&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new an(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n){this.position=e,this.inclusive=n}}function pS(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ne.comparator(ne.fromName(o.referenceValue),n.key):r=Qo(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function gS(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ds(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n="asc"){this.field=e,this.dir=n}}function V7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{}class St extends qC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new W7(e,n,r):n==="array-contains"?new Q7(e,r):n==="in"?new K7(e,r):n==="not-in"?new X7(e,r):n==="array-contains-any"?new Y7(e,r):new St(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new G7(e,r):new q7(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Qo(n,this.value)):n!==null&&Da(this.value)===Da(n)&&this.matchesComparison(Qo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zr extends qC{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new zr(e,n)}matches(e){return QC(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function QC(t){return t.op==="and"}function KC(t){return H7(t)&&QC(t)}function H7(t){for(const e of t.filters)if(e instanceof zr)return!1;return!0}function ax(t){if(t instanceof St)return t.field.canonicalString()+t.op.toString()+Ko(t.value);if(KC(t))return t.filters.map(e=>ax(e)).join(",");{const e=t.filters.map(n=>ax(n)).join(",");return`${t.op}(${e})`}}function XC(t,e){return t instanceof St?function(r,s){return s instanceof St&&r.op===s.op&&r.field.isEqual(s.field)&&ds(r.value,s.value)}(t,e):t instanceof zr?function(r,s){return s instanceof zr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&XC(o,s.filters[l]),!0):!1}(t,e):void le()}function YC(t){return t instanceof St?function(n){return`${n.field.canonicalString()} ${n.op} ${Ko(n.value)}`}(t):t instanceof zr?function(n){return n.op.toString()+" {"+n.getFilters().map(YC).join(" ,")+"}"}(t):"Filter"}class W7 extends St{constructor(e,n,r){super(e,n,r),this.key=ne.fromName(r.referenceValue)}matches(e){const n=ne.comparator(e.key,this.key);return this.matchesComparison(n)}}class G7 extends St{constructor(e,n){super(e,"in",n),this.keys=JC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class q7 extends St{constructor(e,n){super(e,"not-in",n),this.keys=JC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function JC(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ne.fromName(r.referenceValue))}class Q7 extends St{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return jv(n)&&nu(n.arrayValue,this.value)}}class K7 extends St{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&nu(this.value.arrayValue,n)}}class X7 extends St{constructor(e,n){super(e,"not-in",n)}matches(e){if(nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!nu(this.value.arrayValue,n)}}class Y7 extends St{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!jv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>nu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function xS(t,e=null,n=[],r=[],s=null,i=null,o=null){return new J7(t,e,n,r,s,i,o)}function Rv(t){const e=me(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ax(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),wm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ko(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ko(r)).join(",")),e.ue=n}return e.ue}function Av(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!V7(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!XC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gS(t.startAt,e.startAt)&&gS(t.endAt,e.endAt)}function ox(t){return ne.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Z7(t,e,n,r,s,i,o,l){return new yl(t,e,n,r,s,i,o,l)}function Nv(t){return new yl(t)}function yS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ZC(t){return t.collectionGroup!==null}function Sc(t){const e=me(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ht(Ut.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ru(i,r))}),n.has(Ut.keyField().canonicalString())||e.ce.push(new ru(Ut.keyField(),r))}return e.ce}function os(t){const e=me(t);return e.le||(e.le=e8(e,Sc(t))),e.le}function e8(t,e){if(t.limitType==="F")return xS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ru(s.field,i)});const n=t.endAt?new hf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new hf(t.startAt.position,t.startAt.inclusive):null;return xS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function lx(t,e){const n=t.filters.concat([e]);return new yl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ff(t,e,n){return new yl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _m(t,e){return Av(os(t),os(e))&&t.limitType===e.limitType}function ej(t){return`${Rv(os(t))}|lt:${t.limitType}`}function uo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>YC(s)).join(", ")}]`),wm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ko(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ko(s)).join(",")),`Target(${r})`}(os(t))}; limitType=${t.limitType})`}function bm(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ne.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Sc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=pS(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Sc(r),s)||r.endAt&&!function(o,l,c){const u=pS(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Sc(r),s))}(t,e)}function t8(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function tj(t){return(e,n)=>{let r=!1;for(const s of Sc(t)){const i=n8(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function n8(t,e,n){const r=t.field.isKeyField()?ne.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Qo(c,u):le()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Xa(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return HC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r8=new at(ne.comparator);function Vs(){return r8}const nj=new at(ne.comparator);function lc(...t){let e=nj;for(const n of t)e=e.insert(n.key,n);return e}function rj(t){let e=nj;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function va(){return Ec()}function sj(){return Ec()}function Ec(){return new vl(t=>t.toString(),(t,e)=>t.isEqual(e))}const s8=new at(ne.comparator),i8=new Ht(ne.comparator);function ke(...t){let e=i8;for(const n of t)e=e.add(n);return e}const a8=new Ht(Le);function o8(){return a8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:df(e)?"-0":e}}function ij(t){return{integerValue:""+t}}function aj(t,e){return O7(e)?ij(e):Pv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(){this._=void 0}}function l8(t,e,n){return t instanceof su?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Iv(i)&&(i=Cv(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof iu?lj(t,e):t instanceof au?cj(t,e):function(s,i){const o=oj(s,i),l=vS(o)+vS(s.Pe);return ix(o)&&ix(s.Pe)?ij(l):Pv(s.serializer,l)}(t,e)}function c8(t,e,n){return t instanceof iu?lj(t,e):t instanceof au?cj(t,e):n}function oj(t,e){return t instanceof ou?function(r){return ix(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class su extends Sm{}class iu extends Sm{constructor(e){super(),this.elements=e}}function lj(t,e){const n=uj(e);for(const r of t.elements)n.some(s=>ds(s,r))||n.push(r);return{arrayValue:{values:n}}}class au extends Sm{constructor(e){super(),this.elements=e}}function cj(t,e){let n=uj(e);for(const r of t.elements)n=n.filter(s=>!ds(s,r));return{arrayValue:{values:n}}}class ou extends Sm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function vS(t){return pt(t.integerValue||t.doubleValue)}function uj(t){return jv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n){this.field=e,this.transform=n}}function u8(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof iu&&s instanceof iu||r instanceof au&&s instanceof au?qo(r.elements,s.elements,ds):r instanceof ou&&s instanceof ou?ds(r.Pe,s.Pe):r instanceof su&&s instanceof su}(t.transform,e.transform)}class d8{constructor(e,n){this.version=e,this.transformResults=n}}class yn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new yn}static exists(e){return new yn(void 0,e)}static updateTime(e){return new yn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Em{}function hj(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new km(t.key,yn.none()):new Mu(t.key,t.data,yn.none());{const n=t.data,r=An.empty();let s=new Ht(Ut.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Qi(t.key,r,new Gn(s.toArray()),yn.none())}}function h8(t,e,n){t instanceof Mu?function(s,i,o){const l=s.value.clone(),c=_S(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Qi?function(s,i,o){if(!bh(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=_S(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(fj(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function kc(t,e,n,r){return t instanceof Mu?function(i,o,l,c){if(!bh(i.precondition,o))return l;const u=i.value.clone(),d=bS(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Qi?function(i,o,l,c){if(!bh(i.precondition,o))return l;const u=bS(i.fieldTransforms,c,o),d=o.data;return d.setAll(fj(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return bh(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function f8(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=oj(r.transform,s||null);i!=null&&(n===null&&(n=An.empty()),n.set(r.field,i))}return n||null}function wS(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&qo(r,s,(i,o)=>u8(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Mu extends Em{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Qi extends Em{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function fj(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function _S(t,e,n){const r=new Map;$e(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,c8(o,l,n[s]))}return r}function bS(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,l8(i,o,e))}return r}class km extends Em{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class m8 extends Em{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&h8(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=kc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=kc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=sj();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=hj(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&qo(this.mutations,e.mutations,(n,r)=>wS(n,r))&&qo(this.baseMutations,e.baseMutations,(n,r)=>wS(n,r))}}class Fv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){$e(e.mutations.length===r.length);let s=function(){return s8}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Fv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x8{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t,Ne;function y8(t){switch(t){default:return le();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function mj(t){if(t===void 0)return Us("GRPC error has no .code"),z.UNKNOWN;switch(t){case _t.OK:return z.OK;case _t.CANCELLED:return z.CANCELLED;case _t.UNKNOWN:return z.UNKNOWN;case _t.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case _t.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case _t.INTERNAL:return z.INTERNAL;case _t.UNAVAILABLE:return z.UNAVAILABLE;case _t.UNAUTHENTICATED:return z.UNAUTHENTICATED;case _t.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case _t.NOT_FOUND:return z.NOT_FOUND;case _t.ALREADY_EXISTS:return z.ALREADY_EXISTS;case _t.PERMISSION_DENIED:return z.PERMISSION_DENIED;case _t.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case _t.ABORTED:return z.ABORTED;case _t.OUT_OF_RANGE:return z.OUT_OF_RANGE;case _t.UNIMPLEMENTED:return z.UNIMPLEMENTED;case _t.DATA_LOSS:return z.DATA_LOSS;default:return le()}}(Ne=_t||(_t={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v8(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w8=new Sa([4294967295,4294967295],0);function SS(t){const e=v8().encode(t),n=new LC;return n.update(e),new Uint8Array(n.digest())}function ES(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Sa([n,r],0),new Sa([s,i],0)]}class Dv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new cc(`Invalid padding: ${n}`);if(r<0)throw new cc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new cc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new cc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Sa.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Sa.fromNumber(r)));return s.compare(w8)===1&&(s=new Sa([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=SS(e),[r,s]=ES(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Dv(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=SS(e),[r,s]=ES(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class cc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ou.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Tm(fe.min(),s,new at(Le),Vs(),ke())}}class Ou{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ou(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class pj{constructor(e,n){this.targetId=e,this.me=n}}class gj{constructor(e,n,r=Qt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class kS{constructor(){this.fe=0,this.ge=IS(),this.pe=Qt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ke(),n=ke(),r=ke();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le()}}),new Ou(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=IS()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,$e(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _8{constructor(e){this.Le=e,this.Be=new Map,this.ke=Vs(),this.qe=TS(),this.Qe=new at(Le)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:le()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(ox(i))if(r===0){const o=new ne(i.path);this.Ue(n,o,an.newNoDocument(o,fe.min()))}else $e(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Fa(r).toUint8Array()}catch(c){if(c instanceof WC)return Go("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Dv(o,s,i)}catch(c){return Go(c instanceof cc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&ox(l.target)){const c=new ne(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,an.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=ke();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Tm(e,n,this.Qe,this.ke,r);return this.ke=Vs(),this.qe=TS(),this.Qe=new at(Le),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new kS,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ht(Le),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||X("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new kS),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function TS(){return new at(ne.comparator)}function IS(){return new at(ne.comparator)}const b8=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),S8=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),E8=(()=>({and:"AND",or:"OR"}))();class k8{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function cx(t,e){return t.useProto3Json||wm(e)?e:{value:e}}function mf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xj(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function T8(t,e){return mf(t,e.toTimestamp())}function ls(t){return $e(!!t),fe.fromTimestamp(function(n){const r=Bi(n);return new jt(r.seconds,r.nanos)}(t))}function Lv(t,e){return ux(t,e).canonicalString()}function ux(t,e){const n=function(s){return new Ke(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function yj(t){const e=Ke.fromString(t);return $e(Sj(e)),e}function dx(t,e){return Lv(t.databaseId,e.path)}function dg(t,e){const n=yj(e);if(n.get(1)!==t.databaseId.projectId)throw new q(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new q(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ne(wj(n))}function vj(t,e){return Lv(t.databaseId,e)}function I8(t){const e=yj(t);return e.length===4?Ke.emptyPath():wj(e)}function hx(t){return new Ke(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function wj(t){return $e(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function CS(t,e,n){return{name:dx(t,e),fields:n.value.mapValue.fields}}function C8(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:le()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?($e(d===void 0||typeof d=="string"),Qt.fromBase64String(d||"")):($e(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Qt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?z.UNKNOWN:mj(u.code);return new q(d,u.message||"")}(o);n=new gj(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=dg(t,r.document.name),i=ls(r.document.updateTime),o=r.document.createTime?ls(r.document.createTime):fe.min(),l=new An({mapValue:{fields:r.document.fields}}),c=an.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Sh(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=dg(t,r.document),i=r.readTime?ls(r.readTime):fe.min(),o=an.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Sh([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=dg(t,r.document),i=r.removedTargetIds||[];n=new Sh([],i,s,null)}else{if(!("filter"in e))return le();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new x8(s,i),l=r.targetId;n=new pj(l,o)}}return n}function j8(t,e){let n;if(e instanceof Mu)n={update:CS(t,e.key,e.value)};else if(e instanceof km)n={delete:dx(t,e.key)};else if(e instanceof Qi)n={update:CS(t,e.key,e.data),updateMask:O8(e.fieldMask)};else{if(!(e instanceof m8))return le();n={verify:dx(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof su)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof iu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof au)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ou)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw le()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:T8(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le()}(t,e.precondition)),n}function R8(t,e){return t&&t.length>0?($e(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?ls(s.updateTime):ls(i);return o.isEqual(fe.min())&&(o=ls(i)),new d8(o,s.transformResults||[])}(n,e))):[]}function A8(t,e){return{documents:[vj(t,e.path)]}}function N8(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vj(t,s);const i=function(u){if(u.length!==0)return bj(zr.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:ho(p.field),direction:D8(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=cx(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function P8(t){let e=I8(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){$e(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(m){const p=_j(m);return p instanceof zr&&KC(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(y){return new ru(fo(y.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(m){let p;return p=typeof m=="object"?m.value:m,wm(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(m){const p=!!m.before,g=m.values||[];return new hf(g,p)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const p=!m.before,g=m.values||[];return new hf(g,p)}(n.endAt)),Z7(e,s,o,i,l,"F",c,u)}function F8(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function _j(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=fo(n.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=fo(n.unaryFilter.field);return St.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=fo(n.unaryFilter.field);return St.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=fo(n.unaryFilter.field);return St.create(o,"!=",{nullValue:"NULL_VALUE"});default:return le()}}(t):t.fieldFilter!==void 0?function(n){return St.create(fo(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return le()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return zr.create(n.compositeFilter.filters.map(r=>_j(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le()}}(n.compositeFilter.op))}(t):le()}function D8(t){return b8[t]}function L8(t){return S8[t]}function M8(t){return E8[t]}function ho(t){return{fieldPath:t.canonicalString()}}function fo(t){return Ut.fromServerFormat(t.fieldPath)}function bj(t){return t instanceof St?function(n){if(n.op==="=="){if(mS(n.value))return{unaryFilter:{field:ho(n.field),op:"IS_NAN"}};if(fS(n.value))return{unaryFilter:{field:ho(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(mS(n.value))return{unaryFilter:{field:ho(n.field),op:"IS_NOT_NAN"}};if(fS(n.value))return{unaryFilter:{field:ho(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ho(n.field),op:L8(n.op),value:n.value}}}(t):t instanceof zr?function(n){const r=n.getFilters().map(s=>bj(s));return r.length===1?r[0]:{compositeFilter:{op:M8(n.op),filters:r}}}(t):le()}function O8(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Sj(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n,r,s,i=fe.min(),o=fe.min(),l=Qt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new bi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $8{constructor(e){this.ct=e}}function B8(t){const e=P8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ff(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(){this.un=new U8}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve($i.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve($i.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class U8{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ht(Ke.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ht(Ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Xo(0)}static kn(){return new Xo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(){this.changes=new vl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,an.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W8{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&kc(r.mutation,s,Gn.empty(),jt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const s=va();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=lc();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=va();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Vs();const o=Ec(),l=function(){return Ec()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Qi)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),kc(d.mutation,u,d.mutation.getFieldMask(),jt.now())):o.set(u.key,Gn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var m;return l.set(u,new H8(d,(m=o.get(u))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Ec();let s=new at((o,l)=>o-l),i=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||Gn.empty();d=l.applyToLocalView(u,d),r.set(c,d);const m=(s.get(l.batchId)||ke()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,m=sj();d.forEach(p=>{if(!i.has(p)){const g=hj(n.get(p),r.get(p));g!==null&&m.set(p,g),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ne.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):ZC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(va());let l=-1,c=i;return o.next(u=>U.forEach(u,(d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(d)?U.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,ke())).next(d=>({batchId:l,changes:rj(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ne(n)).next(r=>{let s=lc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=lc();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,c=>{const u=function(m,p){return new yl(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,an.newInvalidDocument(d)))});let l=lc();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&kc(d.mutation,u,Gn.empty(),jt.now()),bm(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ls(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:B8(s.bundledQuery),readTime:ls(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q8{constructor(){this.overlays=new at(ne.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=va();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=va(),i=n.length+1,o=new ne(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new at((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=va(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=va(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return U.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new g8(n,r));let i=this.Ir.get(n);i===void 0&&(i=ke(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(){this.sessionToken=Qt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(){this.Tr=new Ht(At.Er),this.dr=new Ht(At.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new At(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new At(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ne(new Ke([])),r=new At(n,e),s=new At(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ne(new Ke([])),r=new At(n,e),s=new At(n,e+1);let i=ke();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new At(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class At{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ne.comparator(e.key,n.key)||Le(e.wr,n.wr)}static Ar(e,n){return Le(e.wr,n.wr)||ne.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K8{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ht(At.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new p8(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new At(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new At(n,0),s=new At(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ht(Le);return n.forEach(s=>{const i=new At(s,0),o=new At(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ne.isDocumentKey(i)||(i=i.child(""));const o=new At(new ne(i),0);let l=new Ht(Le);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},o),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){$e(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new At(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new At(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(e){this.Mr=e,this.docs=function(){return new at(ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():an.newInvalidDocument(n))}getEntries(e,n){let r=Vs();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():an.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Vs();const o=n.path,l=new ne(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||F7(P7(d),r)<=0||(s.has(d.key)||bm(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Y8(this)}getSize(e){return U.resolve(this.size)}}class Y8 extends V8{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J8{constructor(e){this.persistence=e,this.Nr=new vl(n=>Rv(n),Av),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Mv,this.targetCount=0,this.kr=Xo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Xo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Tv(0),this.Kr=!1,this.Kr=!0,this.$r=new Q8,this.referenceDelegate=e(this),this.Ur=new J8(this),this.indexManager=new z8,this.remoteDocumentCache=function(s){return new X8(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new $8(n),this.Gr=new G8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new q8,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new K8(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){X("MemoryPersistence","Starting transaction:",e);const s=new eB(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class eB extends L7{constructor(e){super(),this.currentSequenceNumber=e}}class Ov{constructor(e){this.persistence=e,this.Jr=new Mv,this.Yr=null}static Zr(e){return new Ov(e)}get Xr(){if(this.Yr)return this.Yr;throw le()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=ne.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ke(),s=ke();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new $v(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nB{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return tO()?8:M7(cn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new tB;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Jl()<=je.DEBUG&&X("QueryEngine","SDK will not create cache indexes for query:",uo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(Jl()<=je.DEBUG&&X("QueryEngine","Query:",uo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Jl()<=je.DEBUG&&X("QueryEngine","The SDK decides to create cache indexes for query:",uo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,os(n))):U.resolve())}Yi(e,n){if(yS(n))return U.resolve(null);let r=os(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=ff(n,null,"F"),r=os(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ke(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,ff(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return yS(n)||s.isEqual(fe.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?U.resolve(null):(Jl()<=je.DEBUG&&X("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),uo(n)),this.rs(e,o,n,N7(s,-1)).next(l=>l))})}ts(e,n){let r=new Ht(tj(e));return n.forEach((s,i)=>{bm(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Jl()<=je.DEBUG&&X("QueryEngine","Using full collection scan to execute query:",uo(n)),this.Ji.getDocumentsMatchingQuery(e,n,$i.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rB{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new at(Le),this._s=new vl(i=>Rv(i),Av),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new W8(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function sB(t,e,n,r){return new rB(t,e,n,r)}async function Ej(t,e){const n=me(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=ke();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function iB(t,e){const n=me(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const m=u.batch,p=m.keys();let g=U.resolve();return p.forEach(y=>{g=g.next(()=>d.getEntry(c,y)).next(v=>{const _=u.docVersions.get(y);$e(_!==null),v.version.compareTo(_)<0&&(m.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),d.addEntry(v)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=ke();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function kj(t){const e=me(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function aB(t,e){const n=me(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,m)=>{const p=s.get(m);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,m)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?g=g.withResumeToken(Qt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),s=s.insert(m,g),function(v,_,S){return v.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(p,g,d)&&l.push(n.Ur.updateTargetData(i,g))});let c=Vs(),u=ke();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(oB(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(fe.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return U.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function oB(t,e,n){let r=ke(),s=ke();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Vs();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(fe.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):X("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function lB(t,e){const n=me(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function cB(t,e){const n=me(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new bi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function fx(t,e,n){const r=me(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Lu(o))throw o;X("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function jS(t,e,n){const r=me(t);let s=fe.min(),i=ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const m=me(c),p=m._s.get(d);return p!==void 0?U.resolve(m.os.get(p)):m.Ur.getTargetData(u,d)}(r,o,os(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:fe.min(),n?i:ke())).next(l=>(uB(r,t8(e),l),{documents:l,Ts:i})))}function uB(t,e,n){let r=t.us.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class RS{constructor(){this.activeTargetIds=o8()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class dB{constructor(){this.so=new RS,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new RS,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hB{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){X("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){X("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Md=null;function hg(){return Md===null?Md=function(){return 268435456+Math.round(2147483648*Math.random())}():Md++,"0x"+Md.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mB{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class pB extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=hg(),c=this.xo(n,r.toUriEncodedString());X("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,c,u,s).then(d=>(X("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw Go("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=fB[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=hg();return new Promise((o,l)=>{const c=new MC;c.setWithCredentials(!0),c.listenOnce(OC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case wh.NO_ERROR:const d=c.getResponseJson();X(nn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case wh.TIMEOUT:X(nn,`RPC '${e}' ${i} timed out`),l(new q(z.DEADLINE_EXCEEDED,"Request time out"));break;case wh.HTTP_ERROR:const m=c.getStatus();if(X(nn,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(_){const S=_.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(S)>=0?S:z.UNKNOWN}(g.status);l(new q(y,g.message))}else l(new q(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new q(z.UNAVAILABLE,"Connection failed."));break;default:le()}}finally{X(nn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);X(nn,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=hg(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=zC(),l=BC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");X(nn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const m=o.createWebChannel(d,c);let p=!1,g=!1;const y=new mB({Io:_=>{g?X(nn,`Not sending because RPC '${e}' stream ${s} is closed:`,_):(p||(X(nn,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),X(nn,`RPC '${e}' stream ${s} sending:`,_),m.send(_))},To:()=>m.close()}),v=(_,S,b)=>{_.listen(S,E=>{try{b(E)}catch(R){setTimeout(()=>{throw R},0)}})};return v(m,oc.EventType.OPEN,()=>{g||(X(nn,`RPC '${e}' stream ${s} transport opened.`),y.yo())}),v(m,oc.EventType.CLOSE,()=>{g||(g=!0,X(nn,`RPC '${e}' stream ${s} transport closed`),y.So())}),v(m,oc.EventType.ERROR,_=>{g||(g=!0,Go(nn,`RPC '${e}' stream ${s} transport errored:`,_),y.So(new q(z.UNAVAILABLE,"The operation could not be completed")))}),v(m,oc.EventType.MESSAGE,_=>{var S;if(!g){const b=_.data[0];$e(!!b);const E=b,R=E.error||((S=E[0])===null||S===void 0?void 0:S.error);if(R){X(nn,`RPC '${e}' stream ${s} received error:`,R);const D=R.status;let F=function(j){const C=_t[j];if(C!==void 0)return mj(C)}(D),I=R.message;F===void 0&&(F=z.INTERNAL,I="Unknown error status: "+D+" with message "+R.message),g=!0,y.So(new q(F,I)),m.close()}else X(nn,`RPC '${e}' stream ${s} received:`,b),y.bo(b)}}),v(l,$C.STAT_EVENT,_=>{_.stat===rx.PROXY?X(nn,`RPC '${e}' stream ${s} detected buffering proxy`):_.stat===rx.NOPROXY&&X(nn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function fg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(t){return new k8(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&X("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Tj(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(Us(n.toString()),Us("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new q(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return X("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(X("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gB extends Ij{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=C8(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?ls(o.readTime):fe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=hx(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=ox(c)?{documents:A8(i,c)}:{query:N8(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=xj(i,o.resumeToken);const u=cx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(fe.min())>0){l.readTime=mf(i,o.snapshotVersion.toTimestamp());const u=cx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=F8(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=hx(this.serializer),n.removeTarget=e,this.a_(n)}}class xB extends Ij{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return $e(!!e.streamToken),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){$e(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=R8(e.writeResults,e.commitTime),r=ls(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=hx(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>j8(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yB extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new q(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,ux(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new q(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,ux(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class vB{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Us(n),this.D_=!1):X("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wB{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Ya(this)&&(X("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=me(c);u.L_.add(4),await $u(u),u.q_.set("Unknown"),u.L_.delete(4),await Cm(u)}(this))})}),this.q_=new vB(r,s)}}async function Cm(t){if(Ya(t))for(const e of t.B_)await e(!0)}async function $u(t){for(const e of t.B_)await e(!1)}function Cj(t,e){const n=me(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Vv(n)?Uv(n):wl(n).r_()&&zv(n,e))}function Bv(t,e){const n=me(t),r=wl(n);n.N_.delete(e),r.r_()&&jj(n,e),n.N_.size===0&&(r.r_()?r.o_():Ya(n)&&n.q_.set("Unknown"))}function zv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}wl(t).A_(e)}function jj(t,e){t.Q_.xe(e),wl(t).R_(e)}function Uv(t){t.Q_=new _8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),wl(t).start(),t.q_.v_()}function Vv(t){return Ya(t)&&!wl(t).n_()&&t.N_.size>0}function Ya(t){return me(t).L_.size===0}function Rj(t){t.Q_=void 0}async function _B(t){t.q_.set("Online")}async function bB(t){t.N_.forEach((e,n)=>{zv(t,e)})}async function SB(t,e){Rj(t),Vv(t)?(t.q_.M_(e),Uv(t)):t.q_.set("Unknown")}async function EB(t,e,n){if(t.q_.set("Online"),e instanceof gj&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){X("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await pf(t,r)}else if(e instanceof Sh?t.Q_.Ke(e):e instanceof pj?t.Q_.He(e):t.Q_.We(e),!n.isEqual(fe.min()))try{const r=await kj(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(Qt.EMPTY_BYTE_STRING,d.snapshotVersion)),jj(i,c);const m=new bi(d.target,c,u,d.sequenceNumber);zv(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){X("RemoteStore","Failed to raise snapshot:",r),await pf(t,r)}}async function pf(t,e,n){if(!Lu(e))throw e;t.L_.add(1),await $u(t),t.q_.set("Offline"),n||(n=()=>kj(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{X("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Cm(t)})}function Aj(t,e){return e().catch(n=>pf(t,n,e))}async function jm(t){const e=me(t),n=zi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;kB(e);)try{const s=await lB(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,TB(e,s)}catch(s){await pf(e,s)}Nj(e)&&Pj(e)}function kB(t){return Ya(t)&&t.O_.length<10}function TB(t,e){t.O_.push(e);const n=zi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Nj(t){return Ya(t)&&!zi(t).n_()&&t.O_.length>0}function Pj(t){zi(t).start()}async function IB(t){zi(t).p_()}async function CB(t){const e=zi(t);for(const n of t.O_)e.m_(n.mutations)}async function jB(t,e,n){const r=t.O_.shift(),s=Fv.from(r,e,n);await Aj(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await jm(t)}async function RB(t,e){e&&zi(t).V_&&await async function(r,s){if(function(o){return y8(o)&&o!==z.ABORTED}(s.code)){const i=r.O_.shift();zi(r).s_(),await Aj(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await jm(r)}}(t,e),Nj(t)&&Pj(t)}async function NS(t,e){const n=me(t);n.asyncQueue.verifyOperationInProgress(),X("RemoteStore","RemoteStore received new credentials");const r=Ya(n);n.L_.add(3),await $u(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Cm(n)}async function AB(t,e){const n=me(t);e?(n.L_.delete(2),await Cm(n)):e||(n.L_.add(2),await $u(n),n.q_.set("Unknown"))}function wl(t){return t.K_||(t.K_=function(n,r,s){const i=me(n);return i.w_(),new gB(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:_B.bind(null,t),Ro:bB.bind(null,t),mo:SB.bind(null,t),d_:EB.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Vv(t)?Uv(t):t.q_.set("Unknown")):(await t.K_.stop(),Rj(t))})),t.K_}function zi(t){return t.U_||(t.U_=function(n,r,s){const i=me(n);return i.w_(),new xB(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:IB.bind(null,t),mo:RB.bind(null,t),f_:CB.bind(null,t),g_:jB.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await jm(t)):(await t.U_.stop(),t.O_.length>0&&(X("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ps,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Hv(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wv(t,e){if(Us("AsyncQueue",`${e}: ${t}`),Lu(t))return new q(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ne.comparator(n.key,r.key):(n,r)=>ne.comparator(n.key,r.key),this.keyedMap=lc(),this.sortedSet=new at(this.comparator)}static emptySet(e){return new Mo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(){this.W_=new at(ne.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):le():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Yo{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Yo(e,n,Mo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_m(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class PB{constructor(){this.queries=FS(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=me(n),i=s.queries;s.queries=FS(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new q(z.ABORTED,"Firestore shutting down"))}}function FS(){return new vl(t=>ej(t),_m)}async function Fj(t,e){const n=me(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new NB,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Wv(o,`Initialization of query '${uo(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Gv(n)}async function Dj(t,e){const n=me(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function FB(t,e){const n=me(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Gv(n)}function DB(t,e,n){const r=me(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Gv(t){t.Y_.forEach(e=>{e.next()})}var mx,DS;(DS=mx||(mx={})).ea="default",DS.Cache="cache";class Lj{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Yo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==mx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e){this.key=e}}class Oj{constructor(e){this.key=e}}class LB{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ke(),this.mutatedKeys=ke(),this.Aa=tj(e),this.Ra=new Mo(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new PS,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,m)=>{const p=s.get(d),g=bm(this.query,m)?m:null,y=!!p&&this.mutatedKeys.has(p.key),v=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let _=!1;p&&g?p.data.isEqual(g.data)?y!==v&&(r.track({type:3,doc:g}),_=!0):this.ga(p,g)||(r.track({type:2,doc:g}),_=!0,(c&&this.Aa(g,c)>0||u&&this.Aa(g,u)<0)&&(l=!0)):!p&&g?(r.track({type:0,doc:g}),_=!0):p&&!g&&(r.track({type:1,doc:p}),_=!0,(c||u)&&(l=!0)),_&&(g?(o=o.add(g),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,m)=>function(g,y){const v=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le()}};return v(g)-v(y)}(d.type,m.type)||this.Aa(d.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Yo(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new PS,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ke(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Oj(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Mj(r))}),n}ba(e){this.Ta=e.Ts,this.da=ke();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Yo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class MB{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class OB{constructor(e){this.key=e,this.va=!1}}class $B{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new vl(l=>ej(l),_m),this.Ma=new Map,this.xa=new Set,this.Oa=new at(ne.comparator),this.Na=new Map,this.La=new Mv,this.Ba={},this.ka=new Map,this.qa=Xo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function BB(t,e,n=!0){const r=Hj(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await $j(r,e,n,!0),s}async function zB(t,e){const n=Hj(t);await $j(n,e,!0,!1)}async function $j(t,e,n,r){const s=await cB(t.localStore,os(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await UB(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Cj(t.remoteStore,s),l}async function UB(t,e,n,r,s){t.Ka=(m,p,g)=>async function(v,_,S,b){let E=_.view.ma(S);E.ns&&(E=await jS(v.localStore,_.query,!1).then(({documents:I})=>_.view.ma(I,E)));const R=b&&b.targetChanges.get(_.targetId),D=b&&b.targetMismatches.get(_.targetId)!=null,F=_.view.applyChanges(E,v.isPrimaryClient,R,D);return MS(v,_.targetId,F.wa),F.snapshot}(t,m,p,g);const i=await jS(t.localStore,e,!0),o=new LB(e,i.Ts),l=o.ma(i.documents),c=Ou.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);MS(t,n,u.wa);const d=new MB(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function VB(t,e,n){const r=me(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!_m(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await fx(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Bv(r.remoteStore,s.targetId),px(r,s.targetId)}).catch(Du)):(px(r,s.targetId),await fx(r.localStore,s.targetId,!0))}async function HB(t,e){const n=me(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bv(n.remoteStore,r.targetId))}async function WB(t,e,n){const r=JB(t);try{const s=await function(o,l){const c=me(o),u=jt.now(),d=l.reduce((g,y)=>g.add(y.key),ke());let m,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=Vs(),v=ke();return c.cs.getEntries(g,d).next(_=>{y=_,y.forEach((S,b)=>{b.isValidDocument()||(v=v.add(S))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,y)).next(_=>{m=_;const S=[];for(const b of l){const E=f8(b,m.get(b.key).overlayedDocument);E!=null&&S.push(new Qi(b.key,E,GC(E.value.mapValue),yn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,S,l)}).next(_=>{p=_;const S=_.applyToLocalDocumentSet(m,v);return c.documentOverlayCache.saveOverlays(g,_.batchId,S)})}).then(()=>({batchId:p.batchId,changes:rj(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new at(Le)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,n),await Bu(r,s.changes),await jm(r.remoteStore)}catch(s){const i=Wv(s,"Failed to persist write");n.reject(i)}}async function Bj(t,e){const n=me(t);try{const r=await aB(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&($e(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?$e(o.va):s.removedDocuments.size>0&&($e(o.va),o.va=!1))}),await Bu(n,r,e)}catch(r){await Du(r)}}function LS(t,e,n){const r=me(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=me(o);c.onlineState=l;let u=!1;c.queries.forEach((d,m)=>{for(const p of m.j_)p.Z_(l)&&(u=!0)}),u&&Gv(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function GB(t,e,n){const r=me(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new at(ne.comparator);o=o.insert(i,an.newNoDocument(i,fe.min()));const l=ke().add(i),c=new Tm(fe.min(),new Map,new at(Le),o,l);await Bj(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),qv(r)}else await fx(r.localStore,e,!1).then(()=>px(r,e,n)).catch(Du)}async function qB(t,e){const n=me(t),r=e.batch.batchId;try{const s=await iB(n.localStore,e);Uj(n,r,null),zj(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Bu(n,s)}catch(s){await Du(s)}}async function QB(t,e,n){const r=me(t);try{const s=await function(o,l){const c=me(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>($e(m!==null),d=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Uj(r,e,n),zj(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Bu(r,s)}catch(s){await Du(s)}}function zj(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Uj(t,e,n){const r=me(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function px(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Vj(t,r)})}function Vj(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Bv(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),qv(t))}function MS(t,e,n){for(const r of n)r instanceof Mj?(t.La.addReference(r.key,e),KB(t,r)):r instanceof Oj?(X("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Vj(t,r.key)):le()}function KB(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(X("SyncEngine","New document in limbo: "+n),t.xa.add(r),qv(t))}function qv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ne(Ke.fromString(e)),r=t.qa.next();t.Na.set(r,new OB(n)),t.Oa=t.Oa.insert(n,r),Cj(t.remoteStore,new bi(os(Nv(n.path)),r,"TargetPurposeLimboResolution",Tv.oe))}}async function Bu(t,e,n){const r=me(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){s.push(u);const m=$v.Wi(c.targetId,u);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=me(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>U.forEach(u,p=>U.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(m,p.targetId,g)).next(()=>U.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(m,p.targetId,g)))))}catch(m){if(!Lu(m))throw m;X("LocalStore","Failed to update sequence numbers: "+m)}for(const m of u){const p=m.targetId;if(!m.fromCache){const g=d.os.get(p),y=g.snapshotVersion,v=g.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,v)}}}(r.localStore,i))}async function XB(t,e){const n=me(t);if(!n.currentUser.isEqual(e)){X("SyncEngine","User change. New user:",e.toKey());const r=await Ej(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new q(z.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Bu(n,r.hs)}}function YB(t,e){const n=me(t),r=n.Na.get(e);if(r&&r.va)return ke().add(r.key);{let s=ke();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function Hj(t){const e=me(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GB.bind(null,e),e.Ca.d_=FB.bind(null,e.eventManager),e.Ca.$a=DB.bind(null,e.eventManager),e}function JB(t){const e=me(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=QB.bind(null,e),e}class gf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Im(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return sB(this.persistence,new nB,e.initialUser,this.serializer)}Ga(e){return new Z8(Ov.Zr,this.serializer)}Wa(e){return new dB}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gf.provider={build:()=>new gf};class gx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>LS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=XB.bind(null,this.syncEngine),await AB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new PB}()}createDatastore(e){const n=Im(e.databaseInfo.databaseId),r=function(i){return new pB(i)}(e.databaseInfo);return function(i,o,l,c){return new yB(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new wB(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>LS(this.syncEngine,n,0),function(){return AS.D()?new AS:new hB}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const m=new $B(s,i,o,l,c,u);return d&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=me(s);X("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await $u(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}gx.provider={build:()=>new gx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Us("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=rn.UNAUTHENTICATED,this.clientId=VC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{X("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(X("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ps;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Wv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function mg(t,e){t.asyncQueue.verifyOperationInProgress(),X("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Ej(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function OS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ez(t);X("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>NS(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>NS(e.remoteStore,s)),t._onlineComponents=e}async function ez(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){X("FirestoreClient","Using user provided OfflineComponentProvider");try{await mg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Go("Error using user provided cache. Falling back to memory cache: "+n),await mg(t,new gf)}}else X("FirestoreClient","Using default OfflineComponentProvider"),await mg(t,new gf);return t._offlineComponents}async function Gj(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(X("FirestoreClient","Using user provided OnlineComponentProvider"),await OS(t,t._uninitializedComponentsProvider._online)):(X("FirestoreClient","Using default OnlineComponentProvider"),await OS(t,new gx))),t._onlineComponents}function tz(t){return Gj(t).then(e=>e.syncEngine)}async function qj(t){const e=await Gj(t),n=e.eventManager;return n.onListen=BB.bind(null,e.syncEngine),n.onUnlisten=VB.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=zB.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=HB.bind(null,e.syncEngine),n}function nz(t,e,n={}){const r=new Ps;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new Wj({next:p=>{d.Za(),o.enqueueAndForget(()=>Dj(i,m));const g=p.docs.has(l);!g&&p.fromCache?u.reject(new q(z.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new q(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new Lj(Nv(l.path),d,{includeMetadataChanges:!0,_a:!0});return Fj(i,m)}(await qj(t),t.asyncQueue,e,n,r)),r.promise}function rz(t,e,n={}){const r=new Ps;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new Wj({next:p=>{d.Za(),o.enqueueAndForget(()=>Dj(i,m)),p.fromCache&&c.source==="server"?u.reject(new q(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new Lj(l,d,{includeMetadataChanges:!0,_a:!0});return Fj(i,m)}(await qj(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kj(t,e,n){if(!n)throw new q(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sz(t,e,n,r){if(e===!0&&r===!0)throw new q(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function BS(t){if(!ne.isDocumentKey(t))throw new q(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zS(t){if(ne.isDocumentKey(t))throw new q(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Rm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le()}function wr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new q(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Rm(t);throw new q(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function iz(t,e){if(e<=0)throw new q(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new q(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Qj((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Am{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new US({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new q(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new US(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new S7;switch(r.type){case"firstParty":return new I7(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=$S.get(n);r&&(X("ComponentProvider","Removing Datastore"),$S.delete(n),r.terminate())}(this),Promise.resolve()}}function az(t,e,n,r={}){var s;const i=(t=wr(t,Am))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Go("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=rn.MOCK_USER;else{l=YI(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new q(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new rn(u)}t._authCredentials=new E7(new UC(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ki(this.firestore,e,this._query)}}class vn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Di(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}}class Di extends Ki{constructor(e,n,r){super(e,n,Nv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new ne(e))}withConverter(e){return new Di(this.firestore,e,this._path)}}function _r(t,e,...n){if(t=tt(t),Kj("collection","path",e),t instanceof Am){const r=Ke.fromString(e,...n);return zS(r),new Di(t,null,r)}{if(!(t instanceof vn||t instanceof Di))throw new q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ke.fromString(e,...n));return zS(r),new Di(t.firestore,null,r)}}function Rt(t,e,...n){if(t=tt(t),arguments.length===1&&(e=VC.newId()),Kj("doc","path",e),t instanceof Am){const r=Ke.fromString(e,...n);return BS(r),new vn(t,null,new ne(r))}{if(!(t instanceof vn||t instanceof Di))throw new q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ke.fromString(e,...n));return BS(r),new vn(t.firestore,t instanceof Di?t.converter:null,new ne(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Tj(this,"async_queue_retry"),this.Vu=()=>{const r=fg();r&&X("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=fg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=fg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ps;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Lu(e))throw e;X("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Us("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Hv.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&le()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Xi extends Am{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new VS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new VS(e),this._firestoreClient=void 0,await e}}}function oz(t,e){const n=typeof t=="object"?t:hv(),r=typeof t=="string"?t:e||"(default)",s=gm(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=QI("firestore");i&&az(s,...i)}return s}function Nm(t){if(t._terminated)throw new q(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||lz(t),t._firestoreClient}function lz(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new B7(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Qj(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new ZB(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jo(Qt.fromBase64String(e))}catch(n){throw new q(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Jo(Qt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new q(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Ys(){return new _l("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new q(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new q(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cz=/^__.*__$/;class uz{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Qi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Mu(e,this.data,n,this.fieldTransforms)}}class Xj{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Qi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Yj(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le()}}class Xv{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Xv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return xf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Yj(this.Cu)&&cz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class dz{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Im(e)}Qu(e,n,r,s=!1){return new Xv({Cu:e,methodName:n,qu:r,path:Ut.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uu(t){const e=t._freezeSettings(),n=Im(t._databaseId);return new dz(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yv(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);ew("Data must be an object, but it was:",o,r);const l=eR(r,o);let c,u;if(i.merge)c=new Gn(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const p=xx(e,m,n);if(!o.contains(p))throw new q(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);nR(d,p)||d.push(p)}c=new Gn(d),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new uz(new An(l),c,u)}class Pm extends zu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pm}}class Jv extends zu{_toFieldTransform(e){return new dj(e.path,new su)}isEqual(e){return e instanceof Jv}}class Zv extends zu{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new ou(e.serializer,aj(e.serializer,this.$u));return new dj(e.path,n)}isEqual(e){return e instanceof Zv&&this.$u===e.$u}}function Jj(t,e,n,r){const s=t.Qu(1,e,n);ew("Data must be an object, but it was:",s,r);const i=[],o=An.empty();Xa(r,(c,u)=>{const d=tw(e,c,n);u=tt(u);const m=s.Nu(d);if(u instanceof Pm)i.push(d);else{const p=Vu(u,m);p!=null&&(i.push(d),o.set(d,p))}});const l=new Gn(i);return new Xj(o,l,s.fieldTransforms)}function Zj(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[xx(e,r,n)],c=[s];if(i.length%2!=0)throw new q(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(xx(e,i[p])),c.push(i[p+1]);const u=[],d=An.empty();for(let p=l.length-1;p>=0;--p)if(!nR(u,l[p])){const g=l[p];let y=c[p];y=tt(y);const v=o.Nu(g);if(y instanceof Pm)u.push(g);else{const _=Vu(y,v);_!=null&&(u.push(g),d.set(g,_))}}const m=new Gn(u);return new Xj(d,m,o.fieldTransforms)}function hz(t,e,n,r=!1){return Vu(n,t.Qu(r?4:3,e))}function Vu(t,e){if(tR(t=tt(t)))return ew("Unsupported field value:",e,t),eR(t,e);if(t instanceof zu)return function(r,s){if(!Yj(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Vu(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return aj(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=jt.fromDate(r);return{timestampValue:mf(s.serializer,i)}}if(r instanceof jt){const i=new jt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:mf(s.serializer,i)}}if(r instanceof Qv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jo)return{bytesValue:xj(s.serializer,r._byteString)};if(r instanceof vn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Lv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Kv)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Pv(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Rm(r)}`)}(t,e)}function eR(t,e){const n={};return HC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xa(t,(r,s)=>{const i=Vu(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function tR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof jt||t instanceof Qv||t instanceof Jo||t instanceof vn||t instanceof zu||t instanceof Kv)}function ew(t,e,n){if(!tR(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Rm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function xx(t,e,n){if((e=tt(e))instanceof _l)return e._internalPath;if(typeof e=="string")return tw(t,e);throw xf("Field path arguments must be of type string or ",t,!1,void 0,n)}const fz=new RegExp("[~\\*/\\[\\]]");function tw(t,e,n){if(e.search(fz)>=0)throw xf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new _l(...e.split("."))._internalPath}catch{throw xf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function xf(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new q(z.INVALID_ARGUMENT,l+t+c)}function nR(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Fm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class mz extends rR{data(){return super.data()}}function Fm(t,e){return typeof e=="string"?tw(t,e):e instanceof _l?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new q(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nw{}class rw extends nw{}function pe(t,e,...n){let r=[];e instanceof nw&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof sw).length,l=i.filter(c=>c instanceof Dm).length;if(o>1||o>0&&l>0)throw new q(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Dm extends rw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Dm(e,n,r)}_apply(e){const n=this._parse(e);return sR(e._query,n),new Ki(e.firestore,e.converter,lx(e._query,n))}_parse(e){const n=Uu(e.firestore);return function(i,o,l,c,u,d,m){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new q(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){WS(m,d);const g=[];for(const y of m)g.push(HS(c,i,y));p={arrayValue:{values:g}}}else p=HS(c,i,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||WS(m,d),p=hz(l,o,m,d==="in"||d==="not-in");return St.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Q(t,e,n){const r=e,s=Fm("where",t);return Dm._create(s,r,n)}class sw extends nw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new sw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:zr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)sR(o,c),o=lx(o,c)}(e._query,n),new Ki(e.firestore,e.converter,lx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class iw extends rw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new iw(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new q(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new q(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ru(i,o)}(e._query,this._field,this._direction);return new Ki(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new yl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Ur(t,e="asc"){const n=e,r=Fm("orderBy",t);return iw._create(r,n)}class aw extends rw{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new aw(e,n,r)}_apply(e){return new Ki(e.firestore,e.converter,ff(e._query,this._limit,this._limitType))}}function Zo(t){return iz("limit",t),aw._create("limit",t,"F")}function HS(t,e,n){if(typeof(n=tt(n))=="string"){if(n==="")throw new q(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ZC(e)&&n.indexOf("/")!==-1)throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ke.fromString(n));if(!ne.isDocumentKey(r))throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hS(t,new ne(r))}if(n instanceof vn)return hS(t,n._key);throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rm(n)}.`)}function WS(t,e){if(!Array.isArray(t)||t.length===0)throw new q(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sR(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new q(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new q(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class gz{convertValue(e,n="none"){switch(Da(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Fa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Xa(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>pt(o.doubleValue));return new Kv(i)}convertGeoPoint(e){return new Qv(pt(e.latitude),pt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Cv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(eu(e));default:return null}}convertTimestamp(e){const n=Bi(e);return new jt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ke.fromString(e);$e(Sj(r));const s=new tu(r.get(1),r.get(3)),i=new ne(r.popFirst(5));return s.isEqual(n)||Us(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class iR extends rR{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Fm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Eh extends iR{data(e={}){return super.data(e)}}class xz{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new uc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Eh(this._firestore,this._userDataWriter,r.key,r,new uc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Eh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new uc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Eh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new uc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:yz(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function yz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(t){t=wr(t,vn);const e=wr(t.firestore,Xi);return nz(Nm(e),t._key).then(n=>Sz(e,t,n))}class aR extends gz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,n)}}function Er(t){t=wr(t,Ki);const e=wr(t.firestore,Xi),n=Nm(e),r=new aR(e);return pz(t._query),rz(n,t._query).then(s=>new xz(e,r,t,s))}function vz(t,e,n){t=wr(t,vn);const r=wr(t.firestore,Xi),s=ow(t.converter,e,n);return Hu(r,[Yv(Uu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,yn.none())])}function wz(t,e,n,...r){t=wr(t,vn);const s=wr(t.firestore,Xi),i=Uu(s);let o;return o=typeof(e=tt(e))=="string"||e instanceof _l?Zj(i,"updateDoc",t._key,e,n,r):Jj(i,"updateDoc",t._key,e),Hu(s,[o.toMutation(t._key,yn.exists(!0))])}function _z(t){return Hu(wr(t.firestore,Xi),[new km(t._key,yn.none())])}function bz(t,e){const n=wr(t.firestore,Xi),r=Rt(t),s=ow(t.converter,e);return Hu(n,[Yv(Uu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,yn.exists(!1))]).then(()=>r)}function Hu(t,e){return function(r,s){const i=new Ps;return r.asyncQueue.enqueueAndForget(async()=>WB(await tz(r),s,i)),i.promise}(Nm(t),e)}function Sz(t,e,n){const r=n.docs.get(e._key),s=new aR(t);return new iR(t,s,e._key,r,new uc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ez{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Uu(e)}set(e,n,r){this._verifyNotCommitted();const s=pg(e,this._firestore),i=ow(s.converter,n,r),o=Yv(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,yn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=pg(e,this._firestore);let o;return o=typeof(n=tt(n))=="string"||n instanceof _l?Zj(this._dataReader,"WriteBatch.update",i._key,n,r,s):Jj(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,yn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=pg(e,this._firestore);return this._mutations=this._mutations.concat(new km(n._key,yn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new q(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function pg(t,e){if((t=tt(t)).firestore!==e)throw new q(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Hs(){return new Jv("serverTimestamp")}function lu(t){return new Zv("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(t){return Nm(t=wr(t,Xi)),new Ez(t,e=>Hu(t,e))}(function(e,n=!0){(function(s){xl=s})(Ka),Aa(new Oi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Xi(new k7(r.getProvider("auth-internal")),new j7(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new q(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tu(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),is(oS,"4.7.3",e),is(oS,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR="firebasestorage.googleapis.com",lR="storageBucket",kz=2*60*1e3,Tz=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft extends xs{constructor(e,n,r=0){super(gg(e),`Firebase Storage: ${n} (${gg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ft.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return gg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ht;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ht||(ht={}));function gg(t){return"storage/"+t}function lw(){const t="An unknown error occurred, please check the error payload for server response.";return new ft(ht.UNKNOWN,t)}function Iz(t){return new ft(ht.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function Cz(t){return new ft(ht.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function jz(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ft(ht.UNAUTHENTICATED,t)}function Rz(){return new ft(ht.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Az(t){return new ft(ht.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Nz(){return new ft(ht.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Pz(){return new ft(ht.CANCELED,"User canceled the upload/download.")}function Fz(t){return new ft(ht.INVALID_URL,"Invalid URL '"+t+"'.")}function Dz(t){return new ft(ht.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Lz(){return new ft(ht.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+lR+"' property when initializing the app?")}function Mz(){return new ft(ht.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Oz(){return new ft(ht.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function $z(t){return new ft(ht.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function yx(t){return new ft(ht.INVALID_ARGUMENT,t)}function cR(){return new ft(ht.APP_DELETED,"The Firebase app was deleted.")}function Bz(t){return new ft(ht.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Tc(t,e){return new ft(ht.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Zl(t){throw new ft(ht.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=qn.makeFromUrl(e,n)}catch{return new qn(e,"")}if(r.path==="")return r;throw Dz(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(R){R.path_=decodeURIComponent(R.path)}const d="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${m}/${d}/b/${s}/o${p}`,"i"),y={bucket:1,path:3},v=n===oR?"(?:storage.googleapis.com|storage.cloud.google.com)":n,_="([^?#]*)",S=new RegExp(`^https?://${v}/${s}/${_}`,"i"),E=[{regex:l,indices:c,postModify:i},{regex:g,indices:y,postModify:u},{regex:S,indices:{bucket:1,path:2},postModify:u}];for(let R=0;R<E.length;R++){const D=E[R],F=D.regex.exec(e);if(F){const I=F[D.indices.bucket];let k=F[D.indices.path];k||(k=""),r=new qn(I,k),D.postModify(r);break}}if(r==null)throw Fz(e);return r}}class zz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(..._){u||(u=!0,e.apply(null,_))}function m(_){s=setTimeout(()=>{s=null,t(g,c())},_)}function p(){i&&clearTimeout(i)}function g(_,...S){if(u){p();return}if(_){p(),d.call(null,_,...S);return}if(c()||o){p(),d.call(null,_,...S);return}r<64&&(r*=2);let E;l===1?(l=2,E=0):E=(r+Math.random())*1e3,m(E)}let y=!1;function v(_){y||(y=!0,p(),!u&&(s!==null?(_||(l=2),clearTimeout(s),m(0)):_||(l=1)))}return m(0),i=setTimeout(()=>{o=!0,v(!0)},n),v}function Vz(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(t){return t!==void 0}function Wz(t){return typeof t=="object"&&!Array.isArray(t)}function cw(t){return typeof t=="string"||t instanceof String}function GS(t){return uw()&&t instanceof Blob}function uw(){return typeof Blob<"u"}function qS(t,e,n,r){if(r<e)throw yx(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw yx(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function uR(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Ea;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ea||(Ea={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gz(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e,n,r,s,i,o,l,c,u,d,m,p=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=m,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,y)=>{this.resolve_=g,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Od(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Ea.NO_ERROR,c=i.getStatus();if(!l||Gz(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Ea.ABORT;r(!1,new Od(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new Od(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());Hz(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=lw();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?cR():Pz();o(c)}else{const c=Nz();o(c)}};this.canceled_?n(!1,new Od(!1,null,!0)):this.backoffId_=Uz(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Vz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Od{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Qz(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Kz(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Xz(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Yz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Jz(t,e,n,r,s,i,o=!0){const l=uR(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return Xz(u,e),Qz(u,n),Kz(u,i),Yz(u,r),new qz(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function eU(...t){const e=Zz();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(uw())return new Blob(t);throw new ft(ht.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function tU(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(t){if(typeof atob>"u")throw $z("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class xg{constructor(e,n){this.data=e,this.contentType=n||null}}function rU(t,e){switch(t){case ts.RAW:return new xg(dR(e));case ts.BASE64:case ts.BASE64URL:return new xg(hR(t,e));case ts.DATA_URL:return new xg(iU(e),aU(e))}throw lw()}function dR(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function sU(t){let e;try{e=decodeURIComponent(t)}catch{throw Tc(ts.DATA_URL,"Malformed data URL.")}return dR(e)}function hR(t,e){switch(t){case ts.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Tc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case ts.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Tc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=nU(e)}catch(s){throw s.message.includes("polyfill")?s:Tc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class fR{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Tc(ts.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=oU(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function iU(t){const e=new fR(t);return e.base64?hR(ts.BASE64,e.rest):sU(e.rest)}function aU(t){return new fR(t).contentType}function oU(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,n){let r=0,s="";GS(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(GS(this.data_)){const r=this.data_,s=tU(r,e,n);return s===null?null:new xi(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new xi(r,!0)}}static getBlob(...e){if(uw()){const n=e.map(r=>r instanceof xi?r.data_:r);return new xi(eU.apply(null,n))}else{const n=e.map(o=>cw(o)?rU(ts.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new xi(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(t){let e;try{e=JSON.parse(t)}catch{return null}return Wz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lU(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function cU(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function pR(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(t,e){return e}class hn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||uU}}let $d=null;function dU(t){return!cw(t)||t.length<2?t:pR(t)}function gR(){if($d)return $d;const t=[];t.push(new hn("bucket")),t.push(new hn("generation")),t.push(new hn("metageneration")),t.push(new hn("name","fullPath",!0));function e(i,o){return dU(o)}const n=new hn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new hn("size");return s.xform=r,t.push(s),t.push(new hn("timeCreated")),t.push(new hn("updated")),t.push(new hn("md5Hash",null,!0)),t.push(new hn("cacheControl",null,!0)),t.push(new hn("contentDisposition",null,!0)),t.push(new hn("contentEncoding",null,!0)),t.push(new hn("contentLanguage",null,!0)),t.push(new hn("contentType",null,!0)),t.push(new hn("metadata","customMetadata",!0)),$d=t,$d}function hU(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new qn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function fU(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return hU(r,t),r}function xR(t,e,n){const r=mR(e);return r===null?null:fU(t,r,n)}function mU(t,e,n,r){const s=mR(e);if(s===null||!cw(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,m=t.fullPath,p="/b/"+o(d)+"/o/"+o(m),g=Lm(p,n,r),y=uR({alt:"media",token:u});return g+y})[0]}function pU(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class dw{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(t){if(!t)throw lw()}function gU(t,e){function n(r,s){const i=xR(t,s,e);return yR(i!==null),i}return n}function xU(t,e){function n(r,s){const i=xR(t,s,e);return yR(i!==null),mU(i,s,t.host,t._protocol)}return n}function vR(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=Rz():s=jz():n.getStatus()===402?s=Cz(t.bucket):n.getStatus()===403?s=Az(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function wR(t){const e=vR(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=Iz(t.path)),i.serverResponse=s.serverResponse,i}return n}function yU(t,e,n){const r=e.fullServerUrl(),s=Lm(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new dw(s,i,xU(t,n),o);return l.errorHandler=wR(e),l}function vU(t,e){const n=e.fullServerUrl(),r=Lm(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,u){}const l=new dw(r,s,o,i);return l.successCodes=[200,204],l.errorHandler=wR(e),l}function wU(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function _U(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=wU(null,e)),r}function bU(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let E="";for(let R=0;R<2;R++)E=E+Math.random().toString().slice(2);return E}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=_U(e,r,s),d=pU(u,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",g=xi.getBlob(m,r,p);if(g===null)throw Mz();const y={name:u.fullPath},v=Lm(i,t.host,t._protocol),_="POST",S=t.maxUploadRetryTime,b=new dw(v,_,gU(t,n),S);return b.urlParams=y,b.headers=o,b.body=g.uploadData(),b.errorHandler=vR(e),b}class SU{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ea.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ea.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ea.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Zl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Zl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Zl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Zl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Zl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class EU extends SU{initXhr(){this.xhr_.responseType="text"}}function hw(){return new EU}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n){this._service=e,n instanceof qn?this._location=n:this._location=qn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ma(e,n)}get root(){const e=new qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return pR(this._location.path)}get storage(){return this._service}get parent(){const e=lU(this._location.path);if(e===null)return null;const n=new qn(this._location.bucket,e);return new Ma(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Bz(e)}}function kU(t,e,n){t._throwIfRoot("uploadBytes");const r=bU(t.storage,t._location,gR(),new xi(e,!0),n);return t.storage.makeRequestWithTokens(r,hw).then(s=>({metadata:s,ref:t}))}function TU(t){t._throwIfRoot("getDownloadURL");const e=yU(t.storage,t._location,gR());return t.storage.makeRequestWithTokens(e,hw).then(n=>{if(n===null)throw Oz();return n})}function IU(t){t._throwIfRoot("deleteObject");const e=vU(t.storage,t._location);return t.storage.makeRequestWithTokens(e,hw)}function CU(t,e){const n=cU(t._location.path,e),r=new qn(t._location.bucket,n);return new Ma(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jU(t){return/^[A-Za-z]+:\/\//.test(t)}function RU(t,e){return new Ma(t,e)}function _R(t,e){if(t instanceof fw){const n=t;if(n._bucket==null)throw Lz();const r=new Ma(n,n._bucket);return e!=null?_R(r,e):r}else return e!==void 0?CU(t,e):t}function AU(t,e){if(e&&jU(e)){if(t instanceof fw)return RU(t,e);throw yx("To use ref(service, url), the first argument must be a Storage instance.")}else return _R(t,e)}function QS(t,e){const n=e==null?void 0:e[lR];return n==null?null:qn.makeFromBucketSpec(n,t)}function NU(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:YI(s,t.app.options.projectId))}class fw{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=oR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=kz,this._maxUploadRetryTime=Tz,this._requests=new Set,s!=null?this._bucket=qn.makeFromBucketSpec(s,this._host):this._bucket=QS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qn.makeFromBucketSpec(this._url,e):this._bucket=QS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ma(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new zz(cR());{const o=Jz(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const KS="@firebase/storage",XS="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR="storage";function SR(t,e,n){return t=tt(t),kU(t,e,n)}function ER(t){return t=tt(t),TU(t)}function PU(t){return t=tt(t),IU(t)}function mw(t,e){return t=tt(t),AU(t,e)}function FU(t=hv(),e){t=tt(t);const r=gm(t,bR).getImmediate({identifier:e}),s=QI("storage");return s&&DU(r,...s),r}function DU(t,e,n,r={}){NU(t,e,n,r)}function LU(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new fw(n,r,s,e,Ka)}function MU(){Aa(new Oi(bR,LU,"PUBLIC").setMultipleInstances(!0)),is(KS,XS,""),is(KS,XS,"esm2017")}MU();const pw=eC({apiKey:"AIzaSyDS7lgm2PwJBFrYE6ZHSYJfqcQw2TLC878",appId:"1:938280289868:web:e36c48cfbd55e4a8de96e",projectId:"zingmp3-clone-61799",storageBucket:"zingmp3-clone-61799.appspot.com",authDomain:"zingmp3-clone-61799.firebaseapp.com",messagingSenderId:"938280289868"}),Te=oz(pw),Oa=p7(pw),OU=new Es,gw=FU(pw),$U="/HD-MP3/assets/user-default-971f59df.png";function vx({className:t}){const[e]=Ev(Oa),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return a.jsx("div",{className:n.imageFrame,children:a.jsx(Je,{src:(e==null?void 0:e.photoURL)||$U,className:"w-full"})})}function BU({children:t,onClose:e},n){const[r,s]=f.useState(!1),[i,o]=f.useState(!1),l=()=>{i&&o(!1),r||s(!0)},c=()=>{s(!0)},u=()=>{o(!1)},d=p=>{p.preventDefault(),p.stopPropagation(),u()};f.useImperativeHandle(n,()=>({toggle:l,close:u,open:c,setModalPersist:()=>{}})),f.useEffect(()=>{i||setTimeout(()=>{s(!1),e&&e()},400)},[i]),f.useEffect(()=>{r&&setTimeout(()=>{o(!0)},100)},[r]);const m={unMountedContent:"translate-y-full ",mountedContent:"translate-y-0",unMountedLayer:"opacity-0",mountedLayer:"opacity-20"};return a.jsx(a.Fragment,{children:r&&Ga.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:d,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${i?m.mountedLayer:m.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute bottom-0 left-0 right-0 duration-300 transition-[transform,opacity] z-[99]
                            ${i?m.mountedContent:m.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}const wx=f.forwardRef(BU),xw="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",yw=({data:t,variant:e="link",active:n,link:r})=>{const s=a.jsxs(ju,{children:[a.jsx(Je,{className:`hover:scale-[1.05] transition-transform object-cover ${n?"brightness-[90%]":""}`,src:t.image_url,blurHashEncode:t.blurhash_encode}),n&&a.jsx(qt,{children:a.jsx("img",{src:xw,alt:"",className:"w-[30px]"})})]});return(()=>{switch(e){case"link":return a.jsxs(a.Fragment,{children:[a.jsx(we,{to:`${r||"/playlist/"+t.id}`,className:"",children:s}),a.jsx("p",{className:"text-lg font-[500] leading-[1.3] line-clamp-1 mt-1.5",children:t.name}),a.jsx("p",{className:"text-sm opacity-[.7] leading-[1.3] line-clamp-1",children:t.is_album?t.singers[0].name:t.distributor})]});case"image":return s}})()};function kR({openModal:t,variant:e}){const{theme:n}=G(),r=o=>{t(o)},s={menuItem:"hover:bg-[#fff]/5 rounded-md text-sm font-[500] px-2 py-2 inline-flex items-center cursor-pointer",icon:"w-5 mr-2",divide:"h-[1px]  w-[calc(100%-20px)] my-[4px] mx-auto bg-[#fff]/5"},i=()=>{switch(e){case"client":return a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[a.jsx(O0,{className:s.icon}),"Themes"]}),a.jsx("div",{className:s.divide}),a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[a.jsx(M0,{className:s.icon}),"Info"]})]});case"dashboard":return a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[a.jsx(O0,{className:s.icon}),"Themes"]}),a.jsx("div",{className:s.divide}),a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[a.jsx(M0,{className:s.icon}),"Info"]})]})}};return a.jsx(a.Fragment,{children:a.jsx(mm,{theme:n,children:a.jsx("ul",{className:"flex flex-col w-[200px]",children:i()})})})}const zU=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},o)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return a.jsxs("div",{ref:o,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[a.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:a.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[a.jsx(Je,{src:t.image_url,blurHashEncode:t.blurhash_encode}),a.jsx("div",{className:`${l.overlay}`,children:!e&&a.jsx(ae,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:a.jsx(Xy,{className:"w-10"})})}),e&&a.jsx("div",{className:l.playingGifFrame,children:a.jsx("img",{src:xw,alt:""})})]})}),r&&a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),a.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:t.singers.map((c,u)=>a.jsx("span",{children:c.name},u))})]})]})},yg=f.forwardRef(zU);var TR={exports:{}},IR={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wu=f;function UU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var VU=typeof Object.is=="function"?Object.is:UU,HU=Wu.useSyncExternalStore,WU=Wu.useRef,GU=Wu.useEffect,qU=Wu.useMemo,QU=Wu.useDebugValue;IR.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=WU(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=qU(function(){function c(g){if(!u){if(u=!0,d=g,g=r(g),s!==void 0&&o.hasValue){var y=o.value;if(s(y,g))return m=y}return m=g}if(y=m,VU(d,g))return y;var v=r(g);return s!==void 0&&s(y,v)?(d=g,y):(d=g,m=v)}var u=!1,d,m,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,r,s]);var l=HU(t,i[0],i[1]);return GU(function(){o.hasValue=!0,o.value=l},[l]),QU(l),l};TR.exports=IR;var KU=TR.exports;function XU(t){t()}function YU(){let t=null,e=null;return{clear(){t=null,e=null},notify(){XU(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var YS={notify(){},get:()=>[]};function JU(t,e){let n,r=YS,s=0,i=!1;function o(v){d();const _=r.subscribe(v);let S=!1;return()=>{S||(S=!0,_(),m())}}function l(){r.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return i}function d(){s++,n||(n=e?e.addNestedSub(c):t.subscribe(c),r=YU())}function m(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=YS)}function p(){i||(i=!0,d())}function g(){i&&(i=!1,m())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:g,getListeners:()=>r};return y}var ZU=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eV=ZU(),tV=()=>typeof navigator<"u"&&navigator.product==="ReactNative",nV=tV(),rV=()=>eV||nV?f.useLayoutEffect:f.useEffect,sV=rV(),vg=Symbol.for("react-redux-context"),wg=typeof globalThis<"u"?globalThis:{};function iV(){if(!f.createContext)return{};const t=wg[vg]??(wg[vg]=new Map);let e=t.get(f.createContext);return e||(e=f.createContext(null),t.set(f.createContext,e)),e}var Ui=iV();function aV(t){const{children:e,context:n,serverState:r,store:s}=t,i=f.useMemo(()=>{const c=JU(s);return{store:s,subscription:c,getServerState:r?()=>r:void 0}},[s,r]),o=f.useMemo(()=>s.getState(),[s]);sV(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=n||Ui;return f.createElement(l.Provider,{value:i},e)}var oV=aV;function vw(t=Ui){return function(){return f.useContext(t)}}var CR=vw();function jR(t=Ui){const e=t===Ui?CR:vw(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var lV=jR();function cV(t=Ui){const e=t===Ui?lV:jR(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var Kt=cV(),uV=(t,e)=>t===e;function dV(t=Ui){const e=t===Ui?CR:vw(t),n=(r,s={})=>{const{equalityFn:i=uV}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:l,subscription:c,getServerState:u}=o;f.useRef(!0);const d=f.useCallback({[r.name](p){return r(p)}}[r.name],[r]),m=KU.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,d,i);return f.useDebugValue(m),m};return Object.assign(n,{withTypes:()=>n}),n}var re=dV();function Ot(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var hV=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),JS=hV,_g=()=>Math.random().toString(36).substring(7).split("").join("."),fV={INIT:`@@redux/INIT${_g()}`,REPLACE:`@@redux/REPLACE${_g()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${_g()}`},yf=fV;function ww(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function RR(t,e,n){if(typeof t!="function")throw new Error(Ot(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Ot(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Ot(1));return n(RR)(t,e)}let r=t,s=e,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((_,S)=>{o.set(S,_)}))}function d(){if(c)throw new Error(Ot(3));return s}function m(_){if(typeof _!="function")throw new Error(Ot(4));if(c)throw new Error(Ot(5));let S=!0;u();const b=l++;return o.set(b,_),function(){if(S){if(c)throw new Error(Ot(6));S=!1,u(),o.delete(b),i=null}}}function p(_){if(!ww(_))throw new Error(Ot(7));if(typeof _.type>"u")throw new Error(Ot(8));if(typeof _.type!="string")throw new Error(Ot(17));if(c)throw new Error(Ot(9));try{c=!0,s=r(s,_)}finally{c=!1}return(i=o).forEach(b=>{b()}),_}function g(_){if(typeof _!="function")throw new Error(Ot(10));r=_,p({type:yf.REPLACE})}function y(){const _=m;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(Ot(11));function b(){const R=S;R.next&&R.next(d())}return b(),{unsubscribe:_(b)}},[JS](){return this}}}return p({type:yf.INIT}),{dispatch:p,subscribe:m,getState:d,replaceReducer:g,[JS]:y}}function mV(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:yf.INIT})>"u")throw new Error(Ot(12));if(typeof n(void 0,{type:yf.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ot(13))})}function pV(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{mV(n)}catch(i){s=i}return function(o={},l){if(s)throw s;let c=!1;const u={};for(let d=0;d<r.length;d++){const m=r[d],p=n[m],g=o[m],y=p(g,l);if(typeof y>"u")throw l&&l.type,new Error(Ot(14));u[m]=y,c=c||y!==g}return c=c||r.length!==Object.keys(o).length,c?u:o}}function vf(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function gV(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Ot(15))};const o={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(o));return i=vf(...l)(s.dispatch),{...s,dispatch:i}}}function xV(t){return ww(t)&&"type"in t&&typeof t.type=="string"}var AR=Symbol.for("immer-nothing"),ZS=Symbol.for("immer-draftable"),er=Symbol.for("immer-state");function Nr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var el=Object.getPrototypeOf;function $a(t){return!!t&&!!t[er]}function Ws(t){var e;return t?NR(t)||Array.isArray(t)||!!t[ZS]||!!((e=t.constructor)!=null&&e[ZS])||Om(t)||$m(t):!1}var yV=Object.prototype.constructor.toString();function NR(t){if(!t||typeof t!="object")return!1;const e=el(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===yV}function wf(t,e){Mm(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function Mm(t){const e=t[er];return e?e.type_:Array.isArray(t)?1:Om(t)?2:$m(t)?3:0}function _x(t,e){return Mm(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function PR(t,e,n){const r=Mm(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function vV(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Om(t){return t instanceof Map}function $m(t){return t instanceof Set}function da(t){return t.copy_||t.base_}function bx(t,e){if(Om(t))return new Map(t);if($m(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=NR(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[er];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],l=r[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(el(t),r)}else{const r=el(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function _w(t,e=!1){return Bm(t)||$a(t)||!Ws(t)||(Mm(t)>1&&(t.set=t.add=t.clear=t.delete=wV),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>_w(r,!0))),t}function wV(){Nr(2)}function Bm(t){return Object.isFrozen(t)}var _V={};function Ba(t){const e=_V[t];return e||Nr(0,t),e}var cu;function FR(){return cu}function bV(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function e2(t,e){e&&(Ba("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Sx(t){Ex(t),t.drafts_.forEach(SV),t.drafts_=null}function Ex(t){t===cu&&(cu=t.parent_)}function t2(t){return cu=bV(cu,t)}function SV(t){const e=t[er];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function n2(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[er].modified_&&(Sx(e),Nr(4)),Ws(t)&&(t=_f(e,t),e.parent_||bf(e,t)),e.patches_&&Ba("Patches").generateReplacementPatches_(n[er].base_,t,e.patches_,e.inversePatches_)):t=_f(e,n,[]),Sx(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==AR?t:void 0}function _f(t,e,n){if(Bm(e))return e;const r=e[er];if(!r)return wf(e,(s,i)=>r2(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return bf(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),wf(i,(l,c)=>r2(t,r,s,l,c,n,o)),bf(t,s,!1),n&&t.patches_&&Ba("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function r2(t,e,n,r,s,i,o){if($a(s)){const l=i&&e&&e.type_!==3&&!_x(e.assigned_,r)?i.concat(r):void 0,c=_f(t,s,l);if(PR(n,r,c),$a(c))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(Ws(s)&&!Bm(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;_f(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&bf(t,s)}}function bf(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&_w(e,n)}function EV(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:FR(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=bw;n&&(s=[r],i=uu);const{revoke:o,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=o,l}var bw={get(t,e){if(e===er)return t;const n=da(t);if(!_x(n,e))return kV(t,n,e);const r=n[e];return t.finalized_||!Ws(r)?r:r===bg(t.base_,e)?(Sg(t),t.copy_[e]=Tx(r,t)):r},has(t,e){return e in da(t)},ownKeys(t){return Reflect.ownKeys(da(t))},set(t,e,n){const r=DR(da(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=bg(da(t),e),i=s==null?void 0:s[er];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(vV(n,s)&&(n!==void 0||_x(t.base_,e)))return!0;Sg(t),kx(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return bg(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Sg(t),kx(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=da(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Nr(11)},getPrototypeOf(t){return el(t.base_)},setPrototypeOf(){Nr(12)}},uu={};wf(bw,(t,e)=>{uu[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});uu.deleteProperty=function(t,e){return uu.set.call(this,t,e,void 0)};uu.set=function(t,e,n){return bw.set.call(this,t[0],e,n,t[0])};function bg(t,e){const n=t[er];return(n?da(n):t)[e]}function kV(t,e,n){var s;const r=DR(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function DR(t,e){if(!(e in t))return;let n=el(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=el(n)}}function kx(t){t.modified_||(t.modified_=!0,t.parent_&&kx(t.parent_))}function Sg(t){t.copy_||(t.copy_=bx(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var TV=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(c=i,...u){return o.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&Nr(6),r!==void 0&&typeof r!="function"&&Nr(7);let s;if(Ws(e)){const i=t2(this),o=Tx(e,void 0);let l=!0;try{s=n(o),l=!1}finally{l?Sx(i):Ex(i)}return e2(i,r),n2(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===AR&&(s=void 0),this.autoFreeze_&&_w(s,!0),r){const i=[],o=[];Ba("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else Nr(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let r,s;return[this.produce(e,n,(o,l)=>{r=o,s=l}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Ws(t)||Nr(8),$a(t)&&(t=IV(t));const e=t2(this),n=Tx(t,void 0);return n[er].isManual_=!0,Ex(e),n}finishDraft(t,e){const n=t&&t[er];(!n||!n.isManual_)&&Nr(9);const{scope_:r}=n;return e2(r,e),n2(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=Ba("Patches").applyPatches_;return $a(t)?r(t,e):this.produce(t,s=>r(s,e))}};function Tx(t,e){const n=Om(t)?Ba("MapSet").proxyMap_(t,e):$m(t)?Ba("MapSet").proxySet_(t,e):EV(t,e);return(e?e.scope_:FR()).drafts_.push(n),n}function IV(t){return $a(t)||Nr(10,t),LR(t)}function LR(t){if(!Ws(t)||Bm(t))return t;const e=t[er];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=bx(t,e.scope_.immer_.useStrictShallowCopy_)}else n=bx(t,!0);return wf(n,(r,s)=>{PR(n,r,LR(s))}),e&&(e.finalized_=!1),n}var tr=new TV,MR=tr.produce;tr.produceWithPatches.bind(tr);tr.setAutoFreeze.bind(tr);tr.setUseStrictShallowCopy.bind(tr);tr.applyPatches.bind(tr);tr.createDraft.bind(tr);tr.finishDraft.bind(tr);function OR(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var CV=OR(),jV=OR,RV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?vf:vf.apply(null,arguments)};function s2(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Fs(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>xV(r)&&r.type===t,n}var $R=class dc extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,dc.prototype)}static get[Symbol.species](){return dc}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new dc(...e[0].concat(this)):new dc(...e.concat(this))}};function i2(t){return Ws(t)?MR(t,()=>{}):t}function a2(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function AV(t){return typeof t=="boolean"}var NV=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new $R;return n&&(AV(n)?o.push(CV):o.push(jV(n.extraArgument))),o},PV="RTK_autoBatch",o2=t=>e=>{setTimeout(e,t)},FV=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:o2(10):t.type==="callback"?t.queueNotification:o2(t.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},r,{subscribe(d){const m=()=>s&&d(),p=r.subscribe(m);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var m;try{return s=!((m=d==null?void 0:d.meta)!=null&&m[PV]),i=!s,i&&(o||(o=!0,c(u))),r.dispatch(d)}finally{s=!0}}})},DV=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new $R(t);return r&&s.push(FV(typeof r=="object"?r:void 0)),s};function LV(t){const e=NV(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(ww(n))l=pV(n);else throw new Error(Fs(1));let c;typeof r=="function"?c=r(e):c=e();let u=vf;s&&(u=RV({trace:!1,...typeof s=="object"&&s}));const d=gV(...c),m=DV(d);let p=typeof o=="function"?o(m):m();const g=u(...p);return RR(l,i,g)}function BR(t){const e={},n=[];let r;const s={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Fs(28));if(l in e)throw new Error(Fs(29));return e[l]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function MV(t){return typeof t=="function"}function OV(t,e){let[n,r,s]=BR(e),i;if(MV(t))i=()=>i2(t());else{const l=i2(t);i=()=>l}function o(l=i(),c){let u=[n[c.type],...r.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,m)=>{if(m)if($a(d)){const g=m(d,c);return g===void 0?d:g}else{if(Ws(d))return MR(d,p=>m(p,c));{const p=m(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=i,o}var $V=Symbol.for("rtk-slice-createasyncthunk");function BV(t,e){return`${t}/${e}`}function zV({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[$V];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Fs(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(VV()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(E,R){const D=typeof E=="string"?E:E.type;if(!D)throw new Error(Fs(12));if(D in u.sliceCaseReducersByType)throw new Error(Fs(13));return u.sliceCaseReducersByType[D]=R,d},addMatcher(E,R){return u.sliceMatchers.push({matcher:E,reducer:R}),d},exposeAction(E,R){return u.actionCreators[E]=R,d},exposeCaseReducer(E,R){return u.sliceCaseReducersByName[E]=R,d}};c.forEach(E=>{const R=l[E],D={reducerName:E,type:BV(i,E),createNotation:typeof s.reducers=="function"};WV(R)?qV(D,R,d,e):HV(D,R,d)});function m(){const[E={},R=[],D=void 0]=typeof s.extraReducers=="function"?BR(s.extraReducers):[s.extraReducers],F={...E,...u.sliceCaseReducersByType};return OV(s.initialState,I=>{for(let k in F)I.addCase(k,F[k]);for(let k of u.sliceMatchers)I.addMatcher(k.matcher,k.reducer);for(let k of R)I.addMatcher(k.matcher,k.reducer);D&&I.addDefaultCase(D)})}const p=E=>E,g=new Map;let y;function v(E,R){return y||(y=m()),y(E,R)}function _(){return y||(y=m()),y.getInitialState()}function S(E,R=!1){function D(I){let k=I[E];return typeof k>"u"&&R&&(k=_()),k}function F(I=p){const k=a2(g,R,()=>new WeakMap);return a2(k,I,()=>{const j={};for(const[C,N]of Object.entries(s.selectors??{}))j[C]=UV(N,I,_,R);return j})}return{reducerPath:E,getSelectors:F,get selectors(){return F(D)},selectSlice:D}}const b={name:i,reducer:v,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:_,...S(o),injectInto(E,{reducerPath:R,...D}={}){const F=R??o;return E.inject({reducerPath:F,reducer:v},D),{...b,...S(F,!0)}}};return b}}function UV(t,e,n,r){function s(i,...o){let l=e(i);return typeof l>"u"&&r&&(l=n()),t(l,...o)}return s.unwrapped=t,s}var Sw=zV();function VV(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function HV({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!GV(r))throw new Error(Fs(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?s2(t,o):s2(t))}function WV(t){return t._reducerDefinitionType==="asyncThunk"}function GV(t){return t._reducerDefinitionType==="reducerWithPrepare"}function qV({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Fs(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=n,m=s(t,i,d);r.exposeAction(e,m),o&&r.addCase(m.fulfilled,o),l&&r.addCase(m.pending,l),c&&r.addCase(m.rejected,c),u&&r.addMatcher(m.settled,u),r.exposeCaseReducer(e,{fulfilled:o||Bd,pending:l||Bd,rejected:c||Bd,settled:u||Bd})}function Bd(){}function Fs(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const l2={queueSongs:gn().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function Eg(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const zR=Sw({name:"songQueue",initialState:l2,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,Eg(t),rt("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,Eg(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),rt("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&Eg(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),rt("queue",t.queueSongs)},resetSongQueue:t=>{rt("queue",[]),Object.assign(t,l2)}}}),ze=t=>t.songQueue,{addSongToQueue:zm,setCurrentQueueId:hs,removeSongFromQueue:QV,setQueue:KV,resetSongQueue:XV,setIsFetchingRecommend:c2}=zR.actions,YV=zR.reducer;function bl({className:t="",playlists:e,loading:n}){const{currentSongData:r}=re(ze),s=()=>e.length?e.map((i,o)=>{const l=r==null?void 0:r.song.queue_id.includes(i.id);return a.jsx("div",{className:"p-2 w-1/2 sm:w-1/3 md:w-1/4",children:a.jsx(yw,{active:l,data:i})},o)}):a.jsx(Ye,{className:"mx-auto"});return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex flex-row flex-wrap -mx-[8px] ${t}`,children:[n&&lv,!n&&s()]})})}function UR(){const{theme:t}=G(),{playerConig:{isCrossFade:e,isEnableBeat:n,lyricSize:r,songBackground:s},updatePlayerConfig:i,audioRef:o,shouldSyncSongDuration:l}=dt(),{currentSongData:c}=re(ze),u=p=>{i({lyricSize:p}),rt("lyricSize",p)},d=()=>{if(!o.current||!(c!=null&&c.song))return;const p=!n,g=o.current.currentTime;rt("current_time",g),l.current=!0,o.current.src=p?c.song.beat_url:c.song.song_url,i({isEnableBeat:p})},m={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:`group/text justify-center !hover:brightness-100 font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative ${t.content_hover_bg}`,itemContainer:"flex justify-between  px-3 py-2 items-center min-h-[30px] hover:bg-[#fff]/5",text:"text-sm"};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"w-[240px] sm:w-[220px]",children:a.jsxs(mm,{p:"clear",className:"text-white py-3",theme:t,children:[a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Lyric size"}),a.jsxs("div",{className:"flex space-x-[8px]",children:[a.jsx(ae,{onClick:()=>u("small"),variant:"circle",size:"clear",className:`${r==="small"?t.content_bg:m.disableBtn} ${m.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),a.jsx(ae,{onClick:()=>u("medium"),variant:"circle",size:"clear",className:`${r==="medium"?t.content_bg:m.disableBtn} ${m.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),a.jsx(ae,{onClick:()=>u("large"),variant:"circle",size:"clear",className:`${r==="large"?t.content_bg:m.disableBtn} ${m.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Song background"}),a.jsx(ph,{size:"thin",active:s,cb:()=>i({songBackground:!s})})]}),(c==null?void 0:c.song.beat_url)&&a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Song beat"}),a.jsx(ph,{size:"thin",active:n,cb:d})]}),a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Cross fade"}),a.jsx(ph,{size:"thin",active:e,cb:()=>i({isCrossFade:!e})})]})]})})})}function JV({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,isWrapped:s,...i},o){const[l,c]=f.useState(!1),{theme:u}=G(),{setTriggerRef:d,state:m}=Iu(),{onClick:p}=i,g=f.useRef(null),y=()=>{"ontouchstart"in document.documentElement||c(!0)},v=()=>{c(!1)};f.useEffect(()=>{const b=g.current;if(b)return d&&d(b),b.addEventListener("mouseenter",y),b.addEventListener("mouseleave",v),()=>{b.removeEventListener("mouseenter",y),b.removeEventListener("mouseleave",v)}},[]);const _={container:`${u.modal_bg} text-white`},S=a.jsx(a.Fragment,{children:f.isValidElement(t)&&a.jsxs(a.Fragment,{children:[Object.keys(i).length?f.cloneElement(t,{ref:g,onClick:p}):f.cloneElement(t,{ref:g}),!(m!=null&&m.isOpen)&&l&&a.jsx("div",{className:`${_.container} absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md z-[999] ${n} ${e}`,children:r})]})});if(f.isValidElement(t))return a.jsx(a.Fragment,{children:s?S:a.jsx("div",{className:"relative",children:S})})}const Ds=f.forwardRef(JV);function Ew(){const{setSuccessToast:t}=de(),e=()=>{navigator.clipboard.writeText(location.href),t("Link copied")};return a.jsxs("button",{onClick:e,children:[a.jsx(UF,{}),a.jsx("span",{children:"Copy link"})]})}function Ix(t){return a.jsxs("div",{className:"w-1/3 md:w-1/5 px-2",children:[t.variant==="skeleton"&&a.jsxs(a.Fragment,{children:[a.jsx(ce,{className:"pt-[100%] rounded-full"}),a.jsx(ce,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&a.jsxs(a.Fragment,{children:[a.jsx(we,{to:`/singer/${t.singer.id}`,children:a.jsx(ju,{className:"!rounded-full",children:a.jsx(Je,{blurHashEncode:t.singer.blurhash_encode,src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),a.jsx("p",{className:"mt-1 text-center text-lg",children:t.singer.name})]})]})}const kw=(t,e,n="rgba(255,255,255,.15)")=>`linear-gradient(to right, ${t} ${e}%, ${n} ${e}%, ${n}`;function Um({audioEle:t,baseColor:e,color:n,setStatusFromParent:r,statusFromParent:s,statusRefFromParent:i}){const{theme:o}=G(),[l,c]=f.useState("paused"),[u,d]=f.useState(!1),m=s||l,p=r||c,g=f.useRef(""),y=f.useRef(m),v=f.useRef(null),_=f.useRef(null),S=f.useRef(null),b=i||y,E=()=>{try{t.play(),d(!0)}catch{}},R=()=>{t==null||t.pause(),I()},D=()=>{m==="playing"?R():m==="paused"&&E()},F=()=>{p("playing")},I=()=>{p("paused")},k=()=>{p("paused"),S.current&&(S.current.innerText=Br(t.duration))},j=te=>{if(!t)return;const Se=+(te||t.currentTime/t.duration*100).toFixed(1);_.current&&(_.current.innerText=Br(t.currentTime)),v!=null&&v.current&&(v.current.style.background=kw(n||g.current,Se,e))},C=()=>{const Se=t.currentTime/(t.duration/100);j(+Se.toFixed(1))},N=()=>{console.log("error"),p("error")},P=te=>{const Se=te.target;if(v!=null&&v.current){const H=Se.getBoundingClientRect(),ee=(te.clientX-H.left)/v.current.offsetWidth,ve=Math.round(ee*t.duration);A(ve)}},A=te=>{t.currentTime=te,j(),m!=="playing"&&E()},Z=te=>{t.currentTime=t.currentTime+te},he=te=>{t.currentTime=t.currentTime-te};return f.useEffect(()=>{if(t)return t.addEventListener("error",N),t.addEventListener("pause",I),t.addEventListener("playing",F),t.addEventListener("loadedmetadata",k),v!=null&&v.current&&(v==null||v.current.addEventListener("click",P),t.addEventListener("timeupdate",C)),()=>{t.removeEventListener("error",N),t.removeEventListener("pause",I),t.removeEventListener("playing",F),t.removeEventListener("loadedmetadata",k),v!=null&&v.current&&(t.removeEventListener("timeupdate",C),v==null||v.current.removeEventListener("click",P))}},[t]),f.useEffect(()=>{g.current=o.content_code,m!=="playing"&&j()},[o]),f.useEffect(()=>{b.current=m},[m]),{play:E,pause:R,seek:A,handlePlayPause:D,status:m,forward:Z,backward:he,isClickPlay:u,statusRef:y,progressLineRef:v,currentTimeRef:_,durationRef:S}}const ZV=()=>({playStatus:"paused",isLoaded:!0,countDown:0}),VR=Sw({name:"playStatus",initialState:()=>ZV(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)}}}),In=t=>t.playStatus,{setPlayStatus:Bt}=VR.actions,eH=VR.reducer;function Js({variant:t}){const e=Kt(),{currentQueueId:n,queueSongs:r,currentSongData:s}=re(ze),i=f.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(hs(l)),e(Bt({playStatus:"loading"}));const u=r.map(m=>m[i]);if(!r.length||r.length!==c.length||!!c.find(m=>!u.includes(m[i])))return console.log("set queue"),e(KV({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function HR(t,e){const[n,r]=f.useState(t);return f.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const Tw={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function u2(t,e){const n=f.useRef(),[r,s]=f.useState(0),[i,o]=f.useState(0);return f.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,Tw]),f.useEffect(()=>{n.current||(t(),o(Math.random()*10))},[r]),()=>s(Math.random()*10)}const tH=!1,bn=_r(Te,"Songs"),br=_r(Te,"Playlists"),Sf=_r(Te,"Singers"),nH=_r(Te,"Users");_r(Te,"Lyrics");const Gu=_r(Te,"Comments"),Iw=async({collectionName:t,id:e,msg:n})=>{await _z(Rt(Te,t,e))},Vr=async({collectionName:t,id:e,msg:n})=>La(Rt(Te,t,e)),Gs=async({collectionName:t,data:e,msg:n})=>await bz(_r(Te,t),e),Et=async({collectionName:t,id:e,data:n,msg:r})=>await wz(Rt(Te,t,e),n),Cw=async({file:t,folder:e,namePrefix:n,msg:r})=>{const s=n.replace("@gmail.com","")+"_"+t.name.replaceAll(" ","").toLowerCase(),i=mw(gw,`${e+s}`),o=await SR(i,t);return{fileURL:await ER(o.ref),filePath:o.metadata.fullPath}},rH=async({blob:t,folder:e,msg:n})=>{const r=Date.now()+".jpg",s=mw(gw,`${e+r}`),i=await SR(s,t);return{fileURL:await ER(i.ref),filePath:i.metadata.fullPath}},Yn=async({filePath:t,msg:e})=>{try{const n=mw(gw,t);await PU(n)}catch(n){console.log({error:n})}},WR=async t=>{await Yn({filePath:t.song_file_path,msg:">>> api: delete song file"}),t.beat_file_path&&await Yn({filePath:t.beat_file_path,msg:">>> api: delete song's image file"}),t.image_file_path&&await Yn({filePath:t.image_file_path,msg:">>> api: delete song's image file"})},sH="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let qu=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=sH[n[t]&63];return e};const kg={currentPlaylist:null,playlistSongs:[]},GR=Sw({name:"currentPlaylist",initialState:kg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:qu(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=kg.currentPlaylist,t.playlistSongs=kg.playlistSongs}}}),Zs=t=>t.currentPlaylist,{addSongsToPlaylist:qJ,removeSong:QJ,setCurrentPlaylist:iH,updateCurrentPlaylist:aH,resetCurrentPlaylist:oH,setPlaylistSong:lH}=GR.actions,cH=GR.reducer;function uH(){const t=Kt(),{setErrorToast:e}=de(),{user:n,loading:r}=ge(),s=Gi(),[i,o]=f.useState(!0),l=async()=>{if(!s.id)return;const d=await Vr({collectionName:"Playlists",id:s.id,msg:">>> api get playlist"});if(d.exists())return{...d.data(),id:d.id}},c=async d=>{if(!d.song_ids.length)return[];const m=pe(bn,Q(Ys(),"in",d.song_ids)),p=await Er(m);return p.docs.length?p.docs.map(y=>({id:y.id,...y.data(),queue_id:`${qu(4)}_${d.id}}`})):[]},u=async()=>{try{if(!s.id)return;o(!0);const d=await l();if(!d||!(n?d.owner_email===n.email&&!d.is_official:!1)&&!d.is_public)return;const p=await c(d);t(iH({playlist:d,songs:p}))}catch(d){console.log({message:d}),e()}finally{o(!1)}};return f.useEffect(()=>{if(!r)return u(),()=>{t(oH())}},[r]),{isFetching:i}}function qR({setLoadingFromParent:t}){const[e,n]=f.useState(!1),r=t||n;return{getLyric:async i=>{try{r(!0);const o=await Vr({collectionName:"Lyrics",id:i.lyric_id,msg:"useGetLyric, get lyric"});if(o.exists())return o.data()}catch(o){console.log({message:o})}finally{r(!1)}},loading:e}}function QR(){const t=Kt(),{setSuccessToast:e}=de();return{action:r=>{switch(r.variant){case"add":t(zm({songs:r.songs})),e("Song added to queue");break;case"remove":t(QV({index:r.index}))}}}}const dH=async t=>{const e=Date.now(),n=await wI.post("/api/image/encode",t);let r="";n&&(r=n.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},hH=async t=>{const e=new FormData;e.append("file",t);const n=Date.now(),r=await wI.post("/api/image/optimize",e,{responseType:"blob"});let s;r&&(s=r.data);const i=(Date.now()-n)/1e3;return console.log(">>> api: optimize finished after",i),s};async function Sn(t,e){const n=await Er(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:qu(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function Hr(t){const e=await Er(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function Ef(t){const e=await Er(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function fH(t){const e=await Er(t);return e.docs.length?e.docs.map(r=>r.data()):[]}const Yi=async({imageFile:t,blob:e})=>{let n=e;if(t&&(n=await hH(t)),!n)throw new Error("File not found");const r=rH({blob:n,folder:"/images/"}),{encode:s}=await dH(n),{filePath:i,fileURL:o}=await r;return{image_file_path:i,image_url:o,blurhash_encode:s}};function KR(){const{setPlaylists:t}=Tn(),{setErrorToast:e,setSuccessToast:n}=de(),[r,s]=f.useState(!1);return{isFetching:r,handleAddPlaylist:async(o,l,c)=>{try{if(s(!0),l){const g=await Yi({imageFile:l});Object.assign(o,g)}const u=await Gs({collectionName:"Playlists",data:o}),d=await La(u),m={...d.data(),id:d.id},{push:p=!0}=c||{};return p&&t(g=>[m,...g]),n("Playlist created"),m}catch(u){console.log(u),e()}finally{s(!1)}}}}function Vm(){const[t,e]=f.useState(!0),{setErrorToast:n}=de();return{fetchComment:async({target_id:s,comment_id:i})=>{try{e(!0);let o=pe(Gu);s&&(o=pe(o,Q("target_id","==",s),Q("comment_id","==",""),Ur("updated_at","desc"))),i&&(o=pe(o,Q("comment_id","==",i),Ur("created_at","asc")));const l=await Er(o);if(l.docs.length)return l.docs.map(u=>({...u.data(),id:u.id,replies:[]}))}catch{n()}finally{e(!1)}},isFetching:t}}function mH({audioEle:t}){const e=sr(),n=f.useMemo(()=>e.pathname.includes("lyric")||e.pathname==="/",[e]);return f.useEffect(()=>{n&&t.pause()},[e]),{shouldHide:n}}function XR({isOpenLyricTabs:t,children:e}){const{currentSongData:n}=re(ze),{playStatus:r}=re(In),{setLoading:s,shouldGetLyric:i,setSongLyrics:o}=rv(),l=f.useRef(),{getLyric:c}=qR({setLoadingFromParent:s}),u=async()=>{if(n!=null&&n.song){const m=await c(n.song);m&&o(JSON.parse(m==null?void 0:m.lyrics))}},d=()=>{clearTimeout(l.current),i.current=!0,s(!0),o([])};return f.useEffect(()=>{if(t&&i.current){if(i.current=!1,r==="error"){s(!1);return}l.current=setTimeout(u,500)}},[t,n==null?void 0:n.song.id,r]),f.useEffect(()=>()=>{d()},[n==null?void 0:n.song.id]),e}const YR=["Newest","Popular"],pH=()=>YR.reduce((t,e)=>{const n={playlists:[],shouldFetching:!0};return{...t,[e]:n}},{});function gH(){const[t,e]=f.useState(pH),{setErrorToast:n}=de(),[r,s]=f.useState("Newest"),[i,o]=f.useState(!0),l=async()=>{try{const c={...t[r]};if(o(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=pe(br,Q("is_official","==",!0),Q("is_public","==",!0),Ur("updated_at","desc"),Zo(20));break;case"Popular":u=pe(br,Q("is_official","==",!0),Q("is_public","==",!0),Ur("like","desc"),Zo(20));break}if(u){const d=await Hr(u);c.playlists=d,e(m=>({...m,[r]:c}))}}else await cs(100)}catch(c){console.log({message:c}),n()}finally{o(!1)}};return f.useEffect(()=>(l(),()=>{o(!0)}),[r]),{isFetching:i,playlistMap:t,getPlaylist:l,tabs:YR,tab:r,setTab:s}}function xH(){const{getPlaylist:t,isFetching:e,playlistMap:n,...r}=gH();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ae,{title:"Playlist"}),a.jsx("div",{className:"flex space-x-2 my-2",children:a.jsx(gs,{render:s=>s,...r})}),a.jsx(bl,{loading:e,playlists:n[r.tab].playlists})]})})}const JR=["Newest","Popular"],yH=()=>JR.reduce((t,e)=>{const n={songs:[],shouldFetching:!0};return{...t,[e]:n}},{});function vH(){const[t,e]=f.useState(yH),{setErrorToast:n}=de(),[r,s]=f.useState("Newest"),[i,o]=f.useState(!0),l=async()=>{try{const c={...t[r]};if(o(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=pe(bn,Q("is_official","==",!0),Ur("updated_at","desc"),Zo(20));break;case"Popular":u=pe(bn,Q("is_official","==",!0),Ur("like","desc"),Zo(20));break}if(u){const d=await Sn(u);c.songs=d,e(m=>({...m,[r]:c}))}}else await cs(100)}catch(c){console.log({message:c}),n()}finally{o(!1)}};return f.useEffect(()=>(l(),()=>{o(!0)}),[r]),{isFetching:i,songMap:t,tabs:JR,tab:r,setTab:s}}function wH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const _H=f.forwardRef(wH),bH=_H;function SH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const EH=f.forwardRef(SH),kH=EH;function TH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const IH=f.forwardRef(TH),CH=IH;function jH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const RH=f.forwardRef(jH),AH=RH;function NH(){const{playlists:t,setPlaylists:e}=Tn(),{setErrorToast:n,setSuccessToast:r}=de(),[s,i]=f.useState(!1);return{isFetching:s,addToPlaylist:async({songs:l,playlist:c})=>{try{i(!0);const u=[...c.song_ids];if(l.forEach(v=>{u.includes(v.id)||u.push(v.id)}),u.length===c.song_ids.length){await cs(300),r("Song added");return}const m={song_ids:u},p={...c,...m};await Et({collectionName:"Playlists",id:c.id,data:m});const g=[...t],y=g.findIndex(v=>v.id===c.id);y!==-1&&(g[y]=p,e(g)),r("Song added")}catch(u){console.log({message:u}),n()}finally{i(!1)}}}}const Cx=t=>({name:"",image_url:"",song_url:"",beat_url:"",beat_file_path:"",duration:0,like:0,lyric_id:"",image_file_path:"",song_file_path:"",blurhash_encode:"",singer_map:{},genre_map:{},genres:[],singers:[],is_official:!1,size:0,created_at:Hs(),updated_at:Hs(),...t}),jx=t=>({name:"",song_ids:[],image_url:"",singers:[],singer_map:{},genre_map:{},genres:[],is_album:!1,like:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_path:"",created_at:Hs(),updated_at:Hs(),...t}),d2=({owner_email:t,distributor:e,...n})=>jx({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),kf=t=>({name:"",description:"",image_file_path:"",image_url:"",like:0,created_at:Hs(),blurhash_encode:"",...t}),h2=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}},f2=({user:t,target_id:e,...n})=>({target_id:e,text:"",like:0,reply:0,comment_id:"",user_email:t.email,user_image_url:t.photo_url,user_name:t.display_name,created_at:Hs(),updated_at:Hs(),...n});function ZR(t){const[e,n]=f.useState(),[r,s]=f.useState(),i=f.useRef(null),o=m=>{e&&n({...e,...m})},l=f.useMemo(()=>t.variant==="add"?!0:!t.playlist||!e?!1:e.name!==t.playlist.name||e.like!==t.playlist.like||e.is_public!==t.playlist.is_public,[e]),c=!!r,u=f.useMemo(()=>{const m=!!(e!=null&&e.name)&&l;return t.variant==="add"?m:m||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return jx({distributor:t.user.display_name,owner_email:t.user.email});case"edit":const{id:m,updated_at:p,...g}=t.playlist;return jx(g)}};return f.useEffect(()=>{var m;t.variant==="add"&&((m=i.current)==null||m.focus()),n(d())},[]),f.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),{playlistData:e,imageFile:r,setImageFile:s,updatePlaylistData:o,setPlaylistData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function Qu({close:t,isLoading:e,submit:n,...r}){const{theme:s}=G(),{imageFile:i,setImageFile:o,playlistData:l,updatePlaylistData:c,isChanged:u,isChangeImage:d,inputRef:m,isValidToSubmit:p}=ZR(r),g=async()=>{l&&(!u&&!d||n(l,i))},y=v=>{var _;(_=v.target.files)!=null&&_.length&&o(v.target.files[0])};if(l)return a.jsxs(a.Fragment,{children:[a.jsx(ot,{close:t,title:r.variant==="add"?"Add playlist":"Edit playlist"}),a.jsxs("div",{className:"md:flex md:space-x-3",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:a.jsx(Je,{className:"object-cover object-center h-full",blurHashEncode:l.blurhash_encode,src:l.image_url})}),a.jsx("input",{ref:m,onChange:y,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),a.jsx("div",{className:"space-x-2 flex",children:a.jsx(ae,{className:`${s.content_bg}`,size:"clear",children:a.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:a.jsx(cl,{className:"w-5"})})})})]}),a.jsxs("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",children:"Name"}),a.jsx(Gt,{className:"bg-white/10",id:"name",ref:m,type:"text",placeholder:"name...",value:l.name,onChange:v=>c({name:v.target.value})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{children:"Public"}),a.jsx(ph,{inActiveBg:"bg-black/10",active:l.is_public,cb:()=>c({is_public:!l.is_public})})]})]})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(ae,{isLoading:e,color:"primary",onClick:g,disabled:!p,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function jw(){const t=Kt(),{user:e,updateUserData:n}=ge(),{setPlaylists:r,playlists:s}=Tn(),[i,o]=f.useState(!1),{setSuccessToast:l,setErrorToast:c}=de(),u=Dt();return{isFetching:i,action:async m=>{try{if(!e)throw new Error("user not found");o(!0);const p=Ja(Te),g=Rt(Te,"Users",e.email),y=Rt(Te,"Playlists",m.playlist.id);switch(m.variant){case"like":{if(!e)throw Error();const v=[...e.liked_playlist_ids],_=v.findIndex(R=>R===m.playlist.id),S=_===-1;S?v.unshift(m.playlist.id):v.splice(_,1);const b={liked_playlist_ids:v},E={like:lu(S?1:-1)};p.update(g,b),p.update(y,E),await p.commit(),r(S?R=>[m.playlist,...R]:R=>R.filter(D=>D.id!==m.playlist.id)),n(b);break}case"edit":{const{data:v,playlist:_,imageFile:S}=m,b={..._,...v};if(S){const I=await Yi({imageFile:S});_.image_file_path&&await Yn({filePath:_.image_file_path}),Object.assign(b,I)}await Et({collectionName:"Playlists",data:b,id:_.id,msg:">>> api: update playlist doc"});const E=[...s],R=E.findIndex(I=>I.id===_.id);R!==-1&&(E[R]=b,r(E));const{updated_at:D,...F}=b;t(aH(F)),l("Playlist edited");break}case"delete":{const{playlist:v}=m,_=await Er(pe(Gu,Q("target_id","==",v.id))),S={liked_playlist_ids:e.liked_playlist_ids.filter(E=>E!==v.id)};p.delete(y),p.update(g,S),_.empty||(console.log(`Delete ${_.docs.length} comments`),_.forEach(E=>p.delete(E.ref))),await Promise.all([p.commit(),v.image_file_path?Yn({filePath:v.image_file_path}):()=>{}]);const b=s.filter(E=>E.id!==v.id);r(b),n(S),u("/my-music");break}}}catch(p){console.log({message:p}),c()}finally{o(!1)}},user:e}}function eA(){const{user:t}=ge(),{setErrorToast:e}=de(),{handleAddPlaylist:n,isFetching:r}=KR(),{action:s,isFetching:i}=jw();return{isFetching:r||i,myMusicAddPlaylist:async(c,u)=>{try{if(!t)return;const d=await n(c,u,{push:!1});d&&await s({variant:"like",playlist:d})}catch(d){console.log({error:d}),e()}}}}function Hm({songs:t,closeModal:e}){const{user:n}=ge(),{playlists:r}=Tn(),{theme:s}=G(),{addToPlaylist:i,isFetching:o}=NH(),{myMusicAddPlaylist:l,isFetching:c}=eA(),u=f.useRef(null),d=n?r.filter(g=>g.owner_email===n.email&&!g.is_official):[],m=async g=>{await i({playlist:g,songs:t}),e()},p=async(g,y)=>{var v;g.song_ids=t.map(_=>_.id),await l(g,y),(v=u.current)==null||v.close(),e()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(Pe,{children:[a.jsx(ot,{close:e,title:"Playlists"}),a.jsx("div",{className:`flex-grow flex flex-col overflow-auto space-y-2 ${o?"disable":""}`,children:d.length?d.map((g,y)=>a.jsxs("button",{onClick:()=>m(g),className:`flex rounded-md p-2 ${s.content_hover_bg} bg-white/10`,children:[a.jsx(Qa,{className:"w-5 mr-2"}),a.jsx("span",{children:g.name})]},y)):a.jsx(Ye,{variant:"less"})}),a.jsx("p",{className:"text-center",children:a.jsxs(ae,{className:`${s.content_bg} mt-5 rounded-full justify-center`,onClick:()=>{var g;return(g=u.current)==null?void 0:g.open()},children:[a.jsx(ir,{className:"w-5"}),a.jsx("span",{children:"Add new playlist"})]})})]}),a.jsx(Ee,{variant:"animation",ref:u,children:a.jsx(Pe,{className:"w-[600px]",children:a.jsx(Qu,{close:()=>{var g;return(g=u.current)==null?void 0:g.close()},submit:p,isLoading:o||c,variant:"add",user:n})})})]})}function Rw({modalRef:t,song:e}){const{user:n}=ge();return n?a.jsx(Ee,{variant:"animation",ref:t,children:a.jsx(Hm,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},songs:[e]})}):a.jsx(a.Fragment,{})}function Aw({modalRef:t}){const{user:e}=ge();return e?a.jsxs("button",{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},children:[a.jsx(ir,{}),a.jsx("span",{children:"Add to playlist"})]}):a.jsx(a.Fragment,{})}function PH({song:t,index:e}){const{action:n}=QR(),r=f.useRef(null),s=()=>{n({variant:"remove",index:e})};return a.jsxs(a.Fragment,{children:[a.jsxs(Gm,{song:t,children:[!1,a.jsxs("button",{onClick:s,children:[a.jsx(Ky,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsx(Aw,{modalRef:r}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(_u,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Rw,{song:t,modalRef:r})]})}function FH({song:t,modalRef:e}){const{user:n}=ge(),{updateSong:r}=Tn(),[s,i]=f.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[o,l]=f.useState(!1),[c,u]=f.useState(),{setErrorToast:d,setSuccessToast:m}=de(),p=f.useMemo(()=>t.name!==s.name||t.singers[0].name!==s.singer,[s]),g=!!s.name&&!!s.singer&&p||c;return{isFetching:o,isChanged:p,songData:s,isValidToSubmit:g,handleSubmit:async()=>{var _,S;try{if(!n||!g)return;l(!0),(_=e.current)==null||_.setModalPersist(!0);const{id:b,...E}=t;if(p){if(!s.name||!s.singer)return;E.name=s.name,E.singers=[{...E.singers[0],name:s.singer}]}if(c){const R=await Yi({imageFile:c});Object.assign(E,R),t.image_file_path&&await Yn({filePath:t.image_file_path})}await Et({collectionName:"Songs",data:E,id:t.id}),r({id:t.id,song:E}),m("Song edited"),(S=e.current)==null||S.close()}catch(b){console.log({message:b}),d()}finally{l(!1)}},imageFile:c,setImageFile:u,handleInput:(_,S)=>{i({...s,[_]:S})}}}function DH({song:t,modalRef:e}){const{theme:n}=G(),r=f.useRef(null),{isValidToSubmit:s,songData:i,setImageFile:o,isFetching:l,handleSubmit:c,handleInput:u}=FH({song:t,modalRef:e}),d=p=>{const g=p.target.files;g!=null&&g.length&&(o(g[0]),u("image_url",URL.createObjectURL(g[0])))},m=p=>{var g;p.stopPropagation(),(g=e.current)==null||g.close()};return a.jsxs(Pe,{className:`${Qc(l)} w-[500px]`,children:[a.jsx("input",{ref:r,id:"image-input",type:"file",accept:"image/*",onChange:d,className:"hidden"}),a.jsx(ot,{title:"Edit song",close:()=>{var p;return(p=e.current)==null?void 0:p.close()}}),a.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:a.jsx(Je,{className:"object-cover h-full",src:i.image_url})}),a.jsx("label",{htmlFor:"image-input",className:`inline-block cursor-pointer hover:brightness-90 px-[20px] py-[5px] ${n.content_bg} rounded-full text-[14px]`,children:a.jsx(cl,{className:"w-5"})})]}),a.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"name",className:"",children:"Name"}),a.jsx(Gt,{value:i.name,type:"text",id:"name",onChange:p=>u("name",p.target.value),placeholder:t.name})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"singer",className:"",children:"Singer"}),a.jsx(Gt,{value:i.singer,onChange:p=>u("singer",p.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),a.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[a.jsx(ae,{onClick:m,className:"rounded-full",children:"Close"}),a.jsx(ae,{isLoading:l,onClick:c,disabled:!s,className:`${n.content_bg} rounded-full`,variant:"primary",children:"Save"})]})]})}function Wm(){const{user:t,updateUserData:e}=ge(),{setErrorToast:n,setSuccessToast:r}=de(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:o}=Tn(),[l,c]=f.useState(!1);return{loading:l,action:async d=>{try{if(c(!0),!t)throw new Error("User not found");const m=Ja(Te),p=Rt(Te,"Users",t.email),g=Rt(Te,"Songs",d.song.id);switch(d.variant){case"delete":{const y=s.filter(_=>_.id!==d.song.id),v={liked_song_ids:t.liked_song_ids.filter(_=>_!==d.song.id)};if(m.update(p,v),m.delete(g),d.song.lyric_id){const _=Rt(Te,"Lyrics",d.song.lyric_id);m.delete(_)}await Promise.all([m.commit(),WR(d.song)]),i(y),r(`'${d.song.name}' deleted`);break}case"like":{if(!t)return;const y=[...t.liked_song_ids],v=y.findIndex(E=>E===d.song.id),_=v===-1;_?y.unshift(d.song.id):y.splice(v,1);const S={liked_song_ids:y},b={like:lu(_?1:-1)};m.update(p,S),m.update(g,b),await m.commit(),e(S),o.current=!0;break}}}catch(m){console.log({message:m}),n()}finally{c(!1)}}}}function Nw({song:t}){const{action:e}=QR(),n=()=>{e({variant:"add",songs:[t]})};return a.jsxs("button",{onClick:n,children:[a.jsx(ir,{}),a.jsx("span",{children:"Add to queue"})]})}function LH({song:t}){const[e,n]=f.useState(""),r=f.useRef(null),s=f.useRef(null),{action:i,loading:o}=Wm(),l=m=>{var p;n(m),(p=r.current)==null||p.open()},c=()=>{var m;(m=r.current)==null||m.close()},u=async()=>{await i({variant:"delete",song:t}),c()},d=()=>{switch(e){case"":return a.jsx(a.Fragment,{});case"delete":return a.jsx(ps,{callback:u,loading:o,close:c,label:`Delete ' ${t.name} ' ?`});case"edit":return a.jsx(DH,{modalRef:r,song:t});case"add-to-playlist":return a.jsx(Hm,{closeModal:c,songs:[t]})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Gm,{song:t,children:[!1,a.jsx(Nw,{song:t}),a.jsx(Aw,{modalRef:s}),a.jsxs("button",{onClick:()=>l("edit"),children:[a.jsx(nm,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(we,{to:`lyric/${t.id}`,children:[a.jsx(qy,{}),a.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),a.jsxs("button",{onClick:()=>l("delete"),children:[a.jsx(Ln,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(_u,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Ee,{variant:"animation",ref:r,children:d()}),a.jsx(Rw,{song:t,modalRef:s})]})}function MH({song:t}){const e=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(Gm,{song:t,children:[!1,a.jsx(Nw,{song:t}),a.jsx(Aw,{modalRef:e}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(_u,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Rw,{song:t,modalRef:e})]})}function OH(){const t=Kt(),{playlistSongs:e,currentPlaylist:n}=re(Zs),{playlists:r,setPlaylists:s}=Tn(),{setErrorToast:i,setSuccessToast:o}=de(),[l,c]=f.useState(!1);return{isFetching:l,removeSongFromPlaylist:async({song:d})=>{try{if(!n)return;c(!0);const m=e.filter(_=>_.id!==d.id),p={song_ids:m.map(_=>_.id)},g={...n,...p};await Et({collectionName:"Playlists",id:n.id,data:p});const y=[...r],v=y.findIndex(_=>_.id===n.id);v!==-1&&(y[v]=g,s(y)),t(lH(m)),o(`${d.name} removed`)}catch(m){console.log({message:m}),i()}finally{c(!1)}}}}function $H({song:t}){const{removeSongFromPlaylist:e}=OH();return a.jsxs("button",{onClick:()=>e({song:t}),children:[a.jsx(Ky,{}),a.jsx("span",{children:"Remove"})]})}function BH({song:t}){return a.jsx(a.Fragment,{children:a.jsxs(Gm,{song:t,children:[!1,a.jsx(Nw,{song:t}),a.jsx($H,{song:t}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(_u,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]})})}function zH({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-3 bg-[#fff]/5 rounded-md flex",children:[a.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:a.jsx(Je,{src:t.image_url,className:"object-cover object-center w-full"})}),a.jsxs("div",{className:"ml-1 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function Gm({children:t,song:e}){return a.jsx(vr,{className:"w-[240px]",children:a.jsxs(ml,{children:[a.jsx(zH,{song:e}),a.jsx(fl,{children:t}),a.jsxs("p",{className:"text-xs text-center opacity-70 mt-3",children:["By ",e.distributor]})]})})}function m2({song:t,index:e,variant:n}){const{theme:r}=G(),[s,i]=f.useState(!1),o=()=>{switch(n){case"queue-song":return a.jsx(PH,{song:t,index:e});case"own-song":return a.jsx(LH,{song:t});case"own-playlist":return a.jsx(BH,{song:t});default:return a.jsx(MH,{song:t})}},l=()=>{switch(n){case"queue-song":case"recent-song":return a.jsx(a.Fragment,{});default:return a.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${s?"hidden":"md:block"}`,children:Br(t.duration)})}},c={button:`hover:bg-${r.alpha} p-2 rounded-full`},u=()=>s?`${r.content_bg}`:"block md:hidden";return a.jsx(a.Fragment,{children:a.jsxs(xr,{appendOnPortal:!0,children:[a.jsx(yr,{children:a.jsx("button",{type:"button",className:`block group-hover/main:block ${c.button} ${u()}`,children:a.jsx(ll,{className:"w-5"})})}),l(),o()]})})}function UH({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{theme:i}=G(),{action:o,loading:l}=Wm(),c=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},u=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},d=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":i.content_text;default:return i.content_text}},m={button:`hover:bg-${i.alpha} rounded-full`};return a.jsx("button",{onClick:()=>o({variant:"like",song:e}),className:`${m.button} ${c()} group-hover/main:block md:hidden ${s} ${u()}`,children:l?a.jsx(We,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(hl,{className:`w-5 ${d()}`}):a.jsx(Su,{className:"w-5"})})})}function VH({onClick:t,isChecked:e,isSelected:n}){return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:t,className:`mr-2 md:mr-3 group-hover/main:block ${e?"block":"md:hidden "}`,children:n?a.jsx(av,{className:"w-[18px]"}):a.jsx(GT,{className:"w-[18px]"})}),a.jsx("button",{className:`mr-3 hidden group-hover/main:hidden group-hover/main:mr-[0px] md:block ${Ni(e,"md:hidden")}`,children:a.jsx(Qa,{className:"w-[18px]"})})]})}function HH({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:o="",imageUrl:l,...c}){const{theme:u,isOnMobile:d}=G(),{isChecked:m,selectedSongs:p,selectSong:g}=Tu(),y=f.useMemo(()=>p?p.indexOf(t)!=-1:!1,[p]),v=()=>{m!==void 0&&g(t)},_={button:`${u.content_hover_bg} p-[8px] rounded-full`,checkboxButton:"mr-3 text-[inherit]",itemContainer:`w-full sm:group/container flex flex-row rounded justify-between p-[10px] border-b border-${u.alpha} last:border-none`,imageFrame:" relative rounded-[4px] overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40",ctaWrapper:"flex items-center justify-end flex-shrink-0"},S=f.useMemo(()=>{switch(c.variant){default:return a.jsxs("div",{className:` ${_.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[a.jsx("img",{src:xw,alt:"",className:`"h-[18px] w-[18px] ${Kc(!r)}`}),a.jsx("button",{onClick:e,className:`${Kc(r)} `,children:a.jsx(CH,{className:"w-[24px] text-white"})})]})}},[r,e]),b=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-sm";default:return""}},E=()=>{switch(c.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},R=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},D=N=>{if(!d)return;const P=N.target;console.log(P.tagName),P.tagName!=="A"&&e()},F=a.jsxs(a.Fragment,{children:[n&&a.jsx(VH,{isChecked:m,isSelected:y,onClick:v}),a.jsxs("div",{className:"flex-grow flex",onClick:D,children:[a.jsxs("div",{className:`${_.imageFrame} ${E()}`,children:[a.jsx(Je,{src:l||t.image_url,blurHashEncode:t.blurhash_encode}),S]}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsxs("h5",{className:`line-clamp-1 font-medium overflow-hidden ${b()}`,children:[t.name,!1]}),a.jsx("div",{className:`opacity-[.7] line-clamp-1 ${R()}`,children:t.singers.map((N,P)=>N.id?a.jsx(we,{to:`/singer/${N.id}`,className:`${u.content_hover_text}  hover:underline`,children:(P?", ":"")+N.name},P):a.jsxs("span",{children:[" ",(P?", ":"")+N.name]},P))})]})]})]}),I=()=>{switch(c.variant){case"queue-song":case"recent-song":return F;default:return a.jsx("div",{className:"flex flex-grow overflow-hidden",children:F})}},k=()=>{switch(c.variant){case"queue-song":case"recent-song":return a.jsx(m2,{variant:c.variant,song:t,index:i});default:return a.jsx("div",{className:"flex justify-center md:w-[60px]",children:a.jsx(m2,{variant:c.variant,song:t,index:i})})}},j=a.jsxs("div",{className:"flex items-center",children:[s!=null&&a.jsx(UH,{className:"p-2",isSongActive:r,songVariant:c.variant,isLiked:s,song:t}),k()]});return(()=>{switch(c.variant){case"queue-song":case"recent-song":return a.jsxs("div",{className:`${_.itemContainer} group/main ${r?`${u.content_bg} text-white`:`hover:bg-${u.alpha}`}`,children:[I(),j]});default:return a.jsxs("div",{className:`${_.itemContainer} ${o} group/main ${r||y?`bg-${u.alpha}`:`hover:bg-${u.alpha}`}`,children:[I(),j]})}})()}function ei({songs:t,setSong:e,getActive:n,songVariant:r,imageUrl:s,isHasCheckBox:i=!0}){const{user:o}=ge(),{currentSongData:l}=re(ze);return t.length?t.map((c,u)=>{const d=o?c.owner_email===o.email&&c.is_official===!1:!1;return a.jsx(HH,{active:l?n?n(c,l.song):c.id===l.song.id:!1,onClick:()=>e(c),variant:r||(d?"own-song":"system-song"),isHasCheckBox:i,isLiked:o?o.liked_song_ids.includes(c.id):null,song:c,imageUrl:s,index:u},c.queue_id)}):a.jsx(Ye,{variant:"less"})}function WH(){const t=Kt(),{setSuccessToast:e}=de(),{selectedSongs:n,resetSelect:r}=Tu(),s=()=>{t(zm({songs:n})),e("songs added to queue"),r()};return a.jsxs("button",{onClick:s,children:[a.jsx(ir,{className:"w-5"}),a.jsx("span",{className:"",children:"Add to queue"})]})}function GH({modalRef:t}){const{user:e}=ge(),{selectedSongs:n}=Tu();return e?a.jsx(Ee,{variant:"animation",ref:t,children:a.jsx(Hm,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},songs:n})}):a.jsx(a.Fragment,{})}function qH({modalRef:t}){const{user:e}=ge(),n=()=>{var r;(r=t.current)==null||r.open()};return e?a.jsxs("button",{onClick:n,children:[a.jsx(Xs,{className:"w-5"}),a.jsx("span",{children:"Add to playlist"})]}):a.jsx(a.Fragment,{})}function QH(){const t=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsx(KH,{children:a.jsx(qH,{modalRef:t})}),a.jsx(GH,{modalRef:t})]})}function KH({children:t}){return a.jsx(vr,{children:a.jsx(ml,{children:a.jsx(fl,{children:t})})})}function XH({variant:t}){const e=()=>{switch(t){default:return a.jsx(QH,{})}};return a.jsx(a.Fragment,{children:a.jsxs(xr,{appendOnPortal:!0,children:[a.jsx(yr,{children:a.jsx("button",{className:"!p-1.5",type:"button",children:a.jsx(ll,{className:"w-5"})})}),e()]})})}function qm({children:t,variant:e,selectAll:n}){const{theme:r}=G(),{user:s}=ge(),{isSelectAll:i,isChecked:o,resetSelect:l,selectedSongs:c}=Tu(),u=a.jsxs(a.Fragment,{children:[n&&a.jsx("button",{onClick:n,className:"ml-[10px]",children:i?a.jsx(bu,{className:"w-[20px]"}):a.jsx(GT,{className:"w-[20px]"})}),a.jsx("p",{className:"font-playwriteCU mr-1",children:c.length}),a.jsxs("div",{className:`flex space-x-2 items-center ${r.type==="light"?"[&>button]:bg-black/5":"[&>button]:bg-white/5"}  [&>button]:inline-flex [&>button]:space-x-1 [&>button]:py-1 [&>button]:px-2 [&>button]:rounded-full hover:[&>button]:brightness-95`,children:[a.jsx(WH,{}),s&&a.jsx(XH,{variant:e})]}),a.jsx("button",{onClick:l,className:"p-1 flex-shrink-0",children:a.jsx(qi,{className:"w-[20px]"})})]});return a.jsx("div",{className:"flex items-center space-x-2 h-[44px] mb-3",children:o?u:t})}function Pw(){const t=Kt();return re(ze),{getRecommend:async n=>{try{t(c2(!0));const r=n.genres.map(l=>Q(`genre_map.${l.id}`,"==",!0),Zo(20)),s=Q(Ys(),"!=",n.id),i=pe(bn,...r,s),o=await Sn(i);t(zm({songs:o})),t(c2(!1))}catch{}}}}function YH(){const{isFetching:t,songMap:e,...n}=vH(),{handleSetSong:r}=Js({variant:"songs"}),{getRecommend:s}=Pw(),i=o=>{r(o.queue_id,[o]),s(o)};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ae,{title:"Song"}),a.jsx("div",{className:"flex space-x-1 my-2 p-1",children:a.jsx(gs,{render:o=>o,...n})}),a.jsxs(ms,{children:[a.jsx(qm,{variant:"system-song",children:a.jsx("p",{className:"font-[500] opacity-[.5]",children:"Songs"})}),t&&pl,!t&&a.jsx(ei,{songs:e[n.tab].songs,setSong:o=>i(o)})]})]})})}function JH(){const{user:t}=ge(),[e,n]=f.useState([]),[r,s]=f.useState(!0);return{isFetching:r,recentPlaylists:e,getRecentPlaylist:async()=>{try{if(t){if(t.recent_song_ids.length){const o=pe(br,Q(Ys(),"in",t.recent_song_ids)),l=await Hr(o);n(l)}}else{const o=gn()["recent-playlists"]||[];n(o)}}catch(o){console.log({message:o})}finally{s(!1)}}}}function ZH(){const{currentSongData:t}=re(ze),e=f.useRef(!1),{isFetching:n,getRecentPlaylist:r,recentPlaylists:s}=JH();f.useEffect(()=>{e.current||(e.current=!0,r())},[]);const i={playlistItem:"w-1/4 p-[8px] max-[800px]:w-1/2"},o=()=>s.map((l,c)=>{const u=t==null?void 0:t.song.queue_id.includes(l.id);return a.jsx("div",{className:i.playlistItem,children:a.jsx(yw,{active:u,data:l})},c)});return n?a.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:lv}):s.length?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ae,{title:"Recent listening"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:o()})]})}):a.jsx(a.Fragment,{})}function Qm(){const{user:t}=ge(),[e,n]=f.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await E$(Oa,OU);break}case"logout":{await SC(Oa);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function eW(){const{theme:t}=G(),{loading:e,user:n}=ge(),r=f.useRef(null),{action:s}=Qm(),[i,o]=f.useState(""),l=()=>{var p;return(p=r.current)==null?void 0:p.toggle()},c=p=>{var g;o(p),(g=r.current)==null||g.toggle()},u=async()=>{try{await s("logout")}catch(p){console.log("signOut error",{message:p})}finally{l()}},d=f.useMemo(()=>{switch(i){case"theme":return a.jsx(iv,{close:l});case"info":return a.jsx(sv,{close:l});case"logout":return a.jsx(ps,{close:l,callback:u,loading:!1,label:"Log out ?"})}},[i]),m={linkItem:`py-3 text-lg w-full border-b border-${t.alpha} space-x-2 last:border-none flex items-center`,icon:"w-7"};return a.jsxs("div",{className:"md:hidden",children:[a.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),n&&a.jsxs("div",{className:`bg-${t.alpha} p-3 rounded-md flex mb-3`,children:[a.jsx(vx,{className:"h-[65px] w-[65px]"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-lg font-[500]",children:n.display_name}),a.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),e?[...Array(3).keys()].map(p=>a.jsx(kM,{},p)):a.jsxs("div",{className:"",children:[a.jsxs("button",{className:m.linkItem,onClick:()=>c("theme"),children:[a.jsx(O0,{className:m.icon}),a.jsx("span",{children:"Theme"})]}),a.jsxs("button",{className:m.linkItem,onClick:()=>c("info"),children:[a.jsx(M0,{className:m.icon}),a.jsx("span",{children:"Info"})]}),(n==null?void 0:n.role)==="ADMIN"&&a.jsxs(we,{to:"/dashboard",className:m.linkItem,children:[a.jsx(Gy,{className:m.icon}),a.jsx("span",{children:"Dashboard"})]}),n&&a.jsxs("button",{className:m.linkItem,onClick:()=>c("logout"),children:[a.jsx(OT,{className:m.icon}),a.jsx("span",{children:"Logout"})]})]}),a.jsx(Ee,{ref:r,variant:"animation",children:d})]})}function tW(){return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(ZH,{}),a.jsx(xH,{}),a.jsx(YH,{}),a.jsx(eW,{})]}),a.jsx(vu,{})]})}function tA(){const{user:t,updateUserData:e}=ge();return{updatePlaylist:async r=>{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const o={recent_playlist_ids:[...t.recent_playlist_ids,r.id]};await Et({collectionName:"Users",data:o,id:t.email}),e(o)}}else{const s=gn()["recent-playlists"]||[];s.find(o=>o.id===r.id)||(s.push(r),rt("recent-playlists",s))}}}}const nW=a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(ce,{className:"h-[20px] w-[90px]"})}),pl]});function rW({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=re(Zs),{handleSetSong:s}=Js({variant:"playlist"}),{updatePlaylist:i}=tA(),o=(r==null?void 0:r.is_album)&&!!(r!=null&&r.image_url),l=c=>{if(!r)return;s(c.queue_id,n)&&i(r)};return e?nW:a.jsx(a.Fragment,{children:a.jsxs(ms,{children:[!!n.length&&a.jsx(qm,{variant:t==="others-playlist"?"system-song":"own-playlist",children:a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),a.jsx(ei,{imageUrl:o?r.image_url:"",songs:n,setSong:c=>l(c),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function ti(){const t=Kt(),{playerConig:{isShuffle:e,repeat:n,isCrossFade:r},updatePlayerConfig:s,firstTimeSongLoaded:i,audioRef:o,timelineEleRef:l,currentTimeEleRef:c,isPlayingNewSong:u,themeCodeRef:d,shouldSyncSongDuration:m}=dt(),{currentSongData:p,queueSongs:g}=re(ze),{playStatus:y}=re(In),v=f.useRef(0),_=()=>{l.current&&c.current&&(c.current.innerText="0:00",l.current.style.background="rgba(255, 255, 255, 0.15)")},S=async()=>{try{if(m.current){m.current=!1;const N=gn().current_time||0;o.current.currentTime=N}await o.current.play(),u.current&&(r&&(o.current.volume=0),u.current=!1)}catch{}},b=()=>{o.current.pause()},E=()=>{y==="playing"&&b(),y==="paused"&&S()},R=C=>{const N=l.current,P=c.current,A=C||o.current.currentTime;if(o.current.duration&&N){const Z=A/(o.current.duration/100);N.style.background=kw(d.current,+Z.toFixed(1))}P&&(P.innerText=Br(A)||"0:00")};return{toggleRepeat:()=>{let C;switch(n){case"no":C="one";break;case"one":C="all";break;case"all":C="no";break;default:C="no"}rt("repeat",C),s({repeat:C})},toggleShuffle:()=>{const C=!e;s({isShuffle:C}),rt("isShuffle",C)},next:()=>{if(!p)return;let C=p.index+1,N;C<g.length?N=g[C]:(C=0,N=g[0]),t(hs(N.queue_id))},previous:()=>{if(!p)return;let C=p.index-1,N;C>=0?N=g[C]:(N=g[g.length-1],C=g.length-1),t(hs(N.queue_id))},repeat:n,isShuffle:e,updateProgressElement:R,handleSeek:C=>{const N=C.target;if(l.current){const P=N.getBoundingClientRect(),Z=(C.clientX-P.left)/l.current.offsetWidth,he=Math.round(Z*o.current.duration),te=o.current.currentTime;if(v.current&&Math.abs(te-v.current)<1&&Math.abs(he-v.current)<1)return;R(he),i.current?rt("current_time",he):o.current.currentTime=he,v.current=he}},handlePlayPause:E,play:S,pause:b,resetForNewSong:_}}function Tg({onClick:t,children:e,text:n}){const{theme:r}=G(),{playlistSongs:s}=re(Zs);return a.jsxs(ae,{onClick:t,disabled:!s.length,size:"clear",className:`rounded-full px-5 py-1 ${r.content_bg}`,children:[e,a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function sW(){const{currentPlaylist:t,playlistSongs:e}=re(Zs),{currentSongData:n}=re(ze),{playStatus:r}=re(In),{handlePlayPause:s}=ti(),{handleSetSong:i}=Js({variant:"playlist"}),{updatePlaylist:o}=tA(),l=()=>{if(!t)return;const c=e[0];i(c.queue_id,e)&&o(t)};if(!t)return a.jsx(a.Fragment,{});if(n!=null&&n.song.queue_id.includes(t.id))switch(r){case"playing":case"waiting":return a.jsx(Tg,{text:"Pause",onClick:s,children:a.jsx(im,{className:"w-7 mr-1"})});case"loading":case"paused":return a.jsx(Tg,{text:"Continue",onClick:s,children:a.jsx(Gc,{className:"w-7 mr-1"})})}return a.jsx(Tg,{text:"Play",onClick:l,children:a.jsx(Gc,{className:"w-7 mr-1"})})}function iW({isLiked:t,playlist:e,className:n="p-1.5"}){const{theme:r}=G(),{action:s,isFetching:i}=jw(),o={button:`bg-${r.alpha} hover:brightness-90 rounded-full w-[40px] flex items-center justify-center`};return a.jsx("button",{onClick:()=>s({variant:"like",playlist:e}),className:` ${o.button} ${n}`,children:i?a.jsx(We,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(hl,{className:`w-5 ${r.content_text}`}):a.jsx(Su,{className:"w-5"})})})}function aW(){return a.jsx(a.Fragment,{children:a.jsx(nA,{children:a.jsx(Ew,{})})})}function oW(){const{currentPlaylist:t}=re(Zs),[e,n]=f.useState(""),r=f.useRef(null),{action:s,isFetching:i}=jw(),o=d=>{var m;n(d),(m=r.current)==null||m.open()},l=()=>{var d;return(d=r.current)==null?void 0:d.close()},c=async(d,m)=>{t&&(await s({variant:"edit",playlist:t,data:d,imageFile:m}),l())},u=()=>{if(!t)return a.jsx(a.Fragment,{});switch(e){case"":return a.jsx(a.Fragment,{});case"edit":return a.jsx(Pe,{className:"w-[600px]",children:a.jsx(Qu,{isLoading:i,playlist:t,submit:c,variant:"edit",close:l})});case"delete":return a.jsx(ps,{loading:i,label:`Delete playist ' ${t.name} ' ?`,callback:()=>s({variant:"delete",playlist:t}),close:l})}};return a.jsxs(a.Fragment,{children:[a.jsxs(nA,{children:[a.jsx(Ew,{}),a.jsxs("button",{onClick:()=>o("edit"),children:[a.jsx(Ks,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>o("delete"),children:[a.jsx(Ln,{}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(Ee,{variant:"animation",ref:r,children:u()})]})}function nA({children:t}){return a.jsx(vr,{className:"left-[calc(100%)] bottom-full w-[120px]",animationClassName:"origin-top-left",children:a.jsx(ml,{children:a.jsx(fl,{children:t})})})}function lW({variant:t}){const{theme:e}=G(),[n,r]=f.useState(!1);return a.jsx(a.Fragment,{children:a.jsxs(xr,{children:[a.jsx(yr,{children:a.jsx(ae,{size:"clear",className:`rounded-full p-2.5 ${n?e.content_bg:"bg-"+e.alpha} $
            } `,children:a.jsx(nm,{className:"w-5"})})}),t==="others-playlist"?a.jsx(aW,{}):a.jsx(oW,{})]})})}function Sr(t){const e=["","K","M","B"],n=Math.log10(Math.abs(t))/3|0;return n===0?t.toString():(t/Math.pow(10,n*3)).toFixed(1)+e[n]}function cW({target:t}){const[e,n]=f.useState([]),[r,s]=f.useState(!1),[i,o]=f.useState(!0),l=f.useRef(!0);return{target:t,comments:e,isOpenComment:r,setIsOpenComment:s,setComments:n,shouldFetchComment:l,isFetching:i,setIsFetching:o}}const rA=f.createContext(null);function Km({children:t,target:e}){return a.jsx(rA.Provider,{value:cW({target:e}),children:t})}function Gr(){const t=f.useContext(rA);if(!t)throw new Error("CommentProvider not provided");return t}function sA({children:t}){return a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] bg-[#1f1f1f] backdrop-blur-[15px] z-[-1] absolute inset-0"}),t]})}function iA(){const{user:t,updateUserData:e}=ge(),{setComments:n,comments:r}=Gr(),[s,i]=f.useState(!1);return{isFetching:s,action:async l=>{try{if(!t)return;switch(i(!0),l.type){case"add":{const c=f2({user:t,target_id:l.target_id,text:l.text}),u=await Gs({collectionName:"Comments",data:c}),d=await La(u);if(d.exists()){const m={...d.data(),id:u.id,replies:[]};n(p=>[m,...p]),i(!1)}break}case"reply":{const{comment:c,comment_index:u,text:d}=l,m=f2({user:t,target_id:c.target_id,text:d,comment_id:c.id}),p=await Gs({collectionName:"Comments",data:m}),g=await La(p);if(g.exists()){const y={reply:lu(1)};await Et({collectionName:"Comments",data:y,id:c.id});const v={...g.data(),id:p.id,replies:[]},_=[...r];_[u]={..._[u],replies:[..._[u].replies,v]},n(_),i(!1)}break}case"like":{const c=[...t.liked_comment_ids],u=c.findIndex(g=>g===l.id),d=u===-1;d?c.push(l.id):c.splice(u,1);const m={like:lu(d?1:-1)};await Et({collectionName:"Comments",data:m,id:l.id});const p={liked_comment_ids:c};rt("liked_comment_ids",c),e(p);break}case"delete":{const c=Rt(Te,"Comments",l.comment.id),u=Ja(Te);if(u.delete(c),l.comment.reply){console.log(`Delete ${l.comment.reply} replies `);const p=pe(Gu,Q("comment_id","==",l.comment.id));(await Er(p)).forEach(y=>{u.delete(y.ref)})}await u.commit();const d=[...t.liked_comment_ids],m=d.findIndex(p=>p===p);m!==-1&&(d.splice(m,1),rt("liked_comment_ids",d)),n(p=>p.filter(g=>g.id!==l.comment.id));break}}}catch(c){console.log({error:c})}finally{i(!1)}}}}function aA(t){const e=t.toDate(),r=new Date().getTime()-e.getTime(),s=Math.floor(r/(1e3*60*60*24));return s?s+(s>1?" days ago":" day ago"):"Today"}function oA({onSubmited:t,...e}){const{user:n}=ge(),{themeClass:r,theme:s}=G(),{target:i}=Gr(),{currentSongData:o}=re(ze),{currentPlaylist:l}=re(Zs),{action:c,isFetching:u}=iA(),d=f.useRef(null),m=async()=>{if(!d.current)return;const g=d.current.value;if(!g||!g.trim()||i==="song"&&!o||i==="playlist"&&!l)return;const y=i==="song"?o==null?void 0:o.song.id:l==null?void 0:l.id;if(y){switch(e.variant){case"comment":await c({type:"add",target_id:y,text:g});break;case"reply":await c({type:"reply",text:g,comment:e.comment,comment_index:e.comment_index});break}d.current.value="",t&&t()}},p=e.variant==="comment"?"...":`Reply to ${e.comment.user_name}...`;return a.jsxs("div",{className:"flex w-full",children:[a.jsx("div",{className:"w-[40px] h-[40px] flex-shrink-0",children:a.jsx(Je,{src:n==null?void 0:n.photo_url,className:"rounded-full"})}),a.jsxs("div",{className:`rounded-lg ml-2 flex-grow  flex items-center ${r("bg-black/10 text-black","bg-white/10")}`,children:[a.jsx(Gt,{className:"bg-transparent border-none text-white",placeholder:p,ref:d}),a.jsx(ae,{onClick:m,className:s.content_text,isLoading:u,children:a.jsx(Xc,{className:"w-6"})})]})]})}function uW({comment:t,commentIndex:e}){const{comments:n,setComments:r}=Gr(),[s,i]=f.useState(!1),{fetchComment:o}=Vm(),l=async()=>{try{i(!0);const c=await o({comment_id:t.id});if(c){const u=[...n];u[e]={...u[e],replies:c},r(u)}}catch(c){console.log({error:c})}finally{i(!1)}};return a.jsxs("button",{onClick:l,className:"mt-1 text-[#ccc] flex items-center space-x-1",children:[a.jsxs("span",{children:["View ",t.reply," replies"]}),s?a.jsx(We,{className:"w-5 animate-spin"}):a.jsx(nM,{className:"w-5"})]})}function lA({comment:t,index:e,level:n,variant:r="dark-bg"}){const{themeClass:s}=G(),{user:i}=ge(),{action:o,isFetching:l}=iA(),[c,u]=f.useState(!1),d=f.useRef("like"),m=f.useRef(null),p=i==null?void 0:i.liked_comment_ids.includes(t.id),g=(i==null?void 0:i.email)===t.user_email,y=async()=>{var v;await o({type:"delete",comment:t}),(v=m.current)==null||v.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n==1?"py-3":"mt-2"} `,children:a.jsxs("div",{className:"flex w-full items-start space-x-1.5",children:[a.jsx("div",{className:`flex-shrink-0 ${n===1?"w-[40px] h-[40px]":"w-[36px] h-[36px]"} rounded-full overflow-hidden`,children:a.jsx(Je,{src:t.user_image_url})}),a.jsxs("div",{className:"flex-grow text-[13px]",children:[a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex-grow ml-2",children:[a.jsxs("div",{className:`rounded-md ${r==="theme-bg"?s("text-black","text-white"):"text-white"}`,children:[a.jsx(we,{className:`font-medium line-clamp-1 font-[500] ${r==="theme-bg"?s("text-[#333]","text-[#f1f1f1]"):"text-[#f1f1f1]"}`,to:`/user/${t.user_email}`,children:t.user_name}),a.jsx("div",{className:"mt-1 break-all",children:t.text})]}),a.jsxs("div",{className:"flex space-x-2 mt-1",children:[a.jsx("span",{className:"opacity-[.7]",children:aA(t.created_at)}),i&&a.jsx(a.Fragment,{children:g?a.jsx("button",{onClick:()=>{var v;d.current="delete",(v=m.current)==null||v.open()},children:"Delete"}):n===1&&a.jsx("button",{onClick:()=>u(!0),children:"Reply"})})]}),!!t.reply&&n===1&&!t.replies.length&&a.jsx(uW,{comment:t,commentIndex:e})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("button",{className:"p-1",onClick:()=>{d.current="like",o({type:"like",id:t.id})},children:l&&d.current==="like"?a.jsx(We,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:p?a.jsx(hl,{className:"w-6 text-red-500"}):a.jsx(Su,{className:"w-6"})})}),a.jsx("span",{children:t.like})]})]}),!!t.replies.length&&t.replies.map((v,_)=>a.jsx(lA,{comment:v,index:e,level:2},_)),c&&a.jsx("div",{className:"mt-2",children:a.jsx(oA,{onSubmited:()=>u(!1),comment_index:e,variant:"reply",comment:t})})]})]})}),a.jsx(Ee,{variant:"animation",ref:m,children:a.jsx(ps,{label:"Delete comment",close:()=>{var v;return(v=m.current)==null?void 0:v.close},loading:l,callback:y})})]})}function Fw({comments:t,isFetching:e=!1,className:n="",variant:r}){const{user:s}=ge();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`flex-grow relative overflow-auto no-scrollbar ${n}`,children:[e&&a.jsx(qt,{children:a.jsx(We,{className:"animate-spin w-7"})}),!e&&a.jsx(a.Fragment,{children:t.length?t.map((i,o)=>a.jsx(lA,{variant:r,level:1,index:o,comment:i},i.id)):a.jsx("p",{className:"text-center",children:"..."})})]}),s&&a.jsx("div",{className:"pt-1.5",children:a.jsx(oA,{variant:"comment"})})]})}function dW(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=Gr(),{currentPlaylist:s}=re(Zs),{fetchComment:i}=Vm(),o=async()=>{try{if(!s)return;const l=await i({target_id:s.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};f.useEffect(()=>{!n||!s||t.current&&(t.current=!1,o())},[n])}function p2(){const{isFetching:t,comments:e}=Gr();return dW(),t?a.jsx(qt,{children:a.jsx(We,{className:"w-6 animate-spin"})}):a.jsx(Fw,{comments:e})}function hW(){const{theme:t,isOnMobile:e}=G(),{setIsOpenComment:n}=Gr(),r=f.useRef(null),s=()=>{var o;(o=r.current)==null||o.open(),n(!0)},i={button:`bg-${t.alpha} hover:brightness-90 rounded-full w-[40px] flex items-center justify-center`};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>s(),className:i.button,children:a.jsx(Hy,{className:"w-5"})}),!e&&a.jsx(Ee,{onClose:()=>n(!1),variant:"animation",ref:r,children:a.jsx(Pe,{className:"h-[400px] w-[500px]",children:a.jsx(p2,{})})}),e&&a.jsx(wx,{ref:r,onClose:()=>n(!1),children:a.jsx(sA,{children:a.jsx(p2,{})})})]})}const fW=(t,e)=>(e==null?void 0:e.type)==="date"?new Date(t.toDate()).toLocaleDateString("en-GB"):new Date(t.toDate()).toLocaleString();function mW({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{theme:s}=G(),{currentSongData:i}=re(ze),o=t?i==null?void 0:i.song.queue_id.includes(`${t.id}`):!1,l={container:"flex flex-col md:flex-row lg:flex-col",smallText:"",link:`${s.content_hover_text} hover:underline`},c=()=>t?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:`block hover:underline ${s.content_hover_text} ${l.smallText}`,to:`/singer/${t.singers[0].id}}`,children:t.singers[0].name}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{className:"text-red-500",children:"❤ "}),Sr(t.like)]})]}):a.jsx(a.Fragment,{}),u=()=>{if(!t)return a.jsx(a.Fragment,{});switch(r){case"my-playlist":return a.jsx(a.Fragment,{children:a.jsx("p",{className:l.smallText,children:t.is_public?"Public":"Private"})});case"others-playlist":return a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:[a.jsx("span",{className:"text-red-500 text-base",children:"❤ "}),Sr(t.like)]}),!!t.singers.length&&a.jsx("p",{className:l.smallText,children:t.singers.map((d,m)=>a.jsx(we,{className:`${l.link}`,to:`/singer/${d.id}`,children:(m?", ":"")+d.name},m))}),!t.is_official&&a.jsxs("p",{className:l.smallText,children:["Provided by"," ",a.jsx(we,{className:l.link,to:`/user/${t.owner_email}`,children:t.distributor})]}),a.jsxs("p",{className:l.smallText,children:["Last update:"," ",fW(t.updated_at,{type:"date"})]})]})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:l.container,children:[a.jsx("div",{className:"w-full flex-shrink-0 px-10 md:w-1/3 md:px-0 lg:w-full",children:e?a.jsx(ce,{className:"pt-[100%] rounded-lg"}):t&&a.jsx(yw,{data:t,active:o,variant:"image"})}),a.jsxs("div",{className:"flex flex-col items-center mt-3 md:items-start md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:items-center",children:[e?a.jsxs("div",{className:"space-y-1 flex flex-col items-center",children:[a.jsx(ce,{className:"h-[24px] w-[170px]"}),a.jsx(ce,{className:"h-[17px] w-[170px]"}),a.jsx(ce,{className:"h-[17px] w-[60px]"}),a.jsx(ce,{className:"h-[17px] w-[100px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-xl font-[600] leading-[1.2]",children:t.name}),a.jsx("div",{className:"mt-2.5 text-[#666] text-center md:text-left lg:text-center text-[13px]",children:t.is_album?c():u()})]}),t&&a.jsxs("div",{className:"flex flex-col items-center mt-3 md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[a.jsx(sW,{}),a.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0",children:[a.jsx(lW,{variant:r}),r!=="my-playlist"&&n!==null&&a.jsx(iW,{isLiked:n,playlist:t}),a.jsx(Km,{target:"playlist",children:a.jsx(hW,{})})]})]})]})]})})}function cA(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=kI(),i=sr(),o=Dt(),l=f.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const m=[...t],p=m.pop();p&&(n.current=!1,s(g=>[...g,l]),r(m),o(p))},forward:()=>{const m=[...e],p=m.pop();p&&(n.current=!1,r(g=>[...g,l]),s(m),o(p))},goHome:()=>{o("/")}}}function Xm({className:t=""}){const{backward:e,behind:n,goHome:r}=cA(),s=()=>{n.length?e():r()};return a.jsx(ae,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?a.jsx(zT,{className:"w-6"}):a.jsx(Eu,{className:"w-6"})})}function pW(){const{currentPlaylist:t}=re(Zs),{user:e}=ge(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=uH();return!s&&!t?a.jsx(qt,{children:a.jsx(Ye,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5",children:a.jsx(Xm,{})}),a.jsxs("div",{className:"lg:flex lg:-mx-3",children:[a.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:a.jsx(mW,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),a.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:a.jsx("div",{className:"mt-[30px] lg:mt-0",children:a.jsx(rW,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]}),a.jsx(vu,{})]})}function uA({tab:t}){const{user:e}=ge(),{setUploadedSongs:n,setFavoriteSongs:r,shouldFetchUserSongs:s,shouldFetchFavoriteSongs:i,favoriteSongs:o,uploadedSongs:l}=Tn(),{setErrorToast:c}=de(),[u,d]=f.useState(!0),m=async()=>{if(e)try{switch(t){case"favorite":{if(i.current){if(i.current=!1,e.liked_song_ids.length){const p=pe(bn,Q(Ys(),"in",e.liked_song_ids)),g=await Sn(p),y=[];e.liked_song_ids.forEach(v=>{const _=g.find(S=>S.id===v);_&&y.push(_)}),r(y)}}else await cs(100);break}case"uploaded":if(s.current){s.current=!1;const p=pe(bn,Q("owner_email","==",e.email),Q("is_official","==",!1)),g=await Sn(p);n(g)}else await cs(100)}}catch(p){console.log({message:p}),c()}finally{d(!1)}};return f.useEffect(()=>{m()},[]),{isFetching:u,uploadedSongs:l,favoriteSongs:o,user:e}}function gW(){const{handleSetSong:t}=Js({variant:"songs"}),{favoriteSongs:e,user:n,isFetching:r}=uA({tab:"favorite"}),s=i=>{t(i.queue_id,e)};if(n)return a.jsxs(ms,{children:[a.jsx(qm,{variant:"favorite-song",children:r?a.jsx(ce,{className:"h-[20px] w-[90px]"}):a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[e.length," Songs"]})}),r&&pl,!r&&a.jsx(a.Fragment,{children:e.length?a.jsx(a.Fragment,{children:a.jsx(ei,{setSong:s,songs:e})}):a.jsx(Ye,{})})]})}function xW({song:t}){return a.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[a.jsxs("div",{className:"flex-grow flex",children:[a.jsx(Qa,{className:"w-[18px] mr-2.5"}),a.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:a.jsx(Je,{src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),a.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx(We,{className:"animate-spin w-5"}),a.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function yW(){const{theme:t}=G(),{uploadingSongs:e,isUploading:n}=jI(),{handleSetSong:r}=Js({variant:"songs"}),{uploadedSongs:s,isFetching:i,user:o}=uA({tab:"uploaded"}),l=u=>{r(u,s)},c=f.useMemo(()=>i?0:e.length+s.length,[e,s,i]);return o?a.jsxs(ms,{children:[a.jsx(qm,{variant:"uploaded-song",children:i?a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(ce,{className:"h-[20px] w-[90px]"})})}):a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[c," Songs"]}),a.jsx("button",{disabled:n,children:a.jsxs("label",{className:`${t.content_bg} items-center space-x-1 hover:opacity-80 py-1 rounded-full flex px-4 cursor-pointer`,htmlFor:"song_upload",children:[a.jsx(Uy,{className:"w-5"}),a.jsx("span",{className:"",children:"Upload"})]})})]})}),a.jsxs("div",{className:"",children:[i&&pl,!i&&a.jsx(a.Fragment,{children:c?a.jsxs(a.Fragment,{children:[!!s.length&&a.jsx(ei,{setSong:u=>l(u.queue_id),songs:s,songVariant:"own-song"}),e.map((u,d)=>a.jsx(xW,{song:u},d))]}):a.jsx(Ye,{})})]})]}):a.jsx(a.Fragment,{})}function dA(){const{user:t}=ge(),{setPlaylists:e,shouldFetchUserPlaylists:n,playlists:r}=Tn(),{setErrorToast:s}=de(),[i,o]=f.useState(!0);return{isFetching:i,playlists:r,user:t,setIsFetching:o,getPlaylist:async c=>{try{const u=c||t;if(!u)return;if(o(!0),n.current){n.current=!1;const d=pe(br,Q(Ys(),"in",u.liked_playlist_ids)),p=(await Hr(d)).filter(g=>!g.is_official&&g.owner_email===u.email?!0:!!g.is_public);e(p)}else await cs(100)}catch(u){console.log({message:u}),s()}finally{o(!1)}}}}function vW(){const{user:t}=ge(),{myMusicAddPlaylist:e,isFetching:n}=eA(),r=f.useRef(null),s=()=>{var o;return(o=r.current)==null?void 0:o.close()},i=async(o,l)=>{await e(o,l),s()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(ae,{onClick:()=>{var o;return(o=r.current)==null?void 0:o.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[a.jsx(Xs,{className:"w-6"}),a.jsx("span",{children:"Add new playlist"})]}),a.jsx(Ee,{ref:r,variant:"animation",children:a.jsx(Pe,{className:"w-[600px]",children:a.jsx(Qu,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function wW(){const{isFetching:t,playlists:e,getPlaylist:n}=dA();return f.useEffect(()=>{n()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Ae,{title:"Playlist"}),a.jsx(vW,{})]}),a.jsx(bl,{loading:t,playlists:e})]})})}function _W(){const{user:t}=ge(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=Tn(),{setErrorToast:s}=de(),[i,o]=f.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:o,getSinger:async()=>{try{if(!t)return;if(o(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=pe(Sf,Q(Ys(),"in",t.liked_singer_ids)),u=await Ef(c);n(u)}else await cs(100)}catch(c){console.log({message:c}),s()}finally{o(!1)}}}}function bW(){const{isFetching:t,singers:e,getSinger:n}=_W(),r=[...Array(3).keys()].map(s=>a.jsx(Ix,{variant:"skeleton"},s));return f.useEffect(()=>{n()},[]),t?a.jsxs(a.Fragment,{children:[a.jsx(ce,{className:"h-[48px] w-[160px]"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:r})]}):!t&&!e.length?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ae,{title:"Singers"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.map((s,i)=>a.jsx(Ix,{variant:"singer-item",singer:s},i))})]})})}function SW(){const[t,e]=f.useState("Favorite");return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(wW,{}),a.jsx(bW,{}),a.jsxs("div",{children:[a.jsx(Ae,{title:"Songs"}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(gs,{render:n=>n,setTab:e,tab:t,tabs:["Favorite","Uploaded"]})}),t==="Favorite"?a.jsx(gW,{}):a.jsx(yW,{})]})]}),a.jsx(vu,{})]})}const EW=()=>{const[t,e]=f.useState(),[n,r]=f.useState(""),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState(!1),[d,m]=f.useState(!1),[p,g]=f.useState(!1),[y,v]=f.useState(),_=f.useRef(0),S=f.useMemo(()=>y!==void 0?o[y]:void 0,[y,o]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:o,setLyrics:l,updateLyric:(E,R)=>{l(D=>{const F={...D[E],...R};return D[E]=F,[...D]})},isFetching:c,setIsFetching:u,isChanged:d,setIsChanged:m,start:_,selectLyricIndex:y,setSelectLyricIndex:v,currentLyric:S,isPreview:p,setIsPreview:g}},hA=f.createContext(null);function kW({children:t}){return a.jsx(hA.Provider,{value:EW(),children:t})}const Xt=()=>{const t=f.useContext(hA);if(!t)throw new Error("Edit lyric context not found");return t};function TW({audioEle:t,isClickPlay:e,song:n}){const{start:r,baseLyricArr:s,lyrics:i,setLyrics:o,setIsChanged:l,setIsFetching:c,baseLyric:u}=Xt(),{setErrorToast:d,setSuccessToast:m}=de(),p=i.length>=s.length,g=e&&!!s.length&&!p,y=()=>{if(!t||!s.length||p||!n)return;const b=+t.currentTime.toFixed(1);if(r.current===b)return;const E=s[i.length],R=h2({start:r.current,end:b,text:E});if(r.current=b,o(D=>[...D,R]),s.length===i.length+2){const D=s[s.length-1],F=h2({start:r.current,end:n.duration,text:D});o(I=>[...I,F])}l(!0)},v=()=>{if(i.length&&t){const b=i[i.length-1].start;r.current=b,t.currentTime=b,o(E=>E.slice(0,-1)),l(!0)}},_=()=>{if(!n)return;const b={song_id:n.id,base:u,lyrics:JSON.stringify(i)};rt("temp-lyric",b)};return{addLyric:y,removeLyric:v,isEnableAddBtn:g,submit:async()=>{try{if(c(!0),!n)return;const b=Ja(Te),E={lyrics:JSON.stringify(i),base:u},R=Rt(Te,"Songs",n.id);if(n.lyric_id){const D=Rt(Te,"Lyrics",n.lyric_id);b.update(D,E)}else{const D=Rt(_r(Te,"Lyrics")),F={lyric_id:D.id,updated_at:Hs()};b.set(D,E),b.update(R,F)}await b.commit(),m("Edit lyric successful"),l(!1),rt("temp-lyric","")}catch(b){console.log({error:b}),d(),_()}finally{c(!1)}}}}function IW({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=de(),{song:r,setSong:s}=Xt(),[i,o]=f.useState(),[l,c]=f.useState(!1);return{songFile:i,song:r,setSongFile:o,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{filePath:d,fileURL:m}=await Cw({file:i,folder:"/songs/",namePrefix:"beat"}),p={beat_url:m,beat_file_path:d};await Et({collectionName:"Songs",id:r.id,data:p}),r.beat_file_path&&Yn({filePath:r.beat_file_path}),s(()=>({...r,...p})),n("Upload song beat successful"),t()}catch(d){console.log({error:d}),e()}finally{c(!1)}}}}function CW({closeModal:t}){const{theme:e}=G(),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:o}=IW({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return a.jsxs(Pe,{className:"w-[500px]",children:[a.jsx(ot,{title:"Song beat",close:t}),a.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o&&(n||(o==null?void 0:o.beat_url))&&a.jsx("audio",{src:n?URL.createObjectURL(n):o.beat_url,controls:!0}),a.jsx(ae,{size:"clear",children:a.jsx("label",{htmlFor:"song_upload",className:`${e.content_bg} seld-start rounded-full px-5 py-1.5 cursor-pointer mt-2`,children:a.jsx(Uy,{className:"w-5"})})}),a.jsx(ae,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const jW=40;function RW({closeModal:t}){const{theme:e}=G(),{baseLyric:n,setBaseLyric:r,baseLyricArr:s,setIsChanged:i,lyrics:o}=Xt(),[l,c]=f.useState(n),u=f.useRef(null),d=f.useRef(null),m=()=>{const g=l.split(/\r?\n/).filter(y=>y).filter(y=>y.trim()).join(`\r
`);r(g),i(!0),t()};function p(g){const y=[...s];return y[g]=`<div style="color: transparent; border-radius: 4px; background-color: ${e.content_code}">${y[g]}</div>`,y.join(`\r
`)}return f.useEffect(()=>{if(o.length&&u.current&&d.current){const g=jW*(o.length-1);u.current.scrollTop=g,d.current.style.paddingBottom=g+"px"}},[]),f.useEffect(()=>{const g=()=>{if(u.current&&d.current){const y=u.current.scrollTop;d.current.scrollTop=y}};return u.current&&u.current.addEventListener("scroll",g),()=>{u.current&&u.current.removeEventListener("scroll",g)}},[]),a.jsxs(Pe,{className:"w-[500px]",children:[a.jsx(ot,{close:t,title:"Edit lyric"}),a.jsxs("div",{className:`relative h-[60vh] overflow-hidden rounded-md bg-${e.alpha} `,children:[a.jsx("div",{ref:d,className:"whitespace-break-spaces text-transparent px-2 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:p(o.length===s.length?o.length-1:o.length)}}),a.jsx("textarea",{style:{resize:"none"},ref:u,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full no-scrollbar",value:l,onChange:g=>c(g.target.value)})]}),a.jsx("p",{className:"ml-auto mt-5",children:a.jsx(ae,{onClick:m,color:"primary",className:"rounded-full",children:"Save"})})]})}function g2(t){const[e,n,r]=t.split(":"),[s,i]=r.split(",");return+n*60+ +s+ +i/1e3}function AW(t){const e=t.split(`
`),n=[];let r={start:0,end:0,text:"",cut:[],tune:{start:0,end:0,grow:[]}};for(let s=0;s<e.length;s++){const i=e[s].trim();if(!i){if(!r.text)continue;const o=r.text.trim(),l=o.split(" "),c=l.map(()=>[]),u=l.map(()=>0),d={text:o,tune:{start:r.start,end:r.end,grow:u},cut:c};Object.assign(r,d),n.push({...r}),r.text=""}if(isNaN(+i))if(i.includes("-->")){const[o,l]=i.split("-->").map(d=>d.trim()),c=g2(o),u=g2(l);if(isNaN(c)||isNaN(u))throw new Error(`Error at '${s}'`);Object.assign(r,{start:c,end:u})}else r.text+=i.trim()+" "}return n}function NW(){const{setErrorToast:t}=de(),{setLyrics:e,setIsChanged:n,setIsPreview:r}=Xt();return{handleInputChange:i=>{if(!i.target.files)return;const o=i.target.files[0],l=["json","srt"],c=o.name.split(".")[1],u=new FileReader;u.onload=d=>{var m,p;try{if(!((m=d.target)!=null&&m.result)||typeof d.target.result!="string")return;if(c==="json"){const g=JSON.parse(((p=d.target)==null?void 0:p.result)||"[]");e(g)}else{const g=AW(d.target.result);e(g)}n(!0),r(!0)}catch(g){console.log(g),t(g.message||"")}finally{i.target.value=""}},l.includes(c)?u.readAsText(o):(t("File not supported"),i.target.value="")}}}function PW(){const{lyrics:t,song:e}=Xt(),n=(s,i)=>{if(!e)return;const o=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=`lyric_${S6(e.name)}.${i}`,c.click(),URL.revokeObjectURL(l)};return{exportLyric:({type:s})=>{switch(s){case"json":n(JSON.stringify(t,null,2),"json");break;case"srt":{let i="";const o=l=>{const c=Math.floor(l/60),u=Math.floor(l%60),d=`${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`,[m,p="0"]=l.toString().split(".");return`00:${d},${+p*100}`};t.forEach((l,c)=>{i+=`${c+1}
${o(l.start)} --> ${o(l.end)}
${l.text}

`}),n(i,"srt");break}}}}}function FW({pause:t}){const{theme:e}=G(),{song:n,lyrics:r}=Xt(),[s,i]=f.useState(""),o=f.useRef(null),{handleInputChange:l}=NW(),{exportLyric:c}=PW(),u=p=>{var g;t(),i(p),(g=o.current)==null||g.open()},d=()=>{var p;return(p=o.current)==null?void 0:p.close()},m=()=>{if(s)switch(s){case"lyric":return a.jsx(RW,{closeModal:d});case"song-beat":return n&&a.jsx(CW,{closeModal:d});case"export":return a.jsxs(Pe,{children:[a.jsx(ot,{title:"Export",close:d}),a.jsxs("div",{className:"flex ",children:[a.jsx(ae,{color:"primary",onClick:()=>c({type:"json"}),children:"JSON"}),a.jsx(ae,{color:"primary",onClick:()=>c({type:"srt"}),className:"ml-2",children:"JRC"})]})]})}};return a.jsxs(a.Fragment,{children:[a.jsx("input",{id:"import_lyric",onChange:l,type:"file",className:"hidden"}),a.jsxs(xr,{appendOnPortal:!0,children:[a.jsx(yr,{children:a.jsx(ae,{size:"clear",className:`${e.content_bg} h-[36px] w-[36px] justify-center rounded-full mt-2`,children:a.jsx(ll,{className:"w-6"})})}),a.jsx(vr,{origin:"top right",children:a.jsx(ml,{className:"w-[140px]",children:a.jsxs(fl,{children:[a.jsxs("button",{onClick:()=>u("lyric"),children:[a.jsx(Ks,{}),a.jsx("span",{children:"Edit lyric"})]}),a.jsxs("button",{onClick:()=>u("song-beat"),children:[a.jsx(Qa,{}),a.jsx("span",{children:"Song beat"})]}),a.jsx("button",{className:"!p-0",children:a.jsxs("label",{className:"flex w-full px-3 py-2 cursor-pointer items-center space-x-2",htmlFor:"import_lyric",children:[a.jsx(_u,{}),a.jsx("span",{children:"Import"})]})}),a.jsxs("button",{disabled:!r.length,onClick:()=>u("export"),children:[a.jsx($3,{}),a.jsx("span",{children:"Export"})]})]})})})]}),a.jsx(Ee,{variant:"animation",ref:o,children:m()})]})}function DW({audioEle:t},e){const{theme:n,themeClass:r}=G(),{song:s,lyrics:i,isPreview:o,setIsPreview:l}=Xt(),c=r("rgba(0,0,0,.15)","rgba(255,255,255,.15)"),{backward:u,forward:d,handlePlayPause:m,currentTimeRef:p,durationRef:g,progressLineRef:y,pause:v,seek:_,status:S,isClickPlay:b}=Um({audioEle:t,baseColor:c}),{addLyric:E,removeLyric:R,isEnableAddBtn:D,submit:F}=TW({audioEle:t,isClickPlay:b,song:s});f.useImperativeHandle(e,()=>({seek:_,pause:v,submit:F}));const I=()=>{if(!b&&i.length){const C=i[i.length-1].end;t.currentTime=C}m()},k={button:`mt-2 ml-2 space-x-1 ${n.content_bg} rounded-full`,icon:"w-6",arrow:"before:content-[''] before:absolute before:-translate-x-1/2 before:left-[27px]  before:bottom-[calc(100%-1px)] before:z-[-1] before:border-8 before:border-transparent before:border-b-amber-800"},j=()=>{switch(S){case"error":return a.jsx(rm,{className:"w-6"});case"playing":return a.jsx(im,{className:"w-6"});case"paused":return a.jsx(Gc,{className:"w-6"});case"waiting":return a.jsx(We,{className:"w-6 animate-spin"})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2 [&_button]:outline-none",children:[a.jsx(VI,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),a.jsx(ae,{className:k.button,onClick:I,children:j()}),a.jsxs(ae,{disabled:!D||o,onClick:E,className:k.button,children:[a.jsx(ir,{className:"w-6"}),a.jsx("span",{children:"Add"})]}),a.jsxs(ae,{disabled:!i.length||o,onClick:R,className:k.button,children:[a.jsx(Ky,{className:"w-6"}),a.jsx("span",{children:"Remove"})]}),a.jsxs(ae,{onClick:()=>u(2),className:k.button,children:[a.jsx(Vy,{className:"w-6"}),a.jsx("span",{children:"2s"})]}),a.jsxs(ae,{onClick:()=>d(2),className:k.button,children:[a.jsx("span",{children:"2s"}),a.jsx(Qy,{className:"w-6"})]}),a.jsxs(ae,{disabled:!i.length,onClick:()=>{l(!o),v()},className:k.button,children:[a.jsx(TF,{className:"w-6"}),a.jsx("span",{children:o?"Edit":"Preview"})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(FW,{pause:v})})]}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:p,children:"00:00"}),a.jsx("div",{ref:y,style:{backgroundColor:c},className:"h-1 rounded-full w-full"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:g,children:"00:00"})]})]})}const LW=f.forwardRef(DW);function MW({lyric:t,openModal:e,seek:n,isLast:r,status:s,activeColor:i,isPreview:o},l){const c=()=>{switch(s){case"active":return`${i||"text-[#ffed00]"} active-lyric`;default:return""}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[a.jsx("button",{className:"text-[18px] hover:underline",onClick:()=>n(t.start),children:Br(+t.start)}),a.jsxs("p",{ref:l,className:`font-[700] select-none relative ${Ni(!o,"pr-6")} ${c()}`,children:[t.text,!o&&a.jsx("button",{onClick:e,className:" absolute mt-1 ml-1",children:a.jsx(mM,{className:"w-5"})})]}),r&&t.end!==t.start&&a.jsx("button",{className:"hover:underline pt-[10px]",onClick:()=>n(t.end),children:Br(+t.end)})]})})}const OW=f.forwardRef(MW);function $W({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"disable";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"disable"}};return a.jsx("p",{ref:s,className:`${e} transition-transform duration-[.3s] origin-left select-none font-[700] ${i()}`,children:t})}const fA=f.forwardRef($W),zd=.3;function mA({audioEle:t,lyrics:e,isActive:n}){const[r,s]=f.useState(0),i=f.useRef("instant"),o=f.useRef(0),l=f.useRef([]),c=f.useRef(0),u=()=>{if(l.current[0]===null)return;const m=t.currentTime>o.current?"forward":"backward";o.current=t.currentTime;let p=c.current;switch(m){case"forward":for(;e[p+1]&&e[p+1].start-zd<o.current+zd;)p+=1;break;case"backward":for(;e[p-1]&&e[p-1].end-zd>o.current+zd;)p-=1;break}p!==c.current&&(Math.abs(p-c.current)>5&&(i.current="instant"),c.current=p,s(p),l.current[p]&&_I(l.current[p],i.current),i.current==="instant"&&(i.current="smooth"))},d=()=>{s(0),c.current=0,o.current=0};return f.useEffect(()=>(n&&u(),()=>{n||d()}),[n]),f.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",u),()=>{t.removeEventListener("timeupdate",u)}},[e,n]),f.useEffect(()=>()=>{d()},[e]),{currentIndex:r,lyricRefs:l}}function BW(){const{lyrics:t,isPreview:e}=Xt(),n=f.useRef(null),r=f.useRef("instant");return f.useEffect(()=>{!n.current||e||(_I(n.current,r.current),r.current="instant",r.current==="instant"&&(r.current="smooth"))},[t.length,e]),f.useEffect(()=>()=>{r.current="instant"},[e]),{activeLyricRef:n}}function zW({controlRef:t,audioEle:e,openEditModal:n}){const{theme:r}=G(),{baseLyricArr:s,lyrics:i,setSelectLyricIndex:o,song:l,isPreview:c}=Xt(),{activeLyricRef:u}=BW(),{currentIndex:d,lyricRefs:m}=mA({audioEle:e,isActive:c,lyrics:i}),p=y=>{var v;(v=t.current)==null||v.seek(y)},g=y=>{var v;typeof y=="number"&&((v=t.current)==null||v.pause(),o(y),n())};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow  overflow-auto flex  no-scrollbar md:text-lg rounded-xl px-2 pt-3 mt-3 ${r.side_bar_bg} ${Ni(c,"justify-center")}`,children:[a.jsx("div",{className:`w-1/2 ${Ni(c,"hidden")}`,children:s.length?a.jsx(a.Fragment,{children:s.map((y,v)=>{let _=v===i.length?"active":v<i.length?"done":"coming";return _==="done"&&v===s.length-1&&(_="active"),a.jsx(fA,{ref:_==="active"?u:null,activeColor:r.type==="light"?r.content_text:"",className:"pt-[38px] mr-[24px]",status:_,text:y},v)})}):a.jsx("p",{children:"..."})}),a.jsx("div",{className:`w-1/2 ${Ni(c,"text-center")}`,children:!!(i!=null&&i.length)&&l&&i.map((y,v)=>{let _="coming";return c&&(d===v?_="active":v<d&&(_="done")),a.jsx(OW,{ref:S=>m.current[v]=S,openModal:()=>g(v),seek:p,isPreview:c,lyric:y,status:_,activeColor:r.type==="light"?r.content_text:"",isLast:v===i.length-1&&v!==s.length-1},v)})})]})})}function UW({audioRef:t}){const{user:e}=ge(),{baseLyric:n,setSong:r,song:s,setBaseLyricArr:i,setBaseLyric:o,setLyrics:l,isChanged:c,isFetching:u,start:d}=Xt(),[m,p]=f.useState(!0),g=f.useRef(!1),y=Gi(),v=S=>{if(!S.length)return;const b=S.length-1;if(t.current){const E=S[b].end;d.current=E}},_=async()=>{try{if(!y.id)throw new Error("");const S=await Vr({collectionName:"Songs",id:y.id});if(!S.exists())throw new Error("");const b={...S.data(),id:S.id,queue_id:""};if(b.lyric_id){const E=await Vr({collectionName:"Lyrics",id:b.lyric_id});if(E.exists()){const{base:R,lyrics:D}=E.data(),F=JSON.parse(D);o(R),l(F),v(F)}}r(b)}catch(S){console.log({message:S})}finally{p(!1)}};return f.useEffect(()=>{g.current||(g.current=!0,_())},[e]),f.useEffect(()=>{if(!n)return;const S=n.split(/\r?\n/);i(S)},[n]),f.useEffect(()=>{if(!c)return;const S=b=>{b.preventDefault()};return window.addEventListener("beforeunload",S),()=>{window.removeEventListener("beforeunload",S)}},[c]),{isFetching:m,song:s,isChanged:c,isSubmitting:u}}function pA(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const VW=["Edit","Record"];function HW(){const[t,e]=f.useState(0),[n,r]=f.useState(),[s,i]=f.useState(""),[o,l]=f.useState([[]]),[c,u]=f.useState([]),[d,m]=f.useState(!1),[p,g]=f.useState("Edit"),[y,v]=f.useState("paused"),_=f.useRef(null),S=f.useRef(null),b=f.useRef(null),E=f.useRef(null),R=f.useRef(null),D=f.useRef(null),F=f.useRef(null),I=f.useRef(null),k=f.useRef(),j=f.useRef(!1),C=f.useRef(0),N=f.useRef(0),P=f.useRef(0),A=f.useRef([]),Z=f.useRef([]),he=f.useRef(!0),te=f.useRef(!1),Se=f.useMemo(()=>s.split(" ").filter(ee=>ee.trim()),[s]),H=f.useMemo(()=>Se.map((ee,ve)=>({text:ee,positions:o[ve]})),[s,o]),Y=f.useMemo(()=>{const ee=[];return H.forEach(ve=>{const Ce=pA(ve.text,ve.positions);ee.push(...Ce)}),ee.filter(ve=>ve)},[s,o]);return{eleRefs:{endTimeRangeRef:S,overlayRef:_,startTimeRangeRef:b,startRefText:E,endRefText:R,currentWordRef:D,growInputRef:F,tempWordRef:I},tabProps:{tab:p,setTab:g,tabs:VW},eventRefs:{playWhenSpaceRef:he,moveArrowToGrowRef:te},currentWords:Se,currentWordsData:H,currentSplitWords:Y,actuallyEndRef:C,playerRef:k,actuallyStartRef:N,tempActuallyStartRef:P,wordsRatioRef:A,mergedGrowListRef:Z,isChangedRef:j,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:d,SetIsOpenEditLyricModal:m,setStatus:v,status:y,text:s,setText:i,cut:o,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const gA=f.createContext(null);function WW({children:t}){return a.jsx(gA.Provider,{value:HW(),children:t})}const Lt=()=>{const t=f.useContext(gA);if(!t)throw new Error("LyricEditorProvider not found");return t};function xA(t,e){const n=`lyric_${qu(4)}`,r=document.querySelector("style.keyframe");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(!t.length)return s+="100%{width:100%}}",r.innerText=s,n;let i=t.reduce((u,d)=>u+d,0);const o=[];let l=0,c=0;for(let u=0;u<e.length-1;u++){const d=e[u],m=t[u];c+=d,l+=m,o.push({progress:Math.round(l/i*100),width:c})}for(const u of o)s+=`${u.progress}%{width:${u.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function GW({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:o,status:l,setStatus:c}=Lt(),{play:u,pause:d,statusRef:m}=Um({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:p}=e,g=()=>{d(),p.current&&(p.current.style.animation="none")},y=()=>{if(t.currentTime=r.current,!s.current&&p.current){const S=xA(o.current,i.current);p.current.style.animation=`${S} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},v=()=>{m.current==="paused"?y():g()},_=()=>{if(+t.currentTime.toFixed(1)>=n.current)return g()};return f.useEffect(()=>{if(t)return t.addEventListener("timeupdate",_),()=>{t.removeEventListener("timeupdate",_)}},[]),{handlePlayPause:v,_pause:g,_play:y,status:l}}function qW({audioEle:t}){const{playerRef:e}=Lt(),{_play:n,_pause:r,handlePlayPause:s}=GW({audioEle:t});return f.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),a.jsx(a.Fragment,{})}function QW({audioEle:t}){const{tabProps:e}=Lt(),{theme:n}=G();return a.jsxs(a.Fragment,{children:[a.jsx(qW,{audioEle:t}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(gs,{className:"bg-white/10",...e,render:r=>r}),a.jsx(VI,{positions:"left",bg:n.content_bg,audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})}function KW(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=Xt(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:o,cut:l}=Lt();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:o};t(n,u),e(!0)}}}function XW({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=Xt(),{isChangedRef:s,playerRef:i}=Lt(),{updateLyricTune:o}=KW(),l=()=>{o(),t()},c=u=>{var d;if(typeof n=="number")switch(s.current&&(s.current=!1,o()),(d=i.current)==null||d.pause(),u){case"next":if(n===r.length-1)return;e(m=>m+1);break;case"prev":if(n===0)return;e(m=>m-1);break}};return a.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[a.jsxs(ae,{color:"primary",disabled:n===0,onClick:()=>c("prev"),className:"font-playwriteCU",children:[a.jsx(Vy,{className:"w-6"}),a.jsx("span",{children:"Previous"})]}),a.jsxs(ae,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),className:"font-playwriteCU",children:[a.jsx("span",{children:"Next"}),a.jsx(Qy,{className:"w-6"})]}),a.jsx(ae,{disabled:!s.current,color:"primary",onClick:l,className:"font-playwriteCU",children:"Ok"})]})}function YW(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=Lt(),s=o=>{var l;if(o.key===" "){if(!r.playWhenSpaceRef.current)return;o.preventDefault(),console.log("handle play pause"),(l=e.current)==null||l.handlePlayPause()}if(o.key==="ArrowRight"||o.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(o.key){case"ArrowRight":o.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":o.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=o=>{if(!r.moveArrowToGrowRef.current)return;const l=o.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(d=>d.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};f.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const yA=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function Dw(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,o)=>{const l=e[o].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((d,m)=>(s++,+(d+m).toFixed(1)),0);r.push(u)}}),r}function JW(){const{selectLyricIndex:t,currentLyric:e}=Xt(),{eleRefs:n,actuallyEndRef:r,mergedGrowListRef:s,actuallyStartRef:i,wordsRatioRef:o,setGrowList:l,setCut:c,setText:u,currentWords:d}=Lt(),{tempWordRef:m,endTimeRangeRef:p,startTimeRangeRef:g,startRefText:y,endRefText:v}=n;f.useEffect(()=>{if(!m.current)return;const _=yA(m.current);o.current=_},[d]),f.useEffect(()=>{if(!e)return;const _=e.tune.grow,S=e.text.split(" ").filter(E=>E.trim());u(e.text),c(e.cut);const b=Dw(S,e.cut,_);l(_),s.current=b,v.current&&y.current&&g.current&&p.current&&(i.current=e!=null&&e.tune?e.tune.start:e.start,y.current.innerText=`${e.start} / ${i.current}`,g.current.max=e.end+"",g.current.value=i.current+"",r.current=e!=null&&e.tune?e.tune.end:e.end,v.current.innerText=`${r.current} / ${e.end}`,p.current.max=e.end+"",p.current.value=r.current+"")},[t])}function ZW({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:o,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:d}=Lt(),[m,p]=f.useState(!1),[g,y]=f.useState([]),v=f.useRef(Date.now()),_=f.useRef(!1),S=f.useRef(!1),b=()=>{const P=+((Date.now()-v.current)/1e3).toFixed(1);y(A=>[...A,P])},E=()=>{var P;v.current=Date.now(),_.current||(_.current=!0,(P=e.current)==null||P.play(),p(!0))},R=()=>{_.current&&b()},D=P=>{P.key===" "&&(S.current||(P.preventDefault(),S.current=!0,E()))},F=P=>{P.key===" "&&(P.preventDefault(),R(),S.current=!1)},j={onPointerDown:()=>{E()},onPointerUp:()=>{R()}},C=()=>{var P;(P=e.current)==null||P.pause(),_.current=!1,y([]),p(!1)},N=()=>{n.current=!0,i(g);const P=Dw(d,o,g);c.current=P,s("Edit"),C()};return f.useEffect(()=>{g.length===u.length&&N()},[g]),f.useEffect(()=>{var P;if(r==="Record")return(P=e.current)==null||P.pause(),window.addEventListener("keydown",D),window.addEventListener("keyup",F),t.currentTime=l.current,()=>{var A;(A=e.current)==null||A.pause(),window.removeEventListener("keydown",D),window.removeEventListener("keyup",F)}},[r]),{localGrowList:g,buttonProps:j,clear:C,isRecording:m}}function eG({audioEle:t}){const{currentSplitWords:e}=Lt(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=ZW({audioEle:t});return a.jsxs(a.Fragment,{children:[a.jsx(ae,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:a.jsx(qi,{className:"w-6"})}),a.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[a.jsx("div",{className:"md:text-xl font-[700] text-center",children:e.map((o,l)=>a.jsxs("span",{className:`${l<r.length?"text-[#ffed00]":""} leading-[1]`,children:[o," "]},l))}),a.jsx("p",{className:"mt-5 text-center md:hidden",children:a.jsx(ae,{...n,color:"primary",children:"Record"})})]})]})}function tG(){const{currentLyric:t}=Xt(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:o}=Lt(),{startRefText:l,endRefText:c}=e;return{setEndPoint:g=>{if(!t)return;const y=+g.toFixed(1);n.current=!0,r.current=y,c.current&&(c.current.textContent=`${y} / ${t.end}`),i.current&&(r.current=y,s.current=y-1)},setStartPoint:g=>{if(!t)return;const y=+g.toFixed(1);n.current=!0,s.current=y,l.current&&(l.current.textContent=`${t.start} / ${y}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:g=>{n.current=!0,o(y=>{const v=[...y];let _=v[g.index];switch(g.variant){case"range":_=g.value;break;case"button":_=+(g.action==="minus"?_-.1:_+.1).toFixed(1)}return _<0&&(_=0),v[g.index]=_,v})}}}function nG(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=tG(),{currentLyric:s}=Xt(),{wordIndex:i,growList:o,eleRefs:l}=Lt();return s?a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center mt-5 space-x-2",children:[a.jsxs("label",{htmlFor:"start",className:"flex-shrink-0 w-[150px]",children:["Start: ",a.jsx("span",{ref:l.startRefText})]}),a.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),a.jsxs("div",{className:"flex items-center mt-3 space-x-2",children:[a.jsxs("label",{htmlFor:"end",className:"flex-shrink-0 w-[150px]",children:["End: ",a.jsx("span",{ref:l.endRefText})]}),a.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsxs("label",{htmlFor:"grow",className:"flex-shrink-0 w-[150px] mr-2 leading-[1]",children:["Grow: ",o[i]]}),a.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:10,step:.1,className:"w-full",value:o[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):a.jsx(a.Fragment,{})}function rG(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:o}=Lt(),[l,c]=f.useState(!1),u=f.useRef(null),d=()=>{if(!u.current)return;const m=u.current.value.split(/\r?\n/).filter(y=>y).map(y=>y.trim()).join(" ").split(" ").filter(y=>y).join(" ");n(m);const p=m.split(" ").map(()=>0),g=m.split(" ").map(()=>[]);s(g),i(p),r.current=p,c(!1)};return f.useEffect(()=>{l?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,u.current&&(u.current.value=o)):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[l]),a.jsxs("div",{className:"mt-3 relative pt-5",children:[a.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:l?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>c(!1),children:a.jsx(qi,{className:"w-5"})}),a.jsx("button",{onClick:d,children:a.jsx(bu,{className:"w-5"})})]}):a.jsx("button",{onClick:()=>c(!0),children:a.jsx(Ks,{className:"w-5"})})}),a.jsx("div",{className:"flex justify-center",children:l?a.jsx("textarea",{ref:u,className:`${cv} w-full mt-3 bg-white/10`}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[o,a.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[#ffed00] whitespace-nowrap w-0",children:o})]})})})]})}function sG({text:t,openModal:e,isShowScissor:n,index:r}){const{theme:s}=G(),{growList:i,setWordIndex:o,wordIndex:l,eventRefs:c,eleRefs:u}=Lt(),d=l===r,m=()=>{var p;r!==-1&&(o(r),c.moveArrowToGrowRef.current=!0,(p=u.growInputRef.current)==null||p.focus())};return a.jsxs("div",{ref:p=>d?u.currentWordRef.current=p:{},style:{flexGrow:i[r]!==0?i[r]:.05},onClick:m,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center border ${s.content_border} ${d?s.content_bg:"bg-"+s.alpha}`,children:[a.jsx("span",{children:t}),n&&d&&a.jsx(ae,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-black/10 p-1.5",children:a.jsx(WT,{className:"w-5"})})]})}function iG({wordData:t,wordIndex:e,closeModal:n}){const{theme:r}=G(),{currentLyric:s,selectLyricIndex:i}=Xt(),{setCut:o,cut:l}=Lt(),[c,u]=f.useState(t.positions),d=f.useMemo(()=>pA(t.text,c).filter(y=>y),[c]),m=f.useMemo(()=>t.text.split(""),[]),p=y=>{const v=[...c],_=c.findIndex(S=>S===y);_===-1?v.push(y):v.splice(_,1),u(v)},g=()=>{if(!s||i===void 0)return;const y=c.sort((_,S)=>_-S),v=[...l];v[e]=y,o(v),n()};return a.jsxs(Pe,{className:"w-[500px]",children:[a.jsx(Ae,{title:"Split word "}),a.jsx("div",{className:"flex justify-center space-x-5",children:d.map((y,v)=>a.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:y},v))}),a.jsx("div",{className:"mt-3 flex justify-center",children:m.map((y,v)=>{const _=c.includes(v);return a.jsxs("div",{children:[m.length>1&&v?a.jsx("button",{onClick:()=>p(v),className:` p-1 rounded-full ${_?r.content_bg:"hover:bg-black/10"}`,children:a.jsx(WT,{className:"w-5"})}):"",a.jsx("span",{className:"text-[50px] font-[500]",children:y})]},v)})}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(ae,{onClick:g,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function aG(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=Lt(),[r,s]=f.useState(),i=f.useRef(null),o=f.useMemo(()=>{const u={},d=e.map(p=>p.positions.length);let m=0;return d.forEach((p,g)=>{p===0?(u[m]=g,m++):p>0&&[...Array(p+1).keys()].forEach(()=>{u[m]=g,m++})}),u},[e]),l=f.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var d;s(u),(d=i.current)==null||d.open()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex h-[44px] mt-5",children:t.map((u,d)=>{const m=o[d],p=n[m];return a.jsx(sG,{isShowScissor:p?p.length>1:!1,index:d,openModal:()=>c(m),text:u},d)})}),a.jsx(Ee,{variant:"animation",ref:i,children:l&&r!==void 0&&a.jsx(iG,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function oG(){const{status:t,playerRef:e}=Lt();return a.jsx(ae,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?a.jsx(im,{className:"w-6"}):a.jsx(Gc,{className:"w-6"})})}function lG(){const{eventRefs:t,tabProps:{tab:e}}=Lt();f.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function cG({closeModal:t}){const{song:e}=Xt(),{eleRefs:n,currentWords:r,tabProps:s}=Lt();YW(),JW(),lG();const i=f.useRef(null);return a.jsx(a.Fragment,{children:a.jsxs(Pe,{className:"w-[800px]",children:[a.jsx(ot,{title:"Edit lyric",close:t}),a.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),a.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((o,l)=>a.jsxs("span",{children:[o,a.jsx("span",{children:" "})]},l))}),i.current&&a.jsx(QW,{audioEle:i.current}),a.jsxs("div",{className:"mt-5",children:[i.current&&a.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:a.jsx(eG,{audioEle:i.current})}),a.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[a.jsx(oG,{}),a.jsx(nG,{}),a.jsx(rG,{}),a.jsx(aG,{})]})]}),a.jsx(XW,{closeModal:t})]})})}function uG(t){return a.jsx(WW,{children:a.jsx(cG,{...t})})}function dG({children:t}){const{theme:e}=G(),[n,r]=f.useState(""),s=f.useRef(null),i=f.useRef(null),o=f.useRef(null),{isFetching:l,song:c,isChanged:u,isSubmitting:d}=UW({audioRef:i}),m=()=>{var y,v;(y=s.current)==null||y.pause(),(v=s.current)==null||v.submit()},p=y=>{var v;r(y),(v=o.current)==null||v.open()},g=()=>{var y;return(y=o.current)==null?void 0:y.close()};return a.jsxs(a.Fragment,{children:[a.jsx("audio",{className:"hidden",ref:i,src:c==null?void 0:c.song_url}),l?a.jsx(qt,{children:a.jsx(We,{className:"w-6 animate-spin"})}):c&&a.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden",children:[t,a.jsx(Ae,{title:` Edit lyric - ${c==null?void 0:c.name}`}),a.jsx("div",{className:"mt-3",children:i.current&&a.jsxs(a.Fragment,{children:[a.jsx(LW,{audioEle:i.current,ref:s}),a.jsx(Ee,{persisted:!0,variant:"animation",ref:o,children:n==="edit-lyric"&&a.jsx(uG,{closeModal:g})})]})}),i.current&&a.jsx(zW,{controlRef:s,audioEle:i.current,openEditModal:()=>{p("edit-lyric")}}),a.jsx(ae,{className:`${e.content_bg} font-playwriteCU self-end md:self-start rounded-full mt-5 `,variant:"primary",disabled:!u,isLoading:d,onClick:m,children:"Save"})]})]})}function vA(){return a.jsx(kW,{children:a.jsx(dG,{})})}function hG(){return a.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full md:pb-4",children:[a.jsx(Xm,{className:"mb-1 self-start"}),a.jsx(vA,{})]})}const fG=["Song","Playlist","Singer","User"],mG={songs:[],playlists:[],singers:[],users:[]};function pG(){const[t,e]=f.useState(!1),[n,r]=f.useState("Song"),s=PT(),[i,o]=f.useState(mG),l=u=>{o(d=>({...d,...u}))},c=async()=>{try{const u=s[0].get("q");if(!u)return;switch(n){case"Song":{const d=pe(bn,Q("is_official","==",!0),Q("name",">=",u),Q("name","<=",u+"")),m=await Sn(d);l({songs:m});break}case"Playlist":{const d=pe(br,Q("is_public","==",!0),Q("name",">=",u),Q("name","<=",u+"")),m=await Hr(d);l({playlists:m});break}case"Singer":{const d=pe(Sf,Q("name",">=",u),Q("name","<=",u+"")),m=await Ef(d);l({singers:m});break}case"User":{const d=pe(nH,Q("display_name",">=",u),Q("display_name","<=",u+"")),m=await fH(d);console.log(m),l({users:m});break}}}catch(u){console.log({message:u})}finally{e(!1)}};return f.useEffect(()=>(c(),()=>{e(!0)}),[s[0].get("q"),n]),f.useEffect(()=>()=>{r("Song")},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:c,result:i,tabs:fG}}function gG(){const[t,e]=f.useState(""),[n,r]=f.useState(!1),[s,i]=f.useState(!1),[o,l]=f.useState([]),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),m=f.useRef(!0),p=PT(),g=HR(t,700),y=new AbortController,v=_=>{const S=document.querySelector(".popup-content"),b=_.target,E=document.querySelectorAll(".modal-content");let R=!1;E.forEach(D=>D.contains(b)?R=!0:{}),!(c.current&&u.current&&(c.current.contains(b)||R||u.current.contains(b)||S!=null&&S.contains(b)))&&i(!1)};return f.useEffect(()=>{if(!g.trim()){r(!1),l([]);return}const _=async()=>{try{r(!0);const S=pe(bn,Q("is_official","==",!0),Q("name",">=",t),Q("name","<=",t+"")),b=await Sn(S);l(b)}catch(S){console.log(S)}finally{r(!1)}};return m.current?_():m.current=!0,()=>{console.log("abort"),y.abort()}},[g]),f.useEffect(()=>(s&&document.addEventListener("click",v),()=>{document.removeEventListener("click",v)}),[s]),f.useEffect(()=>(e(p[0].get("q")||""),()=>{var _;m.current=!1,(_=d.current)==null||_.blur(),i(!1)}),[p[0].get("q")]),f.useEffect(()=>{p[0].get("q")!==t&&s&&(m.current=!0)},[t,s]),{isFetching:n,searchResult:o,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:c,searchResultRef:u,inputRef:d}}function xG({songs:t}){const{handleSetSong:e}=Js({variant:"search-bar"}),{getRecommend:n}=Pw(),r=s=>{e(s.queue_id,[s]),n(s)};return a.jsx(ms,{children:t.length?a.jsx(ei,{isHasCheckBox:!1,setSong:r,songs:t}):a.jsx(Ye,{})})}function yG(){const t={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion keyword"}),a.jsx("div",{className:t.listWrapper,children:a.jsxs(we,{to:"/search?q=nhac-tet",children:[a.jsx($T,{className:"w-5"}),a.jsx("span",{children:"Nhac tet"})]})})]})}function wA(){const{theme:t}=G(),e=Dt(),{isFetching:n,inputRef:r,formRef:s,searchResultRef:i,value:o,searchResult:l,setIsFocus:c,isFocus:u,setValue:d}=gG(),m={container:`relative h-[40px] flex px-3 w-full md:w-[300px] ${t.text_color} shadow-md`,unFocusContainer:`bg-${t.alpha} rounded-[20px]`,focusedContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} rounded-[20px_20px_0_0]`,input:`bg-transparent outline-none  w-full ${t.type==="light"?"placeholder:text-black":"placeholder:text-white"}`,searchResultContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] overflow-hidden flex flex-col`},p=async g=>{g.preventDefault(),e(`/search?q=${o}`),c(!1)};return a.jsx(a.Fragment,{children:a.jsxs("form",{ref:s,onSubmit:p,className:`${m.container} ${u?m.focusedContainer:m.unFocusContainer}`,children:[a.jsx("button",{className:"mr-2",children:a.jsx(sm,{className:"w-6"})}),a.jsx("input",{ref:r,value:o,onFocus:()=>c(!0),onChange:g=>d(g.target.value.trim()),placeholder:"Nhac tet...",className:m.input,type:"text"}),a.jsx("button",{type:"button",onClick:()=>d(""),className:`${o?"opacity-100":"!opacity-0"} ${Qc(!o)}`,children:n?a.jsx(We,{className:"w-5 animate-spin"}):a.jsx(qi,{className:"w-5"})}),a.jsx("div",{ref:i,className:`${Kc(!u)} ${m.searchResultContainer}`,children:l.length?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion results"}),a.jsx("div",{className:"overflow-auto no-scrollbar",children:a.jsx(xG,{songs:l})})]}):a.jsx(yG,{})})]})})}function vG(){const{isFetching:t,result:e,tab:n,setTab:r,tabs:s}=pG(),{handleSetSong:i}=Js({variant:"search-bar"}),{getRecommend:o}=Pw(),l=d=>{i(d.queue_id,[d]),o(d)},c=()=>{switch(n){case"Song":return pl;case"Playlist":return a.jsx("div",{className:"flex",children:lv})}},u=()=>{switch(n){case"Song":return e.songs.length?a.jsx(ei,{setSong:l,songs:e.songs}):a.jsx(Ye,{className:"mx-auto"});case"Playlist":return e.playlists.length?a.jsx(bl,{loading:!1,playlists:e.playlists}):a.jsx(Ye,{className:"mx-auto"});case"Singer":return e.singers.length?a.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.singers.map((d,m)=>a.jsx(Ix,{variant:"singer-item",singer:d},m))}):a.jsx(Ye,{className:"mx-auto"});case"User":return e.users.length?a.jsx("div",{children:e.users.map(d=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"w-[46px] h-[46px] rounded-full overflow-hidden",children:a.jsx(Je,{src:d.photo_url})}),a.jsx(we,{to:`/user/${d.email}`,className:"font-semibold mt-3 md:mt-0 md:ml-3",children:d.display_name})]},d.email))}):a.jsx(Ye,{className:"mx-auto"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden",children:a.jsx(wA,{})}),a.jsx(Ae,{title:"Result",className:"mt-1 md:mt-0"}),a.jsx(gs,{className:"w-fit [&_button]:text-sm md:[&_button]:text-base",tabs:s,render:d=>d,tab:n,setTab:r}),a.jsx(ms,{children:a.jsxs("div",{className:"mt-5",children:[t&&c(),!t&&u()]})})]})}function wG(){const{theme:t}=G();return a.jsxs(qt,{children:[a.jsx("h1",{className:`text-[30px] font-bold ${t.text_color}`,children:"Page Not found"}),a.jsx("p",{className:"text-center",children:a.jsx(we,{to:"/",className:`${t.content_bg} inline-block mt-5 text-center rounded-full px-5 py-1.5 cursor-pointer`,children:"Go home"})})]})}function _G(){const{theme:t}=G(),e=Dt(),n=async()=>{await SC(Oa),e("/login")};return a.jsxs("div",{className:`${t.container} flex flex-col justify-center items-center min-h-screen`,children:[a.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.text_color}`,children:"Unauthorized"}),a.jsx(ae,{onClick:n,variant:"primary",className:`${t.content_bg} font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]`,children:"Exit"})]})}function bG(){const[t]=Ev(Oa),{theme:e}=G(),{action:n}=Qm(),r=Dt(),s=async()=>{try{await n("login")}catch(i){console.log(i)}};return f.useEffect(()=>{if(t){r("/");return}},[]),a.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${e.container} ${e.text_color}`,children:[a.jsx(ae,{onClick:s,variant:"default",className:`${e.content_bg} font-bold text-[#fff] text-[30px] rounded-full`,children:"Login with google"})," "]})}function SG(){const[t,e]=f.useState(),[n,r]=f.useState(!0),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:o,albums:c,setAlbums:u,setPlaylists:l}}const _A=f.createContext(null);function EG({children:t}){return a.jsx(_A.Provider,{value:SG(),children:t})}function ni(){const t=f.useContext(_A);if(!t)throw new Error("SingerProvider not provided");return t}let kG="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",TG=(t=21)=>{let e="",n=t|0;for(;n--;)e+=kG[Math.random()*64|0];return e};function IG(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:o}=ni(),{setErrorToast:l}=de(),c=Gi(),u=f.useRef(!1),d=async()=>{try{if(!c.id)return;const m=await Vr({collectionName:"Singers",id:c.id});if(!m.exists())return;const p={...m.data(),id:c.id},g=pe(bn,Q(`singer_map.${p.id}`,"==",!0)),y=await Sn(g,{getQueueId:()=>TG(4)+"_"+p.id}),v=pe(br,Q(`singer_map.${p.id}`,"==",!0)),_=await Hr(v),S=[],b=[];_.forEach(E=>E.is_album?b.push(E):S.push(E)),s(y),e(p),o(S),n(b)}catch(m){console.log({error:m}),l()}finally{t(!1)}};return f.useEffect(()=>{u.current||(u.current=!0,d())},[]),{singer:i,isFetching:r}}function Ig({onClick:t,children:e}){const{songs:n}=ni();return a.jsx(ae,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function CG(){const{songs:t,singer:e}=ni(),{playStatus:n}=re(In),{currentSongData:r}=re(ze),{handleSetSong:s}=Js({variant:"playlist"}),{handlePlayPause:i}=ti(),o=()=>{const l=t[0];s(l.queue_id,t)};if(e&&r!=null&&r.song.queue_id.includes(e.id))switch(n){case"loading":case"paused":return a.jsx(Ig,{onClick:i,children:a.jsx(Xc,{className:"w-7"})});default:return a.jsx(Ig,{onClick:i,children:a.jsx(ov,{className:"w-7"})})}else return a.jsx(Ig,{onClick:o,children:a.jsx(Xc,{className:"w-7"})})}function jG(){const{user:t,updateUserData:e}=ge(),{setSingers:n}=Tn(),[r,s]=f.useState(!1);return{likeSinger:async({singer:o})=>{try{if(s(!0),!t)return;const l=Ja(Te),c=Rt(Te,"Users",t.email),u=Rt(Te,"Singers",o.id),d=[...t.liked_singer_ids],m=d.findIndex(v=>v===o.id),p=m===-1;p?d.unshift(o.id):d.splice(m,1);const g={liked_singer_ids:d},y={like:lu(p?1:-1)};l.update(c,g),l.update(u,y),await l.commit(),n(p?v=>[o,...v]:v=>v.filter(_=>_.id!==o.id)),e(g)}catch(l){console.log({error:l})}finally{s(!1)}},isFetching:r,user:t}}function RG(){const{theme:t}=G(),{singer:e}=ni(),{likeSinger:n,isFetching:r,user:s}=jG(),i=f.useMemo(()=>s&&e?s.liked_singer_ids.includes(e.id):!1,[s]);return e?a.jsx("button",{onClick:()=>n({singer:e}),className:`rounded-full p-2  ${i?t.content_bg:"bg-"+t.alpha}`,children:r?a.jsx(We,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:i?a.jsx(hl,{className:"w-5"}):a.jsx(Su,{className:"w-5"})})}):a.jsx(a.Fragment,{})}function AG(){const{theme:t}=G(),[e,n]=f.useState(""),r=f.useRef(null),{singer:s}=ni(),i=o=>{var l;n(o),(l=r.current)==null||l.open()};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>i("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),a.jsx("div",{className:"!mt-auto",children:a.jsxs("div",{className:"space-x-2 flex items-end",children:[a.jsx(CG,{}),a.jsx(RG,{}),a.jsxs(xr,{children:[a.jsx(yr,{children:a.jsx("button",{className:`p-2 bg-${t.alpha} hover:brightness-95 rounded-full`,children:a.jsx(ll,{className:"w-5"})})}),a.jsx(vr,{children:a.jsx(ml,{className:"w-[140px]",children:a.jsx(fl,{children:a.jsx(Ew,{})})})})]})]})}),e&&a.jsx(Ee,{ref:r,variant:"animation",children:e==="more"&&s&&a.jsx(Pe,{children:s.description})})]})}function NG(){const{theme:t}=G(),{isFetching:e,singer:n}=ni();return!e&&!n?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:`md:flex bg-transparent relative z-0 pb-5 md:p-10 ${t.text_color} `,children:[a.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:a.jsxs("div",{className:"relative h-full w-full",children:[a.jsx("div",{className:`absolute z-[-5] inset-0 ${t.type==="light"?"bg-white/50":"bg-black/50"}  `}),a.jsx("img",{src:(n==null?void 0:n.image_url)||zI,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),a.jsx("div",{className:"w-[70%] z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:e?a.jsx(ce,{className:"pt-[100%] "}):a.jsx(ju,{children:a.jsx(Je,{src:n==null?void 0:n.image_url,blurHashEncode:n==null?void 0:n.blurhash_encode})})}),a.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?a.jsxs(a.Fragment,{children:[a.jsx(ce,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(ce,{className:"h-[24px] w-[200px]"}),a.jsx(ce,{className:"h-[120px] w-full md:w-[100%]"})]}):n&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:n.name}),a.jsxs("p",{children:[a.jsx("span",{className:"text-red-500",children:"❤ "}),Sr(n.like)]}),a.jsx("p",{className:"line-clamp-2",children:n.description}),a.jsx(AG,{})]})})]})})}function PG(){const{handleSetSong:t}=Js({variant:"songs"}),{isFetching:e,songs:n}=ni();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ae,{title:"Popular Songs"}),a.jsx(ms,{children:e?pl:a.jsx(ei,{songs:n,setSong:r=>t(r.queue_id,[r])})})]})})}function FG(){const{isFetching:t,playlists:e}=ni();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ae,{title:"Popular Playlists"}),a.jsx(bl,{playlists:e,loading:t})]})})}function DG(){const{albums:t,isFetching:e}=ni();return a.jsxs(a.Fragment,{children:[a.jsx(Ae,{title:"Albums"}),a.jsx(bl,{playlists:t,loading:e})]})}function LG(){const{isFetching:t,singer:e}=IG();return!t&&!e?a.jsx(qt,{children:a.jsx(Ye,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(Xm,{}),a.jsx(NG,{}),a.jsx(PG,{}),a.jsx(DG,{}),a.jsx(FG,{})]}),a.jsx(vu,{})]})}function MG(){return a.jsx(EG,{children:a.jsx(LG,{})})}function OG(){const[t,e]=f.useState(),[n,r]=f.useState([]),[s,i]=f.useState(!0),{setErrorToast:o}=de(),l=Gi(),c=f.useRef(!1),u=async()=>{try{if(!l.id)return;const d=await Vr({collectionName:"Users",id:l.id});if(!d.exists())return;const m={...d.data()},p=pe(br,Q("owner_email","==",m.email),Q("is_public","==",!0),Q("is_official","==",!1)),g=await Hr(p),y=[],v=[];g.forEach(_=>_.is_album?v.push(_):y.push(_)),r(y),e(m)}catch(d){console.log({error:d}),o()}finally{i(!1)}};return f.useEffect(()=>{c.current||(c.current=!0,u())},[]),{user:t,playlists:n,isFetching:s}}function $G(){const{playlists:t,isFetching:e,user:n}=OG();return!e&&!n?a.jsx(qt,{children:a.jsx(Ye,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5",children:a.jsx(Xm,{})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex flex-col md:flex-row items-center",children:[e?a.jsx(ce,{className:"w-[100px] h-[100px] rounded-full"}):n&&a.jsx("div",{className:"w-[100px] h-[100px] rounded-full overflow-hidden",children:a.jsx(Je,{src:n.photo_url})}),a.jsx("div",{className:"text-center mt-3 md:mt-0 md:ml-3 md:text-left ",children:e?a.jsxs(a.Fragment,{children:[a.jsx(ce,{className:"w-[300px] h-[30px]"}),a.jsx(ce,{className:"w-[200px] h-[22px] mt-1"})]}):n&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-semibold text-2xl",children:n.display_name}),a.jsxs("p",{className:"text-[#666]",children:["Last seen: ",aA(n.last_seen)]})]})})]}),a.jsxs("div",{children:[a.jsx(Ae,{title:"Playlists"}),a.jsx(bl,{loading:e,playlists:t})]})]}),a.jsx(vu,{})]})}function BG(){return a.jsx(a.Fragment,{children:a.jsx("div",{className:"",children:a.jsx("p",{children:"This is dashboard page"})})})}const zG=["All","Result"];function UG(){const{uploadedSongs:t,setUploadedSongs:e}=Tn(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=de(),u=async m=>{try{m.preventDefault(),i(!0);const p=_r(Te,"Songs"),g=pe(p,Q("name",">=",n),Q("name","<=",n+""),Q("is_official","==",!0)),y=await Sn(g);e(y),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=_r(Te,"Songs"),p=pe(m,Q("is_official","==",!0),Ur("updated_at","desc")),g=await Sn(p);e(g)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,uploadedSongs:t,tab:o,setTab:l,tabs:zG}}const x2=wu("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[#5a9e87] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function VG({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:o,type:l="button",variant:c,disabled:u,rounded:d,className:m,active:p,href:g},y){const v=u||e,_="before:shadow-none translate-y-[2px]";return a.jsx(a.Fragment,{children:g?a.jsx(we,{to:g,className:`${x2({variant:c,size:s,color:i,fontWeight:o,rounded:d,border:r,className:m})} ${p?_:""}`,children:n}):a.jsx("button",{ref:y,type:l||"button",onClick:t,disabled:v,className:`${x2({variant:c,size:s,color:p?"primary":i,border:r,fontWeight:o,className:m})} ${p?_:""}`,children:e?a.jsx(We,{className:"w-6 animate-spin"}):n})})}const ue=f.forwardRef(VG),HG=wu("border-[2px] p-3 border-b-[6px] rounded-[14px]",{variants:{colors:{primary:"bg-white border-[#e1e1e1]",second:"bg-[#cee9b6] border-[#4a826f]",third:"bg-white border-[#4a826f]",clear:""}},defaultVariants:{colors:"primary"}});function wn({children:t,onClick:e,colors:n,className:r=""}){return a.jsx("div",{onClick:()=>e?e():{},className:`${HG({colors:n,className:r})} `,children:t})}function Ku({className:t=""}){return a.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:a.jsx(We,{className:"w-6 animate-spin"})})}function Sl({children:t,className:e=""}){const n=`mt-2 ml-2 flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${e}`;return a.jsx("div",{className:n,children:t})}function WG({children:t,...e},n){return a.jsx(Ee,{variant:"animation",...e,ref:n,children:t})}const El=f.forwardRef(WG);function Ym({children:t}){return a.jsx("div",{className:"-ml-2 -mt-2 flex flex-wrap [&_button]:mt-2 [&_button]:ml-2 [&_button:not(.except)]:p-1.5 [&_svg]:w-5 [&_svg]:flex-shrink-0 md:[&_button:not(.except)]:px-3 ",children:t})}function kl({handleSubmit:t,setValue:e,value:n,className:r="",inputRef:s}){const i=o=>{o.preventDefault(),n.trim()&&t(o)};return a.jsx(wn,{className:r,children:a.jsxs("form",{onSubmit:i,className:"flex gap-2 justify-between items-center",children:[a.jsxs("div",{className:"relative flex-grow flex items-center text-[#333]",children:[a.jsx(Gt,{type:"text",ref:s,value:n,onChange:o=>e(o.target.value),placeholder:"..."}),n&&a.jsx("button",{type:"button",onClick:()=>{e("")},className:"absolute right-3",children:a.jsx(qi,{className:"w-6"})})]}),a.jsx(ue,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:a.jsx(sm,{className:"w-6"})})]})})}function GG(){const[t,e]=f.useState(),[n,r]=f.useState(),[s,i]=f.useState([]);return{imageFile:n,setImageFile:r,playlist:t,setPlaylist:e,songs:s,setSongs:i,updatePlaylistData:l=>{t&&e({...t,...l})}}}const bA=f.createContext(null);function qG({children:t}){return a.jsx(bA.Provider,{value:GG(),children:t})}const Lw=()=>{const t=f.useContext(bA);if(!t)throw new Error("PlaylistProvider not provided");return t};function Jm(){const{user:t}=ge(),{playlist:e,songs:n,setSongs:r,updatePlaylistData:s}=Lw(),[i,o]=f.useState(!1),l=Dt(),{setErrorToast:c,setSuccessToast:u}=de(),d=async(p,g)=>{const y={};p.forEach(_=>y[_.id]=!0);const v={singers:p,singer_map:y};await Et({collectionName:"Playlists",id:g,data:v}),s(v)};return{isFetching:i,action:async p=>{try{if(!t)throw new Error("User not found");if(!e)throw new Error("playlist not found");switch(o(!0),p.variant){case"delete-playlist":{const g=Ja(Te),y=Rt(Te,"Playlists",e.id),v=await Er(pe(Gu,Q("target_id","==",e.id)));g.delete(y),v.empty||(console.log(`Delete ${v.docs.length} comments`),v.forEach(_=>g.delete(_.ref))),await Promise.all([g.commit(),e.image_file_path?Yn({filePath:e.image_file_path}):()=>{}]),l("/dashboard/playlist");break}case"add-songs":{const g=[...n,...p.songs],v={song_ids:g.map(_=>_.id)};await Et({collectionName:"Playlists",id:e.id,data:v,msg:">>> api: update playlist doc"}),s(v),r(g),u("Songs added");break}case"edit-playlist":{const g={...e,...p.playlist};if(p.imageFile){const y=await Yi({imageFile:p.imageFile});e.image_file_path&&await Yn({filePath:e.image_file_path}),Object.assign(g,y)}await Et({collectionName:"Playlists",data:g,id:e.id,msg:">>> api: set playlist doc"}),s(g),u("Playlist edited");break}case"remove-song":{const g=n.filter(v=>v.id!==p.song.id),y={song_ids:g.map(v=>v.id)};await Et({collectionName:"Playlists",id:e.id,data:y,msg:">>> api: update playlist doc"}),r(g),u(`'${p.song.name}' removed`);break}case"update-image":{const g={image_url:p.song.image_url,blurhash_encode:p.song.blurhash_encode,image_file_path:""};e.image_file_path&&await Yn({filePath:e.image_file_path}),await Et({collectionName:"Playlists",data:g,id:e.id,msg:">>> api: set playlist doc"}),s(g),u("Playlist edited;");break}case"remove-singer":{const g=e.singers.filter(y=>y.id!==p.singer.id);d(g,e.id),u("Singer removed");break}case"add-singer":{const g=[...e.singers];if(g.find(v=>v.id===p.singer.id))return;g.push(p.singer),d(g,e.id),u("Singer added");break}}}catch(g){console.log({message:g}),c("")}finally{o(!1)}},playlist:e}}function QG({song:t}){const{action:e,isFetching:n,playlist:r}=Jm(),s=f.useRef(null),i={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},o=()=>{var c;(c=s.current)==null||c.open()},l=async c=>{var u;switch(c.variant){case"remove-song":await e({variant:"remove-song",song:c.song});break;case"update-image":await e({variant:"update-image",song:c.song});break;case"add-singer":await e({variant:"add-singer",singer:c.singer}),(u=s.current)==null||u.close()}close()};return a.jsxs(a.Fragment,{children:[a.jsxs(SA,{song:t,children:[a.jsxs("button",{onClick:()=>l({variant:"remove-song",song:t}),children:[a.jsx(Ln,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsxs("button",{onClick:o,children:[a.jsx(ir,{className:"w-5"}),a.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&a.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>l({variant:"update-image",song:t}),children:[a.jsx(cl,{className:"w-5"}),a.jsx("span",{children:"Set playlist image"})]}),n&&a.jsx("div",{className:i.overlay,children:a.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),a.jsx(El,{ref:s,children:a.jsxs(Pe,{children:[a.jsx(Ae,{title:"Singers"}),a.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map((c,u)=>a.jsx("button",{onClick:()=>l({variant:"add-singer",singer:c}),children:c.name},u))})]})})]})}function KG(){const{setUploadedSongs:t,uploadedSongs:e}=Tn(),[n,r]=f.useState(!1),{setSuccessToast:s,setErrorToast:i}=de();return{actions:async l=>{try{r(!0);const c=Ja(Te),u=Rt(Te,"Songs",l.song.id),d=await Er(pe(Gu,Q("target_id","==",l.song.id)));switch(l.variant){case"delete":{const m=e.filter(p=>p.id!==l.song.id);if(c.delete(u),l.song.lyric_id){const p=Rt(Te,"Lyrics",l.song.lyric_id);c.delete(p)}d.empty||(console.log(`Delete ${d.docs.length} comments`),d.forEach(p=>c.delete(p.ref))),await Promise.all([c.commit(),WR(l.song)]),t(m),s(`'${l.song.name}' deleted`);break}}}catch(c){console.log({message:c}),i()}finally{r(!1)}},isFetching:n}}function XG({song:t}){const{actions:e,isFetching:n}=KG(),[r,s]=f.useState(""),i=f.useRef(null),o=()=>{var d;return(d=i.current)==null?void 0:d.close()},l=d=>{var m;s(d),(m=i.current)==null||m.open()},c=async d=>{switch(d.variant){case"delete":await e({variant:"delete",song:t})}o()},u=()=>{switch(r){case"":return a.jsx(a.Fragment,{});case"edit":case"delete":return a.jsx(ps,{loading:n,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",callback:()=>c({variant:"delete",song:t}),close:o})}};return a.jsxs(a.Fragment,{children:[a.jsxs(SA,{song:t,children:[a.jsxs(we,{to:`/dashboard/lyric/${t.id}`,children:[a.jsx(qy,{className:"w-5"}),a.jsx("span",{children:"Lyric"})]}),a.jsxs("button",{onClick:()=>l("delete"),children:[a.jsx(Ln,{className:"w-5"}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(Ee,{ref:i,variant:"animation",children:u()})]})}function YG({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-2 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:a.jsx(Je,{className:"object-cover h-full",src:t.image_url})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function SA({song:t,children:e}){return a.jsx(a.Fragment,{children:a.jsx(vr,{className:"w-[260px]",children:a.jsxs(ml,{children:[a.jsx(YG,{song:t}),a.jsx(fl,{children:e})]})})})}function JG({song:t,variant:e}){const n=()=>{switch(e){case"songs":return a.jsx(XG,{song:t});case"playlist":return a.jsx(QG,{song:t})}};return a.jsx(a.Fragment,{children:a.jsxs(xr,{appendOnPortal:!0,children:[a.jsx(yr,{children:a.jsx(ue,{size:"clear",color:"second",className:"p-1",children:a.jsx(ll,{className:"w-5"})})}),n()]})})}function EA({song:t,className:e="",variant:n}){return a.jsxs("tr",{className:e,children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),a.jsx("td",{children:t.singers.map((r,s)=>a.jsxs(we,{className:"hover:underline",to:`/dashboard/singer/${r.id}`,children:[!!s&&", ",r.name]},s))}),a.jsx("td",{children:Sr(t.like)}),a.jsx("td",{children:a.jsx(JG,{variant:n,song:t})})]})}function kA({value:t,setValue:e,inputRef:n}){return a.jsxs(wn,{className:"flex gap-2 justify-between items-center",children:[a.jsx(Gt,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),a.jsx(ue,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?a.jsx(qi,{className:"w-6"}):a.jsx(sm,{className:"w-6"})})]})}function Ji({className:t="",children:e,...n}){return a.jsx(wn,{children:a.jsx("div",{className:"rounded-md overflow-hidden",children:a.jsx(UI,{className:`[&_td]:text-sm hover:[&_tr]:bg-black/5 [&_tbody_tr]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 ${t}`,...n,children:e})})})}function ZG(){const{isFetching:t,uploadedSongs:e,tabs:n,setTab:r,tab:s,...i}=UG();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{title:"Songs"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(kl,{...i}),a.jsxs(ue,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[a.jsx(Xs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(gs,{disable:s==="All",tabs:n,render:o=>o,tab:s,setTab:r})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(ce,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(Ji,{colList:["Name","Singer","Like"],children:e.length?e.map((o,l)=>a.jsx(EA,{variant:"songs",song:o},l)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"text-center",children:a.jsx(Ye,{})})})})]})]})}function eq(){const[t,e]=f.useState(),[n,r]=f.useState(),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState(),[d,m]=f.useState(),[p,g]=f.useState(),y=f.useRef("add");return{imageFile:c,setImageFile:u,songFile:t,setSongFile:e,songData:n,song:d,setSong:m,variant:y,setSongData:r,updateSongData:E=>{n&&r({...n,...E})},singers:s,setSingers:i,setGenres:l,genres:o,selectGenre:E=>{const R=[...o],D=R.findIndex(F=>F.id===E.id);D===-1?R.push(E):R.splice(D,1),l(R)},selectSinger:E=>{const R=[...s],D=R.findIndex(F=>F.id===E.id);D===-1?R.push(E):R.splice(D,1),i(R)},imageBlob:p,setImageBlob:g,resetAddSongContext:E=>{e(void 0),r(E),i([]),l([])}}}const TA=f.createContext(null);function tq({children:t}){return a.jsx(TA.Provider,{value:eq(),children:t})}const Za=()=>{const t=f.useContext(TA);if(!t)throw new Error("AddSongProvider not provided");return t};function IA(){const{setSongFile:t}=Za(),e=f.useRef(null),n=r=>{var s;(s=r.target.files)!=null&&s.length&&t(r.target.files[0])};return a.jsxs(a.Fragment,{children:[a.jsx("input",{ref:e,onChange:n,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a.jsx(ue,{className:"",size:"clear",children:a.jsx("label",{htmlFor:"song_upload",className:"inline-flex p-1.5 cursor-pointer",children:a.jsx(Uy,{className:"w-6"})})})]})}function nq(){const[t,e]=f.useState([]),n=f.useRef(!0);return{genres:t,shouldFetchGenre:n,setGenres:e}}const CA=f.createContext(null);function rq({children:t}){return a.jsx(CA.Provider,{value:nq(),children:t})}const Mw=()=>{const t=f.useContext(CA);if(!t)throw new Error("GenreProvider is not provided");return t};function jA(){const{setGenres:t,genres:e}=Mw(),{setErrorToast:n,setSuccessToast:r}=de(),[s,i]=f.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(m=>m.name===l.name))return await cs(100),n("Genre already exist");const u=await Gs({collectionName:"Genres",data:{name:l.name}}),d={name:l.name,id:u.id};return t(m=>[d,...m]),i(!1),r("Add genre successful"),d}case"edit":{await Et({collectionName:"Genres",data:{name:l.name},id:l.id});const c=[...e],u=c.findIndex(m=>m.id===l.id),d={...e[u]};Object.assign(d,{name:l.name}),c[u]=d,t(c),r("Edit genre successful");break}case"delete":{await Iw({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function RA(){const{genres:t,setGenres:e,shouldFetchGenre:n}=Mw(),[r,s]=f.useState(!0);return{api:async()=>{try{if(n.current){n.current=!1;const o=_r(Te,"Genres"),l=pe(o);console.log(">>> fetch genres");const c=await Er(l);if(c.docs){const u=c.docs.map(d=>({...d.data(),id:d.id}));e(u)}}else await cs(100)}catch(o){console.log(o)}finally{s(!1)}},isFetching:r,setIsFetching:s,genres:t,shouldFetchGenre:n}}function AA(){const{genres:t}=Mw(),[e,n]=f.useState(""),r=HR(e,800),s=f.useMemo(()=>r?t.filter(i=>i.name.includes(r)):t,[r,t]);return{value:e,setValue:n,_genres:s}}function sq({afterSearched:t=()=>{}}){const[e,n]=f.useState(""),[r,s]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState([]),{setErrorToast:u}=de();return{value:e,isShowResult:i,setValue:n,result:l,handleSubmit:async m=>{try{m.preventDefault(),m.stopPropagation(),s(!0),o(!0);const p=_r(Te,"Singers"),g=pe(p,Q("name",">=",e),Q("name","<=",e+"")),y=await Er(g);if(y.docs){const v=y.docs.map(_=>({..._.data(),id:_.id}));c(v),t()}}catch(p){console.log({message:p}),u()}finally{s(!1)}},isFetching:r}}function iq(){const{setSuccessToast:t,setErrorToast:e}=de(),[n,r]=f.useState(!1);return{isFetching:n,addSinger:async({data:i})=>{try{r(!0);const o=await Gs({collectionName:"Singers",data:i}),c={...(await La(o)).data(),id:o.id};return r(!1),t("Add singer successful"),c}catch(o){console.log({error:o}),e()}finally{r(!1)}}}}function aq({closeModal:t,afterSubmit:e,singerName:n}){const[r,s]=f.useState(kf({name:n})),{addSinger:i,isFetching:o}=iq(),l=r.name,c=(m,p)=>{s({...r,[m]:p.trim()})},u=async()=>{const m=await i({data:r});m&&e&&e(m),t()},d={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};return a.jsxs(Pe,{className:"w-[450px]",children:[a.jsx(ot,{close:t,title:"Add singer"}),a.jsx("div",{className:"space-y-3 overflow-auto",children:a.jsxs("div",{className:d.inputGroup,children:[a.jsx("label",{className:d.label,children:"Customer name:"}),a.jsx(Gt,{value:r.name,onChange:m=>c("name",m.target.value),placeholder:"Enter name...",className:d.input})]})}),a.jsx("div",{className:"text-center mt-5",children:a.jsxs(ue,{disabled:!l,loading:o,onClick:()=>l&&u(),children:[a.jsx(bu,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function Ow({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,...i}=sq({}),o=f.useRef(null),l=()=>{var c;return(c=o.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(Pe,{children:[a.jsx(ot,{title:"Singers",close:e}),a.jsx(kl,{...i}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:r&&(s?a.jsx(Ku,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((c,u)=>a.jsx(wn,{onClick:()=>t(c),children:a.jsx("p",{className:"text-lg",children:c.name})},u)):a.jsx(a.Fragment,{children:a.jsx(Ye,{})})}))}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(ue,{onClick:()=>{var c;return(c=o.current)==null?void 0:c.open()},children:[a.jsx(Xs,{className:"w-6"}),a.jsx("span",{children:"Add new singer"})]})})]}),a.jsx(Ee,{ref:o,variant:"animation",children:a.jsx(aq,{afterSubmit:t,singerName:i.value,closeModal:l})})]})}function oq(){const{singers:t,selectSinger:e}=Za(),n=f.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"",children:[a.jsxs("div",{className:"flex space-x-2 items-center",children:[a.jsx(Ae,{title:"Singer"}),a.jsx(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:a.jsx(Xs,{className:"w-6"})})]}),a.jsx(wn,{className:" mt-1",children:a.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,o)=>a.jsxs(Sl,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{className:"flex",children:a.jsx("button",{onClick:()=>e(i),children:a.jsx(Ln,{className:"w-5"})})})]},o)):"..."})})]}),a.jsx(El,{ref:n,children:a.jsx(Ow,{closeModal:r,choose:s})})]})}function lq({audioEle:t,variant:e}){const{status:n,handlePlayPause:r,progressLineRef:s,currentTimeRef:i,durationRef:o}=Um({audioEle:t,baseColor:"rgba(0,0,0,.10)",color:"#5a9e87"}),l=()=>{switch(n){case"error":return a.jsx(rm,{className:"w-6"});case"playing":return a.jsx(im,{className:"w-6"});case"paused":return a.jsx(Gc,{className:"w-6"});case"waiting":return a.jsx(We,{className:"w-6 animate-spin"})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-end justify-between",children:[a.jsx(ue,{className:"p-1.5",size:"clear",onClick:r,children:l()}),e==="add"&&a.jsx(IA,{})]}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:i,children:"00:00"}),a.jsx("div",{ref:s,style:{backgroundColor:"rgab(0,0,0,.15)"},className:"h-1 rounded-full w-full"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:o,children:"00:00"})]})]})}function $w({closeModal:t,afterSubmit:e,...n}){const[r,s]=f.useState(n.type==="add"?n.genreName||"":n.genre.name),{action:i,isFetching:o}=jA(),{setErrorToast:l}=de(),c=f.useRef(null),u=!!r,d=async()=>{try{switch(n.type){case"add":const g=await i({type:"add",name:r});g&&e&&e(g);break;case"edit":await i({type:"edit",name:r,id:n.genre.id});break}}catch(g){console.log(g),l()}finally{t()}},m={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};f.useEffect(()=>{var g;(g=c.current)==null||g.focus()},[]);const p=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return a.jsxs(Pe,{className:"w-[450px]",children:[a.jsx(ot,{close:t,title:p}),a.jsx("div",{className:"space-y-3 overflow-auto",children:a.jsxs("div",{className:m.inputGroup,children:[a.jsx("label",{className:m.label,children:"Genre name:"}),a.jsx(Gt,{ref:c,value:r,onChange:g=>s(g.target.value),placeholder:"Enter name...",className:m.input})]})}),a.jsx("div",{className:"text-center mt-5",children:a.jsxs(ue,{disabled:!u,loading:o,onClick:()=>u&&d(),children:[a.jsx(bu,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function cq({closeModal:t,choose:e}){const{_genres:n,...r}=AA(),s=f.useRef(null),i=f.useRef(null),o=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=RA();return f.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(Pe,{children:[a.jsx(ot,{title:"Genre",close:t}),a.jsx(kA,{inputRef:i,...r}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?a.jsx(Ku,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((u,d)=>a.jsx(wn,{onClick:()=>e(u),children:a.jsx("p",{className:"text-lg",children:u.name})},d)):a.jsx(a.Fragment,{children:a.jsx(Ye,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(ue,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[a.jsx(ir,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(Ee,{ref:s,variant:"animation",children:a.jsx($w,{afterSubmit:e,genreName:r.value,type:"add",closeModal:o})})]})}function uq(){const{genres:t,selectGenre:e}=Za(),n=f.useRef(null),r=i=>{e(i),s()},s=()=>{var i;return(i=n.current)==null?void 0:i.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"",children:[a.jsxs("div",{className:"flex space-x-2 items-center",children:[a.jsx(Ae,{title:"Genre"}),a.jsx(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:a.jsx(Xs,{className:"w-6"})})]}),a.jsx(wn,{className:"mt-1",children:a.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,o)=>a.jsxs(Sl,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(i),children:a.jsx(Ln,{className:"w-5"})})})]},o)):"..."})})]}),a.jsx(El,{ref:n,children:a.jsx(cq,{closeModal:s,choose:r})})]})}const dq="End-Of-Stream";class xt extends Error{constructor(){super(dq)}}class hq{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new xt;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const o=this.peekQueue.pop();if(!o)throw new Error("peekData should be defined");const l=Math.min(o.length,s);e.set(o.subarray(0,l),n+i),i+=l,s-=l,l<o.length&&this.peekQueue.push(o.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const o=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,o);if(l===0)break;i+=l,s-=l}return i}}class fq extends hq{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new xt;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class NA{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new xt;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new xt;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new xt;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new xt;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const mq=256e3;class pq extends NA{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new xt;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const o=new Uint8Array(r.length+i);return s=await this.peekBuffer(o,{mayBeLess:r.mayBeLess}),e.set(o.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof xt)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new xt}return s}async ignore(e){const n=Math.min(mq,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,o=await this.readBuffer(r,{length:Math.min(n,i)});if(o<0)return o;s+=o}return s}}class gq extends NA{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new xt;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function PA(t,e){return new pq(new fq(t),e)}function tl(t,e){return new gq(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Zm=function(t,e,n,r,s){var i,o,l=s*8-r-1,c=(1<<l)-1,u=c>>1,d=-7,m=n?s-1:0,p=n?-1:1,g=t[e+m];for(m+=p,i=g&(1<<-d)-1,g>>=-d,d+=l;d>0;i=i*256+t[e+m],m+=p,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=r;d>0;o=o*256+t[e+m],m+=p,d-=8);if(i===0)i=1-u;else{if(i===c)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-u}return(g?-1:1)*o*Math.pow(2,i-r)},ep=function(t,e,n,r,s,i){var o,l,c,u=i*8-s-1,d=(1<<u)-1,m=d>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,y=r?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+m>=1?e+=p/c:e+=p*Math.pow(2,1-m),e*c>=2&&(o++,c/=2),o+m>=d?(l=0,o=d):o+m>=1?(l=(e*c-1)*Math.pow(2,s),o=o+m):(l=e*Math.pow(2,m-1)*Math.pow(2,s),o=0));s>=8;t[n+g]=l&255,g+=y,l/=256,s-=8);for(o=o<<s|l,u+=s;u>0;t[n+g]=o&255,g+=y,o/=256,u-=8);t[n+g-y]|=v*128};function ye(t){return new DataView(t.buffer,t.byteOffset)}const _e={len:1,get(t,e){return ye(t).getUint8(e)},put(t,e,n){return ye(t).setUint8(e,n),e+1}},Me={len:2,get(t,e){return ye(t).getUint16(e,!0)},put(t,e,n){return ye(t).setUint16(e,n,!0),e+2}},Be={len:2,get(t,e){return ye(t).getUint16(e)},put(t,e,n){return ye(t).setUint16(e,n),e+2}},Tf={len:3,get(t,e){const n=ye(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=ye(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},_n={len:3,get(t,e){const n=ye(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=ye(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},J={len:4,get(t,e){return ye(t).getUint32(e,!0)},put(t,e,n){return ye(t).setUint32(e,n,!0),e+4}},ie={len:4,get(t,e){return ye(t).getUint32(e)},put(t,e,n){return ye(t).setUint32(e,n),e+4}},du={len:1,get(t,e){return ye(t).getInt8(e)},put(t,e,n){return ye(t).setInt8(e,n),e+1}},As={len:2,get(t,e){return ye(t).getInt16(e)},put(t,e,n){return ye(t).setInt16(e,n),e+2}},xq={len:2,get(t,e){return ye(t).getInt16(e,!0)},put(t,e,n){return ye(t).setInt16(e,n,!0),e+2}},yq={len:3,get(t,e){const n=Tf.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ye(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Bw={len:3,get(t,e){const n=_n.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ye(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},Jn={len:4,get(t,e){return ye(t).getInt32(e)},put(t,e,n){return ye(t).setInt32(e,n),e+4}},mt={len:4,get(t,e){return ye(t).getInt32(e,!0)},put(t,e,n){return ye(t).setInt32(e,n,!0),e+4}},pn={len:8,get(t,e){return ye(t).getBigUint64(e,!0)},put(t,e,n){return ye(t).setBigUint64(e,n,!0),e+8}},If={len:8,get(t,e){return ye(t).getBigInt64(e,!0)},put(t,e,n){return ye(t).setBigInt64(e,n,!0),e+8}},zw={len:8,get(t,e){return ye(t).getBigUint64(e)},put(t,e,n){return ye(t).setBigUint64(e,n),e+8}},FA={len:8,get(t,e){return ye(t).getBigInt64(e)},put(t,e,n){return ye(t).setBigInt64(e,n),e+8}},vq={len:2,get(t,e){return Zm(t,e,!1,10,this.len)},put(t,e,n){return ep(t,n,e,!1,10,this.len),e+this.len}},wq={len:2,get(t,e){return Zm(t,e,!0,10,this.len)},put(t,e,n){return ep(t,n,e,!0,10,this.len),e+this.len}},DA={len:4,get(t,e){return ye(t).getFloat32(e)},put(t,e,n){return ye(t).setFloat32(e,n),e+4}},_q={len:4,get(t,e){return ye(t).getFloat32(e,!0)},put(t,e,n){return ye(t).setFloat32(e,n,!0),e+4}},Rx={len:8,get(t,e){return ye(t).getFloat64(e)},put(t,e,n){return ye(t).setFloat64(e,n),e+8}},bq={len:8,get(t,e){return ye(t).getFloat64(e,!0)},put(t,e,n){return ye(t).setFloat64(e,n,!0),e+8}},Sq={len:10,get(t,e){return Zm(t,e,!1,63,this.len)},put(t,e,n){return ep(t,n,e,!1,63,this.len),e+this.len}},Eq={len:10,get(t,e){return Zm(t,e,!0,63,this.len)},put(t,e,n){return ep(t,n,e,!0,63,this.len),e+this.len}};class kq{constructor(e){this.len=e}get(e,n){}}class Cn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class se{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class Tq{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const Iq=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:Tq,Float16_BE:vq,Float16_LE:wq,Float32_BE:DA,Float32_LE:_q,Float64_BE:Rx,Float64_LE:bq,Float80_BE:Sq,Float80_LE:Eq,INT16_BE:As,INT16_LE:xq,INT24_BE:Bw,INT24_LE:yq,INT32_BE:Jn,INT32_LE:mt,INT64_BE:FA,INT64_LE:If,INT8:du,IgnoreType:kq,StringType:se,UINT16_BE:Be,UINT16_LE:Me,UINT24_BE:_n,UINT24_LE:Tf,UINT32_BE:ie,UINT32_LE:J,UINT64_BE:zw,UINT64_LE:pn,UINT8:_e,Uint8ArrayType:Cn},Symbol.toStringTag,{value:"Module"})),Cq=Object.prototype.toString,jq="[object Uint8Array]",Rq="[object ArrayBuffer]";function LA(t,e,n){return t?t.constructor===e?!0:Cq.call(t)===n:!1}function MA(t){return LA(t,Uint8Array,jq)}function Aq(t){return LA(t,ArrayBuffer,Rq)}function Nq(t){return MA(t)||Aq(t)}function Pq(t){if(!MA(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function Fq(t){if(!Nq(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const Ud={utf8:new globalThis.TextDecoder("utf8")};function Uw(t,e="utf8"){return Fq(t),Ud[e]??(Ud[e]=new globalThis.TextDecoder(e)),Ud[e].decode(t)}function OA(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const Dq=new globalThis.TextEncoder;function Lq(t){return OA(t),Dq.encode(t)}const Mq=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Vw(t){Pq(t);let e="";for(let n=0;n<t.length;n++)e+=Mq[t[n]];return e}const y2={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function v2(t){if(OA(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=y2[t[r*2]],i=y2[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function w2(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function $A(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let o=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){o=!1;break}if(o)return i}return-1}function Oq(t,e){return $A(t,e)!==-1}function $q(t){return[...t].map(e=>e.charCodeAt(0))}function Bq(t,e=0){const n=Number.parseInt(new se(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const zq={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Uq=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],Vq=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],_2=4100;async function BA(t){return new Hq().fromBuffer(t)}function Kr(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class Hq{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(tl(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await PA(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=_2}=n;let s,i;const o=e.getReader({mode:"byob"});try{const{value:u,done:d}=await o.read(new Uint8Array(r));if(i=u,!d&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(m){if(!(m instanceof xt))throw m;s=void 0}i=u}finally{o.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,d){d.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return Kr(this.buffer,e,n)}checkString(e,n){return this.check($q(e),n)}async parse(e){if(this.buffer=new Uint8Array(_2),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(zq);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new se(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new se(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=$A(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof xt))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),Kr(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:Kr(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:Kr(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:Kr(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:Kr(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:Kr(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new se(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),Oq(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof xt))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(_e);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),d=new DataView(l.buffer),m=new DataView(c.buffer,c.length-u,u);return{id:w2(d),len:w2(m)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new se(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new se(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new se(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(Jn),type:await e.readToken(new se(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(pn))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(Kr(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),Kr(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(Kr(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new se(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),Bq(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?Be:Me);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?Be:Me);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?Be:Me).get(this.buffer,2),r=(e?ie:J).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(Uq);new Set(Vq);var Hw={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var b2=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,Wq=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,zA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,Gq=/\\([\u000b\u0020-\u00ff])/g,qq=/([\\"])/g,UA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Hw.format=Qq;Hw.parse=Kq;function Qq(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!UA.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),o=0;o<i.length;o++){if(s=i[o],!zA.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+Yq(e[s])}return r}function Kq(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?Xq(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!UA.test(r))throw new TypeError("invalid media type");var s=new Jq(r.toLowerCase());if(n!==-1){var i,o,l;for(b2.lastIndex=n;o=b2.exec(e);){if(o.index!==n)throw new TypeError("invalid parameter format");n+=o[0].length,i=o[1].toLowerCase(),l=o[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace(Gq,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function Xq(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function Yq(t){var e=String(t);if(zA.test(e))return e;if(e.length>0&&!Wq.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(qq,"\\$1")+'"'}function Jq(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var Zq=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,eQ=tQ;function tQ(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=Zq.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new nQ(n,r,s)}function nQ(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var Ax={exports:{}},Cg,S2;function rQ(){if(S2)return Cg;S2=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;Cg=function(d,m){m=m||{};var p=typeof d;if(p==="string"&&d.length>0)return o(d);if(p==="number"&&isFinite(d))return m.long?c(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(m){var p=parseFloat(m[1]),g=(m[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function l(d){var m=Math.abs(d);return m>=r?Math.round(d/r)+"d":m>=n?Math.round(d/n)+"h":m>=e?Math.round(d/e)+"m":m>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var m=Math.abs(d);return m>=r?u(d,m,r,"day"):m>=n?u(d,m,n,"hour"):m>=e?u(d,m,e,"minute"):m>=t?u(d,m,t,"second"):d+" ms"}function u(d,m,p,g){var y=m>=p*1.5;return Math.round(d/p)+" "+g+(y?"s":"")}return Cg}function sQ(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=o,n.humanize=rQ(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let m=0;for(let p=0;p<d.length;p++)m=(m<<5)-m+d.charCodeAt(p),m|=0;return n.colors[Math.abs(m)%n.colors.length]}n.selectColor=e;function n(d){let m,p=null,g,y;function v(..._){if(!v.enabled)return;const S=v,b=Number(new Date),E=b-(m||b);S.diff=E,S.prev=m,S.curr=b,m=b,_[0]=n.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let R=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(F,I)=>{if(F==="%%")return"%";R++;const k=n.formatters[I];if(typeof k=="function"){const j=_[R];F=k.call(S,j),_.splice(R,1),R--}return F}),n.formatArgs.call(S,_),(S.log||n.log).apply(S,_)}return v.namespace=d,v.useColors=n.useColors(),v.color=n.selectColor(d),v.extend=r,v.destroy=n.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(g!==n.namespaces&&(g=n.namespaces,y=n.enabled(d)),y),set:_=>{p=_}}),typeof n.init=="function"&&n.init(v),v}function r(d,m){const p=n(this.namespace+(typeof m>"u"?":":m)+d);return p.log=this.log,p}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let m;const p=(typeof d=="string"?d:"").split(/[\s,]+/),g=p.length;for(m=0;m<g;m++)p[m]&&(d=p[m].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(l),...n.skips.map(l).map(m=>"-"+m)].join(",");return n.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let m,p;for(m=0,p=n.skips.length;m<p;m++)if(n.skips[m].test(d))return!1;for(m=0,p=n.names.length;m<p;m++)if(n.names[m].test(d))return!0;return!1}function l(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var iQ=sQ;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,m=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(m=d))}),c.splice(m,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}t.exports=iQ(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Ax,Ax.exports);var aQ=Ax.exports;const Ve=uE(aQ);var Nx;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(Nx||(Nx={}));var za;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(za||(za={}));function ut(t,e,n){return(t[e]&1<<n)!==0}function Bn(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function VA(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function oQ(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function Tt(t,e){if(t[0]===255&&t[1]===254)return Tt(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return Tt(oQ(t),e)}return new se(t.length,e).get(t,0)}function yi(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function Re(t,e,n,r){const s=e+~~(n/8),i=n%8;let o=t[s];o&=255>>i;const l=8-i,c=r-l;return c<0?o>>=8-i-r:c>0&&(o<<=c,o|=Re(t,e,n+l,c)),o}function Hn(t,e,n){return Re(t,e,n,1)===1}function lQ(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function cQ(t){return 10*Math.log10(t)}function uQ(t){return 10**(t/10)}function dQ(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:uQ(n)}:{dB:cQ(n),ratio:n}}}var hu;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(hu||(hu={}));var E2;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(E2||(E2={}));var k2;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(k2||(k2={}));const HA={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Px={len:10,get:(t,e)=>({fileIdentifier:new se(3,"ascii").get(t,e),version:{major:du.get(t,e+3),revision:du.get(t,e+4)},flags:{unsynchronisation:ut(t,e+5,7),isExtendedHeader:ut(t,e+5,6),expIndicator:ut(t,e+5,5),footer:ut(t,e+5,4)},size:HA.get(t,e+6)})},T2={len:10,get:(t,e)=>({size:ie.get(t,e),extendedFlags:Be.get(t,e+4),sizeOfPadding:ie.get(t,e+6),crcDataPresent:ut(t,e+4,31)})},WA={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},Fx={len:4,get:(t,e)=>({encoding:WA.get(t,e),language:new se(3,"latin1").get(t,e+1)})},I2={len:6,get:(t,e)=>{const n=Fx.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:_e.get(t,e+4),contentType:_e.get(t,e+5)}}},Cf={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function hQ(t){return Cf[t]&&!Cf[t].multiple}function fQ(t){return!Cf[t].multiple||Cf[t].unique||!1}class Qn{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}Qn.maxRatingScore=1;const mQ={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class pQ extends Qn{constructor(){super(["ID3v1"],mQ)}}class Xu extends Qn{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const gQ={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class Ww extends Xu{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*Qn.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],gQ)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=Tt(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?J.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=Ww.toRating(e.value);break}}}const xQ={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class Gw extends Qn{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],xQ)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=Gw.toRating(e.value),e.id=n[0];break}}}}const yQ={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class vQ extends Xu{constructor(){super(["ID3v2.2"],yQ)}}const wQ={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class _Q extends Xu{constructor(){super(["APEv2"],wQ)}}const bQ={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},SQ="iTunes";class C2 extends Xu{constructor(){super([SQ],bQ)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const EQ={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class jf extends Qn{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*Qn.maxRatingScore}}constructor(){super(["vorbis"],EQ)}postMap(e){if(e.id==="RATING")e.value=jf.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=jf.toRating(n[1],e.value,1),e.id=n[0]}}}const kQ={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class TQ extends Qn{constructor(){super(["exif"],kQ)}}const IQ={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class CQ extends Xu{constructor(){super(["matroska"],IQ)}}const jQ={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class RQ extends Qn{constructor(){super(["AIFF"],jQ)}}class AQ{constructor(){this.tagMappers={},[new pQ,new vQ,new Ww,new C2,new C2,new jf,new _Q,new Gw,new TQ,new CQ,new RQ].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const sa=Ve("music-metadata:collector"),NQ=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class PQ{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new AQ;let n=1;for(const r of NQ)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){sa(`streamInfo: type=${e.type?za[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;sa(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){sa(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:FQ(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=Qn.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=Qn.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=Qn.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=Qn.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=dQ(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await BA(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;sa(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(hQ(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return sa(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!fQ(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):sa(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return sa(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function FQ(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class ar{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const DQ=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,Ze={len:4,get:(t,e)=>{const n=Uw(t.slice(e,e+Ze.len),"latin1");if(!n.match(DQ))throw new Error(`FourCC contains invalid characters: ${lQ(n)} "${n}"`);return n},put:(t,e,n)=>{const r=Lq(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Io;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Io||(Io={}));const j2={len:52,get:(t,e)=>({ID:Ze.get(t,e),version:J.get(t,e+4)/1e3,descriptorBytes:J.get(t,e+8),headerBytes:J.get(t,e+12),seekTableBytes:J.get(t,e+16),headerDataBytes:J.get(t,e+20),apeFrameDataBytes:J.get(t,e+24),apeFrameDataBytesHigh:J.get(t,e+28),terminatingDataBytes:J.get(t,e+32),fileMD5:new Cn(16).get(t,e+36)})},LQ={len:24,get:(t,e)=>({compressionLevel:Me.get(t,e),formatFlags:Me.get(t,e+2),blocksPerFrame:J.get(t,e+4),finalFrameBlocks:J.get(t,e+8),totalFrames:J.get(t,e+12),bitsPerSample:Me.get(t,e+16),channel:Me.get(t,e+18),sampleRate:J.get(t,e+20)})},cr={len:32,get:(t,e)=>({ID:new se(8,"ascii").get(t,e),version:J.get(t,e+8),size:J.get(t,e+12),fields:J.get(t,e+16),flags:GA(J.get(t,e+20))})},jg={len:8,get:(t,e)=>({size:J.get(t,e),flags:GA(J.get(t,e+4))})};function GA(t){return{containsHeader:Vd(t,31),containsFooter:Vd(t,30),isHeader:Vd(t,29),readOnly:Vd(t,0),dataType:(t&6)>>1}}function Vd(t,e){return(t&1<<e)!==0}const ia=Ve("music-metadata:parser:APEv2"),R2="APEv2",A2="APETAGEX";class ns extends ar{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new ns;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(cr.len);await e.randomRead(r,0,cr.len,n-cr.len);const s=cr.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?ia(`APE Header found at offset=${n-cr.len}`):(ia(`APE Footer found at offset=${n-cr.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=cr.get(n,n.length-cr.len);if(s.ID!==A2)throw new Error("Unexpected APEv2 Footer ID preamble value.");tl(n);const i=new ns;return i.init(e,tl(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<cr.len){ia("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(cr);if(e.ID===A2)return await this.tokenizer.ignore(cr.len),this.parseTags(e);if(ia(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),ns.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(j2);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-j2.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-cr.len;ia(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<jg.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(jg);r-=jg.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let o=Bn(n,0,n.length);const l=await this.tokenizer.readToken(new se(o,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case Io.text_utf8:{const u=(await this.tokenizer.readToken(new se(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag(R2,l,d)));break}case Io.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),o=Bn(c,0,c.length);const u=Uw(c.slice(0,o)),d=c.slice(o+1);await this.metadata.addTag(R2,l,{description:u,data:d})}break;case Io.external_info:ia(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case Io.reserved:ia(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(LQ);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",ns.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const Hd=Ve("music-metadata:parser:ID3v1"),Rf=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],Wd={len:128,get:(t,e)=>{const n=new ao(3).get(t,e);return n==="TAG"?{header:n,title:new ao(30).get(t,e+3),artist:new ao(30).get(t,e+33),album:new ao(30).get(t,e+63),year:new ao(4).get(t,e+93),comment:new ao(28).get(t,e+97),zeroByte:_e.get(t,e+127),track:_e.get(t,e+126),genre:_e.get(t,e+127)}:null}};class ao{constructor(e){this.len=e,this.stringType=new se(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=VA(r),r=r.trim(),r.length>0?r:void 0}}class qw extends ar{static getGenre(e){if(e<Rf.length)return Rf[e]}async parse(){if(!this.tokenizer.fileInfo.size){Hd("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new ns;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-Wd.len;if(this.tokenizer.position>e){Hd("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(Wd,e);if(n){Hd("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-Wd.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=qw.getGenre(n.genre);s&&await this.addTag("genre",s)}else Hd("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-Wd.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const N2=Ve("music-metadata:id3v2:frame-parser"),Cr="latin1";function MQ(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=P2(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=P2(r)),r&&e.push(r)),e}function P2(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return Rf[Number.parseInt(t)]}class zn{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=WA.get(e,0),o=e.length;let l=0,c=[];const u=zn.getNullTerminatorLength(s);let d;switch(N2(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let m;try{m=Tt(e.slice(1),s).replace(/\x00+$/,"")}catch(p){if(p instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${p.message}`);break}throw p}switch(n){case"TMCL":case"TIPL":case"IPLS":c=zn.functionList(this.splitValue(n,m));break;case"TRK":case"TRCK":case"TPOS":c=m;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,m);break;case"TCO":case"TCON":c=this.splitValue(n,m).map(p=>MQ(p)).reduce((p,g)=>p.concat(g),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,m):[m],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,m):[m]}break}case"TXXX":{const m=zn.readIdentifierAndData(e,l+1,o,s);c={description:m.id,text:this.splitValue(n,Tt(m.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const m={};switch(l+=1,this.major){case 2:m.format=Tt(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:d=Bn(e,l,o,Cr),m.format=Tt(e.slice(l,d),Cr),l=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}m.format=zn.fixPictureMimeType(m.format),m.type=hu[e[l]],l+=1,d=Bn(e,l,o,s),m.description=Tt(e.slice(l,d),s),l=d+u,m.data=e.slice(l,o),c=m}break;case"CNT":case"PCNT":c=ie.get(e,0);break;case"SYLT":{const m=I2.get(e,0);l+=I2.len;const p={descriptor:"",language:m.language,contentType:m.contentType,timeStampFormat:m.timeStampFormat,syncText:[]};let g=!1;for(;l<o;){const y=zn.readNullTerminatedString(e.subarray(l),m.encoding);if(l+=y.len,g){const v=ie.get(e,l);l+=ie.len,p.syncText.push({text:y.text,timestamp:v})}else p.descriptor=y.text,g=!0}c=p;break}case"ULT":case"USLT":case"COM":case"COMM":{const m=Fx.get(e,l);l+=Fx.len;const p=zn.readNullTerminatedString(e.subarray(l),m.encoding);l+=p.len;const g=zn.readNullTerminatedString(e.subarray(l),m.encoding);c={language:m.language,descriptor:p.text,text:g.text};break}case"UFID":{const m=zn.readIdentifierAndData(e,l,o,Cr);c={owner_identifier:m.id,identifier:m.data};break}case"PRIV":{const m=zn.readIdentifierAndData(e,l,o,Cr);c={owner_identifier:m.id,data:m.data};break}case"POPM":{d=Bn(e,l,o,Cr);const m=Tt(e.slice(l,d),Cr);l=d+1;const p=o-l;c={email:m,rating:_e.get(e,l),counter:p>=5?ie.get(e,l+1):void 0};break}case"GEOB":{d=Bn(e,l+1,o,s);const m=Tt(e.slice(l+1,d),Cr);l=d+1,d=Bn(e,l,o-l,s);const p=Tt(e.slice(l,d),Cr);l=d+1,d=Bn(e,l,o-l,s);const g=Tt(e.slice(l,d),Cr);c={type:m,filename:p,description:g,data:e.slice(l+1,o)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=Bn(e,l+1,o,s),c=Tt(e.slice(l,d),Cr);break;case"WXXX":{d=Bn(e,l+1,o,s);const m=Tt(e.slice(l+1,d),s);l=d+(s==="utf-16le"?2:1),c={description:m,url:Tt(e.slice(l,o),Cr)};break}case"WFD":case"WFED":c=Tt(e.slice(l+1,Bn(e,l+1,o,s)),s);break;case"MCDI":{c=e.slice(0,o);break}default:N2(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=Bn(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:Tt(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),zn.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=Bn(e,n,r,s),o=Tt(e.slice(n,i),s);return n=i+zn.getNullTerminatorLength(s),{id:o,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const F2=new TextDecoder("ascii");class Pr{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:ut(e,0,6),file_alter_preservation:ut(e,0,5),read_only:ut(e,0,4)},format:{grouping_identity:ut(e,1,7),compression:ut(e,1,3),encryption:ut(e,1,2),unsynchronisation:ut(e,1,1),data_length_indicator:ut(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const o=new zn(r,i);switch(r){case 2:return o.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=Pr.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),o.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(Px);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(T2),n=e.size-T2.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new Cn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(Pr.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=Pr.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const o=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+o.length);n+=o.length;const c=Pr.readFrameData(l,o,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:o.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:F2.decode(e.slice(0,3)),length:_n.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:F2.decode(e.slice(0,4)),length:(n===4?HA:ie).get(e,4),flags:Pr.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const OQ={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class $Q{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=Be.get(e,n+8)-16398,s=Be.get(e,n+8+2),i={numChannels:Be.get(e,n),numSampleFrames:ie.get(e,n+2),sampleSize:Be.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=Ze.get(e,n+18),this.len>22){const o=_e.get(e,n+22);if(o>0){const l=(o+1)%2;if(23+o+l===this.len)i.compressionName=new se(o,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const Rg={len:8,get:(t,e)=>({chunkID:Ze.get(t,e),chunkSize:Number(BigInt(ie.get(t,e+4)))})},Ag=Ve("music-metadata:parser:aiff");class BQ extends ar{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(Rg)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(Ze);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Rg.len;){Ag(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Rg),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof xt)Ag("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new $Q(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??OQ[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new Cn(e.chunkSize)),r=tl(n);return await new Pr().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return Ag(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new se(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class ${static fromBin(e,n=0){return new $($.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${Vw(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case $.AudioMedia.str:return"audio";case $.VideoMedia.str:return"video";case $.CommandMedia.str:return"command";case $.Degradable_JPEG_Media.str:return"degradable-jpeg";case $.FileTransferMedia.str:return"file-transfer";case $.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(v2(e.slice(19,23)),8),n.set(v2(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return $.encode(this.str)}}$.HeaderObject=new $("75B22630-668E-11CF-A6D9-00AA0062CE6C");$.DataObject=new $("75B22636-668E-11CF-A6D9-00AA0062CE6C");$.SimpleIndexObject=new $("33000890-E5B1-11CF-89F4-00A0C90349CB");$.IndexObject=new $("D6E229D3-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexObject=new $("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");$.TimecodeIndexObject=new $("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");$.FilePropertiesObject=new $("8CABDCA1-A947-11CF-8EE4-00C00C205365");$.StreamPropertiesObject=new $("B7DC0791-A9B7-11CF-8EE6-00C00C205365");$.HeaderExtensionObject=new $("5FBF03B5-A92E-11CF-8EE3-00C00C205365");$.CodecListObject=new $("86D15240-311D-11D0-A3A4-00A0C90348F6");$.ScriptCommandObject=new $("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");$.MarkerObject=new $("F487CD01-A951-11CF-8EE6-00C00C205365");$.BitrateMutualExclusionObject=new $("D6E229DC-35DA-11D1-9034-00A0C90349BE");$.ErrorCorrectionObject=new $("75B22635-668E-11CF-A6D9-00AA0062CE6C");$.ContentDescriptionObject=new $("75B22633-668E-11CF-A6D9-00AA0062CE6C");$.ExtendedContentDescriptionObject=new $("D2D0A440-E307-11D2-97F0-00A0C95EA850");$.ContentBrandingObject=new $("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");$.StreamBitratePropertiesObject=new $("7BF875CE-468D-11D1-8D82-006097C9A2B2");$.ContentEncryptionObject=new $("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");$.ExtendedContentEncryptionObject=new $("298AE614-2622-4C17-B935-DAE07EE9289C");$.DigitalSignatureObject=new $("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");$.PaddingObject=new $("1806D474-CADF-4509-A4BA-9AABCB96AAE8");$.ExtendedStreamPropertiesObject=new $("14E6A5CB-C672-4332-8399-A96952065B5A");$.AdvancedMutualExclusionObject=new $("A08649CF-4775-4670-8A16-6E35357566CD");$.GroupMutualExclusionObject=new $("D1465A40-5A79-4338-B71B-E36B8FD6C249");$.StreamPrioritizationObject=new $("D4FED15B-88D3-454F-81F0-ED5C45999E24");$.BandwidthSharingObject=new $("A69609E6-517B-11D2-B6AF-00C04FD908E9");$.LanguageListObject=new $("7C4346A9-EFE0-4BFC-B229-393EDE415C85");$.MetadataObject=new $("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");$.MetadataLibraryObject=new $("44231C94-9498-49D1-A141-1D134E457054");$.IndexParametersObject=new $("D6E229DF-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexParametersObject=new $("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");$.TimecodeIndexParametersObject=new $("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");$.CompatibilityObject=new $("26F18B5D-4584-47EC-9F5F-0E651F0452C9");$.AdvancedContentEncryptionObject=new $("43058533-6981-49E6-9B74-AD12CB86D58C");$.AudioMedia=new $("F8699E40-5B4D-11CF-A8FD-00805F5C442B");$.VideoMedia=new $("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");$.CommandMedia=new $("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");$.JFIF_Media=new $("B61BE100-5B4E-11CF-A8FD-00805F5C442B");$.Degradable_JPEG_Media=new $("35907DE0-E415-11CF-A917-00805F5C442B");$.FileTransferMedia=new $("91BD222C-F21C-497A-8B6D-5AA86BFC0185");$.BinaryMedia=new $("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");$.ASF_Index_Placeholder_Object=new $("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function zQ(t){return UQ[t]}function tp(t){return yi(Tt(t,"utf-16le"))}const UQ=[tp,D2,VQ,HQ,WQ,qA,D2];function D2(t){return new Uint8Array(t)}function VQ(t,e=0){return qA(t,e)===1}function HQ(t,e=0){return J.get(t,e)}function WQ(t,e=0){return pn.get(t,e)}function qA(t,e=0){return Me.get(t,e)}var L2;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(L2||(L2={}));const GQ={len:30,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(pn.get(t,e+16)),numberOfHeaderObjects:J.get(t,e+24)})},ha={len:24,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(pn.get(t,e+16))})};class eo{constructor(e){this.len=Number(e.objectSize)-ha.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:Qw.fromBuffer(s)});else{const i=zQ(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class M2 extends eo{get(e,n){return null}}class Dx extends eo{get(e,n){return{fileId:$.fromBin(e,n),fileSize:pn.get(e,n+16),creationDate:pn.get(e,n+24),dataPacketsCount:pn.get(e,n+32),playDuration:pn.get(e,n+40),sendDuration:pn.get(e,n+48),preroll:pn.get(e,n+56),flags:{broadcast:ut(e,n+64,24),seekable:ut(e,n+64,25)},minimumDataPacketSize:J.get(e,n+68),maximumDataPacketSize:J.get(e,n+72),maximumBitrate:J.get(e,n+76)}}}Dx.guid=$.FilePropertiesObject;class Lx extends eo{get(e,n){return{streamType:$.decodeMediaType($.fromBin(e,n)),errorCorrectionType:$.fromBin(e,n+8)}}}Lx.guid=$.StreamPropertiesObject;class Mx{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:$.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}Mx.guid=$.HeaderExtensionObject;const qQ={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function O2(t){const e=await t.readNumber(Me);return(await t.readToken(new se(e*2,"utf-16le"))).replace("\0","")}async function QQ(t){const e=await t.readToken(qQ),n=[];for(let r=0;r<e.entryCount;++r)n.push(await XQ(t));return n}async function KQ(t){const e=await t.readNumber(Me),n=new Uint8Array(e);return await t.readBuffer(n),n}async function XQ(t){const e=await t.readNumber(Me);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await O2(t),description:await O2(t),information:await KQ(t)}}class Ua extends eo{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let o=0;o<Ua.contentDescTags.length;++o){const l=s.getUint16(o*2,!0);if(l>0){const c=Ua.contentDescTags[o],u=i+l;r.push({id:c,value:tp(e.slice(n+i,n+u))}),i=u}}return r}}Ua.guid=$.ContentDescriptionObject;Ua.contentDescTags=["Title","Author","Copyright","Description","Rating"];class Ox extends eo{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){const c=s.getUint16(o,!0);o+=2;const u=tp(e.slice(n+o,n+o+c));o+=c;const d=s.getUint16(o,!0);o+=2;const m=s.getUint16(o,!0);o+=2;const p=e.slice(n+o,n+o+m);o+=m,this.postProcessTag(r,u,d,p)}return r}}Ox.guid=$.ExtendedContentDescriptionObject;class $x extends eo{get(e,n){const r=new DataView(e.buffer,n);return{startTime:pn.get(e,n),endTime:pn.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:ut(e,n+40,0),seekableFlag:ut(e,n+40,1),resendLiveCleanpointsFlag:ut(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}$x.guid=$.ExtendedStreamPropertiesObject;class Af extends eo{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){o+=4;const c=s.getUint16(o,!0);o+=2;const u=s.getUint16(o,!0);o+=2;const d=s.getUint32(o,!0);o+=4;const m=tp(e.slice(n+o,n+o+c));o+=c;const p=e.slice(n+o,n+o+d);o+=d,this.postProcessTag(r,m,u,p)}return r}}Af.guid=$.MetadataObject;class Bx extends Af{}Bx.guid=$.MetadataLibraryObject;class Qw{static fromBuffer(e){return new Qw(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let o=5;for(;r.getUint16(o)!==0;)o+=2;const l=new se(o-5,"utf-16le").get(e,5);for(;r.getUint16(o)!==0;)o+=2;const c=new se(o-5,"utf-16le").get(e,5);return{type:hu[s],format:l,description:c,size:i,data:e.slice(o+4)}}}const Gd=Ve("music-metadata:parser:ASF"),YQ="asf";class JQ extends ar{async parse(){const e=await this.tokenizer.readToken(GQ);if(!e.objectId.equals($.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){Gd("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(ha);switch(Gd("header GUID=%s",r.objectId.str),r.objectId.str){case Dx.guid.str:{const s=await this.tokenizer.readToken(new Dx(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case Lx.guid.str:{const s=await this.tokenizer.readToken(new Lx(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case Mx.guid.str:{const s=await this.tokenizer.readToken(new Mx);await this.parseExtensionObject(s.extensionDataSize);break}case Ua.guid.str:n=await this.tokenizer.readToken(new Ua(r)),await this.addTags(n);break;case Ox.guid.str:n=await this.tokenizer.readToken(new Ox(r)),await this.addTags(n);break;case $.CodecListObject.str:{const s=await QQ(this.tokenizer);s.forEach(o=>{this.metadata.addStreamInfo({type:o.type.videoCodec?za.video:za.audio,codecName:o.codecName})});const i=s.filter(o=>o.type.audioCodec).map(o=>o.codecName).join("/");this.metadata.setFormat("codec",i);break}case $.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-ha.len);break;case $.PaddingObject.str:Gd("Padding: %s bytes",r.objectSize-ha.len),await this.tokenizer.ignore(r.objectSize-ha.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),Gd("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new M2(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(YQ,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(ha),r=n.objectSize-ha.len;switch(n.objectId.str){case $x.guid.str:await this.tokenizer.readToken(new $x(n));break;case Af.guid.str:{const s=await this.tokenizer.readToken(new Af(n));await this.addTags(s);break}case Bx.guid.str:{const s=await this.tokenizer.readToken(new Bx(n));await this.addTags(s);break}case $.PaddingObject.str:await this.tokenizer.ignore(r);break;case $.CompatibilityObject.str:this.tokenizer.ignore(r);break;case $.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new M2(n));break}e-=n.objectSize}while(e>0)}}class fu{static fromBase64(e){return fu.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new fu(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=hu[ie.get(e,n)];n+=4;const s=ie.get(e,n);n+=4;const i=new se(s,"utf-8").get(e,n);n+=s;const o=ie.get(e,n);n+=4;const l=new se(o,"utf-8").get(e,n);n+=o;const c=ie.get(e,n);n+=4;const u=ie.get(e,n);n+=4;const d=ie.get(e,n);n+=4;const m=ie.get(e,n);n+=4;const p=ie.get(e,n);n+=4;const g=Uint8Array.from(e.slice(n,n+p));return{type:r,format:i,description:l,width:c,height:u,colour_depth:d,indexed_color:m,data:g}}}const qd={len:7,get:(t,e)=>({packetType:_e.get(t,e),vorbis:new se(6,"ascii").get(t,e+1)})},ZQ={len:23,get:(t,e)=>({version:J.get(t,e+0),channelMode:_e.get(t,e+4),sampleRate:J.get(t,e+5),bitrateMax:J.get(t,e+9),bitrateNominal:J.get(t,e+13),bitrateMin:J.get(t,e+17)})},Ng=Ve("music-metadata:parser:ID3");class np extends ar{constructor(){super(...arguments),this.id3parser=new Pr}static async startsWithID3v2Header(e){return(await e.peekToken(Px)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof xt)Ng("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Ng("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new qw().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(Px)).fileIdentifier==="ID3")return Ng("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class QA{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=J.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const oo=Ve("music-metadata:parser:ogg:vorbis1");class Va{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=Va.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,o)=>{const l=o.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(Va.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new QA(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){oo("Ignore picture");return}n=fu.fromBase64(n),oo(`Push picture: id=${e}, format=${n.format}`)}else oo(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),oo("Parse first page");const r=qd.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=ZQ.get(n,qd.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),oo("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=qd.get(e,0);switch(oo("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,qd.len)}}async parseUserCommentList(e,n){const r=J.get(e,n);n+=4,n+=r;let s=J.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const eK=Ve("music-metadata:parser:FLAC");var bs;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(bs||(bs={}));class tK extends np{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new Va(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(Ze)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(nK),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(eK(`blockHeader type=${e.type}, length=${e.length}`),e.type){case bs.STREAMINFO:return this.parseBlockStreamInfo(e.length);case bs.PADDING:this.padding+=e.length;break;case bs.APPLICATION:break;case bs.SEEKTABLE:break;case bs.VORBIS_COMMENT:return this.parseComment(e.length);case bs.CUESHEET:break;case bs.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==$2.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken($2);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new Cn(e)),r=new QA(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let o=0;o<s;o++)i[o]=r.parseUserComment();await Promise.all(i.map(o=>this.vorbisParser.addTag(o.key,o.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new fu(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const nK={len:4,get:(t,e)=>({lastBlock:ut(t,e,7),type:Re(t,e,1,7),length:_n.get(t,e+1)})},$2={len:34,get:(t,e)=>({minimumBlockSize:Be.get(t,e),maximumBlockSize:Be.get(t,e+2)/1e3,minimumFrameSize:_n.get(t,e+4),maximumFrameSize:_n.get(t,e+7),sampleRate:_n.get(t,e+10)>>4,channels:Re(t,e+12,4,3)+1,bitsPerSample:Re(t,e+12,7,5)+1,totalSamples:Re(t,e+13,4,36),fileMD5:new Cn(16).get(t,e+18)})},KA=Ve("music-metadata:parser:MP4:atom"),Nf={len:8,get:(t,e)=>{const n=ie.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new se(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(ie.put(t,e,Number(n.length)),Ze.put(t,e+4,n.name))},rK=zw,B2={len:4,get:(t,e)=>({type:new se(4,"ascii").get(t,e)})};class XA{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&KA(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const nl={len:4,get:(t,e)=>{const n=ie.get(t,e)-2082844800;return new Date(n*1e3)}};class sK extends XA{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:_e.get(e,n+0),flags:_n.get(e,n+1),creationTime:nl.get(e,n+4),modificationTime:nl.get(e,n+8),timeScale:ie.get(e,n+12),duration:ie.get(e,n+16),language:Be.get(e,n+20),quality:Be.get(e,n+22)}}}class iK extends XA{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:_e.get(e,n),flags:_n.get(e,n+1),creationTime:nl.get(e,n+4),modificationTime:nl.get(e,n+8),timeScale:ie.get(e,n+12),duration:ie.get(e,n+16),preferredRate:ie.get(e,n+20),preferredVolume:Be.get(e,n+24),previewTime:ie.get(e,n+72),previewDuration:ie.get(e,n+76),posterTime:ie.get(e,n+80),selectionTime:ie.get(e,n+84),selectionDuration:ie.get(e,n+88),currentTime:ie.get(e,n+92),nextTrackID:ie.get(e,n+96)}}}class aK{constructor(e){this.len=e}get(e,n){return{type:{set:_e.get(e,n+0),type:_n.get(e,n+1)},locale:_n.get(e,n+4),value:new Cn(this.len-8).get(e,n+8)}}}class oK{constructor(e){this.len=e}get(e,n){return{version:_e.get(e,n),flags:_n.get(e,n+1),name:new se(this.len-4,"utf-8").get(e,n+4)}}}class lK{constructor(e){this.len=e}get(e,n){return{version:_e.get(e,n),flags:_n.get(e,n+1),creationTime:nl.get(e,n+4),modificationTime:nl.get(e,n+8),trackId:ie.get(e,n+12),duration:ie.get(e,n+20),layer:Be.get(e,n+24),alternateGroup:Be.get(e,n+26),volume:Be.get(e,n+28)}}}const z2={len:8,get:(t,e)=>({version:_e.get(t,e),flags:_n.get(t,e+1),numberOfEntries:ie.get(t,e+4)})};class cK{constructor(e){this.len=e}get(e,n){return{dataFormat:Ze.get(e,n),dataReferenceIndex:Be.get(e,n+10),description:new Cn(this.len-12).get(e,n+12)}}}class uK{constructor(e){this.len=e}get(e,n){const r=z2.get(e,n);n+=z2.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const o=ie.get(e,n);n+=ie.len,s.push(new cK(o).get(e,n)),n+=o}return{header:r,table:s}}}const U2={len:8,get(t,e){return{version:As.get(t,e),revision:As.get(t,e+2),vendor:Jn.get(t,e+4)}}},dK={len:12,get(t,e){return{numAudioChannels:As.get(t,e+0),sampleSize:As.get(t,e+2),compressionId:As.get(t,e+4),packetSize:As.get(t,e+6),sampleRate:Be.get(t,e+8)+Be.get(t,e+10)/1e4}}};class Kw{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=Jn.get(e,n+4);return{version:du.get(e,n+0),flags:Bw.get(e,n+1),numberOfEntries:r,entries:YA(e,this.token,n+8,this.len-8,r)}}}const hK={len:8,get(t,e){return{count:Jn.get(t,e+0),duration:Jn.get(t,e+4)}}};class fK extends Kw{constructor(e){super(e,hK),this.len=e}}const mK={len:12,get(t,e){return{firstChunk:Jn.get(t,e),samplesPerChunk:Jn.get(t,e+4),sampleDescriptionId:Jn.get(t,e+8)}}};class pK extends Kw{constructor(e){super(e,mK),this.len=e}}class gK{constructor(e){this.len=e}get(e,n){const r=Jn.get(e,n+8);return{version:du.get(e,n),flags:Bw.get(e,n+1),sampleSize:Jn.get(e,n+4),numberOfEntries:r,entries:YA(e,Jn,n+12,this.len-12,r)}}}class xK extends Kw{constructor(e){super(e,Jn),this.len=e}}class yK{constructor(e){this.len=e}get(e,n){const r=As.get(e,n+0);return new se(r,"utf-8").get(e,n+2)}}function YA(t,e,n,r,s){if(KA(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let o=0;o<s;++o)i.push(e.get(t,n)),n+=e.len;return i}const vK=Ve("music-metadata:parser:MP4:Atom");class Pf{static async readAtom(e,n,r,s){const i=e.position,o=await e.readToken(Nf);o.length===BigInt(1)&&(o.length=await e.readToken(rK));const c=new Pf(o,o.length===BigInt(1),r),u=c.getPayloadLength(s);return vK(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await Pf.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(Nf)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const Xr=Ve("music-metadata:parser:MP4"),wK="iTunes",V2={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function H2(t,e,n){return n.indexOf(t)===e}class Ff extends ar{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new iK(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new sK(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=ie.len;)r.push(await this.tokenizer.readNumber(ie)),e-=ie.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new lK(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(B2);e-=B2.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}Xr(`ftyp: ${n.join("/")}`);const r=n.filter(H2).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new uK(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new pK(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new fK(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new gK(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new xK(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new se(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=Iq[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(Nf)).name==="\0\0\0\0"){const o=`Error at offset=${this.tokenizer.position}: box.id=0`;Xr(o),this.addWarning(o);break}}catch(i){if(i instanceof Error){const o=`Error at offset=${this.tokenizer.position}: ${i.message}`;Xr(o),this.addWarning(o)}else throw i;break}const s=await Pf.readAtom(this.tokenizer,(i,o)=>this.handleAtom(i,o),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(o=>{const l={},c=V2[o.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${o.dataFormat}>`,o.description){const{description:u}=o;u.sampleRate>0&&(l.type=za.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(H2).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const o=V2[i.dataFormat];o&&this.metadata.setFormat("lossless",!o.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);Xr(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(wK,e,n)}addWarning(e){Xr(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const o=await this.tokenizer.readToken(new oK(i));n+=`:${o.name}`;break}default:{const o=await this.tokenizer.readToken(new Cn(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${Vw(o)} ascii=${Uw(o,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new aK(Number(n.header.length)-Nf.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=_e.get(r.value,3),i=_e.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=_e.get(r.value,1),i=Rf[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:Xr(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,Ff.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,Ff.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,_e.get(r.value,0));break;case 66:await this.addTag(e,Be.get(r.value,0));break;case 67:await this.addTag(e,ie.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=U2.get(e.description,r);return r+=U2.len,s.version===0||s.version===1?n.description=dK.get(e.description,r):Xr(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new yK(c));Xr(`Chapter ${i+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};Xr(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),s.push(d)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),Xr(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,o=1,l=this.getSamplesPerChunk(o,n.sampleToChunkTable),c=0;for(;o<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++o,l=this.getSamplesPerChunk(o,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var W2;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(W2||(W2={}));var G2;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(G2||(G2={}));const q2={len:2,get:(t,e)=>{const n=Re(t,e,0,3),r=Re(t,e,6,1),s=Re(t,e,7,9)/10;if(n>0)return{type:Re(t,e,0,3),origin:Re(t,e,3,3),adjustment:r?-s:s}}},_K={len:27,get:(t,e)=>{const n=ie.get(t,e+2);return{revision:Re(t,e,0,4),vbr_method:Re(t,e,4,4),lowpass_filter:100*_e.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:q2.get(t,6),album_gain:q2.get(t,8),music_length:ie.get(t,e+20),music_crc:_e.get(t,e+24),header_crc:Be.get(t,e+24)}}},Q2=new se(4,"ascii"),Pg=new se(6,"ascii"),bK={len:4,get:(t,e)=>({frames:Hn(t,e,31),bytes:Hn(t,e,30),toc:Hn(t,e,29),vbrScale:Hn(t,e,28)})};async function SK(t){const e=await t.readToken(bK),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(ie)),e.bytes&&(n.streamSize=await t.readToken(ie)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(ie)),await t.peekToken(new se(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new se(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const o=s[0].split(".").map(l=>Number.parseInt(l,10));o[0]>=3&&o[1]>=90&&(n.lame.extended=await t.readToken(_K))}}return n}const Un=Ve("music-metadata:parser:mpeg"),K2=1024,X2={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},EK=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class Pt{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=Re(e,n+1,3,2),this.layer=Pt.LayerDescription[Re(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!Hn(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return Pt.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=Re(e,n+2,0,4),this.sampRateFreqIndex=Re(e,n+2,4,2),this.padding=Hn(e,n+2,6),this.privateBit=Hn(e,n+2,7),this.channelModeIndex=Re(e,n+3,0,2),this.modeExtension=Re(e,n+3,2,2),this.isCopyrighted=Hn(e,n+3,4),this.isOriginalMedia=Hn(e,n+3,5),this.emphasis=Re(e,n+3,7,2),this.version=Pt.VersionID[this.versionIndex],this.channelMode=Pt.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){Un("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=Re(e,n+2,0,2);this.codec="AAC",this.codecProfile=X2.AudioObjectTypes[r],Un(`MPEG-4 audio-codec=${this.codec}`);const s=Re(e,n+2,2,4);this.samplingRate=X2.SamplingFrequencies[s],Un(`sampling-rate=${this.samplingRate}`);const i=Re(e,n+2,7,3);this.mp4ChannelConfig=EK[i],Un(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=Re(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return Pt.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:Pt.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}Pt.SyncByte1=255;Pt.SyncByte2=224;Pt.VersionID=[2.5,null,2,1];Pt.LayerDescription=[0,3,2,1];Pt.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];Pt.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};Pt.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};Pt.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const Y2={len:4,get:(t,e)=>new Pt(t,e)};function kK(t){return`V${Math.floor((100-t)/10)}`}class TK extends np{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(K2),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof xt){if(Un("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;Un(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;Un("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:K2,mayBeLess:!0}),this.syncPeek.len<=163)throw new xt;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=Pt.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),Un(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(Un(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(Pt.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new xt;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=Y2.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&Un("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();Un(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=Y2.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=Re(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),Un(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(As),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new Cn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(Q2);switch(this.offset+=Q2.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=kK(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Pg);if(this.frame_size!==null&&this.frame_size>=this.offset+Pg.len)return this.offset+=Pg.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await SK(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${yi(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),Un("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const J2=Ve("music-metadata:parser:musepack:sv8"),IK=new se(2,"latin1"),Z2={len:5,get:(t,e)=>({crc:J.get(t,e),streamVersion:_e.get(t,e+4)})},eE={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][Re(t,e,0,3)],maxUsedBands:Re(t,e,3,5),channelCount:Re(t,e+1,0,4)+1,msUsed:Hn(t,e+1,4),audioBlockFrames:Re(t,e+1,5,3)})};class CK{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(IK),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};J2(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Z2);e-=Z2.len,Object.assign(n,r),J2(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const o=await this.tokenizer.readToken(eE);return e-=eE.len,Object.assign(n,o),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(_e);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const jK=Ve("music-metadata:parser:musepack");class RK extends ar{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(Ze)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new CK(this.tokenizer);do{const n=await e.readPacketHeader();switch(jK(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),ns.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class AK{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(J);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(J),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const NK={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:Re(t,e+3,0,4),streamMajorVersion:Re(t,e+3,4,4),frameCount:J.get(t,e+4),maxLevel:Me.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][Re(t,e+10,0,2)],link:Re(t,e+10,2,2),profile:Re(t,e+10,4,4),maxBand:Re(t,e+11,0,6),intensityStereo:Hn(t,e+11,6),midSideStereo:Hn(t,e+11,7),titlePeak:Me.get(t,e+12),titleGain:Me.get(t,e+14),albumPeak:Me.get(t,e+16),albumGain:Me.get(t,e+18),lastFrameLength:J.get(t,e+20)>>>20&2047,trueGapless:Hn(t,e+23,0)};return n.lastFrameLength=n.trueGapless?J.get(t,20)>>>20&2047:0,n}},tE=Ve("music-metadata:parser:musepack");class PK extends ar{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(NK);if(e.signature!=="MP+")throw new Error("Unexpected magic number");tE(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new AK(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),tE(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),ns.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const nE=Ve("music-metadata:parser:musepack");class FK extends np{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new se(3,"latin1"));let n;switch(e){case"MP+":{nE("Musepack stream-version 7"),n=new PK;break}case"MPC":{nE("Musepack stream-version 8"),n=new RK;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class DK{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new se(8,"ascii").get(e,n+0),version:_e.get(e,n+8),channelCount:_e.get(e,n+9),preSkip:Me.get(e,n+10),inputSampleRate:J.get(e,n+12),outputGain:Me.get(e,n+16),channelMapping:_e.get(e,n+18)}}}class LK extends Va{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new DK(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new se(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const MK={len:80,get:(t,e)=>({speex:new se(8,"ascii").get(t,e+0),version:VA(new se(20,"ascii").get(t,e+8)),version_id:mt.get(t,e+28),header_size:mt.get(t,e+32),rate:mt.get(t,e+36),mode:mt.get(t,e+40),mode_bitstream_version:mt.get(t,e+44),nb_channels:mt.get(t,e+48),bitrate:mt.get(t,e+52),frame_size:mt.get(t,e+56),vbr:mt.get(t,e+60),frames_per_packet:mt.get(t,e+64),extra_headers:mt.get(t,e+68),reserved1:mt.get(t,e+72),reserved2:mt.get(t,e+76)})},OK=Ve("music-metadata:parser:ogg:speex");class $K extends Va{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){OK("First Ogg/Speex page");const r=MK.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const BK={len:42,get:(t,e)=>({id:new se(7,"ascii").get(t,e),vmaj:_e.get(t,e+7),vmin:_e.get(t,e+8),vrev:_e.get(t,e+9),vmbw:Be.get(t,e+10),vmbh:Be.get(t,e+17),nombr:_n.get(t,e+37),nqual:_e.get(t,e+40)})},Fg=Ve("music-metadata:parser:ogg:theora");class zK{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Fg("flush")}calculateDuration(e){Fg("duration calculation not implemented")}async parseFirstPage(e,n){Fg("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=BK.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const ws=Ve("music-metadata:parser:ogg");class Xw{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let o=n;o<n+r;++o)i+=s.getUint8(o);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:Xw.sum(e,n,this.len)}}}class rp extends ar{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){ws("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(rp.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,ws("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new Xw(e));ws("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new Cn(n.totalPageSize));if(ws("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":ws("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new Va(this.metadata,this.options);break;case"OpusHea":ws("Set page consumer to Ogg/Opus"),this.pageConsumer=new LK(this.metadata,this.options,this.tokenizer);break;case"Speex  ":ws("Set page consumer to Ogg/Speex"),this.pageConsumer=new $K(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":ws("Set page consumer to Ogg/Theora"),this.pageConsumer=new zK(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof xt?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),ws("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}rp.Header={len:27,get:(t,e)=>({capturePattern:Ze.get(t,e),version:_e.get(t,e+4),headerType:{continued:ut(t,e+5,0),firstPage:ut(t,e+5,1),lastPage:ut(t,e+5,2)},absoluteGranulePosition:Number(pn.get(t,e+6)),streamSerialNumber:J.get(t,e+14),pageSequenceNo:J.get(t,e+18),pageChecksum:J.get(t,e+22),page_segments:_e.get(t,e+26)})};const ec={len:8,get:(t,e)=>({chunkID:new se(4,"latin1").get(t,e),chunkSize:J.get(t,e+4)})};class UK{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new se(this.tagHeader.chunkSize,"ascii").get(e,n)}}var zx;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(zx||(zx={}));class VK{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:Me.get(e,n),nChannels:Me.get(e,n+2),nSamplesPerSec:J.get(e,n+4),nAvgBytesPerSec:J.get(e,n+8),nBlockAlign:Me.get(e,n+12),wBitsPerSample:Me.get(e,n+14)}}}class HK{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:J.get(e,n)}}}const rE={len:420,get:(t,e)=>({description:yi(new se(256,"ascii").get(t,e)).trim(),originator:yi(new se(32,"ascii").get(t,e+256)).trim(),originatorReference:yi(new se(32,"ascii").get(t,e+288)).trim(),originationDate:yi(new se(10,"ascii").get(t,e+320)).trim(),originationTime:yi(new se(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:J.get(t,e+338),timeReferenceHigh:J.get(t,e+342),version:Me.get(t,e+346),umid:new Cn(64).get(t,e+348),loudnessValue:Me.get(t,e+412),maxTruePeakLevel:Me.get(t,e+414),maxMomentaryLoudness:Me.get(t,e+416),maxShortTermLoudness:Me.get(t,e+418)})},ci=Ve("music-metadata:parser:RIFF");class WK extends ar{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(ec);if(ci(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof xt))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(Ze);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-Ze.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=ec.len;){const n=await this.tokenizer.readToken(ec);switch(e-=ec.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,ci(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new HK(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new VK(n));let s=zx[r.wFormatTag];s||(ci(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new Cn(n.chunkSize)),s=tl(r);await new Pr().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(rE);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-rE.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":ci(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:ci(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(ci("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new se(4,"latin1"));switch(ci("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),ci(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(ec),r=new UK(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,yi(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const GK=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],Qd={len:32,get:(t,e)=>{const n=J.get(t,e+24),r={BlockID:Ze.get(t,e),blockSize:J.get(t,e+4),version:Me.get(t,e+8),totalSamples:J.get(t,e+12),blockIndex:J.get(t,e+16),blockSamples:J.get(t,e+20),flags:{bitsPerSample:(1+Df(n,0,2))*8,isMono:Zr(n,2),isHybrid:Zr(n,3),isJointStereo:Zr(n,4),crossChannel:Zr(n,5),hybridNoiseShaping:Zr(n,6),floatingPoint:Zr(n,7),samplingRate:GK[Df(n,23,4)],isDSD:Zr(n,31)},crc:new Cn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Dg={len:1,get:(t,e)=>({functionId:Df(t[e],0,6),isOptional:Zr(t[e],5),isOddSize:Zr(t[e],6),largeBlock:Zr(t[e],7)})};function Zr(t,e){return Df(t,e,1)===1}function Df(t,e,n){return t>>>e&4294967295>>>32-n}const aa=Ve("music-metadata:parser:WavPack");class qK extends ar{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),ns.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(Ze)!=="wvpk")break;const n=await this.tokenizer.readToken(Qd);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");aa(`WavPack header blockIndex=${n.blockIndex}, len=${Qd.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(Qd.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Qd.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Dg.len;){const s=await this.tokenizer.readToken(Dg),i=await this.tokenizer.readNumber(s.largeBlock?Tf:_e),o=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),aa(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${o.length}`),s.functionId){case 0:break;case 14:{aa("ID_DSD_BLOCK");const l=1<<_e.get(o,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:aa("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:aa(`ID_BLOCK_CHECKSUM: checksum=${Vw(o)}`);break;default:aa(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=Dg.len+(s.largeBlock?Tf.len:_e.len)+i*2,aa(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const Kd={len:12,get:(t,e)=>({id:Ze.get(t,e),size:pn.get(t,e+4)})},QK={len:16,get:(t,e)=>({fileSize:If.get(t,e),metadataPointer:If.get(t,e+8)})};var sE;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(sE||(sE={}));const KK={len:40,get:(t,e)=>({formatVersion:mt.get(t,e),formatID:mt.get(t,e+4),channelType:mt.get(t,e+8),channelNum:mt.get(t,e+12),samplingFrequency:mt.get(t,e+16),bitsPerSample:mt.get(t,e+20),sampleCount:If.get(t,e+24),blockSizePerChannel:mt.get(t,e+32)})},Lg=Ve("music-metadata:parser:DSF");class XK extends np{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(Kd);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(QK);if(r.metadataPointer===BigInt(0))Lg("No ID3v2 tag present");else return Lg(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new Pr().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=Kd.len;){const n=await this.tokenizer.readToken(Kd);switch(Lg(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(KK);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-Kd.len);break}e-=n.size}}}const lo={len:12,get:(t,e)=>({chunkID:Ze.get(t,e),chunkSize:FA.get(t,e+4)})},fn=Ve("music-metadata:parser:aiff");class YK extends ar{async parse(){const e=await this.tokenizer.readToken(lo);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(Ze)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(Ze.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=lo.len;){const n=await this.tokenizer.readToken(lo);fn(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(lo.len)+n.chunkSize}}async readData(e){fn(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(J);fn(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(Ze)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(Ze.len));break}case"ID3":{const s=await this.tokenizer.readToken(new Cn(Number(e.chunkSize))),i=tl(s);await new Pr().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:fn(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(fn(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(fn(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(lo);fn(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(ie);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken(Be);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt(Be.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(Ze)).trim(),o=await this.tokenizer.readToken(_e),l=await this.tokenizer.readToken(new se(o,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken(Be),o=await this.tokenizer.readToken(_e),l=await this.tokenizer.readToken(_e),c=await this.tokenizer.readToken(ie);fn(`ABSS ${i}:${o}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken(Be);fn(`LSCO lsConfig=${i}`);break}default:fn(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(fn(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(lo.len)+n.chunkSize,fn(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){fn(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=Ze.len;){const r=await this.tokenizer.readToken(Ze);fn(`Channel[ID=${r}]`),n.push(r),e-=BigInt(Ze.len)}return fn(`Channels: ${n.join(", ")}`),n}}var B;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(B||(B={}));const JK={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:B.uint},17143:{name:"ebmlReadVersion",value:B.uint},17138:{name:"ebmlMaxIDWidth",value:B.uint},17139:{name:"ebmlMaxSizeWidth",value:B.uint},17026:{name:"docType",value:B.string},17031:{name:"docTypeVersion",value:B.uint},17029:{name:"docTypeReadVersion",value:B.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:B.binary},21420:{name:"position",value:B.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:B.uid},29572:{name:"filename",value:B.string},3979555:{name:"prevUID",value:B.uid},3965867:{name:"prevFilename",value:B.string},4110627:{name:"nextUID",value:B.uid},4096955:{name:"nextFilename",value:B.string},2807729:{name:"timecodeScale",value:B.uint},17545:{name:"duration",value:B.float},17505:{name:"dateUTC",value:B.uint},31657:{name:"title",value:B.string},19840:{name:"muxingApp",value:B.string},22337:{name:"writingApp",value:B.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:B.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:B.uid},171:{name:"prevSize",value:B.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:B.uint},29637:{name:"uid",value:B.uid},131:{name:"trackType",value:B.uint},185:{name:"flagEnabled",value:B.bool},136:{name:"flagDefault",value:B.bool},21930:{name:"flagForced",value:B.bool},156:{name:"flagLacing",value:B.bool},28135:{name:"minCache",value:B.uint},28136:{name:"maxCache",value:B.uint},2352003:{name:"defaultDuration",value:B.uint},2306383:{name:"timecodeScale",value:B.float},21358:{name:"name",value:B.string},2274716:{name:"language",value:B.string},134:{name:"codecID",value:B.string},25506:{name:"codecPrivate",value:B.binary},2459272:{name:"codecName",value:B.string},3839639:{name:"codecSettings",value:B.string},3883072:{name:"codecInfoUrl",value:B.string},2536e3:{name:"codecDownloadUrl",value:B.string},170:{name:"codecDecodeAll",value:B.bool},28587:{name:"trackOverlay",value:B.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:B.bool},21432:{name:"stereoMode",value:B.uint},176:{name:"pixelWidth",value:B.uint},186:{name:"pixelHeight",value:B.uint},21680:{name:"displayWidth",value:B.uint},21690:{name:"displayHeight",value:B.uint},21683:{name:"aspectRatioType",value:B.uint},3061028:{name:"colourSpace",value:B.uint},3126563:{name:"gammaValue",value:B.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:B.float},30901:{name:"outputSamplingFrequency",value:B.float},159:{name:"channels",value:B.uint},148:{name:"channels",value:B.uint},32123:{name:"channelPositions",value:B.binary},25188:{name:"bitDepth",value:B.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:B.uint},20530:{name:"scope",value:B.bool},20531:{name:"type",value:B.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:B.uint},16981:{name:"contentCompSettings",value:B.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:B.uint},18402:{name:"contentEncKeyID",value:B.binary},18403:{name:"contentSignature ",value:B.binary},18404:{name:"ContentSigKeyID  ",value:B.binary},18405:{name:"contentSigAlgo ",value:B.uint},18406:{name:"contentSigHashAlgo ",value:B.uint}}},25188:{name:"bitDepth",value:B.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:B.uid},183:{name:"positions",container:{247:{name:"track",value:B.uint},241:{name:"clusterPosition",value:B.uint},21368:{name:"blockNumber",value:B.uint},234:{name:"codecState",value:B.uint},219:{name:"reference",container:{150:{name:"time",value:B.uint},151:{name:"cluster",value:B.uint},21343:{name:"number",value:B.uint},235:{name:"codecState",value:B.uint}}},240:{name:"relativePosition",value:B.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:B.string},18030:{name:"name",value:B.string},18016:{name:"mimeType",value:B.string},18012:{name:"data",value:B.binary},18094:{name:"uid",value:B.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:B.uid},145:{name:"timeStart",value:B.uint},146:{name:"timeEnd",value:B.uid},152:{name:"hidden",value:B.bool},17816:{name:"enabled",value:B.uid},143:{name:"track",container:{137:{name:"trackNumber",value:B.uid},128:{name:"display",container:{133:{name:"string",value:B.string},17276:{name:"language ",value:B.string},17278:{name:"country ",value:B.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:B.uid},25540:{name:"tagChapterUID",value:B.uint},25542:{name:"tagAttachmentUID",value:B.uid},25546:{name:"targetType",value:B.string},26826:{name:"targetTypeValue",value:B.uint},25545:{name:"tagEditionUID",value:B.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:B.string},17543:{name:"string",value:B.string},17541:{name:"binary",value:B.binary},17530:{name:"language",value:B.string},17531:{name:"languageIETF",value:B.string},17540:{name:"default",value:B.bool}}}}}}}}}}},co=Ve("music-metadata:parser:ebml");var Fr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Fr||(Fr={}));class ZK{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(B.uint,n=>this.readUint(n)),this.parserMap.set(B.string,n=>this.readString(n)),this.parserMap.set(B.binary,n=>this.readBuffer(n)),this.parserMap.set(B.uid,async n=>this.readBuffer(n)),this.parserMap.set(B.bool,n=>this.readFlag(n)),this.parserMap.set(B.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(JA(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const o=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof xt)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case Fr.ReadNext:if(i.id,co(`Read element: name=${fa(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${o}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,o)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const d=await u(i);s[l.name]=d,await r.elementValue(l,d,o)}}break;case Fr.SkipElement:co(`Go to next element: name=${fa(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`);break;case Fr.IgnoreElement:co(`Ignore element: name=${fa(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(i.len);break;case Fr.SkipSiblings:co(`Ignore remaining container, at: name=${fa(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Fr.TerminateParsing:return co(`Terminate parsing at element: name=${fa(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:co(`parseEbml: parent=${fa(e)}, unknown child: id=${i.id.toString(16)} at position=${o}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(_e);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:Mg(e,e.length),len:Mg(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(DA);case 8:return this.tokenizer.readNumber(Rx);case 10:return this.tokenizer.readNumber(Rx);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return Mg(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new se(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function Mg(t,e){return Number(eX(t,e))}function eX(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),zw.get(n,0)}catch{return BigInt(-1)}}function JA(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,JA(e)}),t}function fa(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${fa(t.parent)}/`),e+t.name}const Xd=Ve("music-metadata:parser:matroska");class tX extends ar{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new ZK(this.tokenizer);Xd("Initializing DTD end MatroskaIterator"),await n.iterate(JK,e,{startNext:r=>{switch(r.id){case 475249515:return Xd(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Fr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return Xd(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),Fr.SkipElement}}return Fr.IgnoreElement;default:return Fr.ReadNext}},elementValue:async(r,s,i)=>{switch(Xd(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const o=s,l=o.timecodeScale?o.timecodeScale:1e6;if(typeof o.duration=="number"){const c=o.duration*l/1e9;await this.addTag("segment:title",o.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const o=s;if(o!=null&&o.entries){o.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=o.entries.filter(c=>c.trackType===za.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const o=s;await Promise.all(o.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?Nx[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async d=>{const m=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,m)}))}))}break;case 423732329:{const o=s;await Promise.all(o.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const Lf=Ve("music-metadata:parser:factory");function nX(t){const e=Hw.parse(t),n=eQ(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function rX(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=ZA(n)||Ux(r)||Ux(s);return i||Lf(`No parser found for MIME-type / extension: ${n}`),sX(t,i,e)}async function sX(t,e,n){if(!e){Lf("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=Ux(t.fileInfo.path)),!e){const o=await BA(i);if(!o)throw new Error("Failed to determine audio format");if(Lf(`Guessed file type is mime=${o.mime}, extension=${o.ext}`),e=ZA(o.mime),!e)throw new Error(`Guessed MIME-type not supported: ${o.mime}`)}}const r=await iX(e),s=new PQ(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function Ux(t){if(!t)return;switch(aX(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function iX(t){switch(t){case"aiff":return new BQ;case"adts":case"mpeg":return new TK;case"apev2":return new ns;case"asf":return new JQ;case"dsf":return new XK;case"dsdiff":return new YK;case"flac":return new tK;case"mp4":return new Ff;case"musepack":return new FK;case"ogg":return new rp;case"riff":return new WK;case"wavpack":return new qK;case"matroska":return new tX;default:throw new Error(`Unknown parser type: ${t}`)}}function aX(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function ZA(t){let e;if(!t)return;try{e=nX(t)}catch{Lf(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function oX(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),lX(t.stream(),n,e)}function lX(t,e,n={}){return cX(PA(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function cX(t,e){return rX(t,e)}const e5=async t=>{var l;if(!t)return;const e=await oX(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:null})};function uX(t){const{setErrorToast:e,setSuccessToast:n}=de(),{songFile:r,imageFile:s,setSong:i,setImageFile:o,updateSongData:l,setSongData:c,resetAddSongContext:u,songData:d,singers:m,song:p,genres:g,setGenres:y,setSingers:v,imageBlob:_,setImageBlob:S,...b}=Za(),[E,R]=f.useState(!1),D=f.useRef(null),F=f.useMemo(()=>{if(t.variant==="add")return!0;if(!p||!d)return!1;if(d.name!==p.name||m.length!==p.singers.length||d.like!==p.like||g.length!==p.genres.length)return!0;const he=!m.find(Se=>p.singers.find(H=>H.id==Se.id)),te=!g.find(Se=>p.genres.find(H=>H.id==Se.id));return he||te},[d,p,m,g]),I=!!s,k=f.useMemo(()=>{const Z=!!(d!=null&&d.name)&&!!m.length&&!!g.length&&F;return t.variant==="add"?Z:Z||I},[I,F,m,g,d]),j=()=>{switch(t.variant){case"add":return Cx({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":const{id:Z,updated_at:he,...te}=t.song;return v(te.singers),y(te.genres),Cx(te)}},C=()=>{var Z,he;switch(t.variant){case"add":(Z=D.current)==null||Z.close(),setTimeout(()=>u(j()),500);break;case"edit":(he=D.current)==null||he.close()}},N=async()=>{if(!r)return;const Z=await e5(r);if(Z){const he={name:Z.name,duration:Math.floor(Z.duration),size:Math.floor(r.size/1024),image_url:""};if(Z.image){const te=new Blob([Z.image]);S(te),he.image_url=URL.createObjectURL(te)}l(he)}},P=()=>{const Z={},he={};return g.forEach(te=>Z[te.id]=!0),m.forEach(te=>he[te.id]=!0),{genre_map:Z,singer_map:he}},A=async()=>{var Z,he;try{if(!k||!d)return;const te={...d};if(R(!0),s||_){const Se=await Yi({imageFile:s,blob:_});t.variant==="edit"&&(p!=null&&p.image_file_path)&&Yn({filePath:p.image_file_path,msg:">>> api: Delete image file"}),Object.assign(te,Se)}switch(t.variant){case"add":{if(!r)return;const{filePath:Se,fileURL:H}=await Cw({file:r,folder:"/songs/",msg:">>> api: upload song file",namePrefix:"song"}),Y={singers:m,genres:g,song_url:H,song_file_path:Se,...P()};Object.assign(te,Y),await Gs({collectionName:"Songs",data:te,msg:">>> api: set song doc"}),n(),(Z=D.current)==null||Z.open();break}case"edit":{if(!p)return;if(F){const Se={singers:m,genres:g,...P()};Object.assign(te,Se)}p&&i({...p,...te}),o(void 0),await Et({collectionName:"Songs",id:p.id,data:te}),n(),(he=D.current)==null||he.open()}}}catch(te){console.log(te),e()}finally{R(!1)}};return f.useEffect(()=>{c(j())},[]),f.useEffect(()=>{r&&N()},[r]),f.useEffect(()=>{s&&l({image_url:URL.createObjectURL(s)})},[s]),{isValidToSubmit:k,handleSubmit:A,isFetching:E,updateSongData:l,songFile:r,songData:d,genres:g,singers:m,modalRef:D,handleCloseModalAfterFinished:C,...b}}function dX({handleCloseModal:t,variant:e}){return a.jsxs(Pe,{children:[a.jsx(ot,{close:t,title:"Finished"}),a.jsx(Je,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),a.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[a.jsxs(ue,{href:"/dashboard/song",children:[a.jsx(LT,{className:"w-6"}),a.jsx("span",{children:"Songs"})]}),a.jsxs(ue,{onClick:t,children:[a.jsx(ir,{className:"w-6"}),a.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function hX(){const t=f.useRef(null),{songData:e,updateSongData:n,song:r}=Za(),[s,i]=f.useState({name:e==null?void 0:e.name,like:e==null?void 0:e.like}),o=c=>{i(u=>({...u,...c}))},l=()=>{var c;n(s),(c=t.current)==null||c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{onClick:()=>{var c;return(c=t.current)==null?void 0:c.open()},size:"clear",children:[a.jsx(Ks,{}),a.jsx("span",{children:"Edit"})]}),a.jsx(we,{to:`/dashboard/lyric/${r==null?void 0:r.id}`,children:a.jsxs(ue,{size:"clear",children:[a.jsx(fF,{}),a.jsx("span",{children:"Lyric"})]})}),a.jsx(Ee,{variant:"animation",ref:t,children:a.jsxs(Pe,{children:[a.jsx(ot,{title:"Edit song",close:()=>{var c;return(c=t.current)==null?void 0:c.close()}}),a.jsxs("div",{className:"space-y-2.5",children:[a.jsxs("div",{children:[a.jsx("p",{children:"Name:"}),a.jsx(Gt,{className:"bg-black/10",value:s==null?void 0:s.name,onChange:c=>o({name:c.target.value})})]}),a.jsxs("div",{className:"t",children:[a.jsx("p",{children:"Like:"}),a.jsx(Gt,{className:"bg-black/10",value:s==null?void 0:s.like,onChange:c=>isNaN(+c.target.value)?{}:o({like:+c.target.value})})]})]}),a.jsx("p",{className:"mt-6 text-right",children:a.jsx(ue,{onClick:l,children:"Ok"})})]})})]})}function fX(){const{setImageFile:t,songData:e,updateSongData:n,imageBlob:r,setImageBlob:s}=Za(),i=f.useRef(null),o=f.useRef(null),l=u=>{var d;(d=u.target.files)!=null&&d.length&&t(u.target.files[0])},c=()=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),n({image_url:""}))};return a.jsxs(a.Fragment,{children:[a.jsx(ue,{className:"except",size:"clear",children:a.jsxs("label",{htmlFor:"image_upload",className:"inline-flex p-1.5 space-x-1 md:px-3",children:[a.jsx(cl,{}),a.jsx("span",{children:"Change image"})]})}),r&&a.jsx(ue,{onClick:c,size:"clear",children:a.jsx(qi,{})}),(e==null?void 0:e.image_url)&&a.jsxs(ue,{onClick:()=>{var u;return(u=o.current)==null?void 0:u.open()},size:"clear",children:[a.jsx(gD,{}),a.jsx("span",{children:"Image info"})]}),a.jsx("input",{ref:i,onChange:l,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),(e==null?void 0:e.image_url)&&a.jsx(Ee,{variant:"animation",ref:o,children:a.jsxs(Pe,{children:[a.jsxs("p",{children:["Url: ",e==null?void 0:e.image_url]}),a.jsxs("p",{children:["Hash: ",e==null?void 0:e.blurhash_encode]})]})})]})}function mX({isEdit:t}){return a.jsx(a.Fragment,{children:a.jsxs(Ym,{children:[a.jsx(fX,{}),t&&a.jsx(hX,{})]})})}function t5(t){const{isFetching:e,handleSubmit:n,updateSongData:r,songData:s,isValidToSubmit:i,songFile:o,modalRef:l,handleCloseModalAfterFinished:c}=uX(t),u=f.useRef(null);return t.variant==="add"&&!o?a.jsx(qt,{children:a.jsx(IA,{})}):a.jsxs("div",{className:"w-full md:max-w-[800px] md:mx-auto",children:[a.jsx("audio",{ref:u,src:t.variant==="add"?URL.createObjectURL(o):(s==null?void 0:s.song_url)||"",className:"hidden"}),s&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"md:flex md:space-x-5",children:[a.jsxs("div",{className:"flex flex-col items-center md:w-1/3 md:block space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto bg-black/5 rounded-lg overflow-hidden",children:a.jsx(Je,{className:"object-cover h-full",blurHashEncode:s.blurhash_encode,src:s.image_url})}),t.variant==="edit"&&a.jsxs("div",{className:"w-full",children:[a.jsx(Ae,{title:s.name}),a.jsxs(wn,{className:"[&>*]:text-sm ",children:[a.jsxs("p",{children:["Duration: ",Br(s.duration)]}),a.jsxs("p",{children:["Size: ",s.size," kb"]}),a.jsxs("p",{className:"mt-1 font-[500]",children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",Sr(s.like)]})]})]}),a.jsx("div",{className:"w-full",children:a.jsx(mX,{isEdit:t.variant==="edit"})})]}),a.jsxs("div",{className:"mt-5 md:mt-0 space-y-3 flex-grow",children:[u.current&&a.jsx(lq,{variant:t.variant,audioEle:u.current}),t.variant==="add"&&a.jsx(wn,{children:a.jsxs("span",{children:["Duration: ",Br(s.duration)," , Size:"," ",s.size,"kb"]})}),t.variant==="add"&&a.jsxs("div",{className:"",children:[a.jsx(Ae,{title:"Name"}),a.jsx(Gt,{value:s.name,onChange:d=>r({name:d.target.value})})]}),a.jsx(oq,{}),a.jsx(uq,{})]})]}),a.jsx("p",{className:"text-center mt-5",children:a.jsxs(ue,{onClick:n,disabled:!i,loading:e,children:[a.jsx(av,{className:"w-6"}),a.jsx("span",{children:"Ok"})]})}),a.jsx(Ee,{persisted:t.variant==="add",ref:l,variant:"animation",children:a.jsx(dX,{variant:t.variant,handleCloseModal:c})})]})]})}function pX(){const{user:t}=ge();if(t)return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{className:"mb-5",title:"Add Song"}),a.jsx(t5,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function gX(){const[t,e]=f.useState(!0),[n,r]=f.useState(),s=f.useRef(!1),i=Dt(),{setErrorToast:o}=de();return{song:n,isFetching:t,getSong:async c=>{try{const u=await Vr({collectionName:"Songs",id:c});if(!u.exists())return i("/dashboard/song");const d={...u.data(),id:u.id,queue_id:""};r(d)}catch(u){console.log(u),o()}finally{e(!1)}},ranEffect:s}}function xX(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=gX(),{variant:s,setSong:i}=Za(),o=Gi();return f.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!o.songId)return;t(o.songId)}},[]),f.useEffect(()=>{n&&i(n)},[n]),e?a.jsx(qt,{children:a.jsx(Ku,{})}):n?a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{className:"mb-5",title:"Edit Song"}),a.jsx(t5,{song:n,variant:"edit"})]}):a.jsx(a.Fragment,{})}const yX=["All","Result"];function vX(){const{setPlaylists:t,playlists:e}=Tn(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=de(),u=async m=>{try{m.preventDefault(),i(!0);const p=pe(br,Q("is_official","==",!0),Q("is_album","==",!1),Q("name",">=",n),Q("name","<=",n+"")),g=await Hr(p);t(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=pe(br,Q("is_official","==",!0),Q("is_album","==",!1),Ur("updated_at","desc")),p=await Hr(m);t(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,playlists:e,tab:o,setTab:l,tabs:yX}}function wX(){const{user:t}=ge(),{handleAddPlaylist:e,isFetching:n}=KR(),r=f.useRef(null),s=()=>{var o;return(o=r.current)==null?void 0:o.close()},i=async(o,l)=>{o.is_official=!0,await e(o,l),s()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{onClick:()=>{var o;return(o=r.current)==null?void 0:o.open()},className:"self-start p-1.5 ml-5",size:"clear",color:"primary",children:[a.jsx(Xs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),a.jsx(Ee,{ref:r,variant:"animation",children:a.jsx(Pe,{className:"w-[600px]",children:a.jsx(Qu,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function _X(){const{isFetching:t,playlists:e,tab:n,tabs:r,setTab:s,...i}=vX();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{title:"Playlists"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(kl,{...i}),a.jsx(wX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(gs,{disable:n==="All",tabs:r,render:o=>o,tab:n,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(ce,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(Ji,{colList:["Name","Like",""],children:e.length?e.map((o,l)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(we,{className:"hover:underline",to:`/dashboard/playlist/${o.id}`,children:o.name})}),a.jsx("td",{children:Sr(o.like)}),a.jsx("td",{children:"-"})]},l)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ye,{})})})})]})]})}function bX(){const[t,e]=f.useState([]),[n,r]=f.useState(""),[s,i]=f.useState(!1),{setErrorToast:o}=de();return{isFetching:s,value:n,songs:t,setValue:r,handleSubmit:async c=>{try{c.preventDefault(),i(!0);const u=pe(bn,Q("name",">=",n),Q("name","<=",n+""),Q("is_official","==",!0)),d=await Sn(u);e(d)}catch(u){console.log({message:u}),o()}finally{i(!1)}}}}function SX({closeModal:t,submit:e,isLoading:n}){const{theme:r}=G(),{songs:s,isFetching:i,...o}=bX(),{selectedSongs:l,selectSong:c}=Tu(),u=async()=>{l.length&&(e(l),t())},d=f.useMemo(()=>{const p=l.map(g=>g.id);return s.filter(g=>!p.includes(g.id))},[s,l]),m={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-black/10 p-2",songItem:"rounded-md w-full p-1 text-left"};return a.jsx(a.Fragment,{children:a.jsxs(Pe,{className:"w-[600px] h-[400px]",children:[a.jsx(ot,{close:t,title:"Add song"}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2",children:[a.jsxs("div",{className:`${m.col}`,children:[a.jsx(kl,{...o}),a.jsx("div",{className:`${m.box} flex-grow mt-3`,children:a.jsx("div",{className:"h-full overflow-auto pace-y-2",children:i?a.jsx(Ku,{className:"h-full"}):d.map((p,g)=>a.jsx("button",{onClick:()=>c(p),className:`${m.songItem} bg-black/10 ${r.content_hover_bg}`,children:a.jsx("h5",{className:"",children:p.name})},g))})})]}),a.jsxs("div",{className:`${m.col} mt-3 md:mt-0`,children:[a.jsx("div",{className:"font-[500] mb-3",children:"Selected:"}),a.jsx("div",{className:`${m.box} flex-grow overflow-auto space-y-2 `,children:l.map((p,g)=>a.jsx("button",{onClick:()=>c(p),className:`${m.songItem} ${r.content_bg} hover:bg-black/10 hover:text-black`,children:a.jsx("h5",{className:"",children:p.name})},g))})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(ue,{disabled:!l.length,loading:n,onClick:u,children:[a.jsx(bu,{className:"w-6"}),a.jsx("span",{children:"Add"})]})})]})})}function n5(t){return a.jsx(ms,{children:a.jsx(SX,{...t})})}function EX(){const[t,e]=f.useState(""),n=f.useRef(null),{action:r,playlist:s,isFetching:i}=Jm(),o=d=>{var m,p;e(d),t==="add-song-to-playlist"&&((m=n.current)==null||m.setModalPersist(!0)),(p=n.current)==null||p.open()},l=()=>{var d;return(d=n.current)==null?void 0:d.close()},c=async d=>{await r(d),l()},u=()=>{switch(t){case"":return a.jsx(a.Fragment,{});case"edit":return s?a.jsx(a.Fragment,{children:a.jsx(Pe,{className:"w-[600px]",children:a.jsx(Qu,{submit:(d,m)=>c({variant:"edit-playlist",playlist:d,imageFile:m}),variant:"edit",isLoading:i,playlist:s,close:l})})}):"Playlist is undefined";case"delete":return a.jsx(ps,{loading:i,label:"Delete playlist ?",callback:()=>c({variant:"delete-playlist"}),close:l});case"add-song-to-playlist":return a.jsx(n5,{isLoading:i,submit:d=>c({variant:"add-songs",songs:d}),closeModal:l})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Ym,{children:[a.jsxs(ue,{onClick:()=>o("edit"),size:"clear",children:[a.jsx(Ks,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(ue,{onClick:()=>o("delete"),size:"clear",children:[a.jsx(Ln,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(ue,{onClick:()=>o("add-song-to-playlist"),size:"clear",children:[a.jsx(AH,{}),a.jsx("span",{children:"Add song"})]})]}),a.jsx(Ee,{variant:"animation",ref:n,children:u()})]})}function kX(){const[t,e]=f.useState(!0),{setSongs:n,setPlaylist:r,playlist:s,songs:i}=Lw(),o=f.useRef(!1),l=Gi(),c=Dt(),{setErrorToast:u}=de(),d=async()=>{try{if(!l.id)return;const m=await Vr({collectionName:"Playlists",id:l.id});if(!m.exists())return c("/dashboard/playlist");const p={...m.data(),id:m.id};if(p.song_ids.length){const g=pe(bn,Q(Ys(),"in",p.song_ids)),y=await Sn(g);n(y)}r(p)}catch(m){console.log(m),u()}finally{e(!1)}};return f.useEffect(()=>{o.current||(o.current=!0,d())},[]),{songs:i,playlist:s,isFetching:t}}function TX({singer:t}){const{action:e}=Jm();return a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:a.jsx(Ln,{className:"w-5"})})})]})}function IX(t){const{playlist:e}=Lw(),{updatePlaylistData:n,playlistData:r,isValidToSubmit:s}=ZR(t),{action:i,isFetching:o}=Jm(),l=f.useRef(null),c=f.useRef(null),u=async()=>{var d;!r||!s||(await i({variant:"edit-playlist",playlist:r}),(d=l.current)==null||d.close())};if(e)return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("p",{className:"mt-1 font-[500]",children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",Sr(e.like)]}),a.jsx("button",{className:"",onClick:()=>{var d;return(d=l.current)==null?void 0:d.open()},children:a.jsx(Ks,{className:"w-5"})})]}),a.jsx(Ee,{variant:"animation",ref:l,children:a.jsxs(Pe,{children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"like",children:"Like"}),a.jsx(Gt,{id:"like",ref:c,type:"number",value:(r==null?void 0:r.like)+"",onChange:d=>n({like:+d.target.value})})]}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(ue,{loading:o,color:"primary",onClick:u,disabled:!s,className:"font-playwriteCU rounded-full",children:"Save"})})]})})]})}function CX(){const{isFetching:t,songs:e,playlist:n}=kX(),r=f.useMemo(()=>e.reduce((s,i)=>s+i.duration,0),[e]);return t?a.jsx(qt,{children:a.jsx(Ku,{})}):n?a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{title:"Edit playlist",className:"mb-3"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-2.5 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto",children:a.jsx(ju,{children:a.jsx(Je,{className:"object-cover h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})})}),a.jsxs("div",{children:[a.jsx(Ae,{title:n.name}),a.jsxs(wn,{className:"mt-1",children:[a.jsx("p",{children:n.is_public?"Public":"Private"}),a.jsxs("p",{children:[e.length," songs - ",Br(r)]}),a.jsx(IX,{variant:"edit",playlist:n})]})]}),a.jsx(EX,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[a.jsx(Ae,{title:"Singers"}),a.jsx(wn,{className:"mt-1",children:n.singers.length?a.jsx("div",{className:"-mt-2 -ml-2 flex ",children:n.singers.map((s,i)=>a.jsx(Sl,{children:a.jsx(TX,{singer:s})},i))}):a.jsx(Ye,{})}),a.jsx(Ae,{title:"Songs",className:"mt-3"}),a.jsx(wn,{className:"mt-1",children:a.jsx("div",{className:"overflow-hidden",children:a.jsx(UI,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer","Like",""],children:e.length?e.map((s,i)=>a.jsx(EA,{variant:"playlist",song:s},i)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,children:a.jsx(Ye,{})})})})})})]})]})]}):a.jsx(a.Fragment,{})}function jX(t){const{setErrorToast:e,setSuccessToast:n}=de(),{singer:r,setSinger:s,setSingers:i}=Qs(),[o,l]=f.useState(),[c,u]=f.useState(),[d,m]=f.useState(!1),p=f.useRef(null),g=E=>{o&&l({...o,...E})},y=f.useMemo(()=>t.variant==="add"?!0:!r||!o?!1:o.name!==r.name||o.description!==r.description||o.like!==r.like,[o]),v=!!c,_=f.useMemo(()=>{const E=!!(o!=null&&o.name)&&y;return t.variant==="add"?E:E||v},[v,y,o]),S=async()=>{try{if(!_||!o)return;m(!0);const E={...o};if(c){const R=await Yi({imageFile:c});Object.assign(E,R)}switch(t.variant){case"add":{const R=await Gs({collectionName:"Singers",data:E}),D={...o,id:R.id};i(F=>[D,...F]),n("Add singer successful");break}case"edit":{if(!r)return;await Et({collectionName:"Singers",id:r.id,data:E}),s({...r,...E}),n("Edit singer successful")}}}catch(E){console.log(E),e()}finally{m(!1),t.closeModal()}},b=()=>{switch(t.variant){case"add":return kf({});case"edit":if(!r)throw new Error("");const{id:E,...R}=r;return kf(R)}};return f.useEffect(()=>{var E;t.variant==="add"&&((E=p.current)==null||E.focus()),l(b())},[]),f.useEffect(()=>{c&&g({image_url:URL.createObjectURL(c)})},[c]),f.useEffect(()=>{var E;(E=p.current)==null||E.focus()},[]),{singerData:o,imageFile:c,setImageFile:u,updateSingerData:g,setSingerData:l,inputRef:p,handleSubmit:S,isFetching:d,isValidToSubmit:_}}function r5(t){const{theme:e}=G(),{setImageFile:n,singerData:r,handleSubmit:s,isFetching:i,isValidToSubmit:o,updateSingerData:l,inputRef:c}=jX(t),u=d=>{var m;(m=d.target.files)!=null&&m.length&&n(d.target.files[0])};if(r)return a.jsxs(Pe,{className:"w-[700px] md:block",children:[a.jsx(ot,{close:t.closeModal,title:t.variant==="add"?"Add singer":"Edit singer"}),a.jsxs("div",{className:"flex-grow overflow-auto md:flex md:flex-[unset] md:overflow-hidden",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:a.jsx(Je,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),a.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",id:"image_upload",className:"hidden"}),a.jsx("div",{className:"space-x-2 flex",children:a.jsx(ue,{className:`${e.content_bg}`,size:"clear",children:a.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:a.jsx(cl,{className:"w-5"})})})})]}),a.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Name:"}),a.jsx(Gt,{ref:c,type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:r.name,onChange:d=>l({name:d.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Description:"}),a.jsx("textarea",{placeholder:"...",id:"description",className:`${cv} w-full bg-[#f1f1f1] rounded-md min-h-[100px]`,value:r.description,onChange:d=>l({description:d.target.value})})]}),t.variant==="edit"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),a.jsx(Gt,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:r.like+"",onChange:d=>l({like:+d.target.value})})]})]})]}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(ue,{loading:i,color:"primary",onClick:s,disabled:!o,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function RX(){const t=f.useRef(null),e=()=>{var n;return(n=t.current)==null?void 0:n.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(Xs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),a.jsx(Ee,{ref:t,variant:"animation",children:a.jsx(r5,{closeModal:e,variant:"add"})})]})}const AX=["All","Result"];function NX(){const{setSingers:t,singers:e}=Qs(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=de(),u=async m=>{try{m.preventDefault(),i(!0);const p=pe(Sf,Q("name",">=",n),Q("name","<=",n+"")),g=await Ef(p);t(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=pe(Sf,Ur("created_at","desc")),p=await Ef(m);t(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,singers:e,tab:o,setTab:l,tabs:AX}}function PX(){const{isFetching:t,singers:e,tabs:n,tab:r,setTab:s,...i}=NX();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{title:"Singer"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(kl,{...i}),a.jsx(RX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(gs,{disable:r==="All",tabs:n,render:o=>o,tab:r,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(ce,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(Ji,{colList:["Name","Like"],children:e.length?e.map((o,l)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${o.id}`,children:o.name})}),a.jsx("td",{children:Sr(o.like)})]},l)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Ye,{})})})})]})]})}function FX({value:t}){const e=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[a.jsx(ir,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),a.jsx(Ee,{ref:e,variant:"animation",children:a.jsx($w,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function DX({genre:t}){const[e,n]=f.useState(""),r=f.useRef(null),{action:s,isFetching:i}=jA(),o=u=>{var d;n(u),(d=r.current)==null||d.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return a.jsxs(a.Fragment,{children:[a.jsxs(Sl,{children:[a.jsx("span",{children:t.name}),a.jsxs("div",{children:[a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(Ks,{className:"w-5"})}),a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(Ln,{className:"w-5"})})]})]}),a.jsxs(Ee,{variant:"animation",ref:r,children:[e==="edit"&&a.jsx($w,{type:"edit",genre:t,closeModal:l}),e==="delete"&&a.jsx(ps,{callback:c,close:l,loading:i,label:`Delete genre '${t.name}'`})]})]})}function LX(){const{isFetching:t,api:e}=RA(),{_genres:n,...r}=AA();return f.useEffect(()=>{e()},[]),a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{title:"Genres"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(kA,{...r}),a.jsx(FX,{value:r.value})]}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(ce,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(a.Fragment,{children:n.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(s=>a.jsx(DX,{genre:s},s.id))}):a.jsx(Ye,{})})]})]})}function MX(){return a.jsx(vA,{})}function OX(){const{setErrorToast:t}=de(),{singer:e,setSinger:n}=Qs(),[r,s]=f.useState(!1),i=Dt();return{isFetching:r,action:async l=>{try{switch(l.variant){case"delete":{if(!e)throw new Error("");s(!0),await Iw({collectionName:"Singers",id:e.id}),e.image_file_path&&await Yn({filePath:e.image_file_path}),s(!1),i("/dashboard/singer");break}}}catch(c){console.log({message:c}),t("")}finally{s(!1)}},singer:e,setSinger:n}}function $X(){const[t,e]=f.useState(""),n=f.useRef(null),{action:r,isFetching:s,singer:i}=OX(),o=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>o("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),a.jsx("div",{className:"mt-3 md:!mt-auto",children:a.jsxs(Ym,{children:[a.jsxs(ue,{onClick:()=>o("edit"),className:"md:px-3",size:"clear",children:[a.jsx(Ks,{className:"w-6"}),a.jsx("span",{children:"Edit singer"})]}),a.jsxs(ue,{onClick:()=>o("delete"),className:"md:px-3",size:"clear",children:[a.jsx(Ln,{className:"w-6"}),a.jsx("span",{children:"Delete"})]})]})}),a.jsxs(El,{ref:n,children:[t==="more"&&i&&a.jsx(Pe,{children:i.description}),t==="edit"&&a.jsx(r5,{closeModal:l,variant:"edit"}),t==="delete"&&i&&a.jsx(ps,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),close:l})]})]})}function BX(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=Qs(),{setErrorToast:s}=de(),{setIsFetching:i}=Yu(),o=Gi(),l=Dt(),c=f.useRef(!1),u=async()=>{try{if(!o.id)return;const d=await Vr({collectionName:"Singers",id:o.id});d.exists()||l("/dashboard/singer");const m={...d.data(),id:o.id},p=pe(bn,Q(`singer_map.${m.id}`,"==",!0)),g=await Sn(p),y=pe(br,Q(`singer_map.${m.id}`,"==",!0)),v=await Hr(y),_=[],S=[];v.forEach(b=>b.is_album?S.push(b):_.push(b)),t(m),n(_),r(S),e(g)}catch(d){console.log({error:d}),s()}finally{i(!1)}};f.useEffect(()=>{c.current||(c.current=!0,u())},[])}function zX(){const[t,e]=f.useState(!0);return{isFetching:t,setIsFetching:e}}const s5=f.createContext(null);function UX({children:t}){return BX(),t}function VX({children:t}){return a.jsx(s5.Provider,{value:zX(),children:a.jsx(UX,{children:t})})}function Yu(){const t=f.useContext(s5);if(!t)throw new Error;return t}function HX(){const{singer:t}=Qs(),{isFetching:e}=Yu();return!e&&!t?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex",children:[a.jsx("div",{className:"w-[260px] h-[260px] mx-auto md:m-unset",children:e?a.jsx(ce,{className:"pt-[100%] "}):a.jsx(ju,{children:a.jsx(Je,{src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})})}),a.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?a.jsxs(a.Fragment,{children:[a.jsx(ce,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(ce,{className:"h-[120px] w-full md:w-[70%]"}),a.jsx(ce,{className:"h-[17px] w-[200px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:t.name}),a.jsxs("p",{children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",Sr(t.like)]}),a.jsx("p",{className:"line-clamp-2",children:t.description}),a.jsx($X,{})]})})]})})}function WX(){const{songs:t}=Qs(),{isFetching:e}=Yu();return a.jsxs(a.Fragment,{children:[a.jsx(Ae,{title:"Songs"}),a.jsx(ms,{children:e?a.jsx(ce,{className:"h-[100px]"}):a.jsx(Ji,{colList:["Name","Singer"],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsx(we,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Ye,{})})})})})]})}function GX(){const{playlists:t}=Qs(),{isFetching:e}=Yu();return a.jsxs(a.Fragment,{children:[a.jsx(Ae,{title:"Playlists"}),e&&a.jsx(ce,{className:"h-[100px]"}),!e&&a.jsx(Ji,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Ye,{})})})})]})}function qX(){const[t,e]=f.useState(),[n,r]=f.useState([]),[s,i]=f.useState(),[o,l]=f.useState(),[c,u]=f.useState();return{singer:t,setSinger:e,songs:n,setSongs:r,updateAlbumData:m=>{s&&i({...s,...m})},albumData:s,imageFile:o,setImageFile:l,setAlbumData:i,album:c,setAlbum:u}}const i5=f.createContext(null);function QX({children:t}){return a.jsx(i5.Provider,{value:qX(),children:t})}function Tl(){const t=f.useContext(i5);if(!t)throw new Error("AddAlbumProvider not provided");return t}function KX(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,setSongs:i,album:o,singer:l,songs:c,setAlbum:u,setImageFile:d,setAlbumData:m}=Tl(),{setSuccessToast:p,setErrorToast:g}=de(),[y,v]=f.useState(!1),_=f.useRef(!1),S=f.useMemo(()=>t.variant==="add"?!0:!o||!s||!l?!1:s.name!==o.name||l.id!==o.singers[0].id||s.like!==o.like||!!c.find(F=>!o.song_ids.includes(F.id)),[s,o,l,c]),b=!!e,E=f.useMemo(()=>{const F=!!S&&!!s&&!!s.name&&!!l&&!!c.length;return t.variant==="add"?F:F||b},[b,S,s,l,c]),R=async()=>{try{if(!s||!l)return;if(v(!0),e){const F=await Yi({imageFile:e});Object.assign(s,F)}switch(s.singers=[l],s.singer_map={[l.id]:!0},s.song_ids=c.map(F=>F.id),t.variant){case"add":{const F=await Gs({collectionName:"Playlists",data:s}),I=await La(F),k={...I.data(),id:I.id};t.callback(k),p("Album created");break}case"edit":{if(!o)return;await Et({collectionName:"Playlists",data:s,id:o.id}),u({...o,...s}),p("Album edited");break}}}catch(F){console.log(F),g()}finally{v(!1),d(void 0)}},D=async()=>{switch(t.variant){case"add":m(d2({owner_email:t.user.email,distributor:t.user.email})),r(t.singer);break;case"edit":const{id:F,song_ids:I,singers:k,...j}=t.album;if(I){const C=pe(bn,Q(Ys(),"in",I)),N=await Sn(C);i(N)}u(t.album),r(k[0]),m(d2({...j,song_ids:I,singers:k}));break}};return f.useEffect(()=>{_.current||(_.current=!0,D())},[]),f.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:R,isFetching:y,isValidToSubmit:E}}function XX(){const{singer:t,setSinger:e,albumData:n,updateAlbumData:r}=Tl(),s=f.useRef(null),i=o=>{var l;e(o),(l=s.current)==null||l.close()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(wn,{className:"space-y-2.5",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-lg",htmlFor:"name",children:"Name"}),a.jsx(Gt,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:o=>r({name:o.target.value})})]}),a.jsxs("div",{className:"flex items-center space-x-1.5",children:[a.jsx("p",{className:"text-lg",children:"Singer"}),t?a.jsxs(Sl,{className:"mt-0",children:[a.jsx("span",{children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(void 0),children:a.jsx(Ln,{className:"w-5"})})})]}):a.jsx(ue,{size:"clear",className:"p-1.5",onClick:()=>{var o;return(o=s.current)==null?void 0:o.open()},children:a.jsx(ir,{className:"w-5"})})]})]}),a.jsx(Ee,{variant:"animation",ref:s,children:a.jsx(Ow,{choose:i,closeModal:()=>{var o;return(o=s.current)==null?void 0:o.close()}})})]})}function YX(){const{songs:t,setSongs:e}=Tl(),n=f.useRef(null),r=i=>{const o=t.map(c=>c.id),l=i.filter(c=>!o.includes(c.id));e([...t,...l])},s=i=>{const o=t.filter(l=>l.id!==i.id);e(o)};return a.jsxs(a.Fragment,{children:[a.jsxs(Ji,{colList:["Name","Singer","Like"," "],children:[t.map((i,o)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("span",{children:i.name})}),a.jsx("td",{children:i.singers.map((l,c)=>a.jsxs("span",{className:"hover:underline",children:[!!c&&", ",l.name]},c))}),a.jsx("td",{children:a.jsx("span",{children:Sr(i.like)})}),a.jsx("td",{children:a.jsx(ue,{onClick:()=>s(i),size:"clear",className:"p-1",children:a.jsx(Ln,{className:"w-5"})})})]},o)),a.jsx("tr",{className:"!bg-white border-none",children:a.jsx("td",{colSpan:3,children:a.jsx("p",{className:"text-center",children:a.jsxs(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:[a.jsx(ir,{className:"w-6"}),a.jsx("span",{children:"Add song"})]})})})})]}),a.jsx(Ee,{variant:"animation",ref:n,children:a.jsx(n5,{submit:r,closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()},isLoading:!1})})]})}function JX(){const{album:t}=Tl(),e=f.useRef(null),n=Dt(),r=async()=>{try{if(!t)return;await Promise.all([Iw({collectionName:"Playlists",id:t.id}),t.image_file_path?Yn({filePath:t.image_file_path}):()=>{}]),n("/dashboard/album")}catch{}};return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{size:"clear",onClick:()=>{var s;return(s=e.current)==null?void 0:s.open()},children:[a.jsx(Ln,{className:"w-6"}),a.jsx("span",{children:"Delete"})]}),a.jsx(Ee,{variant:"animation",ref:e,children:a.jsx(ps,{label:`Delete album ' ${t==null?void 0:t.name} '`,close:()=>{var s;return(s=e.current)==null?void 0:s.close()},callback:r,loading:!1})})]})}function ZX({closeModal:t}){const{albumData:e,singer:n,setSinger:r,updateAlbumData:s}=Tl();if(!e||!n)throw new Error("albumData or singer is undefined");const[i,o]=f.useState(e),[l,c]=f.useState(n),u=f.useRef(null),d=f.useMemo(()=>i.name!==e.name||i.like!==e.like||l!==n,[i,l]),m=f.useMemo(()=>!!(i!=null&&i.name)&&!!l&&d,[d]),p=v=>{o({...i,...v})},g=v=>{var _;c(v),(_=u.current)==null||_.close()},y=()=>{r(l),s(i),t()};if(i)return a.jsxs(a.Fragment,{children:[a.jsxs(Pe,{children:[a.jsx(ot,{close:t,title:"Edit album"}),a.jsx("div",{className:"flex-grow overflow-auto",children:a.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Album name:"}),a.jsx(Gt,{type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:i.name,onChange:v=>p({name:v.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Singer:"}),a.jsx("div",{className:"-mt-2 -ml-2",children:a.jsxs(Sl,{className:"mt-0 w-fit",children:[a.jsx("span",{children:l.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>{var v;return(v=u.current)==null?void 0:v.open()},children:a.jsx(We,{className:"w-5"})})})]})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),a.jsx(Gt,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:i.like+"",onChange:v=>p({like:+v.target.value})})]})]})}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(ue,{color:"primary",onClick:y,disabled:!m,className:"font-playwriteCU rounded-full",children:"Save"})})]}),a.jsx(El,{ref:u,children:a.jsx(Ow,{choose:g,closeModal:()=>{var v;return(v=u.current)==null?void 0:v.close()}})})]})}function eY(){const t=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{onClick:()=>{var e;return(e=t.current)==null?void 0:e.open()},children:[a.jsx(Ks,{className:"w-6"}),a.jsx("span",{children:"Edit"})]}),a.jsx(Ee,{variant:"animation",ref:t,children:a.jsx(ZX,{closeModal:()=>{var e;return(e=t.current)==null?void 0:e.close()}})})]})}function tY({className:t="",...e}){const{theme:n}=G(),{albumData:r,singer:s,setImageFile:i}=Tl(),{submit:o,isFetching:l,isValidToSubmit:c}=KX(e),u=m=>{var p;(p=m.target.files)!=null&&p.length&&i(m.target.files[0])},d=a.jsxs(Ym,{children:[a.jsx(ue,{className:`${n.content_bg} !p-0`,size:"clear",children:a.jsxs("label",{htmlFor:"image_upload",className:"md:px-3 p-1.5 inline-flex space-x-1 cursor-pointer ",children:[a.jsx(cl,{className:"w-6"}),a.jsx("span",{children:"Change image"})]})}),e.variant==="edit"&&a.jsxs(a.Fragment,{children:[a.jsx(eY,{}),a.jsx(JX,{})]})]});return r?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`md:flex ${t}`,children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] mx-auto h-[200px] rounded-lg overflow-hidden",children:a.jsx(Je,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),a.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),e.variant==="add"&&a.jsx("div",{children:d}),e.variant==="edit"&&a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ae,{title:r.name}),a.jsxs(wn,{className:"text-[#333]",children:[a.jsx("p",{className:"text-xl",children:s==null?void 0:s.name}),a.jsxs("p",{children:[r.song_ids.length," songs"]}),a.jsxs("p",{className:"mt-1 font-[500]",children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",Sr(r.like)]})]}),a.jsx("div",{className:"mt-3",children:d})]})})]}),a.jsxs("div",{className:"mt-3 md:w-3/4 md:mt-0 md:ml-3 flex-grow flex flex-col space-y-2.5",children:[e.variant==="add"&&a.jsx(XX,{}),a.jsxs("div",{children:[e.variant==="add"&&a.jsx("p",{className:"text-lg mb-1",children:"Songs"}),e.variant==="edit"&&a.jsx(Ae,{title:"Songs"}),a.jsx(YX,{})]})]})]}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(ue,{loading:l,color:"primary",onClick:o,disabled:!c,className:"font-playwriteCU rounded-full",children:"Save"})})]}):a.jsx(a.Fragment,{})}function Yw(t){return a.jsx(QX,{children:a.jsx(tY,{...t})})}function nY(){const{user:t}=ge(),{singer:e,setAlbums:n}=Qs(),r=f.useRef(null),s=i=>{n(o=>[i,...o])};return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"px-3 py-1",size:"clear",children:[a.jsx(ir,{className:"w-5"}),a.jsx("span",{children:"Add album"})]}),a.jsx(El,{ref:r,children:a.jsx(Pe,{className:"w-[700px]",children:t&&e&&a.jsxs(a.Fragment,{children:[a.jsx(ot,{title:"Add album",close:()=>{var i;return(i=r.current)==null?void 0:i.close()}}),a.jsx(Yw,{className:"flex-grow overflow-auto no-scrollbar md:overflow-hidden",variant:"add",singer:e,callback:s,user:t})]})})})]})}function rY(){const{albums:t}=Qs(),{isFetching:e}=Yu();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Ae,{title:"Albums"}),a.jsx(nY,{})]}),e&&a.jsx(ce,{className:"h-[100px]"}),!e&&a.jsx(Ji,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/album/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Ye,{})})})})]})}function sY(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"pb-[46px] space-y-3",children:[a.jsx(HX,{}),a.jsx(rY,{}),a.jsx(WX,{}),a.jsx(GX,{})]})})}function iY(){return a.jsx(VX,{children:a.jsx(sY,{})})}function aY({setAlbums:t}){const{user:e}=ge(),n=f.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(o=>[i,...o]),r()};if(e)return a.jsxs(a.Fragment,{children:[a.jsxs(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(Xs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),a.jsx(Ee,{ref:n,variant:"animation",children:a.jsxs(Pe,{className:"w-[800px]",children:[a.jsx(ot,{close:()=>{var i;return(i=n.current)==null?void 0:i.close()},title:"Add album"}),a.jsx(Yw,{className:"overflow-auto",variant:"add",user:e,callback:s})]})})]})}const oY=["All","Result"];function lY(){const[t,e]=f.useState([]),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=de(),u=async m=>{try{m.preventDefault(),i(!0);const p=pe(br,Q("is_album","==",!0),Q("name",">=",n),Q("name","<=",n+"")),g=await Hr(p);e(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=pe(br,Q("is_album","==",!0),Ur("created_at","desc")),p=await Hr(m);e(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:o,setTab:l,tabs:oY,setAlbums:e}}function cY(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...o}=lY();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{title:"Albums"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(kl,{...o}),a.jsx(aY,{setAlbums:i})]}),a.jsx("div",{className:"mt-5 w-fit  self-start",children:a.jsx(gs,{disable:n==="All",tabs:r,render:l=>l,tab:n,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(ce,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(Ji,{colList:["Name","Singer","Like"],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(we,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),a.jsx("td",{children:a.jsx(we,{to:`/dashboard/singer/${l.singers[0].id}`,children:l.singers[0].name})}),a.jsx("td",{children:Sr(l.like)})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ye,{})})})})]})]})}function iE({children:t}){return a.jsx(tq,{children:t})}function uY({children:t}){return a.jsx(qG,{children:t})}function dY(){const[t,e]=f.useState(!0),[n,r]=f.useState(),s=f.useRef(!1),i=Gi(),o=Dt(),{setErrorToast:l}=de(),c=async()=>{try{if(!i.id)return;const u=await Vr({collectionName:"Playlists",id:i.id});if(!u.exists())return o("/dashboard/album");const d={...u.data(),id:u.id};if(!d.is_album)return o(`/dashboard/playlist/${d.id}`);r(d)}catch(u){console.log(u),l()}finally{e(!1)}};return f.useEffect(()=>{s.current||(s.current=!0,c())},[]),{album:n,isFetching:t}}function hY(){const{album:t,isFetching:e}=dY();return e?a.jsx(qt,{children:a.jsx(We,{className:"w-6 animate-spin"})}):t?a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Ae,{title:"Edit album",className:"mb-3"}),a.jsx(Yw,{variant:"edit",album:t})]}):a.jsx(a.Fragment,{})}function fY(){const[t,e]=f.useState([]),[n,r]=f.useState(999),[s,i]=f.useState(!1),o=f.useRef(!0),l=f.useMemo(()=>t[n],[t,n]);return{isOpenComment:s,setIsOpenComment:i,currentSong:l,songs:t,setSongs:e,currentIndex:n,setCurrentIndex:r,firstTimeSongLoaded:o}}const a5=f.createContext(null);function mY({children:t}){return a.jsx(a5.Provider,{value:fY(),children:t})}function ri(){const t=f.useContext(a5);if(!t)throw new Error("SongsContextProvider not provided");return t}function pY(){const{currentSong:t,isOpenComment:e}=ri(),[n,r]=f.useState([]),{fetchComment:s,isFetching:i}=Vm(),o=async()=>{const l=await s({target_id:t.id});l&&r(l)};return f.useEffect(()=>{if(!(!e||!t))return o(),()=>{e&&r([])}},[t,e]),{comments:n,setComments:r,isFetching:i}}function gY(){const{isOpenComment:t,setIsOpenComment:e}=ri(),{themeClass:n}=G(),{comments:r,isFetching:s}=pY(),i=t?"semi-lg:right-0 block":"semi-lg:right-[-100%] hidden semi-lg:block",o={border:`${n("border-black/20","border-white/20")}`};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${t?"fixed":""} semi-lg:hidden bg-black/60 inset-0 z-[90]`}),a.jsx("div",{className:`transition-[right] max-h-[80vh] max-w-[90vw] duration-[.3s] z-[99] semi-lg:z-[0] absolute rounded-xl  left-1/2 top-1/2 translate-y-[-50%] translate-x-[-50%] semi-lg:left-[unset] semi-lg:top-0 semi-lg:transform-none semi-lg:h-full semi-lg:min-h-[360px] w-[400px] xl:w-[480px] semi-lg:p-4 top-0 ${i}`,children:a.jsxs("div",{className:`semi-lg:border text-white h-[400px] bg-[#333] p-5 semi-lg:p-3 semi-lg:h-full w-full rounded-xl flex flex-col ${o.border}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-playwriteCU text-xl",children:"Comments"}),a.jsx(ae,{onClick:()=>e(!1),className:"p-1.5 hover:bg-black/20",size:"clear",children:a.jsx(fm,{className:"w-8"})})]}),a.jsx(Fw,{variant:"dark-bg",isFetching:s,comments:r,className:"pr-2"})]})})]})}function xY(){const[t,e]=f.useState("idle"),[n,r]=f.useState(!1),[s,i]=f.useState([]),o=f.useRef(null),l=f.useRef("idle"),c=f.useRef(!0),u=f.useRef(!0);return{status:t,setStatus:e,statusRef:l,controlRef:o,canPlay:n,setCanPlay:r,lyrics:s,setLyrics:i,shouldGetLyric:c,shouldPlayAfterLoaded:u}}const o5=f.createContext(null);function yY({children:t}){return a.jsx(o5.Provider,{value:xY(),children:t})}function Il(){const t=f.useContext(o5);if(!t)throw new Error("PlayerProvider not provided");return t}function vY({audioEle:t}){const{setStatus:e,shouldPlayAfterLoaded:n,canPlay:r}=Il(),{firstTimeSongLoaded:s,currentSong:i}=ri(),o=()=>{e("loading")},l=()=>{if(s.current){s.current=!1,e("paused");return}n.current&&(n.current=!1,t==null||t.play())},c=()=>{e("error")};f.useEffect(()=>{r&&i&&(t.src=i.song_url)},[r]),f.useEffect(()=>(t.addEventListener("error",c),t.addEventListener("loadstart",o),t.addEventListener("loadedmetadata",l),()=>{t.removeEventListener("error",c),t.removeEventListener("loadstart",o),t.removeEventListener("loadedmetadata",l)}),[])}function wY({isLiked:t,song:e}){const{theme:n}=G(),{action:r,loading:s}=Wm();return a.jsx("button",{onClick:()=>r({variant:"like",song:e}),children:s?a.jsx(We,{className:" animate-spin"}):a.jsx(hl,{className:t?n.content_text:""})})}function _Y({song:t}){const{setIsOpenComment:e}=ri(),{user:n}=ge();return a.jsxs("div",{className:`flex 
			space-x-2
			[&_button]:rounded-full
			[&_button]:p-2
			[&_svg]:w-6
			hover:[&_button]:bg-white/10
			[&_div]:flex-col
			[&_div]:flex
			[&_span]:text-center
			[&_span]:font-medium
		 `,children:[n&&a.jsx("div",{children:a.jsx(wY,{isLiked:n.liked_song_ids.includes(t.id),song:t})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(!0),children:a.jsx(Y6,{})})})]})}function bY({audioEle:t,song:e}){const{status:n,controlRef:r,setStatus:s,statusRef:i}=Il();vY({audioEle:t});const{pause:o,play:l,handlePlayPause:c,progressLineRef:u}=Um({audioEle:t,setStatusFromParent:s,statusFromParent:n,statusRefFromParent:i});f.useImperativeHandle(r,()=>({pause:o,play:l,handlePlayPause:c}));const d=()=>{switch(n){case"playing":return a.jsx(ov,{});case"paused":return a.jsx(Xc,{});case"error":return a.jsx(DI,{});case"loading":return a.jsx(We,{className:"animate-spin"});default:return a.jsx(Qa,{})}},m={before:"before:content-[''] before:w-[100%] before:h-4 before:absolute before:bottom-full before:translate-y-[50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:c,className:"[&_svg]:w-7",children:d()}),a.jsx("div",{className:"flex space-x-2 ml-auto",children:a.jsx(_Y,{song:e})})]}),a.jsx("div",{className:"h-2 flex items-center mt-3",children:a.jsx("div",{ref:u,style:{backgroundColor:"rgba(255,255,255,.3)"},className:`relative h-1 rounded-full w-full ${m.before} ${n==="idle"?"hidden":""}`})})]})}const Yd=.3;function SY({audioEle:t,lyrics:e,isActive:n}){const[r,s]=f.useState(0),i=f.useRef(0),o=f.useRef(0),l=()=>{const c=t.currentTime>i.current?"forward":"backward";i.current=t.currentTime;let u=o.current;switch(c){case"forward":for(;e[u+1]&&e[u+1].start-Yd<i.current+Yd;)u+=1;break;case"backward":for(;e[u-1]&&e[u-1].end-Yd>i.current+Yd;)u-=1;break}u!==o.current&&(o.current=u,s(u))};return f.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",l),()=>{t.removeEventListener("timeupdate",l)}},[e,n]),{currentIndex:r}}function EY(){const{canPlay:t,setLyrics:e,shouldGetLyric:n}=Il(),{currentSong:r}=ri(),s=f.useRef(),{loading:i,getLyric:o}=qR({}),l=async()=>{if(r&&r.lyric_id){const c=await o(r);c&&e(JSON.parse(c==null?void 0:c.lyrics))}};return f.useEffect(()=>{t&&n.current&&(n.current=!1,s.current=setTimeout(l,500))},[t]),{isFetching:i}}function kY({audioEle:t}){const{lyrics:e,canPlay:n}=Il(),{isFetching:r}=EY(),s=f.useRef(null),i=f.useRef(null),{currentIndex:o}=SY({audioEle:t,lyrics:e,isActive:n}),l=()=>a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"transition-transform origin-bottom-left duration-[.4s] translate-y-[50px]",ref:s,children:e[o].text},o),e[o+1]&&a.jsx("p",{ref:i,className:"mt-3 transition-transform duration-[.4s] opacity-[.4] translate-y-[-10px]",children:e[o+1].text},o+"asda")]}),c={container:"no-scrollbar [&_p]:w-[70%] [&_p]:select-none [&_p]:font-[700] pt-4	"};return f.useEffect(()=>{setTimeout(()=>{s.current&&Object.assign(s.current.style,{transform:"scale(1.3) translateY(0px)"}),i.current&&Object.assign(i.current.style,{transform:"translateY(0px)"})},10)},[o,e]),a.jsxs("div",{className:`${c.container}`,children:[r&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(We,{className:"w-7 animate-spin"})}),!r&&a.jsx(a.Fragment,{children:e.length?l():a.jsx("div",{children:"..."})})]})}function TY({index:t,songItemRef:e}){const{currentIndex:n,setCurrentIndex:r}=ri(),{setCanPlay:s,canPlay:i,controlRef:o,statusRef:l}=Il(),[c,u]=f.useState(!1),d=f.useRef(),m=f.useMemo(()=>n===t,[n]),p=g=>{const[y]=g;u(y.isIntersecting)};f.useEffect(()=>{var g,y;m?i?(g=o.current)==null||g.play():s(!0):i&&l.current==="playing"&&((y=o.current)==null||y.pause())},[m]),f.useEffect(()=>{e.current&&new IntersectionObserver(p,{threshold:1}).observe(e.current)},[]),f.useEffect(()=>(d.current=setTimeout(()=>{c&&r(t)},600),()=>{clearTimeout(d.current)}),[c])}function IY({song:t,index:e,songItemRef:n}){const{controlRef:r}=Il(),s=f.useRef(null);return TY({index:e,songItemRef:n}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative z-0 flex items-center flex-shrink-0 text-white h-full w-full sm:w-auto sm:aspect-[3/5] rounded-xl overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] overflow-hidden ",children:t.blurhash_encode&&a.jsx(Cu,{hash:t.blurhash_encode,height:"100%",width:"100%"})}),a.jsx("div",{className:"absolute top-0 p-4 left-0 w-full z-[99]",children:s.current&&a.jsx(kY,{audioEle:s.current})}),a.jsx("div",{className:"w-full aspect-[1/1] overflow relative mask-image",children:a.jsx("img",{onClick:()=>{var i;return(i=r.current)==null?void 0:i.handlePlayPause()},className:"w-full object-cover",src:t.image_url})}),a.jsx("div",{className:"absolute z-0 bottom-0 left-0 w-full",children:a.jsxs("div",{className:"relative p-4",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] bg-gradient-to-b to-black/60 from-transparent"}),a.jsx("div",{className:"text-xl font-semibold",children:t.name}),a.jsx("div",{className:"opacity-[.8]",children:t.singers.map((i,o)=>a.jsxs("span",{children:[" ",(o?", ":"")+i.name]},o))}),a.jsx("div",{className:"mt-2",children:s.current&&a.jsx(bY,{song:t,audioEle:s.current})})]})})]}),a.jsx("audio",{className:"hidden",ref:s})]})}function CY(t,e){const{isOpenComment:n}=ri(),r=f.useRef(null);return f.useImperativeHandle(e,()=>r.current),a.jsx(a.Fragment,{children:a.jsx("div",{"data-index":t.index,className:"h-full flex-shrink-0 p-4 min-h-[360px] snap-center",children:a.jsx("div",{className:`relative h-full w-full transition-[right] duration-[.3s]  ${n?"semi-lg:right-[calc(400px*0.5)] ":"right-0"}`,ref:r,children:a.jsx(yY,{children:a.jsx(IY,{...t,songItemRef:r})})})})})}const aE=f.forwardRef(CY);function jY(){const{setSongs:t}=ri(),{setErrorToast:e}=de(),[n,r]=f.useState(!0),s=f.useRef(!1),i=async()=>{try{r(!0);const o=pe(bn,Q("is_official","==",!0),Ur("updated_at","desc"),Zo(20)),l=await Sn(o);t(c=>[...c,...l])}catch(o){console.log({message:o}),e()}finally{r(!1)}};return f.useEffect(()=>{s.current||(s.current=!0,i())},[]),{isFetching:n,getSong:i}}const Jw="/HD-MP3/assets/loading-b1210647.gif";function RY(){const{setCurrentIndex:t,songs:e}=ri(),{isFetching:n}=jY(),r=f.useRef(null),s=f.useCallback(o=>{r.current&&r.current.disconnect(),r.current=new IntersectionObserver(l=>{l[0].isIntersecting&&console.log("get song ")}),o&&r.current.observe(o)},[]),i=f.useMemo(()=>e.map((o,l)=>e.length===l+1?a.jsx(aE,{index:l,ref:s,song:o},l):a.jsx(aE,{index:l,song:o},l)),[e]);return f.useEffect(()=>{setTimeout(()=>{t(0)},1e3)},[]),a.jsxs("div",{className:"h-full snap-y snap-mandatory overflow-auto no-scrollbar flex flex-col items-center",children:[n&&a.jsx(qt,{children:a.jsx("img",{src:Jw,className:"w-[250px] max-w-[90vw]"})}),i]})}function AY(){return a.jsx(mY,{children:a.jsxs("div",{className:"fixed top-0 left-0 right-0 bottom-[47px] z-[90] md:inset-0 sm:relative overflow-hidden flex-grow",children:[a.jsx(RY,{}),a.jsx(Km,{target:"song",children:a.jsx(gY,{})})]})})}const oa={home:"/",discorver:"/discover",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id",user:"/user/:id"},oE={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},ur={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id"},NY=[{path:oa.home,component:AY,layout:""},{path:oa.discorver,component:tW,layout:""},{path:oa.playlist,component:pW,layout:""},{path:oa.search,component:vG,layout:""},{path:oa.unauthorized,component:_G,layout:""},{path:oa.singer,component:MG,layout:""},{path:oa.user,component:$G,layout:""}],PY=[{path:oE.myMusic,component:SW,layout:""},{path:oE.songLyric,component:hG,layout:""}],FY=[{path:ur.dashboard,component:BG,layout:""},{path:ur.playlist,component:_X,layout:""},{path:ur.genre,component:LX,layout:""},{path:ur.singer,component:PX,layout:pb},{path:ur.editSinger,component:iY,layout:pb},{path:ur.playlistDetail,component:CX,layout:uY},{path:ur.album,component:cY,layout:""},{path:ur.editAlbum,component:hY,layout:""},{path:ur.song,component:ZG,layout:""},{path:ur.addSong,component:pX,layout:iE},{path:ur.editSong,component:xX,layout:iE},{path:ur.songLyric,component:MX,layout:""}];function DY(){const{user:t,loading:e}=ge(),{theme:n}=G();return e?a.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${n.container}`,children:a.jsx("img",{className:"w-[150px]",src:Jw,alt:""})}):t?a.jsx(tm,{}):a.jsx(NT,{state:{from:"/my-music"},replace:!0,to:"/login"})}function LY(){const[t,e]=f.useState(!0),[n,r]=f.useState(!1),{user:s,loading:i}=ge(),{theme:o}=G();return f.useEffect(()=>{(async()=>{await cs(1e3),r(!0),e(!1)})()},[]),i||t?a.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${o.container}`,children:a.jsx("img",{className:"w-[150px]",src:Jw,alt:""})}):s&&n?a.jsx(tm,{}):a.jsx(NT,{replace:!0,to:"/unauthorized"})}const l5=[{path:"/dashboard",title:"Dashboard",icon:a.jsx(Gy,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/song",title:"Songs",icon:a.jsx(Qa,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/playlist",title:"Playlists",icon:a.jsx(YF,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/album",title:"Albums",icon:a.jsx(jF,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/singer",title:"Singers",icon:a.jsx($0,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/genre",title:"Genres",icon:a.jsx(bD,{className:"w-5 flex-shrink-0"})}];function MY(){const{theme:t}=G(),[e,n]=f.useState(!1),r=sr(),s="",i={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 ",itemActive:"text-[#cd1818] bg-[#f1f1f1]",icon:"w-[24px] flex-shrink-0"};return a.jsxs("div",{className:`${i.container} ${e?"w-[150px]":"w-[70px]"}`,children:[a.jsxs("div",{className:"md:mt-[60px]",children:[l5.map((o,l)=>{const c=r.pathname===o.path;return a.jsxs(we,{className:`
              ${c?t.content_bg:"hover:bg-black/10"}
              ${i.item} ${e?"!justify-start":""}
              ${s===o.path?i.itemActive:""}`,to:o.path,children:[o.icon,e&&a.jsx("span",{children:o.title})]},l)}),a.jsxs(we,{to:"/",target:"_blank",className:`${i.item} ${e?"!justify-start":""}
               
               `,children:[a.jsx(Eu,{className:i.icon}),e&&a.jsx("span",{children:"Home"})]})]}),a.jsx(ue,{onClick:()=>n(o=>!o),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:e?a.jsx(bH,{className:"w-5 "}):a.jsx(kH,{className:"w-5"})})]})}function c5({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=cA();return a.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[a.jsx("button",{onClick:r,className:`relative ${Qc(!e.length)}`,children:a.jsx(LT,{className:"w-5"})}),a.jsx("button",{onClick:s,className:`relative ${Qc(!n.length)}`,children:a.jsx(L3,{className:"w-5"})})]})}function OY(){const{theme:t}=G(),[e,n]=f.useState(0),[r,s]=f.useState(""),i=f.useRef(null),o=f.useRef(null),l=m=>{var p,g;s(m),(p=o.current)==null||p.close(),(g=i.current)==null||g.open()},c=()=>{var m;return(m=i.current)==null?void 0:m.close()},u=m=>{const p=m.target.scrollTop||0;n(p)},d=()=>{switch(r){case"":return a.jsx(a.Fragment,{});case"theme":return a.jsx(iv,{close:c});case"info":return a.jsx(sv,{close:c})}};return f.useEffect(()=>{const m=document.querySelector(".main-container");return m==null||m.addEventListener("scroll",u),()=>{m==null||m.removeEventListener("scroll",u)}},[]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${e?" shadow-lg":""}`,children:[a.jsxs("div",{className:"flex",children:[a.jsxs(we,{to:"/dashboard",className:"text-xl font-[500]",children:["HD",a.jsx("span",{className:`${t.content_text} ml-[4px] uppercase`,children:"Dashboard"})]}),a.jsx(c5,{className:"ml-5"})]}),a.jsx("div",{className:"flex",children:a.jsxs(xr,{children:[a.jsx(yr,{ref:o,children:a.jsx("button",{className:`flex p-2 items-center rounded-full bg-${t.alpha} ${t.content_hover_bg}`,children:a.jsx(nm,{className:"w-6"})})}),a.jsx(vr,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(kR,{openModal:l,variant:"dashboard"})})]})})]}),a.jsx(Ee,{ref:i,variant:"animation",children:d()})]})}function $Y(){const[t,e]=f.useState(!1),n=f.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return f.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),a.jsxs(a.Fragment,{children:[a.jsx(wn,{colors:"third",className:`absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bottom-[80px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:l5.map((s,i)=>a.jsxs(we,{className:"inline-flex py-1.5 space-x-1",to:s.path,children:[s.icon,a.jsx("span",{children:s.title})]},i))}),a.jsx(ue,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] bottom-[10px] left-[10px]  p-1.5",children:a.jsx(ll,{className:"w-6"})})]})}function BY({className:t="",toast:e,onClick:n}){const{theme:r}=G(),[s,i]=f.useState(!1),o={icon:"w-6",container:`transition-[transform,opacity] text-white px-3 py-1 space-x-1 rounded-md flex items-center ${r.modal_bg}`,text:"font-[500] text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},l=()=>{switch(e.variant){case"success":return a.jsx(av,{className:`${o.icon} text-emerald-500`});case"error":return a.jsx(fm,{className:`${o.icon} text-red-500`})}};return f.useEffect(()=>{setTimeout(()=>{i(!0)},0)},[]),a.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`${o.container} ${t} ${s?o.open:o.init} `,children:[l(),a.jsx("p",{className:o.text,children:e.desc})]})}const u5=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=de(),[s,i]=f.useState(""),o=l=>{n(c=>c.filter(u=>u.id!=l))};return f.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),f.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),a.jsx(a.Fragment,{children:Ga.createPortal(a.jsx("div",{className:`fixed z-[199] ${e}`,children:a.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>a.jsx(BY,{onClick:o,toast:l},c))})}),document.getElementById("portals"))})};function zY(){const{setTheme:t,isOnMobile:e,theme:n}=G();return f.useEffect(()=>{t(VD)},[]),a.jsx(a.Fragment,{children:a.jsx(II,{children:a.jsx(rq,{children:a.jsxs("div",{className:`${n.container} fixed inset-full flex ${n.text_color}`,children:[e?a.jsx($Y,{}):a.jsx(MY,{}),a.jsxs("div",{className:"flex flex-col flex-grow",children:[a.jsx(OY,{}),a.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:a.jsx(tm,{})})]}),a.jsx(u5,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),a.jsx(TI,{})]})})})})}const d5="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu";function UY({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:o,idle:l}=dt(),c=t==="desktop"?n:s,u=t==="desktop"?r:o,d=t==="desktop"?e:i,m={item:"px-3 md:px-8 leading-[30px] font-[600] cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?m.fadeTransition:""}`,children:d.map((p,g)=>{const y=p===c;return a.jsx("li",{onClick:()=>u(p),className:`${m.item} ${y?"bg-white/20":"hover:bg-white/5"}`,children:p},g)})})}function VY({themeType:t,children:e}){const{theme:n}=G(),{isOpenComment:r,setIsOpenComment:s}=Gr(),i=t==="dark"?"bg-[#1f1f1f]":n.container,o={mainContainer:`hidden fixed w-[400px] md:flex flex-col bottom-0 right-[0] top-0 z-[99] p-3 pb-5 text-white border-l-[1px] border-${n.alpha} transition-[transform] duration-[.5s] linear delay-100`};return a.jsxs("div",{className:`${n.text_color} ${o.mainContainer} ${r?"translate-x-0---":"translate-x-full"}     `,children:[a.jsx("div",{className:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] ${i} absolute inset-0`}),a.jsx("p",{children:a.jsx("button",{className:"p-1.5",onClick:()=>s(!1),children:a.jsx(fm,{className:"w-7"})})}),e]})}function HY(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=Gr(),{currentSongData:s}=re(ze),{fetchComment:i}=Vm(),o=async()=>{try{if(!(s!=null&&s.song))return;const l=await i({target_id:s.song.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};f.useEffect(()=>{!n||!(s!=null&&s.song)||t.current&&(t.current=!1,o())},[n]),f.useEffect(()=>()=>{t.current||(t.current=!0)},[s==null?void 0:s.song])}function h5(){const{isFetching:t,comments:e}=Gr();return HY(),t?a.jsx(qt,{children:a.jsx(We,{className:"w-6 animate-spin"})}):a.jsx(Fw,{comments:e})}function WY({show:t}){const{theme:e}=G(),{setIsOpenComment:n}=Gr(),r={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${e.content_hover_bg}`};return a.jsxs(a.Fragment,{children:[t&&a.jsx(Ds,{position:"top-[calc(100%+8px)]",content:"Comment",children:a.jsx("button",{onClick:()=>n(!0),className:`p-2 ${r.button}`,children:a.jsx(Hy,{})})}),Ga.createPortal(a.jsx(VY,{themeType:"dark",children:a.jsx(h5,{})}),document.getElementById("portals"))]})}function GY(){const{user:t}=ge(),{theme:e}=G(),{activeTab:n,idle:r,setIsOpenFullScreen:s}=dt(),{currentSongData:i}=re(ze),o=Dt(),l=i&&t?i.song.owner_email===t.email&&i.song.is_official===!1:!1,c=()=>{i!=null&&i.song&&(s(!1),setTimeout(()=>{o(`/my-music/lyric/${i==null?void 0:i.song.id}`)},300))},u={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${e.content_hover_bg}`,headerWrapper:"relative flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${u.headerWrapper} ${r?"pointer-events-none":""}`,children:[r&&i&&a.jsx("div",{className:"absolute left-4",children:n!=="Songs"&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU text-sm",children:i.song.name}),a.jsx("p",{className:"opacity-70 text-sm",children:i.song.singers.map((d,m)=>(m?", ":"")+d.name)})]})}),a.jsx(UY,{}),a.jsxs("div",{className:`absolute flex right-4 space-x-3 ${r&&u.fadeTransition}`,children:[a.jsx(Km,{target:"song",children:a.jsx(WY,{show:!!(i!=null&&i.song.is_official)})}),l&&n==="Lyric"&&a.jsx(Ds,{position:"top-[calc(100%+8px)]",content:"Edit lyric",children:a.jsx("button",{onClick:()=>c(),className:`p-2 ${u.button}`,children:a.jsx(qy,{})})}),a.jsxs(xr,{children:[a.jsx(yr,{children:a.jsx(Ds,{position:"top-[calc(100%+8px)]",content:"Setting",children:a.jsx("button",{className:`${u.button} p-2`,children:a.jsx(Wy,{})})})}),a.jsx(vr,{className:"top-[calc(100%+8px)] right-0 z-[99]",animationClassName:"origin-top-right",children:a.jsx(UR,{})})]}),a.jsx(Ds,{position:"top-[calc(100%+8px)]",content:"Close",children:a.jsx("button",{onClick:()=>s(!1),className:`p-2 ${u.button}`,children:a.jsx(BT,{})})})]})]})})}function f5({className:t}){const{playerConig:{lyricSize:e},audioRef:n,isOpenFullScreen:r,activeTab:s}=dt();if(!n.current)throw new Error("audioRef error");const{loading:i,songLyrics:o}=rv(),l=f.useMemo(()=>r&&s==="Lyric",[r,s]),{currentIndex:c,lyricRefs:u}=mA({audioEle:n.current,isActive:l,lyrics:o}),d={small:"text-[16px] sm:text-[26px]",medium:"text-[20px] sm:text-[30px]",large:"text-[26px] sm:text-[46px]"},m=()=>o.map((g,y)=>{let v="coming";return c===y?v="active":y<c&&(v="done"),a.jsx(fA,{ref:_=>u.current[y]=_,status:v,text:g.text,activeColor:"scale-[1.3]",className:"leading-[1.3] mb-3 w-[70%] md:mb-5 last:mb-[50vh]"},y)}),p={container:"no-scrollbar pt-[20px] mask-image overflow-y-auto overflow-x-hidden"};return a.jsxs("div",{className:`${p.container} ${d[e||"medium"]} ${t}`,children:[i&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(qt,{children:a.jsx(We,{className:"w-7 animate-spin"})})}),!i&&a.jsx(a.Fragment,{children:o.length?m():a.jsx("div",{className:"relative w-full h-full",children:a.jsx(qt,{children:a.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const tc=.3,lE=t=>t%2!==0;function qY(){const{songLyrics:t,loading:e}=rv(),{audioRef:n,isOpenFullScreen:r,activeTab:s}=dt();if(!n.current)throw new Error("useKaraoke !audioRef.current");const{playStatus:i}=re(In),[o,l]=f.useState(0),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),m=f.useRef(null),p=f.useRef(0),g=f.useRef(0),y=f.useRef("paused"),v=f.useRef(!1),_=f.useMemo(()=>r&&s=="Karaoke",[r,s]),S=f.useMemo(()=>{if(t.length){if(o<0)return{odd:"",even:""};const D=lE(o);if(!t[o+1])return{odd:"",even:""};const F=D?[o,o+1]:[o+1,o],I=t[F[0]].text.trim(),k=t[F[1]].text.trim();return{odd:I,even:k}}else return{odd:"",even:""}},[o,t]),b=D=>{D.style.animation="none"},E=(D,F,I,k)=>{var N,P;let j="running";y.current==="paused"&&(j="paused"),I.style.animation=`${D} ${(((N=F==null?void 0:F.tune)==null?void 0:N.end)||F.end)-(((P=F==null?void 0:F.tune)==null?void 0:P.start)||F.start)}s linear ${j} forwards`;const C=+k.toFixed(1);Math.abs(C)>.2&&(I.style.animationDelay=`${C}s`)},R=()=>{if(!t.length)return;const D=n.current.currentTime>=p.current?"forward":"backward";p.current=n.current.currentTime;let F=g.current;switch(D){case"forward":for(;F<t.length&&t[F+1]&&t[F+1].start-tc<p.current+tc;)F+=1;break;case"backward":for(;F>0&&t[F-1]&&t[F-1].end-tc>p.current+tc;)F-=1;break}if(F!==g.current||v.current||y.current==="paused"||y.current==="waiting"){if(v.current=!1,g.current=F,l(F),!c.current||!u.current||!m.current||!d.current)return;const I=t[F],{tune:k,text:j,cut:C}=I,N=p.current+tc-k.start,P=j.split(" "),A=lE(F),Z=yA(A?m.current:d.current),he=Dw(P,C,k.grow),te=A?[c.current,u.current]:[u.current,c.current],Se=xA(he,Z);E(Se,I,te[0],-N),b(te[1])}};return f.useEffect(()=>{y.current==="waiting"?setTimeout(()=>{y.current=i},300):y.current=i},[i]),f.useEffect(()=>{_&&(v.current=!0,i==="paused"&&R())},[_]),f.useEffect(()=>{if(!(!t.length||!_))return n.current.addEventListener("timeupdate",R),()=>{n.current.removeEventListener("timeupdate",R)}},[t,_]),f.useEffect(()=>()=>{p.current=0,g.current=-1,l(0)},[t]),{loading:e,currentIndexRef:g,oddOverlay:c,evenOverlay:u,currentIndex:o,textData:S,tempEventText:d,tempOddText:m}}function cE({text:t,overlayRef:e}){const{playStatus:n}=re(In),[r,s]=f.useState(t),[i,o]=f.useState(!1),l=f.useRef(!0);f.useEffect(()=>{t&&o(!1)},[t]),f.useEffect(()=>{if(i)return;const u=()=>{s(t),o(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),f.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return a.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",a.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function QY(){const{loading:t,evenOverlay:e,oddOverlay:n,tempEventText:r,tempOddText:s,textData:i}=qY();return t?a.jsx(qt,{children:a.jsx(We,{className:"w-7 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:r,className:"inline-flex h-0 opacity-0",children:i.even.split(" ").map((o,l)=>a.jsx("span",{className:"leading-1",children:o},l))}),a.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:i.odd.split(" ").map((o,l)=>a.jsx("span",{className:"k leading-1",children:o},l))}),a.jsx(cE,{overlayRef:e,text:i.even}),a.jsx("div",{className:"mt-8"}),a.jsx(cE,{overlayRef:n,text:i.odd})]})}const m5=()=>{window.dispatchEvent(new Event("mousemove"))};function Vx(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,o=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-o))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=m5},900)),n||Math.abs(i)>r||Math.abs(o)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return o>i?setTimeout(()=>{e.scrollLeft=c-l},300):o<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function KY(){const t=Kt(),{isOpenFullScreen:e,idle:n}=dt(),{currentQueueId:r}=re(ze),{playStatus:s}=re(In),i=f.useRef(null),o=f.useRef(null),l=f.useRef("paused"),c=()=>{!(o!=null&&o.current)||!(i!=null&&i.current)||Vx(o.current,i.current,n)},u=p=>{let g=document.querySelector(".song-thumb.centered");if(!g)if(o.current)g=o.current;else return;let y;switch(p){case"ArrowRight":y=g.nextElementSibling;break;case"ArrowLeft":y=g.previousElementSibling;break}y&&i.current&&(g.classList.remove("centered"),y.classList.add("centered"),Vx(y,i.current))},d=()=>{if(!o.current)return;const p=document.querySelector(".song-thumb.centered"),g=p==null?void 0:p.getAttribute("queue-id");g&&t(hs(g))},m=p=>{if(p.key==="ArrowRight"||p.key==="ArrowLeft")return p.preventDefault(),u(p.key);p.key==="Enter"&&(p.preventDefault(),d())};return f.useEffect(()=>{e&&c()},[r,e]),f.useEffect(()=>{if(e)return document.addEventListener("keydown",m),()=>{var p;document.removeEventListener("keydown",m),(p=document.querySelector(".song-thumb.centered"))==null||p.classList.remove("centered")}},[r,e]),f.useEffect(()=>{const p=i==null?void 0:i.current;if(p)return p.onscroll=m5,()=>{p.onscroll=()=>{}}},[]),f.useEffect(()=>{l.current=s},[s]),{activeSongRef:o,containerRef:i}}function XY(){const t=Kt(),{activeTab:e,isOpenFullScreen:n,idle:r}=dt(),{theme:s}=G(),{currentSongData:i}=re(ze),{queueSongs:o,currentQueueId:l}=re(ze),{activeSongRef:c,containerRef:u}=KY(),d=_=>{l!==_&&t(hs(_))},m=u2(()=>g("next"),200),p=u2(()=>g("previous"),200),g=(_="next")=>{const S=u.current;S.style.scrollBehavior="smooth",_==="next"?S.scrollLeft+=500:_==="previous"&&(S.scrollLeft-=500)},y={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:`absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/30 rounded-full ${s.content_hover_bg}`,lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},v=f.useMemo(()=>{if(i!=null&&i.song&&o.length)return o.map((_,S)=>_.queue_id===l?a.jsx(yg,{ref:c,hasTitle:!0,onClick:()=>d(_.queue_id),active:!0,data:_},S):a.jsx(yg,{idleClass:`${r?y.fadeTransition:""}`,hasTitle:!0,active:!1,data:_,onClick:()=>d(_.queue_id)},S))},[i==null?void 0:i.song,o,r]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:u,className:`song-list-container ${y.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:v}),e==="Songs"&&!r&&a.jsxs(a.Fragment,{children:[a.jsx(ae,{hover:"scale",size:"clear",onClick:()=>p(),className:`${y.absoluteButton} left-[20px]`,children:a.jsx(zT,{className:"w-[30px]"})}),a.jsx(ae,{hover:"scale",size:"clear",onClick:()=>m(),className:`${y.absoluteButton} right-[20px]`,children:a.jsx(oF,{className:"w-[30px]"})})]}),a.jsx(NI,{children:a.jsxs(XR,{isOpenLyricTabs:n&&(e==="Lyric"||e==="Karaoke"),children:[a.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:a.jsxs("div",{className:y.lyricTabContainer,children:[a.jsx(yg,{active:!0,data:i==null?void 0:i.song}),a.jsx(f5,{className:"w-full ml-[40px] h-full"})]})}),a.jsx("div",{className:`absolute inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:a.jsx(QY,{})})]})})]})}function YY(){var o,l;const{isOpenFullScreen:t,idle:e,activeTab:n,playerConig:{songBackground:r}}=dt(),{currentSongData:s}=re(ze),i={wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[a.jsx("div",{className:` ${i.bg}`,children:r&&a.jsx(Cu,{radioGroup:"",height:"100%",width:"100%",hash:((o=s==null?void 0:s.song)==null?void 0:o.blurhash_encode)||d5})}),a.jsxs("div",{className:i.container,children:[a.jsx(GY,{}),a.jsx("div",{className:i.content,children:a.jsx(XY,{})}),n!=="Songs"&&a.jsxs("p",{className:`text-center ${e&&i.fadeTransition}`,children:[((l=s==null?void 0:s.song)==null?void 0:l.name)||"...",a.jsxs("span",{className:"opacity-70 text-sm",children:[" - ",s==null?void 0:s.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function JY(){const{user:t}=ge(),[e,n]=f.useState([]),[r,s]=f.useState(!0);return{isFetching:r,recentSongs:e,getRecentSongs:async()=>{try{if(t&&t.recent_song_ids.length){const o=pe(bn,Q(Ys(),"in",t.recent_song_ids)),l=await Sn(o);n(l)}else{const o=gn()["recent-songs"]||[];n(o)}}catch(o){console.log({message:o})}finally{s(!1)}}}}function ZY({setTab:t}){const e=Kt(),n=f.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i}=JY(),o=[...Array(5).keys()].map(c=>a.jsx(ce,{className:"h-[57px] mt-1"},c)),l=c=>{e(zm({songs:[c]})),e(hs(c.queue_id)),t("Queue")};return f.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?o:a.jsx(ei,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l})}const eJ=["Queue","Recent"];function tJ(){const t=Kt(),{theme:e}=G(),{isOpenSongQueue:n,setIsOpenSongQueue:r}=dt(),{queueSongs:s,currentQueueId:i,isFetching:o}=re(ze),{resetForNewSong:l}=ti(),[c,u]=f.useState("Queue"),d=f.useCallback(y=>{y!==i&&t(hs(y))},[i]),m=f.useCallback(()=>{t(XV()),l(),r(!1)},[]),p=[...Array(5).keys()].map(y=>a.jsx(ce,{className:"h-[56px] mt-1"},y)),g={mainContainer:`hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 ${e.container} border-l-[1px] border-${e.alpha} transition-[transform] duration-[.5s] linear delay-100`,songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return a.jsx(ms,{children:a.jsxs("div",{className:`${e.text_color} ${g.mainContainer} ${n?"translate-x-0---":"translate-x-full"}     `,children:[a.jsx(gs,{className:"w-fit mx-auto text-sm",tab:c,setTab:u,tabs:eJ,render:y=>y}),a.jsx("div",{className:g.songListContainer,children:c==="Queue"?a.jsxs(a.Fragment,{children:[a.jsx(ei,{isHasCheckBox:!1,songs:s,setSong:y=>d(y.queue_id),songVariant:"queue-song",getActive:(y,v)=>y.queue_id===v.queue_id}),o&&p,a.jsx("div",{className:"text-center",children:!!s.length&&a.jsxs(ae,{onClick:m,size:"clear",className:`${e.content_bg} rounded-full my-5 px-3 py-1 space-x-1`,children:[a.jsx(Ln,{className:"w-6"}),a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Clear"})]})})]}):a.jsx(ZY,{setTab:u})})]})})}const nJ=f.memo(tJ);function rJ({vinylRef:t}){const{playStatus:e}=re(In);f.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function sJ({textRef:t,textWrapperRef:e,content:n}){const r=f.useRef(),s=f.useRef(),i=f.useRef(!1),o=f.useRef(0),l=f.useRef(0),c=f.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},m=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-o.current,l.current=Math.ceil(c.current/35))},p=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},g=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),o.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,m(),setTimeout(d,1e3),r.current=setInterval(d,l.current*1e3+3e3))};f.useEffect(()=>(g(),p),[n])}function iJ({content:t,className:e}){const n=f.useRef(null),r=f.useRef(null);return sJ({textRef:r,textWrapperRef:n,content:t}),a.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:a.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const p5=f.memo(iJ);function aJ({isOpenFullScreen:t,song:e}){const n=f.useRef(null),{theme:r}=G();rJ({vinylRef:n});const s={songInfoChild:"flex flex-row"};return a.jsx("div",{className:`w-1/4  ${Kc(t)}`,children:a.jsxs("div",{className:`${s.songInfoChild} ${Kc(t)}`,children:[a.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:a.jsx(Je,{src:e==null?void 0:e.image_url,className:"rounded-full h-full object-cover"})}),a.jsxs("div",{className:"ml-2 flex-grow",children:[a.jsx("div",{className:"h-[32px]",children:a.jsx(p5,{className:"leading-[1.5] font-playwriteCU",content:(e==null?void 0:e.name)||"Name"})}),e&&a.jsx("div",{className:"leading-[1.2] text-sm opacity-[.7] line-clamp-1",children:e.singers.map((i,o)=>i.id?a.jsx(we,{to:`/singer/${i.id}`,className:`${r.content_hover_text}  hover:underline`,children:(o?", ":"")+i.name},o):a.jsx("span",{children:(o?", ":"")+i.name},o))})]})]})})}function oJ({audioEle:t,volumeLineRef:e}){const{theme:n}=G(),[r,s]=f.useState(!1),[i,o]=Q0("volume",1),l=d=>{const p=d.target.getBoundingClientRect(),g=e.current;if(g){let y=+((d.clientX-p.x)/g.clientWidth).toFixed(2);y>.9?y=1:y<.05?(y=0,s(!0)):s(!1),o(y)}},c=d=>{d.preventDefault();const m=.1;let p=i;d.deltaY>0?p-m>0?p-=m:p=0:p+m<1?p+=m:p=1,o(+p.toFixed(2))},u=()=>s(!r);return f.useEffect(()=>{if(e.current&&t){const d=i*100;e.current.style.background=kw(n.content_code,d),t.volume=i,s(i===0)}},[i,n]),f.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function lJ({audioEle:t}){const e=f.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=oJ({audioEle:t,volumeLineRef:e}),o={before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]",volumeLineBase:"ml-1 w-full relative h-[4px] cursor-pointer rounded-full shadow-[2px_2px_10px_rgba(0,0,0,.15)]"};return a.jsxs("div",{className:"flex flex-grow items-center max-w-[120px] mr-2",children:[a.jsx("button",{onWheel:r,onClick:()=>n(),children:i?a.jsx(RD,{className:"w-6"}):a.jsx(ID,{className:"w-6"})}),a.jsx("div",{onClick:l=>s(l),ref:e,className:`${o.volumeLineBase} ${o.before}`,style:{background:"#e1e1e1"}})]})}function cJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return a.jsx(Xy,{className:`${n.icon}`});case"error":return a.jsx(rm,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(We,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(HT,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function uJ(){var _;const{theme:t}=G(),{playerConig:{isShuffle:e,repeat:n},isOpenFullScreen:r,timelineEleRef:s,currentTimeEleRef:i}=dt(),{currentSongData:o,queueSongs:l}=re(ze),{playStatus:c}=re(In),{next:u,previous:d,toggleRepeat:m,toggleShuffle:p,handlePlayPause:g,handleSeek:y}=ti(),v={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-[6px] sm:h-1 flex-grow relative cursor-pointer rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${v.buttonsContainer}`,children:[a.jsxs("button",{disabled:l.length<=1,className:`relative ${v.button} ${n!=="no"&&t.content_text}`,onClick:m,children:[a.jsx(MT,{className:v.icon}),a.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:n==="one"?"1":n==="all"?"-":""})]}),a.jsx("button",{disabled:l.length<=1,className:v.button,onClick:d,children:a.jsx(Vy,{className:v.icon})}),a.jsx(cJ,{playStatus:c,handlePlayPause:g}),a.jsx("button",{disabled:l.length<=1,className:`${v.button}`,onClick:u,children:a.jsx(Qy,{className:v.icon})}),a.jsx("button",{disabled:l.length<=1,className:`${v.button} ${e&&t.content_text}`,onClick:p,children:a.jsx($T,{className:v.icon})})]}),a.jsxs("div",{className:`${v.progressContainer} ${r?"mb-0":"mb-5 sm:mb-2"} ${c==="error"||c==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] sm:w-9",children:a.jsx("span",{ref:i,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx("div",{ref:s,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:S=>y(S),className:`${v.processLineBase}  ${v.before}`}),a.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:o!=null&&o.song?Br((_=o.song)==null?void 0:_.duration):"0:00"})})]})]})}function dJ(){const{theme:t}=G(),e=f.useRef(null);return f.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function hJ(){const{theme:t}=G(),e=Kt(),{countDown:n}=re(In),r=f.useRef(null),s=()=>{var o;n?e(Bt({countDown:0})):(o=r.current)==null||o.open()},i={container:"w-[54px] sm:w-[50px] flex justify-center",button:`rounded-[99px]  hover:bg-${t.alpha} p-[5px]`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:i.container,children:n?a.jsx(Ds,{content:"Clear timer",children:a.jsxs("button",{className:"group flex items-center",onClick:s,children:[a.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:n.toString().padStart(2,"0")}),a.jsx("span",{className:`hidden group-hover:block ${i.button}`,children:a.jsx(qi,{className:"w-8 sm:w-6"})})]})}):a.jsx(Ds,{content:"Sleep timer",children:a.jsx("button",{onClick:s,className:i.button,children:a.jsx(UT,{className:"w-8 sm:w-6"})})})}),a.jsx(Ee,{ref:r,variant:"animation",children:a.jsx(FI,{active:o=>e(Bt({countDown:o})),closeModal:()=>{var o;return(o=r.current)==null?void 0:o.close()}})})]})}function fJ(){const{audioRef:t,idle:e}=dt();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=G(),{isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenFullScreen:i,setIsOpenSongQueue:o}=dt(),{currentQueueId:l,currentSongData:c}=re(ze),{containerRef:u}=dJ(),{shouldHide:d}=mH({audioEle:t.current}),m=()=>{s&&o(!1),i(!0)},p={wrapper:`bottom-player hidden md:block border-${n.alpha} fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]`,container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 ${n.bottom_player_bg}`};return a.jsxs("div",{ref:u,className:`${p.wrapper} ${r?"border-transparent":n.image?n.bottom_player_bg:""} ${d&&"translate-y-[100%] "} `,children:[!n.image&&a.jsx("div",{className:`${p.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),a.jsxs("div",{className:`${p.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[a.jsx(aJ,{song:c==null?void 0:c.song,isOpenFullScreen:r}),a.jsx("div",{className:` ${p.controlWrapper} ${Qc(l===null)}`,children:a.jsx(uJ,{})}),a.jsxs("div",{className:`${p.right}  ${r?"hidden":""}`,children:[a.jsx(lJ,{audioEle:t.current}),a.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[a.jsx(Ds,{content:"Fullscreen mode",children:a.jsx("button",{onClick:m,className:`rounded-[99px]  hover:bg-${n.alpha}  p-[5px]`,children:a.jsx(uF,{className:"w-6"})})}),a.jsx(Ds,{content:"Queue",children:a.jsx("button",{onClick:()=>o(!s),className:`ml-1 hover:bg-${n.alpha} rounded-md p-[5px]`,children:a.jsx(vD,{className:"w-6"})})}),a.jsx("div",{className:`w-[2px] h-[26px] ml-2 bg-${n.alpha}`}),a.jsx(hJ,{})]})]})]})]})}function mJ({isOpenFullScreen:t}){const e=f.useRef(null);return f.useEffect(()=>{const n=e.current;n&&(t?(n.style.transform="translate(0)",n.style.zIndex="99"):(n.style.transform="translate(0, 100%)",setTimeout(()=>{n.style.zIndex="-10"},500)))},[t]),{wrapperRef:e}}function pJ({imageUrl:t}){const{mobileActiveTab:e,setMobileActiveTab:n}=dt(),r=e==="Playing";return a.jsx("div",{onClick:()=>n(r?"Lyric":"Playing"),className:` ${r?"w-full h-auto px-2 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:a.jsx(Je,{src:t,className:"w-full rounded-md"})})}function gJ({song:t,onClick:e,active:n}){const r={itemContainer:`border-b 
    last:border-none border-white/10 rounded-md flex p-2 ${n?"bg-white/10":""}`,imageFrame:"w-[54px] h-[54px] relative rounded-md overflow-hidden flex-shrink-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{onClick:e,className:`${r.itemContainer} `,children:[a.jsx("div",{className:`${r.imageFrame}  `,children:a.jsx(Je,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("p",{className:"text-lg line-clamp-1 text-sm",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1 text-sm",children:t.singers.map((s,i)=>a.jsxs("span",{children:[" ",(i?", ":"")+s.name]},i))})]})]})})}function xJ({}){const t=Kt(),{queueSongs:e,isFetching:n,currentQueueId:r}=re(ze),s=[...Array(5).keys()].map(o=>a.jsx(ce,{className:"h-[40px] mt-1"},o)),i=()=>a.jsx(a.Fragment,{children:e.map((o,l)=>a.jsx(gJ,{song:o,active:r===o.queue_id,onClick:()=>t(hs(o.queue_id))},l))});return a.jsxs(a.Fragment,{children:[i(),n&&s]})}function yJ(){const t=f.useRef(null),e=Kt(),{countDown:n}=re(In),r=()=>{var s;n?e(Bt({countDown:0})):(s=t.current)==null||s.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{className:Ni(!!n,"active"),onClick:r,children:n?a.jsx(iM,{className:"w-6"}):a.jsx(UT,{className:"w-6"})}),a.jsx("span",{children:n?n.toString().padStart(2,"")+" songs":"Timer"})]}),a.jsx(Ee,{ref:t,variant:"animation",children:a.jsx(FI,{active:s=>e(Bt({countDown:s})),closeModal:()=>{var s;return(s=t.current)==null?void 0:s.close()}})})]})}function vJ({song:t}){const e=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:a.jsx(ir,{className:"w-6"})}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(Ee,{variant:"animation",ref:e,children:a.jsx(Hm,{closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()},songs:[t]})})]})}function wJ({isLiked:t,song:e}){const{action:n,loading:r}=Wm();return a.jsxs("div",{children:[a.jsx("button",{onClick:()=>n({variant:"like",song:e}),className:`${Ni(t,"active")}`,children:r?a.jsx(We,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(hl,{className:"w-6"}):a.jsx(Su,{className:"w-6"})})}),a.jsx("span",{children:t?"Dislike":"Like"})]})}function _J(){const{user:t}=ge(),{currentSongData:e,queueSongs:n}=re(ze),{toggleRepeat:r,repeat:s}=ti(),i={buttonList:"flex flex-shrink-0 overflow-auto space-x-2 [&_div]:flex [&_div]:w-[70px] [&_div]:flex-col [&_div]:items-center [&_div]:space-y-1.5 [&_div]:text-center [&_button]:p-3.5 [&_button]:bg-white/10 [&_button]:rounded-full [&_button.active]:text-[#198585] [&_span]:text-xs"};if(e)return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#1f1f1f] absolute inset-0"}),a.jsxs("div",{className:i.buttonList,children:[a.jsxs("div",{children:[a.jsx("button",{disabled:n.length<=1,className:`${Ni(s!=="no","active")}`,onClick:r,children:a.jsx(MT,{className:"w-6"})}),a.jsx("span",{className:"break-word",children:s==="one"?"Repeat one":s==="all"?"Repeat all":"Play once"})]}),t&&a.jsxs(a.Fragment,{children:[a.jsx(vJ,{song:e.song}),a.jsx(wJ,{song:e.song,isLiked:!!(t!=null&&t.liked_song_ids.includes(e.song.id))})]}),a.jsx(yJ,{})]}),a.jsx("div",{className:"flex-grow overflow-auto mt-3 border-t border-white/60 pt-3",children:e&&a.jsx(xJ,{currentIndex:e.index})})]})})}function bJ(){const{setIsOpenFullScreen:t}=dt(),{setIsOpenComment:e}=Gr(),n=f.useRef(null),r=f.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),e(!0)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{className:"p-1.5",onClick:s,children:a.jsx(Hy,{className:"w-6"})}),a.jsx("button",{className:"p-1.5",onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:a.jsx(Q6,{className:"w-6"})}),a.jsx("button",{onClick:()=>t(!1),className:"p-1.5",children:a.jsx(BT,{className:"w-6"})})]}),a.jsx(wx,{ref:n,children:a.jsx(_J,{})}),a.jsx(wx,{onClose:()=>e(!1),ref:r,children:a.jsx(sA,{children:a.jsx(h5,{})})})]})}function SJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-10"},r=()=>{switch(e){case"playing":return a.jsx(ov,{className:`${n.icon}`});case"error":return a.jsx(DI,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(W6,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(Xc,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function EJ(){var l;const{timelineEleRef:t,currentTimeEleRef:e}=dt(),{playStatus:n}=re(In),{currentSongData:r}=re(ze),{handleSeek:s,handlePlayPause:i}=ti(),o={buttonsContainer:"w-full flex items-center justify-between space-x-2 mt-2",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-1 flex-grow relative rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${o.progressContainer}  ${n==="error"||n==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] sm:w-9",children:a.jsx("span",{ref:e,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx("div",{ref:t,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:c=>s(c),className:`${o.processLineBase}  ${o.before}`}),a.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:r!=null&&r.song?Br((l=r.song)==null?void 0:l.duration):"0:00"})})]}),a.jsxs("div",{className:`${o.buttonsContainer}`,children:[a.jsx(SJ,{playStatus:n,handlePlayPause:i}),a.jsx(Km,{target:"song",children:a.jsx(bJ,{})})]})]})}function kJ(){const{isOpenFullScreen:t,playerConig:{songBackground:e},mobileActiveTab:n}=dt(),{currentSongData:r}=re(ze),s=f.useRef(null),{wrapperRef:i}=mJ({isOpenFullScreen:t}),o={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"mt-auto",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{ref:i,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[e&&a.jsx("div",{className:o.bgImage,children:a.jsx(Cu,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||d5})}),a.jsx("div",{className:"h-full z-10 p-4 flex flex-col",children:a.jsxs("div",{ref:s,className:o.container,children:[a.jsxs("div",{className:`${n!="Playing"?"flex items-center":"sm:flex"}`,children:[a.jsx(pJ,{imageUrl:r==null?void 0:r.song.image_url}),a.jsxs("div",{className:`ml-2 ${n!="Playing"?"block":"hidden sm:block"}`,children:[a.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:r==null?void 0:r.song.name}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]}),n==="Lyric"&&a.jsxs(xr,{appendOnPortal:!0,children:[a.jsx(yr,{children:a.jsx("button",{className:" p-[6px] rounded-full ml-auto  bg-white/10",children:a.jsx(Wy,{className:"w-6"})})}),a.jsx(vr,{position:"left-bottom",origin:"top right",children:a.jsx(UR,{})})]})]}),a.jsx("div",{className:`mt-2 justify-between items-center ${n!="Playing"?"hidden":"flex sm:hidden"}`,children:a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{className:"h-[40px]",children:a.jsx(p5,{className:"text-xl leading-[1.5] font-playwriteCU",content:(r==null?void 0:r.song.name)||"..."})}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>l.id?a.jsx(we,{to:`/singer/${l.id}`,children:(c?", ":"")+l.name},c):a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]})}),a.jsx(NI,{children:a.jsx(XR,{isOpenLyricTabs:t&&n=="Lyric",children:a.jsx(f5,{className:`text-left ${n==="Lyric"?"flex-1 block":"hidden"}`})})}),a.jsx("div",{className:`${o.control}`,children:a.jsx(EJ,{})})]})})]})})}function TJ({audioEle:t}){const e=sr(),n=f.useMemo(()=>e.pathname==="/",[e]),r=f.useMemo(()=>e.pathname.includes("lyric"),[e]);return f.useEffect(()=>{(n||r)&&t.pause()},[e]),{shouldHidePlayer:n,location:e,shouldHideAll:r}}function IJ({ActiveClass:t}){const{user:e}=ge(),{action:n}=Qm(),r=Dt(),s=f.useRef(null),i=async()=>{try{await n("login"),r("/my-music")}catch(o){console.log(o)}};return e?a.jsx(we,{className:`
                  ${t}
                `,to:"/my-music",children:a.jsxs("div",{children:[a.jsx($0,{}),a.jsx("span",{children:"My song"})]})}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{var o;return(o=s.current)==null?void 0:o.open()},className:`
                  ${t}
                `,children:a.jsxs("div",{children:[a.jsx($0,{}),a.jsx("span",{children:"Login"})]})}),a.jsx(Ee,{ref:s,variant:"animation",children:a.jsxs(Pe,{children:[a.jsx(ot,{close:()=>{var o;return(o=s.current)==null?void 0:o.close()},title:"Login"}),a.jsx("div",{className:"text-center my-5",children:a.jsx(ae,{onClick:i,color:"primary",children:"Login with Google"})})]})})]})}function CJ(){const{isOpenFullScreen:t,setIsOpenFullScreen:e,audioRef:n}=dt();if(!n.current)return a.jsx(a.Fragment,{});const{theme:r}=G(),{playStatus:s}=re(In),{currentSongData:i}=re(ze),{handlePlayPause:o}=ti(),{shouldHideAll:l,shouldHidePlayer:c,location:u}=TJ({audioEle:n.current}),d=f.useMemo(()=>{switch(s){case"playing":return a.jsx(Xy,{className:"w-10"});case"error":return a.jsx(rm,{className:"w-10"});case"loading":case"waiting":return a.jsx(We,{className:"w-10 animate-spin"});case"paused":return a.jsx(HT,{className:"w-10"})}},[s]),m=g=>g?`${r.content_text}`:"",p={wrapper:`block md:hidden fixed bottom-0 w-full transition-transform overflow-hidden border-t border-${r.alpha} z-[9]`,container:`absolute inset-0 ${r.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`,songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"ml-2 flex-shrink-0"};return a.jsxs("div",{className:`${p.wrapper} ${l?"translate-y-[100%]":""}`,children:[a.jsx("div",{className:`${p.container} ${c?"hidden":""} ${t?"opacity-0 transition-opacity delay-[.3s]":""}`}),a.jsxs("div",{className:`flex justify-between items-center px-4 py-3 ${c?"hidden":""}`,children:[a.jsx("div",{onClick:()=>i!=null&&i.song.name?e(!0):{},className:"mobile-current-song flex-grow",children:a.jsxs("div",{className:p.songImageWrapper,children:[a.jsx("div",{className:p.image,children:a.jsx(Je,{src:i==null?void 0:i.song.image_url,className:"rounded-full"})}),a.jsx("div",{className:"flex-grow ml-2",children:(i==null?void 0:i.song.song_url)&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU line-clamp-1",children:(i==null?void 0:i.song.name)||"..."}),a.jsx("p",{className:"opacity-70 text-sm line-clamp-1",children:i==null?void 0:i.song.singers.map((g,y)=>(y?", ":"")+g.name)})]})})]})}),a.jsx("div",{className:`${p.cta} ${!(i!=null&&i.song.name)&&"disable"}`,children:a.jsx("button",{className:"p-[4px]",onClick:o,children:d})})]}),a.jsxs("div",{className:`flex items-center py-1 justify-evenly [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_svg]:w-6
      [&_span]:text-[10px]
      ${c?"":"border-t border-"+r.alpha}
      `,children:[a.jsx(we,{className:`
              ${m(u.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Eu,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(we,{className:`
              ${m(u.pathname==="/discover")}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(VT,{}),a.jsx("span",{children:"Discover"})]})}),a.jsx(we,{className:`
              ${m(u.pathname==="/search")}
            `,to:"/search",children:a.jsxs("div",{children:[a.jsx(sm,{}),a.jsx("span",{children:"Search"})]})}),a.jsx(IJ,{ActiveClass:m(u.pathname==="/my-music")})]})]})}function jJ(){const t=Kt(),{audioRef:e,firstTimeSongLoaded:n}=dt(),{playStatus:r,countDown:s}=re(In),{handlePlayPause:i}=ti(),o=f.useRef(0),l=()=>(console.log("song end"),rt("timer",o.current-1),t(Bt({countDown:o.current-1})));f.useEffect(()=>{const c=gn().timer||0;t(Bt({countDown:c}))},[]),f.useEffect(()=>{if(!(!s||!e.current))return e.current.addEventListener("ended",l),n.current||(rt("timer",s),rt("is_timer",!0),r==="paused"&&i()),()=>{var c;(c=e.current)==null||c.removeEventListener("ended",l)}},[!!s]),f.useEffect(()=>{o.current=s},[s])}function RJ(){const{isOpenFullScreen:t,playerConig:{repeat:e,isShuffle:n,isCrossFade:r,isEnableBeat:s},audioRef:i,firstTimeSongLoaded:o,startFadeWhenEnd:l,isPlayingNewSong:c,timelineEleRef:u,currentTimeEleRef:d,themeCodeRef:m,shouldSyncSongDuration:p}=dt();if(!i.current)throw new Error("Use Control audioRef.current is undefined");const g=Kt(),{theme:y}=G(),{user:v,updateUserData:_}=ge(),{queueSongs:S,currentSongData:b,currentQueueId:E}=re(ze),{playStatus:R}=re(In),{currentPlaylist:D}=re(Zs),F=f.useRef(),I=f.useRef(!1),k=f.useRef(!1),j=f.useRef(!1),C=f.useRef("paused"),N=f.useRef([]),P=sr(),{setErrorToast:A}=de(),{next:Z,updateProgressElement:he,play:te,pause:Se}=ti(),H=f.useMemo(()=>P.pathname.includes("edit"),[P]),Y=f.useMemo(()=>gn(),[]),ee=be=>S[be],ve=()=>{g(Bt({playStatus:"paused"}))},Ce=()=>{R!=="playing"&&(g(Bt({playStatus:"playing"})),j.current=!1)},Ge=()=>{u.current&&d.current&&(d.current.innerText="0:00",u.current.style.background="rgba(255, 255, 255, 0.15)")},kr=be=>{const vt=gn().volume||1;if(be<=2){const wt=be/2*vt;i.current.volume=wt}else if(be<l.current){i.current.volume!=vt&&(i.current.volume=vt);return}if(be>=l.current){const wt=(i.current.duration-be)/2*vt;i.current.volume=wt}},or=()=>{const be=i.current.currentTime;C.current!=="paused"&&g(Bt({playStatus:"playing"})),he(be),r&&kr(be),be&&Math.round(be)%3===0&&rt("current_time",Math.round(be))},lr=()=>{if(console.log("end"),!F.current)return;const be=gn(),vt=be.volume||1,wt=be.timer;if(e==="one"&&wt&&wt!==1)return te();if(i.current.volume=vt,k.current=!0,n){let On=F.current.index;for(;On===F.current.index;)On=Math.round(Math.random()*S.length-1);const jn=ee(On);return g(hs(jn.queue_id))}return wt===0&&be.is_timer?(I.current=!0,rt("is_timer",!1)):F.current.index===S.length-1&&(e==="all"||wt>=1?I.current=!1:I.current=!0),S.length===1?Ge():Z()},Mn=()=>{F.current&&g(Bt({playStatus:"loading"}))},Ju=()=>{if(!F.current)return;const be=i.current.duration;if(l.current=be-3,rt("current_queue_id",F.current.song.queue_id),I.current)return I.current=!1,g(Bt({playStatus:"paused"}));if((H||o.current)&&(g(Bt({playStatus:"paused"})),o.current)){o.current=!1,p.current=!0,he(Y.current_time||0);return}if(F.current)if(v){const vt=F.current.song.id,wt=[...N.current];if(!wt.includes(vt)){console.log("push recent songs");const jn={recent_song_ids:[...wt,vt]};_(jn),Et({collectionName:"Users",data:jn,id:v.email})}}else{const vt=gn()["recent-songs"]||[];vt.find(On=>{var jn;return On.id===((jn=F.current)==null?void 0:jn.song.id)})||vt.unshift(F.current.song),rt("recent-songs",vt)}te()},Zu=()=>{g(Bt({playStatus:"waiting"}))},Zi=()=>{if(F.current){if(j.current||(j.current=!0,A("Found internet error")),!k.current)return g(Bt({playStatus:"error"}));if(S.length>1){if(F.current.index===S.length-1){g(Bt({playStatus:"error"}));return}Z()}else g(Bt({playStatus:"error"}))}};f.useEffect(()=>{v&&(N.current=v.recent_song_ids)},[v]),f.useEffect(()=>{const be=Y.current_queue_id||null;be&&S.length?g(hs(be)):o.current=!1},[]),f.useEffect(()=>(i.current.addEventListener("error",Zi),i.current.addEventListener("pause",ve),i.current.addEventListener("play",Ce),i.current.addEventListener("loadstart",Mn),i.current.addEventListener("loadedmetadata",Ju),i.current.addEventListener("waiting",Zu),()=>{var be,vt,wt,On,jn,Cl;(be=i.current)==null||be.removeEventListener("error",Zi),(vt=i.current)==null||vt.removeEventListener("pause",ve),(wt=i.current)==null||wt.removeEventListener("play",Ce),(On=i.current)==null||On.removeEventListener("loadstart",Mn),(jn=i.current)==null||jn.removeEventListener("loadedmetadata",Ju),(Cl=i.current)==null||Cl.addEventListener("waiting",Zu)}),[]),f.useEffect(()=>{if(!b||!E){C.current="paused",Se();return}return i.current.src=s&&b.song.beat_url?b.song.beat_url:b.song.song_url,F.current=b,()=>{Ge(),c.current=!0,p.current&&(p.current=!1)}},[b==null?void 0:b.song]),f.useEffect(()=>{if(!b){R==="paused"&&Ge();return}let be=`${b.song.name}`;R==="paused"&&D&&b.song.queue_id.includes(D.id)&&(be=`${D.name}`),document.title=be,C.current=R},[R]),f.useEffect(()=>(i.current.addEventListener("ended",lr),()=>{var be;return(be=i.current)==null?void 0:be.removeEventListener("ended",lr)}),[e,n,E,S]),f.useEffect(()=>(i.current.addEventListener("timeupdate",or),()=>{var be;(be=i.current)==null||be.removeEventListener("timeupdate",or)}),[r]),f.useEffect(()=>{t?m.current="#fff":m.current=y.content_code,he(o.current?Y.current_time:0)},[y,t]),f.useEffect(()=>{H&&R==="playing"&&Se()},[H])}function AJ(t,e){const{currentSongData:n}=re(ze),{isOpenFullScreen:r,setIdle:s}=dt(),[i,o]=f.useState(0),l=f.useRef(),c=f.useRef(),u=()=>{s(!1),o(Math.random())},d=()=>{clearTimeout(c.current),clearTimeout(l.current)},m=async()=>{if(!r)return;const p=document.querySelector(".song-thumb.active"),g=document.querySelector(".song-list-container");if(p&&g){const y=Vx(p,g,!0);let v=Tw.focusDelay;y||(v=0),l.current=setTimeout(()=>{s(!0)},v)}};if(f.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),f.useEffect(()=>(c.current=setTimeout(()=>{m()},t),()=>{d()}),[i]),!r)return!1}function NJ({children:t}){const{isOnMobile:e}=G();return RJ(),jJ(),AJ(Tw.focusDelay,e),f.useMemo(()=>t,[])}function PJ(){const{isOnMobile:t}=G(),{audioRef:e}=dt(),[n,r]=f.useState(!1),s=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(YY,{}),a.jsx(nJ,{}),a.jsx(fJ,{})]}),i=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(kJ,{}),a.jsx(CJ,{})]});return f.useEffect(()=>{r(!0)},[]),a.jsxs(a.Fragment,{children:[a.jsx("audio",{ref:e,className:"hidden"}),e.current&&a.jsx(NJ,{children:t?i:s})]})}function FJ(){const{theme:t}=G(),{user:e,loading:n}=ge(),r=sr(),s=Dt(),i=()=>{s("/dashboard")},o=[...Array(2).keys()].map(u=>a.jsxs("div",{className:"h-[78px] lg:h-[51px] w-full",children:[a.jsx(ce,{className:"lg:ml-1 w-[28px] h-[28px] flex-shrink-0"}),a.jsx(ce,{className:"w-[60px] h-[22px] lg:h-[28px] lg:w-[100px]"})]},u)),l=u=>u?`${t.content_text}`:"",c={container:`w-[80px] lg:w-[180px]  relative  flex-shrink-0 border-r-[1px] h-screen ${t.side_bar_bg} border-${t.alpha}`,linkList:`
      ${t.type==="light"?"hover:[&_div]:bg-black/10":"hover:[&_div]:bg-white/10"}
      [&_div]:py-3
      [&_div]:leading-[2.2] 
      [&_div]:font-playwriteCU 
      [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_div]:space-y-1 
      [&_span]:text-[10px]

      lg:[&_div]:space-y-0 
      lg:[&_div]:space-x-2 
      lg:[&_div]:px-3
      lg:[&_div]:flex-row 
      lg:[&_div]:items-center
      [&_svg]:w-7
      lg:[&_a]:border-l-[4px]
      [&_a]:w-full
      lg:[&_span]:text-[14px]
      `};return a.jsxs("div",{className:`hidden md:block ${c.container} ${t.text_color}`,children:[a.jsx("div",{className:"px-[10px] h-[60px] flex items-center justify-center",children:a.jsxs("div",{className:"text-xl hidden lg:block font-[500]",children:["HD",a.jsx("span",{className:`${t.content_text} ml-[4px]`,children:"MP3"})]})}),a.jsxs("div",{className:`flex flex-col items-start ${c.linkList}`,children:[n&&o,!n&&a.jsxs(a.Fragment,{children:[a.jsx(we,{className:`
              ${l(r.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Eu,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(we,{className:`
              ${l(r.pathname==="/discover")}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(VT,{}),a.jsx("span",{children:"Discover"})]})}),e&&a.jsxs(a.Fragment,{children:[a.jsx(we,{className:`
                  ${l(r.pathname==="/my-music")}`,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(Qa,{}),a.jsx("span",{children:"My Song"})]})}),e.role==="ADMIN"&&a.jsx(we,{to:"/dashboard",className:"border-transparent",children:a.jsxs("div",{onClick:i,children:[a.jsx(Gy,{}),a.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]})]})}function DJ({contentRef:t}){const{theme:e}=G(),[n,r]=f.useState(0),[s,i]=Ev(Oa),[o,l]=f.useState(""),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),{action:m}=Qm(),p=E=>{var R,D;l(E),(R=d.current)==null||R.toggle(),(D=c.current)==null||D.close()},g=async()=>{var E;try{await m("logout")}catch(R){console.log("signOut error",{message:R})}finally{(E=d.current)==null||E.toggle()}},y=async()=>{var E;try{(E=u.current)==null||E.close(),await m("login")}catch(R){console.log({message:R})}},v=()=>{var R;const E=((R=t.current)==null?void 0:R.scrollTop)||0;r(E)},_=a.jsx(ce,{className:"h-[40px] w-[40px] rounded-full"}),S=f.useMemo(()=>{switch(o){case"":return a.jsx(a.Fragment,{});case"theme":return a.jsx(iv,{close:()=>{var E;return(E=d.current)==null?void 0:E.toggle()}});case"info":return a.jsx(sv,{close:()=>{var E;return(E=d.current)==null?void 0:E.toggle()}});case"confirm":return a.jsx(ps,{close:()=>{var E;return(E=d.current)==null?void 0:E.toggle()},callback:g,loading:!1,label:"Sign out ?"})}},[o]);f.useEffect(()=>{var E;return(E=t.current)==null||E.addEventListener("scroll",v),()=>{document.removeEventListener("scroll",v)}},[]);const b={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full",menuItem:"hover:bg-white/5 rounded-[4px] w-full text-sm px-[10px] h-[44px] inline-flex items-center font-[500]",icon:"w-5 mr-1",divide:`h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-${e.alpha}`};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`hidden md:block h-[60px] fixed top-0 right-0  left-[80px] lg:left-[180px] z-[20]  ${n?"shadow-lg":"bg-transparent"}`,children:[a.jsx("div",{className:`${n?"":"hidden "} absolute inset-0 ${e.container} bg-opacity-[0.9] backdrop-blur-[15px] z-[-1] `}),a.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[a.jsx(c5,{className:"mr-5"}),a.jsx(wA,{}),a.jsxs("div",{className:"flex space-x-3 ml-auto",children:[a.jsxs(xr,{children:[a.jsx(yr,{ref:c,children:a.jsx(Ds,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:a.jsx("button",{className:`flex px-[6px] items-center ${b.button} bg-${e.alpha} ${e.content_hover_bg}`,children:a.jsx(nm,{className:"w-full"})})})}),a.jsx(vr,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(kR,{openModal:p,variant:"client"})})]}),a.jsxs(xr,{children:[a.jsx(yr,{ref:u,className:"flex items-center",children:a.jsx("button",{className:"flex hover:brightness-90",children:i?_:a.jsx(vx,{className:"w-[40px] h-[40px]"})})}),a.jsx(vr,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(mm,{theme:e,children:a.jsxs("div",{className:"w-[250px] max-h-[50vh]",children:[s&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[a.jsx(vx,{className:"login-trigger w-[46px] h-[46px]"}),a.jsx("div",{className:"ml-[12px]",children:a.jsx("h5",{className:"font-semibold line-clamp-1",children:s==null?void 0:s.displayName})})]}),a.jsx("div",{className:b.divide}),a.jsxs("button",{className:`${b.menuItem}`,onClick:()=>p("confirm"),children:[a.jsx(OT,{className:b.icon}),"Log out"]})]}),!s&&a.jsxs("button",{className:`${b.menuItem}`,onClick:y,children:[a.jsx(k3,{className:b.icon}),"Log in"]})]})})})]})]})]})]}),a.jsx(Ee,{variant:"animation",ref:d,children:S})]})}function LJ(){const{user:t,setUser:e}=ge(),{isDev:n}=G(),{uploadedSongs:r,setUploadedSongs:s,shouldFetchFavoriteSongs:i}=Tn(),{setIsUploading:o,isUploading:l,setUploadingSongs:c,resetUploadContext:u}=jI(),[d,m]=f.useState(""),p=f.useRef(null),{setErrorToast:g,setSuccessToast:y}=de(),v=()=>{const S=p.current;S&&(S.value=""),u()},_=async S=>{try{if(!t)return;const b=[],E=[],R=S.target.files;if(!R.length)return;const D=[],F=[],I=Date.now(),k=P=>r.some(A=>A.size===P.size)||D.some(A=>A.size===P.size);for(let P=0;P<=R.length-1;P++){const A=R[P],Z=await e5(A);if(!Z)continue;const he={name:Z.singer,created_at:""},te={...kf(he),id:""},Se={name:Z.name,singers:[te],duration:Math.floor(Z.duration),size:Math.floor(A.size/1024)},H=Z.image?new Blob([Z.image]):null;H&&(E.push(H),Se.image_url=URL.createObjectURL(H));const Y=Cx({...Se,owner_email:t.email,distributor:t.display_name});if(k(Y)){console.log(">>>duplicate");continue}D.push(Y),b.push(P)}if(r.length+b.length>5)return m("You have reach the upload limit");if(!D.length)return;c(D),o(!0);for(let P=0;P<b.length;P++){const A=b[P],Z=E[P],he={...D[P]},{filePath:te,fileURL:Se}=await Cw({file:R[A],folder:"/songs/",namePrefix:t.email,msg:">>> api: upload song file"});if(Z){const ve=await Yi({blob:Z});Object.assign(he,ve)}Object.assign(he,{song_file_path:te,song_url:Se});const H=await Gs({collectionName:"Songs",data:he,msg:">>> api: set song doc"}),Y=await La(H);F.push(Y.id);const ee={...Y.data(),id:H.id,queue_id:qu(4)};s(ve=>[...ve,ee]),c(ve=>{const Ce=[...ve];return Ce.shift,Ce})}const C={liked_song_ids:[...F,...t.liked_song_ids]};await Et({collectionName:"Users",data:C,id:t.email}),e({...t,...C}),i.current=!0,y(`${D.length} songs uploaded`);const N=Date.now();n&&console.log(">>> upload songs finished after",(N-I)/1e3)}catch(b){console.log({message:b}),g(d)}finally{v()}};return f.useEffect(()=>{if(!l)return;const S=document.querySelector(".temp-song");S&&S.scrollIntoView({behavior:"smooth",block:"center"})},[l]),{handleInputChange:_,inputRef:p}}function MJ(){const{handleInputChange:t,inputRef:e}=LJ(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return a.jsx(a.Fragment,{children:Ga.createPortal(a.jsx("div",{className:n.container,children:a.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function OJ(){const{theme:t}=G(),e=f.useRef(null),n={page:`md:flex md:h-screen  ${t.container} ${t.text_color}`,container:"md:h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] pt-[10px] md:pt-[60px] md:overflow-auto"};return f.useEffect(()=>{const r=document.querySelector(".my-tag"),s=document.querySelector("body");s.style.backgroundColor=t.container_code,r&&r.setAttribute("content",t.container_code)},[t]),a.jsx(a.Fragment,{children:a.jsx(M6,{children:a.jsxs(II,{children:[a.jsxs("div",{className:`${n.page}`,children:[a.jsx(FJ,{}),a.jsxs("div",{ref:e,className:n.container,children:[a.jsx(DJ,{contentRef:e}),a.jsx(tm,{})]}),a.jsx(PJ,{})]}),a.jsx(u5,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),a.jsx(MJ,{}),a.jsx(TI,{})]})})})}function Og({children:t}){return t}function $J(){return a.jsx(a.Fragment,{children:a.jsx(h3,{children:a.jsxs(i3,{children:[a.jsx(Yr,{path:"*",element:a.jsx(wG,{})}),a.jsx(Yr,{path:"/login",element:a.jsx(bG,{})}),a.jsxs(Yr,{element:a.jsx(OJ,{}),children:[NY.map((t,e)=>{const n=t.layout||Og,r=t.component;return a.jsx(Yr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)}),a.jsx(Yr,{element:a.jsx(DY,{}),children:PY.map((t,e)=>{const n=t.layout||Og,r=t.component;return a.jsx(Yr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})]}),a.jsx(Yr,{element:a.jsx(LY,{}),children:a.jsx(Yr,{element:a.jsx(zY,{}),children:FY.map((t,e)=>{const n=t.layout||Og,r=t.component;return a.jsx(Yr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})})]})})})}const BJ=LV({reducer:{currentPlaylist:cH,playStatus:eH,songQueue:YV},middleware:t=>t({serializableCheck:!1})});function zJ(){const{setUser:t,setLoading:e,loading:n,user:r}=ge(),{getPlaylist:s}=dA(),i=f.useRef(!1),o=async()=>{Oa.onAuthStateChanged(async l=>{if(l&&l.email){const c=await Vr({collectionName:"Users",id:l.email,msg:"usePersistAuth, get user"}),u=c.data(),d={email:l.email,display_name:l.displayName,photo_url:l.photoURL,liked_song_ids:(u==null?void 0:u.liked_song_ids)||[],recent_playlist_ids:(u==null?void 0:u.recent_playlist_ids)||[],recent_song_ids:(u==null?void 0:u.recent_song_ids)||[],liked_singer_ids:(u==null?void 0:u.liked_singer_ids)||[],role:(u==null?void 0:u.role)||"USER",liked_playlist_ids:(u==null?void 0:u.liked_playlist_ids)||[],liked_comment_ids:gn().liked_comment_ids||[],last_seen:""};c.exists()?await Promise.all([s(d),Et({collectionName:"Users",id:d.email,data:{last_seen:Hs()},msg:"usePersistAuth, update user doc"})]):await vz(Rt(Te,"Users",d.email),d),t(d)}else t(null);e(!1)})};return f.useEffect(()=>{i.current||(i.current=!0,o())},[]),{user:r,loading:n}}function UJ({children:t}){return zJ(),t}$g.createRoot(document.getElementById("root")).render(a.jsx(wE.StrictMode,{children:a.jsx(oV,{store:BJ,children:a.jsx(BD,{children:a.jsx(C6,{children:a.jsx(UD,{children:a.jsx(R6,{children:a.jsx(P6,{children:a.jsx(UJ,{children:a.jsx($J,{})})})})})})})})}));
