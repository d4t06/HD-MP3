function vN(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function QE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var KE={exports:{}},Tf={},XE={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ou=Symbol.for("react.element"),wN=Symbol.for("react.portal"),_N=Symbol.for("react.fragment"),bN=Symbol.for("react.strict_mode"),SN=Symbol.for("react.profiler"),EN=Symbol.for("react.provider"),kN=Symbol.for("react.context"),TN=Symbol.for("react.forward_ref"),IN=Symbol.for("react.suspense"),CN=Symbol.for("react.memo"),RN=Symbol.for("react.lazy"),B1=Symbol.iterator;function jN(t){return t===null||typeof t!="object"?null:(t=B1&&t[B1]||t["@@iterator"],typeof t=="function"?t:null)}var YE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},JE=Object.assign,ZE={};function Yo(t,e,n){this.props=t,this.context=e,this.refs=ZE,this.updater=n||YE}Yo.prototype.isReactComponent={};Yo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Yo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ek(){}ek.prototype=Yo.prototype;function Nx(t,e,n){this.props=t,this.context=e,this.refs=ZE,this.updater=n||YE}var Px=Nx.prototype=new ek;Px.constructor=Nx;JE(Px,Yo.prototype);Px.isPureReactComponent=!0;var z1=Array.isArray,tk=Object.prototype.hasOwnProperty,Fx={current:null},nk={key:!0,ref:!0,__self:!0,__source:!0};function rk(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)tk.call(e,r)&&!nk.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ou,type:t,key:i,ref:a,props:s,_owner:Fx.current}}function AN(t,e){return{$$typeof:ou,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Dx(t){return typeof t=="object"&&t!==null&&t.$$typeof===ou}function NN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var U1=/\/+/g;function hp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?NN(""+t.key):e.toString(36)}function Bd(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ou:case wN:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+hp(a,0):r,z1(s)?(n="",t!=null&&(n=t.replace(U1,"$&/")+"/"),Bd(s,e,n,"",function(u){return u})):s!=null&&(Dx(s)&&(s=AN(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(U1,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",z1(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+hp(i,l);a+=Bd(i,e,n,c,s)}else if(c=jN(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+hp(i,l++),a+=Bd(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function id(t,e,n){if(t==null)return t;var r=[],s=0;return Bd(t,r,"","",function(i){return e.call(n,i,s++)}),r}function PN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xn={current:null},zd={transition:null},FN={ReactCurrentDispatcher:xn,ReactCurrentBatchConfig:zd,ReactCurrentOwner:Fx};Se.Children={map:id,forEach:function(t,e,n){id(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return id(t,function(){e++}),e},toArray:function(t){return id(t,function(e){return e})||[]},only:function(t){if(!Dx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Se.Component=Yo;Se.Fragment=_N;Se.Profiler=SN;Se.PureComponent=Nx;Se.StrictMode=bN;Se.Suspense=IN;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FN;Se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=JE({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Fx.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)tk.call(e,c)&&!nk.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:ou,type:t.type,key:s,ref:i,props:r,_owner:a}};Se.createContext=function(t){return t={$$typeof:kN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:EN,_context:t},t.Consumer=t};Se.createElement=rk;Se.createFactory=function(t){var e=rk.bind(null,t);return e.type=t,e};Se.createRef=function(){return{current:null}};Se.forwardRef=function(t){return{$$typeof:TN,render:t}};Se.isValidElement=Dx;Se.lazy=function(t){return{$$typeof:RN,_payload:{_status:-1,_result:t},_init:PN}};Se.memo=function(t,e){return{$$typeof:CN,type:t,compare:e===void 0?null:e}};Se.startTransition=function(t){var e=zd.transition;zd.transition={};try{t()}finally{zd.transition=e}};Se.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Se.useCallback=function(t,e){return xn.current.useCallback(t,e)};Se.useContext=function(t){return xn.current.useContext(t)};Se.useDebugValue=function(){};Se.useDeferredValue=function(t){return xn.current.useDeferredValue(t)};Se.useEffect=function(t,e){return xn.current.useEffect(t,e)};Se.useId=function(){return xn.current.useId()};Se.useImperativeHandle=function(t,e,n){return xn.current.useImperativeHandle(t,e,n)};Se.useInsertionEffect=function(t,e){return xn.current.useInsertionEffect(t,e)};Se.useLayoutEffect=function(t,e){return xn.current.useLayoutEffect(t,e)};Se.useMemo=function(t,e){return xn.current.useMemo(t,e)};Se.useReducer=function(t,e,n){return xn.current.useReducer(t,e,n)};Se.useRef=function(t){return xn.current.useRef(t)};Se.useState=function(t){return xn.current.useState(t)};Se.useSyncExternalStore=function(t,e,n){return xn.current.useSyncExternalStore(t,e,n)};Se.useTransition=function(){return xn.current.useTransition()};Se.version="18.2.0";XE.exports=Se;var m=XE.exports;const sk=QE(m),DN=vN({__proto__:null,default:sk},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LN=m,MN=Symbol.for("react.element"),ON=Symbol.for("react.fragment"),$N=Object.prototype.hasOwnProperty,BN=LN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zN={key:!0,ref:!0,__self:!0,__source:!0};function ik(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)$N.call(e,r)&&!zN.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:MN,type:t,key:i,ref:a,props:s,_owner:BN.current}}Tf.Fragment=ON;Tf.jsx=ik;Tf.jsxs=ik;KE.exports=Tf;var o=KE.exports;var Cg={},ak={exports:{}},er={},ok={exports:{}},lk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,X){var te=H.length;H.push(X);e:for(;0<te;){var xe=te-1>>>1,Ee=H[xe];if(0<s(Ee,X))H[xe]=X,H[te]=Ee,te=xe;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var X=H[0],te=H.pop();if(te!==X){H[0]=te;e:for(var xe=0,Ee=H.length,Qe=Ee>>>1;xe<Qe;){var Sr=2*(xe+1)-1,sr=H[Sr],ir=Sr+1,Ln=H[ir];if(0>s(sr,te))ir<Ee&&0>s(Ln,sr)?(H[xe]=Ln,H[ir]=te,xe=ir):(H[xe]=sr,H[Sr]=te,xe=Sr);else if(ir<Ee&&0>s(Ln,te))H[xe]=Ln,H[ir]=te,xe=ir;else break e}}return X}function s(H,X){var te=H.sortIndex-X.sortIndex;return te!==0?te:H.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,f=null,p=3,x=!1,v=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(H){for(var X=n(u);X!==null;){if(X.callback===null)r(u);else if(X.startTime<=H)r(u),X.sortIndex=X.expirationTime,e(c,X);else break;X=n(u)}}function I(H){if(_=!1,b(H),!v)if(n(c)!==null)v=!0,we(F);else{var X=n(u);X!==null&&ze(I,X.startTime-H)}}function F(H,X){v=!1,_&&(_=!1,E(k),k=-1),x=!0;var te=p;try{for(b(X),f=n(c);f!==null&&(!(f.expirationTime>X)||H&&!N());){var xe=f.callback;if(typeof xe=="function"){f.callback=null,p=f.priorityLevel;var Ee=xe(f.expirationTime<=X);X=t.unstable_now(),typeof Ee=="function"?f.callback=Ee:f===n(c)&&r(c),b(X)}else r(c);f=n(c)}if(f!==null)var Qe=!0;else{var Sr=n(u);Sr!==null&&ze(I,Sr.startTime-X),Qe=!1}return Qe}finally{f=null,p=te,x=!1}}var D=!1,C=null,k=-1,j=5,R=-1;function N(){return!(t.unstable_now()-R<j)}function P(){if(C!==null){var H=t.unstable_now();R=H;var X=!0;try{X=C(!0,H)}finally{X?A():(D=!1,C=null)}}else D=!1}var A;if(typeof w=="function")A=function(){w(P)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,pe=ee.port2;ee.port1.onmessage=P,A=function(){pe.postMessage(null)}}else A=function(){S(P,0)};function we(H){C=H,D||(D=!0,A())}function ze(H,X){k=S(function(){H(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){v||x||(v=!0,we(F))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(p){case 1:case 2:case 3:var X=3;break;default:X=p}var te=p;p=X;try{return H()}finally{p=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,X){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var te=p;p=H;try{return X()}finally{p=te}},t.unstable_scheduleCallback=function(H,X,te){var xe=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?xe+te:xe):te=xe,H){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=te+Ee,H={id:h++,callback:X,priorityLevel:H,startTime:te,expirationTime:Ee,sortIndex:-1},te>xe?(H.sortIndex=te,e(u,H),n(c)===null&&H===n(u)&&(_?(E(k),k=-1):_=!0,ze(I,te-xe))):(H.sortIndex=Ee,e(c,H),v||x||(v=!0,we(F))),H},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(H){var X=p;return function(){var te=p;p=X;try{return H.apply(this,arguments)}finally{p=te}}}})(lk);ok.exports=lk;var UN=ok.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ck=m,Yn=UN;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uk=new Set,_c={};function Oa(t,e){No(t,e),No(t+"Capture",e)}function No(t,e){for(_c[t]=e,t=0;t<e.length;t++)uk.add(e[t])}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rg=Object.prototype.hasOwnProperty,VN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,V1={},H1={};function HN(t){return Rg.call(H1,t)?!0:Rg.call(V1,t)?!1:VN.test(t)?H1[t]=!0:(V1[t]=!0,!1)}function WN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function qN(t,e,n,r){if(e===null||typeof e>"u"||WN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yn(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zt[t]=new yn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zt[e]=new yn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zt[t]=new yn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zt[t]=new yn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zt[t]=new yn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zt[t]=new yn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zt[t]=new yn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zt[t]=new yn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zt[t]=new yn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Lx=/[\-:]([a-z])/g;function Mx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Lx,Mx);zt[e]=new yn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Lx,Mx);zt[e]=new yn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Lx,Mx);zt[e]=new yn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zt[t]=new yn(t,1,!1,t.toLowerCase(),null,!1,!1)});zt.xlinkHref=new yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zt[t]=new yn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ox(t,e,n,r){var s=zt.hasOwnProperty(e)?zt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qN(e,n,s,r)&&(n=null),r||s===null?HN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Hs=ck.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ad=Symbol.for("react.element"),oo=Symbol.for("react.portal"),lo=Symbol.for("react.fragment"),$x=Symbol.for("react.strict_mode"),jg=Symbol.for("react.profiler"),dk=Symbol.for("react.provider"),hk=Symbol.for("react.context"),Bx=Symbol.for("react.forward_ref"),Ag=Symbol.for("react.suspense"),Ng=Symbol.for("react.suspense_list"),zx=Symbol.for("react.memo"),oi=Symbol.for("react.lazy"),fk=Symbol.for("react.offscreen"),W1=Symbol.iterator;function Dl(t){return t===null||typeof t!="object"?null:(t=W1&&t[W1]||t["@@iterator"],typeof t=="function"?t:null)}var nt=Object.assign,fp;function Xl(t){if(fp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fp=e&&e[1]||""}return`
`+fp+t}var mp=!1;function pp(t,e){if(!t||mp)return"";mp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{mp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xl(t):""}function GN(t){switch(t.tag){case 5:return Xl(t.type);case 16:return Xl("Lazy");case 13:return Xl("Suspense");case 19:return Xl("SuspenseList");case 0:case 2:case 15:return t=pp(t.type,!1),t;case 11:return t=pp(t.type.render,!1),t;case 1:return t=pp(t.type,!0),t;default:return""}}function Pg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case lo:return"Fragment";case oo:return"Portal";case jg:return"Profiler";case $x:return"StrictMode";case Ag:return"Suspense";case Ng:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case hk:return(t.displayName||"Context")+".Consumer";case dk:return(t._context.displayName||"Context")+".Provider";case Bx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zx:return e=t.displayName||null,e!==null?e:Pg(t.type)||"Memo";case oi:e=t._payload,t=t._init;try{return Pg(t(e))}catch{}}return null}function QN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pg(e);case 8:return e===$x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ni(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function KN(t){var e=mk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function od(t){t._valueTracker||(t._valueTracker=KN(t))}function pk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=mk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function mh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fg(t,e){var n=e.checked;return nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function q1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ni(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function gk(t,e){e=e.checked,e!=null&&Ox(t,"checked",e,!1)}function Dg(t,e){gk(t,e);var n=Ni(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Lg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Lg(t,e.type,Ni(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function G1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Lg(t,e,n){(e!=="number"||mh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Yl=Array.isArray;function bo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ni(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Mg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return nt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Q1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(V(92));if(Yl(n)){if(1<n.length)throw Error(V(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ni(n)}}function xk(t,e){var n=Ni(e.value),r=Ni(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function K1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Og(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ld,vk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ld=ld||document.createElement("div"),ld.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ld.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ac={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},XN=["Webkit","ms","Moz","O"];Object.keys(ac).forEach(function(t){XN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ac[e]=ac[t]})});function wk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ac.hasOwnProperty(t)&&ac[t]?(""+e).trim():e+"px"}function _k(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=wk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var YN=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $g(t,e){if(e){if(YN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function Bg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zg=null;function Ux(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ug=null,So=null,Eo=null;function X1(t){if(t=uu(t)){if(typeof Ug!="function")throw Error(V(280));var e=t.stateNode;e&&(e=Af(e),Ug(t.stateNode,t.type,e))}}function bk(t){So?Eo?Eo.push(t):Eo=[t]:So=t}function Sk(){if(So){var t=So,e=Eo;if(Eo=So=null,X1(t),e)for(t=0;t<e.length;t++)X1(e[t])}}function Ek(t,e){return t(e)}function kk(){}var gp=!1;function Tk(t,e,n){if(gp)return t(e,n);gp=!0;try{return Ek(t,e,n)}finally{gp=!1,(So!==null||Eo!==null)&&(kk(),Sk())}}function Sc(t,e){var n=t.stateNode;if(n===null)return null;var r=Af(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(V(231,e,typeof n));return n}var Vg=!1;if(Ps)try{var Ll={};Object.defineProperty(Ll,"passive",{get:function(){Vg=!0}}),window.addEventListener("test",Ll,Ll),window.removeEventListener("test",Ll,Ll)}catch{Vg=!1}function JN(t,e,n,r,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var oc=!1,ph=null,gh=!1,Hg=null,ZN={onError:function(t){oc=!0,ph=t}};function e5(t,e,n,r,s,i,a,l,c){oc=!1,ph=null,JN.apply(ZN,arguments)}function t5(t,e,n,r,s,i,a,l,c){if(e5.apply(this,arguments),oc){if(oc){var u=ph;oc=!1,ph=null}else throw Error(V(198));gh||(gh=!0,Hg=u)}}function $a(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ik(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Y1(t){if($a(t)!==t)throw Error(V(188))}function n5(t){var e=t.alternate;if(!e){if(e=$a(t),e===null)throw Error(V(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Y1(s),t;if(i===r)return Y1(s),e;i=i.sibling}throw Error(V(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?t:e}function Ck(t){return t=n5(t),t!==null?Rk(t):null}function Rk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Rk(t);if(e!==null)return e;t=t.sibling}return null}var jk=Yn.unstable_scheduleCallback,J1=Yn.unstable_cancelCallback,r5=Yn.unstable_shouldYield,s5=Yn.unstable_requestPaint,ht=Yn.unstable_now,i5=Yn.unstable_getCurrentPriorityLevel,Vx=Yn.unstable_ImmediatePriority,Ak=Yn.unstable_UserBlockingPriority,xh=Yn.unstable_NormalPriority,a5=Yn.unstable_LowPriority,Nk=Yn.unstable_IdlePriority,If=null,Yr=null;function o5(t){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(If,t,void 0,(t.current.flags&128)===128)}catch{}}var Pr=Math.clz32?Math.clz32:u5,l5=Math.log,c5=Math.LN2;function u5(t){return t>>>=0,t===0?32:31-(l5(t)/c5|0)|0}var cd=64,ud=4194304;function Jl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function yh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Jl(l):(i&=a,i!==0&&(r=Jl(i)))}else a=n&~s,a!==0?r=Jl(a):i!==0&&(r=Jl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pr(e),s=1<<n,r|=t[n],e&=~s;return r}function d5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function h5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Pr(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=d5(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Wg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Pk(){var t=cd;return cd<<=1,!(cd&4194240)&&(cd=64),t}function xp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function lu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pr(e),t[e]=n}function f5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Pr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Hx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var De=0;function Fk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Dk,Wx,Lk,Mk,Ok,qg=!1,dd=[],wi=null,_i=null,bi=null,Ec=new Map,kc=new Map,ci=[],m5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Z1(t,e){switch(t){case"focusin":case"focusout":wi=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":Ec.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kc.delete(e.pointerId)}}function Ml(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=uu(e),e!==null&&Wx(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function p5(t,e,n,r,s){switch(e){case"focusin":return wi=Ml(wi,t,e,n,r,s),!0;case"dragenter":return _i=Ml(_i,t,e,n,r,s),!0;case"mouseover":return bi=Ml(bi,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ec.set(i,Ml(Ec.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,kc.set(i,Ml(kc.get(i)||null,t,e,n,r,s)),!0}return!1}function $k(t){var e=ca(t.target);if(e!==null){var n=$a(e);if(n!==null){if(e=n.tag,e===13){if(e=Ik(n),e!==null){t.blockedOn=e,Ok(t.priority,function(){Lk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ud(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);zg=r,n.target.dispatchEvent(r),zg=null}else return e=uu(n),e!==null&&Wx(e),t.blockedOn=n,!1;e.shift()}return!0}function e_(t,e,n){Ud(t)&&n.delete(e)}function g5(){qg=!1,wi!==null&&Ud(wi)&&(wi=null),_i!==null&&Ud(_i)&&(_i=null),bi!==null&&Ud(bi)&&(bi=null),Ec.forEach(e_),kc.forEach(e_)}function Ol(t,e){t.blockedOn===e&&(t.blockedOn=null,qg||(qg=!0,Yn.unstable_scheduleCallback(Yn.unstable_NormalPriority,g5)))}function Tc(t){function e(s){return Ol(s,t)}if(0<dd.length){Ol(dd[0],t);for(var n=1;n<dd.length;n++){var r=dd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wi!==null&&Ol(wi,t),_i!==null&&Ol(_i,t),bi!==null&&Ol(bi,t),Ec.forEach(e),kc.forEach(e),n=0;n<ci.length;n++)r=ci[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ci.length&&(n=ci[0],n.blockedOn===null);)$k(n),n.blockedOn===null&&ci.shift()}var ko=Hs.ReactCurrentBatchConfig,vh=!0;function x5(t,e,n,r){var s=De,i=ko.transition;ko.transition=null;try{De=1,qx(t,e,n,r)}finally{De=s,ko.transition=i}}function y5(t,e,n,r){var s=De,i=ko.transition;ko.transition=null;try{De=4,qx(t,e,n,r)}finally{De=s,ko.transition=i}}function qx(t,e,n,r){if(vh){var s=Gg(t,e,n,r);if(s===null)Ip(t,e,r,wh,n),Z1(t,r);else if(p5(s,t,e,n,r))r.stopPropagation();else if(Z1(t,r),e&4&&-1<m5.indexOf(t)){for(;s!==null;){var i=uu(s);if(i!==null&&Dk(i),i=Gg(t,e,n,r),i===null&&Ip(t,e,r,wh,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Ip(t,e,r,null,n)}}var wh=null;function Gg(t,e,n,r){if(wh=null,t=Ux(r),t=ca(t),t!==null)if(e=$a(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ik(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return wh=t,null}function Bk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(i5()){case Vx:return 1;case Ak:return 4;case xh:case a5:return 16;case Nk:return 536870912;default:return 16}default:return 16}}var gi=null,Gx=null,Vd=null;function zk(){if(Vd)return Vd;var t,e=Gx,n=e.length,r,s="value"in gi?gi.value:gi.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Vd=s.slice(t,1<r?1-r:void 0)}function Hd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hd(){return!0}function t_(){return!1}function tr(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?hd:t_,this.isPropagationStopped=t_,this}return nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hd)},persist:function(){},isPersistent:hd}),e}var Jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qx=tr(Jo),cu=nt({},Jo,{view:0,detail:0}),v5=tr(cu),yp,vp,$l,Cf=nt({},cu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$l&&($l&&t.type==="mousemove"?(yp=t.screenX-$l.screenX,vp=t.screenY-$l.screenY):vp=yp=0,$l=t),yp)},movementY:function(t){return"movementY"in t?t.movementY:vp}}),n_=tr(Cf),w5=nt({},Cf,{dataTransfer:0}),_5=tr(w5),b5=nt({},cu,{relatedTarget:0}),wp=tr(b5),S5=nt({},Jo,{animationName:0,elapsedTime:0,pseudoElement:0}),E5=tr(S5),k5=nt({},Jo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),T5=tr(k5),I5=nt({},Jo,{data:0}),r_=tr(I5),C5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},R5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},j5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function A5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=j5[t])?!!e[t]:!1}function Kx(){return A5}var N5=nt({},cu,{key:function(t){if(t.key){var e=C5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Hd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?R5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kx,charCode:function(t){return t.type==="keypress"?Hd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Hd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),P5=tr(N5),F5=nt({},Cf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s_=tr(F5),D5=nt({},cu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kx}),L5=tr(D5),M5=nt({},Jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),O5=tr(M5),$5=nt({},Cf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),B5=tr($5),z5=[9,13,27,32],Xx=Ps&&"CompositionEvent"in window,lc=null;Ps&&"documentMode"in document&&(lc=document.documentMode);var U5=Ps&&"TextEvent"in window&&!lc,Uk=Ps&&(!Xx||lc&&8<lc&&11>=lc),i_=String.fromCharCode(32),a_=!1;function Vk(t,e){switch(t){case"keyup":return z5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var co=!1;function V5(t,e){switch(t){case"compositionend":return Hk(e);case"keypress":return e.which!==32?null:(a_=!0,i_);case"textInput":return t=e.data,t===i_&&a_?null:t;default:return null}}function H5(t,e){if(co)return t==="compositionend"||!Xx&&Vk(t,e)?(t=zk(),Vd=Gx=gi=null,co=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Uk&&e.locale!=="ko"?null:e.data;default:return null}}var W5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function o_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!W5[t.type]:e==="textarea"}function Wk(t,e,n,r){bk(r),e=_h(e,"onChange"),0<e.length&&(n=new Qx("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var cc=null,Ic=null;function q5(t){n2(t,0)}function Rf(t){var e=fo(t);if(pk(e))return t}function G5(t,e){if(t==="change")return e}var qk=!1;if(Ps){var _p;if(Ps){var bp="oninput"in document;if(!bp){var l_=document.createElement("div");l_.setAttribute("oninput","return;"),bp=typeof l_.oninput=="function"}_p=bp}else _p=!1;qk=_p&&(!document.documentMode||9<document.documentMode)}function c_(){cc&&(cc.detachEvent("onpropertychange",Gk),Ic=cc=null)}function Gk(t){if(t.propertyName==="value"&&Rf(Ic)){var e=[];Wk(e,Ic,t,Ux(t)),Tk(q5,e)}}function Q5(t,e,n){t==="focusin"?(c_(),cc=e,Ic=n,cc.attachEvent("onpropertychange",Gk)):t==="focusout"&&c_()}function K5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Rf(Ic)}function X5(t,e){if(t==="click")return Rf(e)}function Y5(t,e){if(t==="input"||t==="change")return Rf(e)}function J5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mr=typeof Object.is=="function"?Object.is:J5;function Cc(t,e){if(Mr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Rg.call(e,s)||!Mr(t[s],e[s]))return!1}return!0}function u_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function d_(t,e){var n=u_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=u_(n)}}function Qk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Qk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Kk(){for(var t=window,e=mh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=mh(t.document)}return e}function Yx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Z5(t){var e=Kk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Qk(n.ownerDocument.documentElement,n)){if(r!==null&&Yx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=d_(n,i);var a=d_(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var eP=Ps&&"documentMode"in document&&11>=document.documentMode,uo=null,Qg=null,uc=null,Kg=!1;function h_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kg||uo==null||uo!==mh(r)||(r=uo,"selectionStart"in r&&Yx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),uc&&Cc(uc,r)||(uc=r,r=_h(Qg,"onSelect"),0<r.length&&(e=new Qx("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=uo)))}function fd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ho={animationend:fd("Animation","AnimationEnd"),animationiteration:fd("Animation","AnimationIteration"),animationstart:fd("Animation","AnimationStart"),transitionend:fd("Transition","TransitionEnd")},Sp={},Xk={};Ps&&(Xk=document.createElement("div").style,"AnimationEvent"in window||(delete ho.animationend.animation,delete ho.animationiteration.animation,delete ho.animationstart.animation),"TransitionEvent"in window||delete ho.transitionend.transition);function jf(t){if(Sp[t])return Sp[t];if(!ho[t])return t;var e=ho[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Xk)return Sp[t]=e[n];return t}var Yk=jf("animationend"),Jk=jf("animationiteration"),Zk=jf("animationstart"),e2=jf("transitionend"),t2=new Map,f_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bi(t,e){t2.set(t,e),Oa(e,[t])}for(var Ep=0;Ep<f_.length;Ep++){var kp=f_[Ep],tP=kp.toLowerCase(),nP=kp[0].toUpperCase()+kp.slice(1);Bi(tP,"on"+nP)}Bi(Yk,"onAnimationEnd");Bi(Jk,"onAnimationIteration");Bi(Zk,"onAnimationStart");Bi("dblclick","onDoubleClick");Bi("focusin","onFocus");Bi("focusout","onBlur");Bi(e2,"onTransitionEnd");No("onMouseEnter",["mouseout","mouseover"]);No("onMouseLeave",["mouseout","mouseover"]);No("onPointerEnter",["pointerout","pointerover"]);No("onPointerLeave",["pointerout","pointerover"]);Oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Oa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zl));function m_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,t5(r,e,void 0,t),t.currentTarget=null}function n2(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;m_(s,l,u),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;m_(s,l,u),i=c}}}if(gh)throw t=Hg,gh=!1,Hg=null,t}function We(t,e){var n=e[e0];n===void 0&&(n=e[e0]=new Set);var r=t+"__bubble";n.has(r)||(r2(e,t,2,!1),n.add(r))}function Tp(t,e,n){var r=0;e&&(r|=4),r2(n,t,r,e)}var md="_reactListening"+Math.random().toString(36).slice(2);function Rc(t){if(!t[md]){t[md]=!0,uk.forEach(function(n){n!=="selectionchange"&&(rP.has(n)||Tp(n,!1,t),Tp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[md]||(e[md]=!0,Tp("selectionchange",!1,e))}}function r2(t,e,n,r){switch(Bk(e)){case 1:var s=x5;break;case 4:s=y5;break;default:s=qx}n=s.bind(null,e,n,t),s=void 0,!Vg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Ip(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ca(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Tk(function(){var u=i,h=Ux(n),f=[];e:{var p=t2.get(t);if(p!==void 0){var x=Qx,v=t;switch(t){case"keypress":if(Hd(n)===0)break e;case"keydown":case"keyup":x=P5;break;case"focusin":v="focus",x=wp;break;case"focusout":v="blur",x=wp;break;case"beforeblur":case"afterblur":x=wp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=n_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=_5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=L5;break;case Yk:case Jk:case Zk:x=E5;break;case e2:x=O5;break;case"scroll":x=v5;break;case"wheel":x=B5;break;case"copy":case"cut":case"paste":x=T5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=s_}var _=(e&4)!==0,S=!_&&t==="scroll",E=_?p!==null?p+"Capture":null:p;_=[];for(var w=u,b;w!==null;){b=w;var I=b.stateNode;if(b.tag===5&&I!==null&&(b=I,E!==null&&(I=Sc(w,E),I!=null&&_.push(jc(w,I,b)))),S)break;w=w.return}0<_.length&&(p=new x(p,v,null,n,h),f.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",p&&n!==zg&&(v=n.relatedTarget||n.fromElement)&&(ca(v)||v[Fs]))break e;if((x||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,x?(v=n.relatedTarget||n.toElement,x=u,v=v?ca(v):null,v!==null&&(S=$a(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(x=null,v=u),x!==v)){if(_=n_,I="onMouseLeave",E="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(_=s_,I="onPointerLeave",E="onPointerEnter",w="pointer"),S=x==null?p:fo(x),b=v==null?p:fo(v),p=new _(I,w+"leave",x,n,h),p.target=S,p.relatedTarget=b,I=null,ca(h)===u&&(_=new _(E,w+"enter",v,n,h),_.target=b,_.relatedTarget=S,I=_),S=I,x&&v)t:{for(_=x,E=v,w=0,b=_;b;b=Za(b))w++;for(b=0,I=E;I;I=Za(I))b++;for(;0<w-b;)_=Za(_),w--;for(;0<b-w;)E=Za(E),b--;for(;w--;){if(_===E||E!==null&&_===E.alternate)break t;_=Za(_),E=Za(E)}_=null}else _=null;x!==null&&p_(f,p,x,_,!1),v!==null&&S!==null&&p_(f,S,v,_,!0)}}e:{if(p=u?fo(u):window,x=p.nodeName&&p.nodeName.toLowerCase(),x==="select"||x==="input"&&p.type==="file")var F=G5;else if(o_(p))if(qk)F=Y5;else{F=K5;var D=Q5}else(x=p.nodeName)&&x.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(F=X5);if(F&&(F=F(t,u))){Wk(f,F,n,h);break e}D&&D(t,p,u),t==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&Lg(p,"number",p.value)}switch(D=u?fo(u):window,t){case"focusin":(o_(D)||D.contentEditable==="true")&&(uo=D,Qg=u,uc=null);break;case"focusout":uc=Qg=uo=null;break;case"mousedown":Kg=!0;break;case"contextmenu":case"mouseup":case"dragend":Kg=!1,h_(f,n,h);break;case"selectionchange":if(eP)break;case"keydown":case"keyup":h_(f,n,h)}var C;if(Xx)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else co?Vk(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(Uk&&n.locale!=="ko"&&(co||k!=="onCompositionStart"?k==="onCompositionEnd"&&co&&(C=zk()):(gi=h,Gx="value"in gi?gi.value:gi.textContent,co=!0)),D=_h(u,k),0<D.length&&(k=new r_(k,t,null,n,h),f.push({event:k,listeners:D}),C?k.data=C:(C=Hk(n),C!==null&&(k.data=C)))),(C=U5?V5(t,n):H5(t,n))&&(u=_h(u,"onBeforeInput"),0<u.length&&(h=new r_("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=C))}n2(f,e)})}function jc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _h(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Sc(t,n),i!=null&&r.unshift(jc(t,i,s)),i=Sc(t,e),i!=null&&r.push(jc(t,i,s))),t=t.return}return r}function Za(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function p_(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Sc(n,i),c!=null&&a.unshift(jc(n,c,l))):s||(c=Sc(n,i),c!=null&&a.push(jc(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var sP=/\r\n?/g,iP=/\u0000|\uFFFD/g;function g_(t){return(typeof t=="string"?t:""+t).replace(sP,`
`).replace(iP,"")}function pd(t,e,n){if(e=g_(e),g_(t)!==e&&n)throw Error(V(425))}function bh(){}var Xg=null,Yg=null;function Jg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zg=typeof setTimeout=="function"?setTimeout:void 0,aP=typeof clearTimeout=="function"?clearTimeout:void 0,x_=typeof Promise=="function"?Promise:void 0,oP=typeof queueMicrotask=="function"?queueMicrotask:typeof x_<"u"?function(t){return x_.resolve(null).then(t).catch(lP)}:Zg;function lP(t){setTimeout(function(){throw t})}function Cp(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Tc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Tc(e)}function Si(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function y_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Zo=Math.random().toString(36).slice(2),Qr="__reactFiber$"+Zo,Ac="__reactProps$"+Zo,Fs="__reactContainer$"+Zo,e0="__reactEvents$"+Zo,cP="__reactListeners$"+Zo,uP="__reactHandles$"+Zo;function ca(t){var e=t[Qr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fs]||n[Qr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=y_(t);t!==null;){if(n=t[Qr])return n;t=y_(t)}return e}t=n,n=t.parentNode}return null}function uu(t){return t=t[Qr]||t[Fs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function fo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function Af(t){return t[Ac]||null}var t0=[],mo=-1;function zi(t){return{current:t}}function Ge(t){0>mo||(t.current=t0[mo],t0[mo]=null,mo--)}function Ue(t,e){mo++,t0[mo]=t.current,t.current=e}var Pi={},nn=zi(Pi),kn=zi(!1),wa=Pi;function Po(t,e){var n=t.type.contextTypes;if(!n)return Pi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Tn(t){return t=t.childContextTypes,t!=null}function Sh(){Ge(kn),Ge(nn)}function v_(t,e,n){if(nn.current!==Pi)throw Error(V(168));Ue(nn,e),Ue(kn,n)}function s2(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(V(108,QN(t)||"Unknown",s));return nt({},n,r)}function Eh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Pi,wa=nn.current,Ue(nn,t),Ue(kn,kn.current),!0}function w_(t,e,n){var r=t.stateNode;if(!r)throw Error(V(169));n?(t=s2(t,e,wa),r.__reactInternalMemoizedMergedChildContext=t,Ge(kn),Ge(nn),Ue(nn,t)):Ge(kn),Ue(kn,n)}var ws=null,Nf=!1,Rp=!1;function i2(t){ws===null?ws=[t]:ws.push(t)}function dP(t){Nf=!0,i2(t)}function Ui(){if(!Rp&&ws!==null){Rp=!0;var t=0,e=De;try{var n=ws;for(De=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ws=null,Nf=!1}catch(s){throw ws!==null&&(ws=ws.slice(t+1)),jk(Vx,Ui),s}finally{De=e,Rp=!1}}return null}var po=[],go=0,kh=null,Th=0,lr=[],cr=0,_a=null,bs=1,Ss="";function ra(t,e){po[go++]=Th,po[go++]=kh,kh=t,Th=e}function a2(t,e,n){lr[cr++]=bs,lr[cr++]=Ss,lr[cr++]=_a,_a=t;var r=bs;t=Ss;var s=32-Pr(r)-1;r&=~(1<<s),n+=1;var i=32-Pr(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,bs=1<<32-Pr(e)+s|n<<s|r,Ss=i+t}else bs=1<<i|n<<s|r,Ss=t}function Jx(t){t.return!==null&&(ra(t,1),a2(t,1,0))}function Zx(t){for(;t===kh;)kh=po[--go],po[go]=null,Th=po[--go],po[go]=null;for(;t===_a;)_a=lr[--cr],lr[cr]=null,Ss=lr[--cr],lr[cr]=null,bs=lr[--cr],lr[cr]=null}var Qn=null,Hn=null,Xe=!1,Rr=null;function o2(t,e){var n=ur(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function __(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qn=t,Hn=Si(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qn=t,Hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_a!==null?{id:bs,overflow:Ss}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ur(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qn=t,Hn=null,!0):!1;default:return!1}}function n0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function r0(t){if(Xe){var e=Hn;if(e){var n=e;if(!__(t,e)){if(n0(t))throw Error(V(418));e=Si(n.nextSibling);var r=Qn;e&&__(t,e)?o2(r,n):(t.flags=t.flags&-4097|2,Xe=!1,Qn=t)}}else{if(n0(t))throw Error(V(418));t.flags=t.flags&-4097|2,Xe=!1,Qn=t}}}function b_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qn=t}function gd(t){if(t!==Qn)return!1;if(!Xe)return b_(t),Xe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jg(t.type,t.memoizedProps)),e&&(e=Hn)){if(n0(t))throw l2(),Error(V(418));for(;e;)o2(t,e),e=Si(e.nextSibling)}if(b_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Hn=Si(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Hn=null}}else Hn=Qn?Si(t.stateNode.nextSibling):null;return!0}function l2(){for(var t=Hn;t;)t=Si(t.nextSibling)}function Fo(){Hn=Qn=null,Xe=!1}function ey(t){Rr===null?Rr=[t]:Rr.push(t)}var hP=Hs.ReactCurrentBatchConfig;function Ir(t,e){if(t&&t.defaultProps){e=nt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Ih=zi(null),Ch=null,xo=null,ty=null;function ny(){ty=xo=Ch=null}function ry(t){var e=Ih.current;Ge(Ih),t._currentValue=e}function s0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function To(t,e){Ch=t,ty=xo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(En=!0),t.firstContext=null)}function hr(t){var e=t._currentValue;if(ty!==t)if(t={context:t,memoizedValue:e,next:null},xo===null){if(Ch===null)throw Error(V(308));xo=t,Ch.dependencies={lanes:0,firstContext:t}}else xo=xo.next=t;return e}var ua=null;function sy(t){ua===null?ua=[t]:ua.push(t)}function c2(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,sy(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ds(t,r)}function Ds(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var li=!1;function iy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function u2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Rs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ei(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ds(t,n)}return s=r.interleaved,s===null?(e.next=e,sy(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ds(t,n)}function Wd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hx(t,n)}}function S_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Rh(t,e,n,r){var s=t.updateQueue;li=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==a&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;a=0,h=u=c=null,l=i;do{var p=l.lane,x=l.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,_=l;switch(p=e,x=n,_.tag){case 1:if(v=_.payload,typeof v=="function"){f=v.call(x,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=_.payload,p=typeof v=="function"?v.call(x,f,p):v,p==null)break e;f=nt({},f,p);break e;case 2:li=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else x={eventTime:x,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=x,c=f):h=h.next=x,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Sa|=a,t.lanes=a,t.memoizedState=f}}function E_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(V(191,s));s.call(r)}}}var d2=new ck.Component().refs;function i0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:nt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Pf={isMounted:function(t){return(t=t._reactInternals)?$a(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=mn(),s=Ti(t),i=Rs(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ei(t,i,s),e!==null&&(Fr(e,t,s,r),Wd(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=mn(),s=Ti(t),i=Rs(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ei(t,i,s),e!==null&&(Fr(e,t,s,r),Wd(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=mn(),r=Ti(t),s=Rs(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ei(t,s,r),e!==null&&(Fr(e,t,r,n),Wd(e,t,r))}};function k_(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Cc(n,r)||!Cc(s,i):!0}function h2(t,e,n){var r=!1,s=Pi,i=e.contextType;return typeof i=="object"&&i!==null?i=hr(i):(s=Tn(e)?wa:nn.current,r=e.contextTypes,i=(r=r!=null)?Po(t,s):Pi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function T_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Pf.enqueueReplaceState(e,e.state,null)}function a0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=d2,iy(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=hr(i):(i=Tn(e)?wa:nn.current,s.context=Po(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(i0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Pf.enqueueReplaceState(s,s.state,null),Rh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Bl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;l===d2&&(l=s.refs={}),a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,t))}return t}function xd(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function I_(t){var e=t._init;return e(t._payload)}function f2(t){function e(E,w){if(t){var b=E.deletions;b===null?(E.deletions=[w],E.flags|=16):b.push(w)}}function n(E,w){if(!t)return null;for(;w!==null;)e(E,w),w=w.sibling;return null}function r(E,w){for(E=new Map;w!==null;)w.key!==null?E.set(w.key,w):E.set(w.index,w),w=w.sibling;return E}function s(E,w){return E=Ii(E,w),E.index=0,E.sibling=null,E}function i(E,w,b){return E.index=b,t?(b=E.alternate,b!==null?(b=b.index,b<w?(E.flags|=2,w):b):(E.flags|=2,w)):(E.flags|=1048576,w)}function a(E){return t&&E.alternate===null&&(E.flags|=2),E}function l(E,w,b,I){return w===null||w.tag!==6?(w=Lp(b,E.mode,I),w.return=E,w):(w=s(w,b),w.return=E,w)}function c(E,w,b,I){var F=b.type;return F===lo?h(E,w,b.props.children,I,b.key):w!==null&&(w.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===oi&&I_(F)===w.type)?(I=s(w,b.props),I.ref=Bl(E,w,b),I.return=E,I):(I=Yd(b.type,b.key,b.props,null,E.mode,I),I.ref=Bl(E,w,b),I.return=E,I)}function u(E,w,b,I){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=Mp(b,E.mode,I),w.return=E,w):(w=s(w,b.children||[]),w.return=E,w)}function h(E,w,b,I,F){return w===null||w.tag!==7?(w=ga(b,E.mode,I,F),w.return=E,w):(w=s(w,b),w.return=E,w)}function f(E,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Lp(""+w,E.mode,b),w.return=E,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ad:return b=Yd(w.type,w.key,w.props,null,E.mode,b),b.ref=Bl(E,null,w),b.return=E,b;case oo:return w=Mp(w,E.mode,b),w.return=E,w;case oi:var I=w._init;return f(E,I(w._payload),b)}if(Yl(w)||Dl(w))return w=ga(w,E.mode,b,null),w.return=E,w;xd(E,w)}return null}function p(E,w,b,I){var F=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return F!==null?null:l(E,w,""+b,I);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ad:return b.key===F?c(E,w,b,I):null;case oo:return b.key===F?u(E,w,b,I):null;case oi:return F=b._init,p(E,w,F(b._payload),I)}if(Yl(b)||Dl(b))return F!==null?null:h(E,w,b,I,null);xd(E,b)}return null}function x(E,w,b,I,F){if(typeof I=="string"&&I!==""||typeof I=="number")return E=E.get(b)||null,l(w,E,""+I,F);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case ad:return E=E.get(I.key===null?b:I.key)||null,c(w,E,I,F);case oo:return E=E.get(I.key===null?b:I.key)||null,u(w,E,I,F);case oi:var D=I._init;return x(E,w,b,D(I._payload),F)}if(Yl(I)||Dl(I))return E=E.get(b)||null,h(w,E,I,F,null);xd(w,I)}return null}function v(E,w,b,I){for(var F=null,D=null,C=w,k=w=0,j=null;C!==null&&k<b.length;k++){C.index>k?(j=C,C=null):j=C.sibling;var R=p(E,C,b[k],I);if(R===null){C===null&&(C=j);break}t&&C&&R.alternate===null&&e(E,C),w=i(R,w,k),D===null?F=R:D.sibling=R,D=R,C=j}if(k===b.length)return n(E,C),Xe&&ra(E,k),F;if(C===null){for(;k<b.length;k++)C=f(E,b[k],I),C!==null&&(w=i(C,w,k),D===null?F=C:D.sibling=C,D=C);return Xe&&ra(E,k),F}for(C=r(E,C);k<b.length;k++)j=x(C,E,k,b[k],I),j!==null&&(t&&j.alternate!==null&&C.delete(j.key===null?k:j.key),w=i(j,w,k),D===null?F=j:D.sibling=j,D=j);return t&&C.forEach(function(N){return e(E,N)}),Xe&&ra(E,k),F}function _(E,w,b,I){var F=Dl(b);if(typeof F!="function")throw Error(V(150));if(b=F.call(b),b==null)throw Error(V(151));for(var D=F=null,C=w,k=w=0,j=null,R=b.next();C!==null&&!R.done;k++,R=b.next()){C.index>k?(j=C,C=null):j=C.sibling;var N=p(E,C,R.value,I);if(N===null){C===null&&(C=j);break}t&&C&&N.alternate===null&&e(E,C),w=i(N,w,k),D===null?F=N:D.sibling=N,D=N,C=j}if(R.done)return n(E,C),Xe&&ra(E,k),F;if(C===null){for(;!R.done;k++,R=b.next())R=f(E,R.value,I),R!==null&&(w=i(R,w,k),D===null?F=R:D.sibling=R,D=R);return Xe&&ra(E,k),F}for(C=r(E,C);!R.done;k++,R=b.next())R=x(C,E,k,R.value,I),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?k:R.key),w=i(R,w,k),D===null?F=R:D.sibling=R,D=R);return t&&C.forEach(function(P){return e(E,P)}),Xe&&ra(E,k),F}function S(E,w,b,I){if(typeof b=="object"&&b!==null&&b.type===lo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ad:e:{for(var F=b.key,D=w;D!==null;){if(D.key===F){if(F=b.type,F===lo){if(D.tag===7){n(E,D.sibling),w=s(D,b.props.children),w.return=E,E=w;break e}}else if(D.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===oi&&I_(F)===D.type){n(E,D.sibling),w=s(D,b.props),w.ref=Bl(E,D,b),w.return=E,E=w;break e}n(E,D);break}else e(E,D);D=D.sibling}b.type===lo?(w=ga(b.props.children,E.mode,I,b.key),w.return=E,E=w):(I=Yd(b.type,b.key,b.props,null,E.mode,I),I.ref=Bl(E,w,b),I.return=E,E=I)}return a(E);case oo:e:{for(D=b.key;w!==null;){if(w.key===D)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(E,w.sibling),w=s(w,b.children||[]),w.return=E,E=w;break e}else{n(E,w);break}else e(E,w);w=w.sibling}w=Mp(b,E.mode,I),w.return=E,E=w}return a(E);case oi:return D=b._init,S(E,w,D(b._payload),I)}if(Yl(b))return v(E,w,b,I);if(Dl(b))return _(E,w,b,I);xd(E,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(E,w.sibling),w=s(w,b),w.return=E,E=w):(n(E,w),w=Lp(b,E.mode,I),w.return=E,E=w),a(E)):n(E,w)}return S}var Do=f2(!0),m2=f2(!1),du={},Jr=zi(du),Nc=zi(du),Pc=zi(du);function da(t){if(t===du)throw Error(V(174));return t}function ay(t,e){switch(Ue(Pc,e),Ue(Nc,t),Ue(Jr,du),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Og(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Og(e,t)}Ge(Jr),Ue(Jr,e)}function Lo(){Ge(Jr),Ge(Nc),Ge(Pc)}function p2(t){da(Pc.current);var e=da(Jr.current),n=Og(e,t.type);e!==n&&(Ue(Nc,t),Ue(Jr,n))}function oy(t){Nc.current===t&&(Ge(Jr),Ge(Nc))}var Ze=zi(0);function jh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jp=[];function ly(){for(var t=0;t<jp.length;t++)jp[t]._workInProgressVersionPrimary=null;jp.length=0}var qd=Hs.ReactCurrentDispatcher,Ap=Hs.ReactCurrentBatchConfig,ba=0,et=null,St=null,Rt=null,Ah=!1,dc=!1,Fc=0,fP=0;function Gt(){throw Error(V(321))}function cy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mr(t[n],e[n]))return!1;return!0}function uy(t,e,n,r,s,i){if(ba=i,et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qd.current=t===null||t.memoizedState===null?xP:yP,t=n(r,s),dc){i=0;do{if(dc=!1,Fc=0,25<=i)throw Error(V(301));i+=1,Rt=St=null,e.updateQueue=null,qd.current=vP,t=n(r,s)}while(dc)}if(qd.current=Nh,e=St!==null&&St.next!==null,ba=0,Rt=St=et=null,Ah=!1,e)throw Error(V(300));return t}function dy(){var t=Fc!==0;return Fc=0,t}function qr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?et.memoizedState=Rt=t:Rt=Rt.next=t,Rt}function fr(){if(St===null){var t=et.alternate;t=t!==null?t.memoizedState:null}else t=St.next;var e=Rt===null?et.memoizedState:Rt.next;if(e!==null)Rt=e,St=t;else{if(t===null)throw Error(V(310));St=t,t={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Rt===null?et.memoizedState=Rt=t:Rt=Rt.next=t}return Rt}function Dc(t,e){return typeof e=="function"?e(t):e}function Np(t){var e=fr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=St,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,u=i;do{var h=u.lane;if((ba&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,a=r):c=c.next=f,et.lanes|=h,Sa|=h}u=u.next}while(u!==null&&u!==i);c===null?a=r:c.next=l,Mr(r,e.memoizedState)||(En=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,et.lanes|=i,Sa|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Pp(t){var e=fr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Mr(i,e.memoizedState)||(En=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function g2(){}function x2(t,e){var n=et,r=fr(),s=e(),i=!Mr(r.memoizedState,s);if(i&&(r.memoizedState=s,En=!0),r=r.queue,hy(w2.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,Lc(9,v2.bind(null,n,r,s,e),void 0,null),At===null)throw Error(V(349));ba&30||y2(n,e,s)}return s}function y2(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function v2(t,e,n,r){e.value=n,e.getSnapshot=r,_2(e)&&b2(t)}function w2(t,e,n){return n(function(){_2(e)&&b2(t)})}function _2(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mr(t,n)}catch{return!0}}function b2(t){var e=Ds(t,1);e!==null&&Fr(e,t,1,-1)}function C_(t){var e=qr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dc,lastRenderedState:t},e.queue=t,t=t.dispatch=gP.bind(null,et,t),[e.memoizedState,t]}function Lc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function S2(){return fr().memoizedState}function Gd(t,e,n,r){var s=qr();et.flags|=t,s.memoizedState=Lc(1|e,n,void 0,r===void 0?null:r)}function Ff(t,e,n,r){var s=fr();r=r===void 0?null:r;var i=void 0;if(St!==null){var a=St.memoizedState;if(i=a.destroy,r!==null&&cy(r,a.deps)){s.memoizedState=Lc(e,n,i,r);return}}et.flags|=t,s.memoizedState=Lc(1|e,n,i,r)}function R_(t,e){return Gd(8390656,8,t,e)}function hy(t,e){return Ff(2048,8,t,e)}function E2(t,e){return Ff(4,2,t,e)}function k2(t,e){return Ff(4,4,t,e)}function T2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function I2(t,e,n){return n=n!=null?n.concat([t]):null,Ff(4,4,T2.bind(null,e,t),n)}function fy(){}function C2(t,e){var n=fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&cy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function R2(t,e){var n=fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&cy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function j2(t,e,n){return ba&21?(Mr(n,e)||(n=Pk(),et.lanes|=n,Sa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,En=!0),t.memoizedState=n)}function mP(t,e){var n=De;De=n!==0&&4>n?n:4,t(!0);var r=Ap.transition;Ap.transition={};try{t(!1),e()}finally{De=n,Ap.transition=r}}function A2(){return fr().memoizedState}function pP(t,e,n){var r=Ti(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},N2(t))P2(e,n);else if(n=c2(t,e,n,r),n!==null){var s=mn();Fr(n,t,r,s),F2(n,e,r)}}function gP(t,e,n){var r=Ti(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(N2(t))P2(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Mr(l,a)){var c=e.interleaved;c===null?(s.next=s,sy(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=c2(t,e,s,r),n!==null&&(s=mn(),Fr(n,t,r,s),F2(n,e,r))}}function N2(t){var e=t.alternate;return t===et||e!==null&&e===et}function P2(t,e){dc=Ah=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function F2(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hx(t,n)}}var Nh={readContext:hr,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useInsertionEffect:Gt,useLayoutEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useMutableSource:Gt,useSyncExternalStore:Gt,useId:Gt,unstable_isNewReconciler:!1},xP={readContext:hr,useCallback:function(t,e){return qr().memoizedState=[t,e===void 0?null:e],t},useContext:hr,useEffect:R_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Gd(4194308,4,T2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Gd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gd(4,2,t,e)},useMemo:function(t,e){var n=qr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=qr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=pP.bind(null,et,t),[r.memoizedState,t]},useRef:function(t){var e=qr();return t={current:t},e.memoizedState=t},useState:C_,useDebugValue:fy,useDeferredValue:function(t){return qr().memoizedState=t},useTransition:function(){var t=C_(!1),e=t[0];return t=mP.bind(null,t[1]),qr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=et,s=qr();if(Xe){if(n===void 0)throw Error(V(407));n=n()}else{if(n=e(),At===null)throw Error(V(349));ba&30||y2(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,R_(w2.bind(null,r,i,t),[t]),r.flags|=2048,Lc(9,v2.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=qr(),e=At.identifierPrefix;if(Xe){var n=Ss,r=bs;n=(r&~(1<<32-Pr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Fc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=fP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yP={readContext:hr,useCallback:C2,useContext:hr,useEffect:hy,useImperativeHandle:I2,useInsertionEffect:E2,useLayoutEffect:k2,useMemo:R2,useReducer:Np,useRef:S2,useState:function(){return Np(Dc)},useDebugValue:fy,useDeferredValue:function(t){var e=fr();return j2(e,St.memoizedState,t)},useTransition:function(){var t=Np(Dc)[0],e=fr().memoizedState;return[t,e]},useMutableSource:g2,useSyncExternalStore:x2,useId:A2,unstable_isNewReconciler:!1},vP={readContext:hr,useCallback:C2,useContext:hr,useEffect:hy,useImperativeHandle:I2,useInsertionEffect:E2,useLayoutEffect:k2,useMemo:R2,useReducer:Pp,useRef:S2,useState:function(){return Pp(Dc)},useDebugValue:fy,useDeferredValue:function(t){var e=fr();return St===null?e.memoizedState=t:j2(e,St.memoizedState,t)},useTransition:function(){var t=Pp(Dc)[0],e=fr().memoizedState;return[t,e]},useMutableSource:g2,useSyncExternalStore:x2,useId:A2,unstable_isNewReconciler:!1};function Mo(t,e){try{var n="",r=e;do n+=GN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Fp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function o0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var wP=typeof WeakMap=="function"?WeakMap:Map;function D2(t,e,n){n=Rs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Fh||(Fh=!0,x0=r),o0(t,e)},n}function L2(t,e,n){n=Rs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){o0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){o0(t,e),typeof r!="function"&&(ki===null?ki=new Set([this]):ki.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function j_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new wP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=FP.bind(null,t,e,n),e.then(t,t))}function A_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function N_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Rs(-1,1),e.tag=2,Ei(n,e,1))),n.lanes|=1),t)}var _P=Hs.ReactCurrentOwner,En=!1;function dn(t,e,n,r){e.child=t===null?m2(e,null,n,r):Do(e,t.child,n,r)}function P_(t,e,n,r,s){n=n.render;var i=e.ref;return To(e,s),r=uy(t,e,n,r,i,s),n=dy(),t!==null&&!En?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ls(t,e,s)):(Xe&&n&&Jx(e),e.flags|=1,dn(t,e,r,s),e.child)}function F_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!_y(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,M2(t,e,i,r,s)):(t=Yd(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Cc,n(a,r)&&t.ref===e.ref)return Ls(t,e,s)}return e.flags|=1,t=Ii(i,r),t.ref=e.ref,t.return=e,e.child=t}function M2(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Cc(i,r)&&t.ref===e.ref)if(En=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(En=!0);else return e.lanes=t.lanes,Ls(t,e,s)}return l0(t,e,n,r,s)}function O2(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(vo,Un),Un|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ue(vo,Un),Un|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ue(vo,Un),Un|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ue(vo,Un),Un|=r;return dn(t,e,s,n),e.child}function $2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function l0(t,e,n,r,s){var i=Tn(n)?wa:nn.current;return i=Po(e,i),To(e,s),n=uy(t,e,n,r,i,s),r=dy(),t!==null&&!En?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ls(t,e,s)):(Xe&&r&&Jx(e),e.flags|=1,dn(t,e,n,s),e.child)}function D_(t,e,n,r,s){if(Tn(n)){var i=!0;Eh(e)}else i=!1;if(To(e,s),e.stateNode===null)Qd(t,e),h2(e,n,r),a0(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=hr(u):(u=Tn(n)?wa:nn.current,u=Po(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&T_(e,a,r,u),li=!1;var p=e.memoizedState;a.state=p,Rh(e,r,a,s),c=e.memoizedState,l!==r||p!==c||kn.current||li?(typeof h=="function"&&(i0(e,n,h,r),c=e.memoizedState),(l=li||k_(e,n,l,r,p,c,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,u2(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ir(e.type,l),a.props=u,f=e.pendingProps,p=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=hr(c):(c=Tn(n)?wa:nn.current,c=Po(e,c));var x=n.getDerivedStateFromProps;(h=typeof x=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==c)&&T_(e,a,r,c),li=!1,p=e.memoizedState,a.state=p,Rh(e,r,a,s);var v=e.memoizedState;l!==f||p!==v||kn.current||li?(typeof x=="function"&&(i0(e,n,x,r),v=e.memoizedState),(u=li||k_(e,n,u,r,p,v,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),a.props=r,a.state=v,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return c0(t,e,n,r,i,s)}function c0(t,e,n,r,s,i){$2(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&w_(e,n,!1),Ls(t,e,i);r=e.stateNode,_P.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Do(e,t.child,null,i),e.child=Do(e,null,l,i)):dn(t,e,l,i),e.memoizedState=r.state,s&&w_(e,n,!0),e.child}function B2(t){var e=t.stateNode;e.pendingContext?v_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&v_(t,e.context,!1),ay(t,e.containerInfo)}function L_(t,e,n,r,s){return Fo(),ey(s),e.flags|=256,dn(t,e,n,r),e.child}var u0={dehydrated:null,treeContext:null,retryLane:0};function d0(t){return{baseLanes:t,cachePool:null,transitions:null}}function z2(t,e,n){var r=e.pendingProps,s=Ze.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ue(Ze,s&1),t===null)return r0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Mf(a,r,0,null),t=ga(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=d0(n),e.memoizedState=u0,t):my(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return bP(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ii(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ii(l,i):(i=ga(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?d0(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=u0,r}return i=t.child,t=i.sibling,r=Ii(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function my(t,e){return e=Mf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function yd(t,e,n,r){return r!==null&&ey(r),Do(e,t.child,null,n),t=my(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bP(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Fp(Error(V(422))),yd(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Mf({mode:"visible",children:r.children},s,0,null),i=ga(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Do(e,t.child,null,a),e.child.memoizedState=d0(a),e.memoizedState=u0,i);if(!(e.mode&1))return yd(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(V(419)),r=Fp(i,r,void 0),yd(t,e,a,r)}if(l=(a&t.childLanes)!==0,En||l){if(r=At,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ds(t,s),Fr(r,t,s,-1))}return wy(),r=Fp(Error(V(421))),yd(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=DP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Hn=Si(s.nextSibling),Qn=e,Xe=!0,Rr=null,t!==null&&(lr[cr++]=bs,lr[cr++]=Ss,lr[cr++]=_a,bs=t.id,Ss=t.overflow,_a=e),e=my(e,r.children),e.flags|=4096,e)}function M_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),s0(t.return,e,n)}function Dp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function U2(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(dn(t,e,r.children,n),r=Ze.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&M_(t,n,e);else if(t.tag===19)M_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ue(Ze,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&jh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Dp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&jh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Dp(e,!0,n,null,i);break;case"together":Dp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ls(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Sa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,n=Ii(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ii(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function SP(t,e,n){switch(e.tag){case 3:B2(e),Fo();break;case 5:p2(e);break;case 1:Tn(e.type)&&Eh(e);break;case 4:ay(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ue(Ih,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ue(Ze,Ze.current&1),e.flags|=128,null):n&e.child.childLanes?z2(t,e,n):(Ue(Ze,Ze.current&1),t=Ls(t,e,n),t!==null?t.sibling:null);Ue(Ze,Ze.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return U2(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ue(Ze,Ze.current),r)break;return null;case 22:case 23:return e.lanes=0,O2(t,e,n)}return Ls(t,e,n)}var V2,h0,H2,W2;V2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};h0=function(){};H2=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,da(Jr.current);var i=null;switch(n){case"input":s=Fg(t,s),r=Fg(t,r),i=[];break;case"select":s=nt({},s,{value:void 0}),r=nt({},r,{value:void 0}),i=[];break;case"textarea":s=Mg(t,s),r=Mg(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=bh)}$g(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(_c.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(_c.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&We("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};W2=function(t,e,n,r){n!==r&&(e.flags|=4)};function zl(t,e){if(!Xe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function EP(t,e,n){var r=e.pendingProps;switch(Zx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return Tn(e.type)&&Sh(),Qt(e),null;case 3:return r=e.stateNode,Lo(),Ge(kn),Ge(nn),ly(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(gd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rr!==null&&(w0(Rr),Rr=null))),h0(t,e),Qt(e),null;case 5:oy(e);var s=da(Pc.current);if(n=e.type,t!==null&&e.stateNode!=null)H2(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(V(166));return Qt(e),null}if(t=da(Jr.current),gd(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Qr]=e,r[Ac]=i,t=(e.mode&1)!==0,n){case"dialog":We("cancel",r),We("close",r);break;case"iframe":case"object":case"embed":We("load",r);break;case"video":case"audio":for(s=0;s<Zl.length;s++)We(Zl[s],r);break;case"source":We("error",r);break;case"img":case"image":case"link":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"input":q1(r,i),We("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},We("invalid",r);break;case"textarea":Q1(r,i),We("invalid",r)}$g(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&pd(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&pd(r.textContent,l,t),s=["children",""+l]):_c.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&We("scroll",r)}switch(n){case"input":od(r),G1(r,i,!0);break;case"textarea":od(r),K1(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=bh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Qr]=e,t[Ac]=r,V2(t,e,!1,!1),e.stateNode=t;e:{switch(a=Bg(n,r),n){case"dialog":We("cancel",t),We("close",t),s=r;break;case"iframe":case"object":case"embed":We("load",t),s=r;break;case"video":case"audio":for(s=0;s<Zl.length;s++)We(Zl[s],t);s=r;break;case"source":We("error",t),s=r;break;case"img":case"image":case"link":We("error",t),We("load",t),s=r;break;case"details":We("toggle",t),s=r;break;case"input":q1(t,r),s=Fg(t,r),We("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=nt({},r,{value:void 0}),We("invalid",t);break;case"textarea":Q1(t,r),s=Mg(t,r),We("invalid",t);break;default:s=r}$g(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?_k(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&vk(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&bc(t,c):typeof c=="number"&&bc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(_c.hasOwnProperty(i)?c!=null&&i==="onScroll"&&We("scroll",t):c!=null&&Ox(t,i,c,a))}switch(n){case"input":od(t),G1(t,r,!1);break;case"textarea":od(t),K1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ni(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?bo(t,!!r.multiple,i,!1):r.defaultValue!=null&&bo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=bh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(t&&e.stateNode!=null)W2(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(V(166));if(n=da(Pc.current),da(Jr.current),gd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Qr]=e,(i=r.nodeValue!==n)&&(t=Qn,t!==null))switch(t.tag){case 3:pd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&pd(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qr]=e,e.stateNode=r}return Qt(e),null;case 13:if(Ge(Ze),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Xe&&Hn!==null&&e.mode&1&&!(e.flags&128))l2(),Fo(),e.flags|=98560,i=!1;else if(i=gd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(V(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(V(317));i[Qr]=e}else Fo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),i=!1}else Rr!==null&&(w0(Rr),Rr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ze.current&1?Et===0&&(Et=3):wy())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return Lo(),h0(t,e),t===null&&Rc(e.stateNode.containerInfo),Qt(e),null;case 10:return ry(e.type._context),Qt(e),null;case 17:return Tn(e.type)&&Sh(),Qt(e),null;case 19:if(Ge(Ze),i=e.memoizedState,i===null)return Qt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)zl(i,!1);else{if(Et!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=jh(t),a!==null){for(e.flags|=128,zl(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ue(Ze,Ze.current&1|2),e.child}t=t.sibling}i.tail!==null&&ht()>Oo&&(e.flags|=128,r=!0,zl(i,!1),e.lanes=4194304)}else{if(!r)if(t=jh(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),zl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Xe)return Qt(e),null}else 2*ht()-i.renderingStartTime>Oo&&n!==1073741824&&(e.flags|=128,r=!0,zl(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ht(),e.sibling=null,n=Ze.current,Ue(Ze,r?n&1|2:n&1),e):(Qt(e),null);case 22:case 23:return vy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Un&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function kP(t,e){switch(Zx(e),e.tag){case 1:return Tn(e.type)&&Sh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Lo(),Ge(kn),Ge(nn),ly(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return oy(e),null;case 13:if(Ge(Ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));Fo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ge(Ze),null;case 4:return Lo(),null;case 10:return ry(e.type._context),null;case 22:case 23:return vy(),null;case 24:return null;default:return null}}var vd=!1,Yt=!1,TP=typeof WeakSet=="function"?WeakSet:Set,Q=null;function yo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){it(t,e,r)}else n.current=null}function f0(t,e,n){try{n()}catch(r){it(t,e,r)}}var O_=!1;function IP(t,e){if(Xg=vh,t=Kk(),Yx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,f=t,p=null;t:for(;;){for(var x;f!==n||s!==0&&f.nodeType!==3||(l=a+s),f!==i||r!==0&&f.nodeType!==3||(c=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(x=f.firstChild)!==null;)p=f,f=x;for(;;){if(f===t)break t;if(p===n&&++u===s&&(l=a),p===i&&++h===r&&(c=a),(x=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=x}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yg={focusedElem:t,selectionRange:n},vh=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var _=v.memoizedProps,S=v.memoizedState,E=e.stateNode,w=E.getSnapshotBeforeUpdate(e.elementType===e.type?_:Ir(e.type,_),S);E.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(I){it(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return v=O_,O_=!1,v}function hc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&f0(e,n,i)}s=s.next}while(s!==r)}}function Df(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function m0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function q2(t){var e=t.alternate;e!==null&&(t.alternate=null,q2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qr],delete e[Ac],delete e[e0],delete e[cP],delete e[uP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function G2(t){return t.tag===5||t.tag===3||t.tag===4}function $_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||G2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function p0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bh));else if(r!==4&&(t=t.child,t!==null))for(p0(t,e,n),t=t.sibling;t!==null;)p0(t,e,n),t=t.sibling}function g0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(g0(t,e,n),t=t.sibling;t!==null;)g0(t,e,n),t=t.sibling}var Dt=null,Cr=!1;function si(t,e,n){for(n=n.child;n!==null;)Q2(t,e,n),n=n.sibling}function Q2(t,e,n){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(If,n)}catch{}switch(n.tag){case 5:Yt||yo(n,e);case 6:var r=Dt,s=Cr;Dt=null,si(t,e,n),Dt=r,Cr=s,Dt!==null&&(Cr?(t=Dt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(Cr?(t=Dt,n=n.stateNode,t.nodeType===8?Cp(t.parentNode,n):t.nodeType===1&&Cp(t,n),Tc(t)):Cp(Dt,n.stateNode));break;case 4:r=Dt,s=Cr,Dt=n.stateNode.containerInfo,Cr=!0,si(t,e,n),Dt=r,Cr=s;break;case 0:case 11:case 14:case 15:if(!Yt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&f0(n,e,a),s=s.next}while(s!==r)}si(t,e,n);break;case 1:if(!Yt&&(yo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){it(n,e,l)}si(t,e,n);break;case 21:si(t,e,n);break;case 22:n.mode&1?(Yt=(r=Yt)||n.memoizedState!==null,si(t,e,n),Yt=r):si(t,e,n);break;default:si(t,e,n)}}function B_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new TP),e.forEach(function(r){var s=LP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function kr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Dt=l.stateNode,Cr=!1;break e;case 3:Dt=l.stateNode.containerInfo,Cr=!0;break e;case 4:Dt=l.stateNode.containerInfo,Cr=!0;break e}l=l.return}if(Dt===null)throw Error(V(160));Q2(i,a,s),Dt=null,Cr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){it(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)K2(e,t),e=e.sibling}function K2(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(kr(e,t),zr(t),r&4){try{hc(3,t,t.return),Df(3,t)}catch(_){it(t,t.return,_)}try{hc(5,t,t.return)}catch(_){it(t,t.return,_)}}break;case 1:kr(e,t),zr(t),r&512&&n!==null&&yo(n,n.return);break;case 5:if(kr(e,t),zr(t),r&512&&n!==null&&yo(n,n.return),t.flags&32){var s=t.stateNode;try{bc(s,"")}catch(_){it(t,t.return,_)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&gk(s,i),Bg(l,a);var u=Bg(l,i);for(a=0;a<c.length;a+=2){var h=c[a],f=c[a+1];h==="style"?_k(s,f):h==="dangerouslySetInnerHTML"?vk(s,f):h==="children"?bc(s,f):Ox(s,h,f,u)}switch(l){case"input":Dg(s,i);break;case"textarea":xk(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?bo(s,!!i.multiple,x,!1):p!==!!i.multiple&&(i.defaultValue!=null?bo(s,!!i.multiple,i.defaultValue,!0):bo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ac]=i}catch(_){it(t,t.return,_)}}break;case 6:if(kr(e,t),zr(t),r&4){if(t.stateNode===null)throw Error(V(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(_){it(t,t.return,_)}}break;case 3:if(kr(e,t),zr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Tc(e.containerInfo)}catch(_){it(t,t.return,_)}break;case 4:kr(e,t),zr(t);break;case 13:kr(e,t),zr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(xy=ht())),r&4&&B_(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Yt=(u=Yt)||h,kr(e,t),Yt=u):kr(e,t),zr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(Q=t,h=t.child;h!==null;){for(f=Q=h;Q!==null;){switch(p=Q,x=p.child,p.tag){case 0:case 11:case 14:case 15:hc(4,p,p.return);break;case 1:yo(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(_){it(r,n,_)}}break;case 5:yo(p,p.return);break;case 22:if(p.memoizedState!==null){U_(f);continue}}x!==null?(x.return=p,Q=x):U_(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=wk("display",a))}catch(_){it(t,t.return,_)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(_){it(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:kr(e,t),zr(t),r&4&&B_(t);break;case 21:break;default:kr(e,t),zr(t)}}function zr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(G2(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(bc(s,""),r.flags&=-33);var i=$_(t);g0(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=$_(t);p0(t,l,a);break;default:throw Error(V(161))}}catch(c){it(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function CP(t,e,n){Q=t,X2(t)}function X2(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||vd;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Yt;l=vd;var u=Yt;if(vd=a,(Yt=c)&&!u)for(Q=s;Q!==null;)a=Q,c=a.child,a.tag===22&&a.memoizedState!==null?V_(s):c!==null?(c.return=a,Q=c):V_(s);for(;i!==null;)Q=i,X2(i),i=i.sibling;Q=s,vd=l,Yt=u}z_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):z_(t)}}function z_(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yt||Df(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Yt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ir(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&E_(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}E_(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Tc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}Yt||e.flags&512&&m0(e)}catch(p){it(e,e.return,p)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function U_(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function V_(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Df(4,e)}catch(c){it(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){it(e,s,c)}}var i=e.return;try{m0(e)}catch(c){it(e,i,c)}break;case 5:var a=e.return;try{m0(e)}catch(c){it(e,a,c)}}}catch(c){it(e,e.return,c)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var RP=Math.ceil,Ph=Hs.ReactCurrentDispatcher,py=Hs.ReactCurrentOwner,dr=Hs.ReactCurrentBatchConfig,Re=0,At=null,vt=null,$t=0,Un=0,vo=zi(0),Et=0,Mc=null,Sa=0,Lf=0,gy=0,fc=null,bn=null,xy=0,Oo=1/0,ys=null,Fh=!1,x0=null,ki=null,wd=!1,xi=null,Dh=0,mc=0,y0=null,Kd=-1,Xd=0;function mn(){return Re&6?ht():Kd!==-1?Kd:Kd=ht()}function Ti(t){return t.mode&1?Re&2&&$t!==0?$t&-$t:hP.transition!==null?(Xd===0&&(Xd=Pk()),Xd):(t=De,t!==0||(t=window.event,t=t===void 0?16:Bk(t.type)),t):1}function Fr(t,e,n,r){if(50<mc)throw mc=0,y0=null,Error(V(185));lu(t,n,r),(!(Re&2)||t!==At)&&(t===At&&(!(Re&2)&&(Lf|=n),Et===4&&ui(t,$t)),In(t,r),n===1&&Re===0&&!(e.mode&1)&&(Oo=ht()+500,Nf&&Ui()))}function In(t,e){var n=t.callbackNode;h5(t,e);var r=yh(t,t===At?$t:0);if(r===0)n!==null&&J1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&J1(n),e===1)t.tag===0?dP(H_.bind(null,t)):i2(H_.bind(null,t)),oP(function(){!(Re&6)&&Ui()}),n=null;else{switch(Fk(r)){case 1:n=Vx;break;case 4:n=Ak;break;case 16:n=xh;break;case 536870912:n=Nk;break;default:n=xh}n=sT(n,Y2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Y2(t,e){if(Kd=-1,Xd=0,Re&6)throw Error(V(327));var n=t.callbackNode;if(Io()&&t.callbackNode!==n)return null;var r=yh(t,t===At?$t:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Lh(t,r);else{e=r;var s=Re;Re|=2;var i=Z2();(At!==t||$t!==e)&&(ys=null,Oo=ht()+500,pa(t,e));do try{NP();break}catch(l){J2(t,l)}while(1);ny(),Ph.current=i,Re=s,vt!==null?e=0:(At=null,$t=0,e=Et)}if(e!==0){if(e===2&&(s=Wg(t),s!==0&&(r=s,e=v0(t,s))),e===1)throw n=Mc,pa(t,0),ui(t,r),In(t,ht()),n;if(e===6)ui(t,r);else{if(s=t.current.alternate,!(r&30)&&!jP(s)&&(e=Lh(t,r),e===2&&(i=Wg(t),i!==0&&(r=i,e=v0(t,i))),e===1))throw n=Mc,pa(t,0),ui(t,r),In(t,ht()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(V(345));case 2:sa(t,bn,ys);break;case 3:if(ui(t,r),(r&130023424)===r&&(e=xy+500-ht(),10<e)){if(yh(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){mn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Zg(sa.bind(null,t,bn,ys),e);break}sa(t,bn,ys);break;case 4:if(ui(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Pr(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*RP(r/1960))-r,10<r){t.timeoutHandle=Zg(sa.bind(null,t,bn,ys),r);break}sa(t,bn,ys);break;case 5:sa(t,bn,ys);break;default:throw Error(V(329))}}}return In(t,ht()),t.callbackNode===n?Y2.bind(null,t):null}function v0(t,e){var n=fc;return t.current.memoizedState.isDehydrated&&(pa(t,e).flags|=256),t=Lh(t,e),t!==2&&(e=bn,bn=n,e!==null&&w0(e)),t}function w0(t){bn===null?bn=t:bn.push.apply(bn,t)}function jP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Mr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ui(t,e){for(e&=~gy,e&=~Lf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pr(e),r=1<<n;t[n]=-1,e&=~r}}function H_(t){if(Re&6)throw Error(V(327));Io();var e=yh(t,0);if(!(e&1))return In(t,ht()),null;var n=Lh(t,e);if(t.tag!==0&&n===2){var r=Wg(t);r!==0&&(e=r,n=v0(t,r))}if(n===1)throw n=Mc,pa(t,0),ui(t,e),In(t,ht()),n;if(n===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,sa(t,bn,ys),In(t,ht()),null}function yy(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(Oo=ht()+500,Nf&&Ui())}}function Ea(t){xi!==null&&xi.tag===0&&!(Re&6)&&Io();var e=Re;Re|=1;var n=dr.transition,r=De;try{if(dr.transition=null,De=1,t)return t()}finally{De=r,dr.transition=n,Re=e,!(Re&6)&&Ui()}}function vy(){Un=vo.current,Ge(vo)}function pa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,aP(n)),vt!==null)for(n=vt.return;n!==null;){var r=n;switch(Zx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sh();break;case 3:Lo(),Ge(kn),Ge(nn),ly();break;case 5:oy(r);break;case 4:Lo();break;case 13:Ge(Ze);break;case 19:Ge(Ze);break;case 10:ry(r.type._context);break;case 22:case 23:vy()}n=n.return}if(At=t,vt=t=Ii(t.current,null),$t=Un=e,Et=0,Mc=null,gy=Lf=Sa=0,bn=fc=null,ua!==null){for(e=0;e<ua.length;e++)if(n=ua[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ua=null}return t}function J2(t,e){do{var n=vt;try{if(ny(),qd.current=Nh,Ah){for(var r=et.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ah=!1}if(ba=0,Rt=St=et=null,dc=!1,Fc=0,py.current=null,n===null||n.return===null){Et=1,Mc=e,vt=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=$t,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=A_(a);if(x!==null){x.flags&=-257,N_(x,a,l,i,e),x.mode&1&&j_(i,u,e),e=x,c=u;var v=e.updateQueue;if(v===null){var _=new Set;_.add(c),e.updateQueue=_}else v.add(c);break e}else{if(!(e&1)){j_(i,u,e),wy();break e}c=Error(V(426))}}else if(Xe&&l.mode&1){var S=A_(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),N_(S,a,l,i,e),ey(Mo(c,l));break e}}i=c=Mo(c,l),Et!==4&&(Et=2),fc===null?fc=[i]:fc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=D2(i,c,e);S_(i,E);break e;case 1:l=c;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ki===null||!ki.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=L2(i,l,e);S_(i,I);break e}}i=i.return}while(i!==null)}tT(n)}catch(F){e=F,vt===n&&n!==null&&(vt=n=n.return);continue}break}while(1)}function Z2(){var t=Ph.current;return Ph.current=Nh,t===null?Nh:t}function wy(){(Et===0||Et===3||Et===2)&&(Et=4),At===null||!(Sa&268435455)&&!(Lf&268435455)||ui(At,$t)}function Lh(t,e){var n=Re;Re|=2;var r=Z2();(At!==t||$t!==e)&&(ys=null,pa(t,e));do try{AP();break}catch(s){J2(t,s)}while(1);if(ny(),Re=n,Ph.current=r,vt!==null)throw Error(V(261));return At=null,$t=0,Et}function AP(){for(;vt!==null;)eT(vt)}function NP(){for(;vt!==null&&!r5();)eT(vt)}function eT(t){var e=rT(t.alternate,t,Un);t.memoizedProps=t.pendingProps,e===null?tT(t):vt=e,py.current=null}function tT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=kP(n,e),n!==null){n.flags&=32767,vt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Et=6,vt=null;return}}else if(n=EP(n,e,Un),n!==null){vt=n;return}if(e=e.sibling,e!==null){vt=e;return}vt=e=t}while(e!==null);Et===0&&(Et=5)}function sa(t,e,n){var r=De,s=dr.transition;try{dr.transition=null,De=1,PP(t,e,n,r)}finally{dr.transition=s,De=r}return null}function PP(t,e,n,r){do Io();while(xi!==null);if(Re&6)throw Error(V(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(f5(t,i),t===At&&(vt=At=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wd||(wd=!0,sT(xh,function(){return Io(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=dr.transition,dr.transition=null;var a=De;De=1;var l=Re;Re|=4,py.current=null,IP(t,n),K2(n,t),Z5(Yg),vh=!!Xg,Yg=Xg=null,t.current=n,CP(n),s5(),Re=l,De=a,dr.transition=i}else t.current=n;if(wd&&(wd=!1,xi=t,Dh=s),i=t.pendingLanes,i===0&&(ki=null),o5(n.stateNode),In(t,ht()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Fh)throw Fh=!1,t=x0,x0=null,t;return Dh&1&&t.tag!==0&&Io(),i=t.pendingLanes,i&1?t===y0?mc++:(mc=0,y0=t):mc=0,Ui(),null}function Io(){if(xi!==null){var t=Fk(Dh),e=dr.transition,n=De;try{if(dr.transition=null,De=16>t?16:t,xi===null)var r=!1;else{if(t=xi,xi=null,Dh=0,Re&6)throw Error(V(331));var s=Re;for(Re|=4,Q=t.current;Q!==null;){var i=Q,a=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Q=u;Q!==null;){var h=Q;switch(h.tag){case 0:case 11:case 15:hc(8,h,i)}var f=h.child;if(f!==null)f.return=h,Q=f;else for(;Q!==null;){h=Q;var p=h.sibling,x=h.return;if(q2(h),h===u){Q=null;break}if(p!==null){p.return=x,Q=p;break}Q=x}}}var v=i.alternate;if(v!==null){var _=v.child;if(_!==null){v.child=null;do{var S=_.sibling;_.sibling=null,_=S}while(_!==null)}}Q=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Q=a;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:hc(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,Q=E;break e}Q=i.return}}var w=t.current;for(Q=w;Q!==null;){a=Q;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,Q=b;else e:for(a=w;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Df(9,l)}}catch(F){it(l,l.return,F)}if(l===a){Q=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,Q=I;break e}Q=l.return}}if(Re=s,Ui(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(If,t)}catch{}r=!0}return r}finally{De=n,dr.transition=e}}return!1}function W_(t,e,n){e=Mo(n,e),e=D2(t,e,1),t=Ei(t,e,1),e=mn(),t!==null&&(lu(t,1,e),In(t,e))}function it(t,e,n){if(t.tag===3)W_(t,t,n);else for(;e!==null;){if(e.tag===3){W_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ki===null||!ki.has(r))){t=Mo(n,t),t=L2(e,t,1),e=Ei(e,t,1),t=mn(),e!==null&&(lu(e,1,t),In(e,t));break}}e=e.return}}function FP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=mn(),t.pingedLanes|=t.suspendedLanes&n,At===t&&($t&n)===n&&(Et===4||Et===3&&($t&130023424)===$t&&500>ht()-xy?pa(t,0):gy|=n),In(t,e)}function nT(t,e){e===0&&(t.mode&1?(e=ud,ud<<=1,!(ud&130023424)&&(ud=4194304)):e=1);var n=mn();t=Ds(t,e),t!==null&&(lu(t,e,n),In(t,n))}function DP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nT(t,n)}function LP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(e),nT(t,n)}var rT;rT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||kn.current)En=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return En=!1,SP(t,e,n);En=!!(t.flags&131072)}else En=!1,Xe&&e.flags&1048576&&a2(e,Th,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Qd(t,e),t=e.pendingProps;var s=Po(e,nn.current);To(e,n),s=uy(null,e,r,t,s,n);var i=dy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(r)?(i=!0,Eh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,iy(e),s.updater=Pf,e.stateNode=s,s._reactInternals=e,a0(e,r,t,n),e=c0(null,e,r,!0,i,n)):(e.tag=0,Xe&&i&&Jx(e),dn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Qd(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=OP(r),t=Ir(r,t),s){case 0:e=l0(null,e,r,t,n);break e;case 1:e=D_(null,e,r,t,n);break e;case 11:e=P_(null,e,r,t,n);break e;case 14:e=F_(null,e,r,Ir(r.type,t),n);break e}throw Error(V(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),l0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),D_(t,e,r,s,n);case 3:e:{if(B2(e),t===null)throw Error(V(387));r=e.pendingProps,i=e.memoizedState,s=i.element,u2(t,e),Rh(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mo(Error(V(423)),e),e=L_(t,e,r,n,s);break e}else if(r!==s){s=Mo(Error(V(424)),e),e=L_(t,e,r,n,s);break e}else for(Hn=Si(e.stateNode.containerInfo.firstChild),Qn=e,Xe=!0,Rr=null,n=m2(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fo(),r===s){e=Ls(t,e,n);break e}dn(t,e,r,n)}e=e.child}return e;case 5:return p2(e),t===null&&r0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Jg(r,s)?a=null:i!==null&&Jg(r,i)&&(e.flags|=32),$2(t,e),dn(t,e,a,n),e.child;case 6:return t===null&&r0(e),null;case 13:return z2(t,e,n);case 4:return ay(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Do(e,null,r,n):dn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),P_(t,e,r,s,n);case 7:return dn(t,e,e.pendingProps,n),e.child;case 8:return dn(t,e,e.pendingProps.children,n),e.child;case 12:return dn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ue(Ih,r._currentValue),r._currentValue=a,i!==null)if(Mr(i.value,a)){if(i.children===s.children&&!kn.current){e=Ls(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Rs(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),s0(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(V(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),s0(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}dn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,To(e,n),s=hr(s),r=r(s),e.flags|=1,dn(t,e,r,n),e.child;case 14:return r=e.type,s=Ir(r,e.pendingProps),s=Ir(r.type,s),F_(t,e,r,s,n);case 15:return M2(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),Qd(t,e),e.tag=1,Tn(r)?(t=!0,Eh(e)):t=!1,To(e,n),h2(e,r,s),a0(e,r,s,n),c0(null,e,r,!0,t,n);case 19:return U2(t,e,n);case 22:return O2(t,e,n)}throw Error(V(156,e.tag))};function sT(t,e){return jk(t,e)}function MP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(t,e,n,r){return new MP(t,e,n,r)}function _y(t){return t=t.prototype,!(!t||!t.isReactComponent)}function OP(t){if(typeof t=="function")return _y(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bx)return 11;if(t===zx)return 14}return 2}function Ii(t,e){var n=t.alternate;return n===null?(n=ur(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Yd(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")_y(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case lo:return ga(n.children,s,i,e);case $x:a=8,s|=8;break;case jg:return t=ur(12,n,e,s|2),t.elementType=jg,t.lanes=i,t;case Ag:return t=ur(13,n,e,s),t.elementType=Ag,t.lanes=i,t;case Ng:return t=ur(19,n,e,s),t.elementType=Ng,t.lanes=i,t;case fk:return Mf(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dk:a=10;break e;case hk:a=9;break e;case Bx:a=11;break e;case zx:a=14;break e;case oi:a=16,r=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=ur(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ga(t,e,n,r){return t=ur(7,t,r,e),t.lanes=n,t}function Mf(t,e,n,r){return t=ur(22,t,r,e),t.elementType=fk,t.lanes=n,t.stateNode={isHidden:!1},t}function Lp(t,e,n){return t=ur(6,t,null,e),t.lanes=n,t}function Mp(t,e,n){return e=ur(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $P(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xp(0),this.expirationTimes=xp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function by(t,e,n,r,s,i,a,l,c){return t=new $P(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ur(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},iy(i),t}function BP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:oo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function iT(t){if(!t)return Pi;t=t._reactInternals;e:{if($a(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var n=t.type;if(Tn(n))return s2(t,n,e)}return e}function aT(t,e,n,r,s,i,a,l,c){return t=by(n,r,!0,t,s,i,a,l,c),t.context=iT(null),n=t.current,r=mn(),s=Ti(n),i=Rs(r,s),i.callback=e??null,Ei(n,i,s),t.current.lanes=s,lu(t,s,r),In(t,r),t}function Of(t,e,n,r){var s=e.current,i=mn(),a=Ti(s);return n=iT(n),e.context===null?e.context=n:e.pendingContext=n,e=Rs(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ei(s,e,a),t!==null&&(Fr(t,s,a,i),Wd(t,s,a)),a}function Mh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function q_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Sy(t,e){q_(t,e),(t=t.alternate)&&q_(t,e)}function zP(){return null}var oT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ey(t){this._internalRoot=t}$f.prototype.render=Ey.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));Of(t,e,null,null)};$f.prototype.unmount=Ey.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ea(function(){Of(null,t,null,null)}),e[Fs]=null}};function $f(t){this._internalRoot=t}$f.prototype.unstable_scheduleHydration=function(t){if(t){var e=Mk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ci.length&&e!==0&&e<ci[n].priority;n++);ci.splice(n,0,t),n===0&&$k(t)}};function ky(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function G_(){}function UP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Mh(a);i.call(u)}}var a=aT(e,r,t,0,null,!1,!1,"",G_);return t._reactRootContainer=a,t[Fs]=a.current,Rc(t.nodeType===8?t.parentNode:t),Ea(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Mh(c);l.call(u)}}var c=by(t,0,!1,null,null,!1,!1,"",G_);return t._reactRootContainer=c,t[Fs]=c.current,Rc(t.nodeType===8?t.parentNode:t),Ea(function(){Of(e,c,n,r)}),c}function zf(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Mh(a);l.call(c)}}Of(e,a,t,s)}else a=UP(n,e,t,s,r);return Mh(a)}Dk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Jl(e.pendingLanes);n!==0&&(Hx(e,n|1),In(e,ht()),!(Re&6)&&(Oo=ht()+500,Ui()))}break;case 13:Ea(function(){var r=Ds(t,1);if(r!==null){var s=mn();Fr(r,t,1,s)}}),Sy(t,1)}};Wx=function(t){if(t.tag===13){var e=Ds(t,134217728);if(e!==null){var n=mn();Fr(e,t,134217728,n)}Sy(t,134217728)}};Lk=function(t){if(t.tag===13){var e=Ti(t),n=Ds(t,e);if(n!==null){var r=mn();Fr(n,t,e,r)}Sy(t,e)}};Mk=function(){return De};Ok=function(t,e){var n=De;try{return De=t,e()}finally{De=n}};Ug=function(t,e,n){switch(e){case"input":if(Dg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Af(r);if(!s)throw Error(V(90));pk(r),Dg(r,s)}}}break;case"textarea":xk(t,n);break;case"select":e=n.value,e!=null&&bo(t,!!n.multiple,e,!1)}};Ek=yy;kk=Ea;var VP={usingClientEntryPoint:!1,Events:[uu,fo,Af,bk,Sk,yy]},Ul={findFiberByHostInstance:ca,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},HP={bundleType:Ul.bundleType,version:Ul.version,rendererPackageName:Ul.rendererPackageName,rendererConfig:Ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ck(t),t===null?null:t.stateNode},findFiberByHostInstance:Ul.findFiberByHostInstance||zP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_d.isDisabled&&_d.supportsFiber)try{If=_d.inject(HP),Yr=_d}catch{}}er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VP;er.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ky(e))throw Error(V(200));return BP(t,e,null,n)};er.createRoot=function(t,e){if(!ky(t))throw Error(V(299));var n=!1,r="",s=oT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=by(t,1,!1,null,null,n,!1,r,s),t[Fs]=e.current,Rc(t.nodeType===8?t.parentNode:t),new Ey(e)};er.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=Ck(e),t=t===null?null:t.stateNode,t};er.flushSync=function(t){return Ea(t)};er.hydrate=function(t,e,n){if(!Bf(e))throw Error(V(200));return zf(null,t,e,!0,n)};er.hydrateRoot=function(t,e,n){if(!ky(t))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=oT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=aT(e,null,t,1,n??null,s,!1,i,a),t[Fs]=e.current,Rc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new $f(e)};er.render=function(t,e,n){if(!Bf(e))throw Error(V(200));return zf(null,t,e,!1,n)};er.unmountComponentAtNode=function(t){if(!Bf(t))throw Error(V(40));return t._reactRootContainer?(Ea(function(){zf(null,null,t,!1,function(){t._reactRootContainer=null,t[Fs]=null})}),!0):!1};er.unstable_batchedUpdates=yy;er.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Bf(n))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return zf(t,e,n,!1,r)};er.version="18.2.0-next-9e3b772b8-20220608";function lT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lT)}catch(t){console.error(t)}}lT(),ak.exports=er;var el=ak.exports,Q_=el;Cg.createRoot=Q_.createRoot,Cg.hydrateRoot=Q_.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oc(){return Oc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Oc.apply(this,arguments)}var yi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(yi||(yi={}));const K_="popstate";function WP(t){t===void 0&&(t={});function e(s,i){let{pathname:a="/",search:l="",hash:c=""}=Ba(s.location.hash.substr(1));return _0("",{pathname:a,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let a=s.document.querySelector("base"),l="";if(a&&a.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:Oh(i))}function r(s,i){Uf(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return GP(e,n,r,t)}function mt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Uf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qP(){return Math.random().toString(36).substr(2,8)}function X_(t,e){return{usr:t.state,key:t.key,idx:e}}function _0(t,e,n,r){return n===void 0&&(n=null),Oc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ba(e):e,{state:n,key:e&&e.key||r||qP()})}function Oh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ba(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function GP(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l=yi.Pop,c=null,u=h();u==null&&(u=0,a.replaceState(Oc({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function f(){l=yi.Pop;let S=h(),E=S==null?null:S-u;u=S,c&&c({action:l,location:_.location,delta:E})}function p(S,E){l=yi.Push;let w=_0(_.location,S,E);n&&n(w,S),u=h()+1;let b=X_(w,u),I=_.createHref(w);try{a.pushState(b,"",I)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(I)}i&&c&&c({action:l,location:_.location,delta:1})}function x(S,E){l=yi.Replace;let w=_0(_.location,S,E);n&&n(w,S),u=h();let b=X_(w,u),I=_.createHref(w);a.replaceState(b,"",I),i&&c&&c({action:l,location:_.location,delta:0})}function v(S){let E=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof S=="string"?S:Oh(S);return mt(E,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,E)}let _={get action(){return l},get location(){return t(s,a)},listen(S){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(K_,f),c=S,()=>{s.removeEventListener(K_,f),c=null}},createHref(S){return e(s,S)},createURL:v,encodeLocation(S){let E=v(S);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:p,replace:x,go(S){return a.go(S)}};return _}var Y_;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Y_||(Y_={}));function QP(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Ba(e):e,s=Ty(r.pathname||"/",n);if(s==null)return null;let i=cT(t);KP(i);let a=null;for(let l=0;a==null&&l<i.length;++l)a=s4(i[l],o4(s));return a}function cT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,a,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(mt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ci([r,c.relativePath]),h=n.concat(c);i.children&&i.children.length>0&&(mt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),cT(i.children,e,h,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:n4(u,i.index),routesMeta:h})};return t.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let c of uT(i.path))s(i,a,c)}),e}function uT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=uT(r.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function KP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:r4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const XP=/^:\w+$/,YP=3,JP=2,ZP=1,e4=10,t4=-2,J_=t=>t==="*";function n4(t,e){let n=t.split("/"),r=n.length;return n.some(J_)&&(r+=t4),e&&(r+=JP),n.filter(s=>!J_(s)).reduce((s,i)=>s+(XP.test(i)?YP:i===""?ZP:e4),r)}function r4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function s4(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",h=i4({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!h)return null;Object.assign(r,h.params);let f=l.route;i.push({params:r,pathname:Ci([s,h.pathname]),pathnameBase:d4(Ci([s,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(s=Ci([s,h.pathnameBase]))}return i}function i4(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=a4(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,h,f)=>{if(h==="*"){let p=l[f]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}return u[h]=l4(l[f]||"",h),u},{}),pathname:i,pathnameBase:a,pattern:t}}function a4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Uf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function o4(t){try{return decodeURI(t)}catch(e){return Uf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function l4(t,e){try{return decodeURIComponent(t)}catch(n){return Uf(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Ty(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function c4(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ba(t):t;return{pathname:n?n.startsWith("/")?n:u4(n,e):e,search:h4(r),hash:f4(s)}}function u4(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Op(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Iy(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Cy(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ba(t):(s=Oc({},t),mt(!s.pathname||!s.pathname.includes("?"),Op("?","pathname","search",s)),mt(!s.pathname||!s.pathname.includes("#"),Op("#","pathname","hash",s)),mt(!s.search||!s.search.includes("#"),Op("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,l;if(r||a==null)l=n;else{let f=e.length-1;if(a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}l=f>=0?e[f]:"/"}let c=c4(s,l),u=a&&a!=="/"&&a.endsWith("/"),h=(i||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const Ci=t=>t.join("/").replace(/\/\/+/g,"/"),d4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),h4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,f4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function m4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const dT=["post","put","patch","delete"];new Set(dT);const p4=["get",...dT];new Set(p4);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $h(){return $h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$h.apply(this,arguments)}const Ry=m.createContext(null),g4=m.createContext(null),tl=m.createContext(null),Vf=m.createContext(null),us=m.createContext({outlet:null,matches:[],isDataRoute:!1}),hT=m.createContext(null);function x4(t,e){let{relative:n}=e===void 0?{}:e;nl()||mt(!1);let{basename:r,navigator:s}=m.useContext(tl),{hash:i,pathname:a,search:l}=mT(t,{relative:n}),c=a;return r!=="/"&&(c=a==="/"?r:Ci([r,a])),s.createHref({pathname:c,search:l,hash:i})}function nl(){return m.useContext(Vf)!=null}function nr(){return nl()||mt(!1),m.useContext(Vf).location}function fT(t){m.useContext(tl).static||m.useLayoutEffect(t)}function Vt(){let{isDataRoute:t}=m.useContext(us);return t?N4():y4()}function y4(){nl()||mt(!1);let t=m.useContext(Ry),{basename:e,navigator:n}=m.useContext(tl),{matches:r}=m.useContext(us),{pathname:s}=nr(),i=JSON.stringify(Iy(r).map(c=>c.pathnameBase)),a=m.useRef(!1);return fT(()=>{a.current=!0}),m.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let h=Cy(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ci([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,i,s,t])}const v4=m.createContext(null);function w4(t){let e=m.useContext(us).outlet;return e&&m.createElement(v4.Provider,{value:t},e)}function za(){let{matches:t}=m.useContext(us),e=t[t.length-1];return e?e.params:{}}function mT(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=m.useContext(us),{pathname:s}=nr(),i=JSON.stringify(Iy(r).map(a=>a.pathnameBase));return m.useMemo(()=>Cy(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function _4(t,e){return b4(t,e)}function b4(t,e,n){nl()||mt(!1);let{navigator:r}=m.useContext(tl),{matches:s}=m.useContext(us),i=s[s.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=nr(),u;if(e){var h;let _=typeof e=="string"?Ba(e):e;l==="/"||(h=_.pathname)!=null&&h.startsWith(l)||mt(!1),u=_}else u=c;let f=u.pathname||"/",p=l==="/"?f:f.slice(l.length)||"/",x=QP(t,{pathname:p}),v=I4(x&&x.map(_=>Object.assign({},_,{params:Object.assign({},a,_.params),pathname:Ci([l,r.encodeLocation?r.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?l:Ci([l,r.encodeLocation?r.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,n);return e&&v?m.createElement(Vf.Provider,{value:{location:$h({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:yi.Pop}},v):v}function S4(){let t=A4(),e=m4(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),n?m.createElement("pre",{style:s},n):null,i)}const E4=m.createElement(S4,null);class k4 extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?m.createElement(us.Provider,{value:this.props.routeContext},m.createElement(hT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function T4(t){let{routeContext:e,match:n,children:r}=t,s=m.useContext(Ry);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),m.createElement(us.Provider,{value:e},r)}function I4(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let l=i.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));l>=0||mt(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let h=c.route.id?a==null?void 0:a[c.route.id]:null,f=null;n&&(f=c.route.errorElement||E4);let p=e.concat(i.slice(0,u+1)),x=()=>{let v;return h?v=f:c.route.Component?v=m.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=l,m.createElement(T4,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:v})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?m.createElement(k4,{location:n.location,revalidation:n.revalidation,component:f,error:h,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}var b0;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(b0||(b0={}));var $c;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})($c||($c={}));function C4(t){let e=m.useContext(Ry);return e||mt(!1),e}function R4(t){let e=m.useContext(g4);return e||mt(!1),e}function j4(t){let e=m.useContext(us);return e||mt(!1),e}function pT(t){let e=j4(),n=e.matches[e.matches.length-1];return n.route.id||mt(!1),n.route.id}function A4(){var t;let e=m.useContext(hT),n=R4($c.UseRouteError),r=pT($c.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function N4(){let{router:t}=C4(b0.UseNavigateStable),e=pT($c.UseNavigateStable),n=m.useRef(!1);return fT(()=>{n.current=!0}),m.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,$h({fromRouteId:e},i)))},[t,e])}function gT(t){let{to:e,replace:n,state:r,relative:s}=t;nl()||mt(!1);let{matches:i}=m.useContext(us),{pathname:a}=nr(),l=Vt(),c=Cy(e,Iy(i).map(h=>h.pathnameBase),a,s==="path"),u=JSON.stringify(c);return m.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function Hf(t){return w4(t.context)}function Wr(t){mt(!1)}function P4(t){let{basename:e="/",children:n=null,location:r,navigationType:s=yi.Pop,navigator:i,static:a=!1}=t;nl()&&mt(!1);let l=e.replace(/^\/*/,"/"),c=m.useMemo(()=>({basename:l,navigator:i,static:a}),[l,i,a]);typeof r=="string"&&(r=Ba(r));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:x="default"}=r,v=m.useMemo(()=>{let _=Ty(u,l);return _==null?null:{location:{pathname:_,search:h,hash:f,state:p,key:x},navigationType:s}},[l,u,h,f,p,x,s]);return v==null?null:m.createElement(tl.Provider,{value:c},m.createElement(Vf.Provider,{children:n,value:v}))}function F4(t){let{children:e,location:n}=t;return _4(S0(e),n)}var Z_;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(Z_||(Z_={}));new Promise(()=>{});function S0(t,e){e===void 0&&(e=[]);let n=[];return m.Children.forEach(t,(r,s)=>{if(!m.isValidElement(r))return;let i=[...e,s];if(r.type===m.Fragment){n.push.apply(n,S0(r.props.children,i));return}r.type!==Wr&&mt(!1),!r.props.index||!r.props.children||mt(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=S0(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function E0(){return E0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},E0.apply(this,arguments)}function D4(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function L4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function M4(t,e){return t.button===0&&(!e||e==="_self")&&!L4(t)}function k0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function O4(t,e){let n=k0(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const $4=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],B4="startTransition",eb=DN[B4];function z4(t){let{basename:e,children:n,future:r,window:s}=t,i=m.useRef();i.current==null&&(i.current=WP({window:s,v5Compat:!0}));let a=i.current,[l,c]=m.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},h=m.useCallback(f=>{u&&eb?eb(()=>c(f)):c(f)},[c,u]);return m.useLayoutEffect(()=>a.listen(h),[a,h]),m.createElement(P4,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a})}const U4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",V4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ce=m.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:h}=e,f=D4(e,$4),{basename:p}=m.useContext(tl),x,v=!1;if(typeof u=="string"&&V4.test(u)&&(x=u,U4))try{let w=new URL(window.location.href),b=u.startsWith("//")?new URL(w.protocol+u):new URL(u),I=Ty(b.pathname,p);b.origin===w.origin&&I!=null?u=I+b.search+b.hash:v=!0}catch{}let _=x4(u,{relative:s}),S=H4(u,{replace:a,state:l,target:c,preventScrollReset:h,relative:s});function E(w){r&&r(w),w.defaultPrevented||S(w)}return m.createElement("a",E0({},f,{href:x||_,onClick:v||i?r:E,ref:n,target:c}))});var tb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(tb||(tb={}));var nb;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(nb||(nb={}));function H4(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:a}=e===void 0?{}:e,l=Vt(),c=nr(),u=mT(t,{relative:a});return m.useCallback(h=>{if(M4(h,n)){h.preventDefault();let f=r!==void 0?r:Oh(c)===Oh(u);l(t,{replace:f,state:s,preventScrollReset:i,relative:a})}},[c,l,u,r,s,n,t,i,a])}function xT(t){let e=m.useRef(k0(t)),n=m.useRef(!1),r=nr(),s=m.useMemo(()=>O4(r.search,n.current?null:e.current),[r.search]),i=Vt(),a=m.useCallback((l,c)=>{const u=k0(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,a]}function W4(){const[t,e]=m.useState([]),[n,r]=m.useState(),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState([]);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:a,setPlaylists:l,albums:c,setAlbums:u}}const yT=m.createContext(null);function q4({children:t}){return o.jsx(yT.Provider,{value:W4(),children:t})}function Ws(){const t=m.useContext(yT);if(!t)throw new Error("SingerProvider not provided");return t}function rb({children:t}){return o.jsx(q4,{children:t})}function Wf(){const t={container:"pt-[30px] pb-[110px] md:mt-auto md:pb-[120px] md:flex md:justify-between md:items-center",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm"};return o.jsxs("div",{className:`${t.container}`,children:[o.jsxs("p",{className:t.copyRightText,children:["Make with  ",o.jsx("span",{className:"text-red-500",children:"❤"}),"  by d4t06 ",o.jsx("br",{})," © All rights no reserve ¯\\_(ツ)_/¯"]}),o.jsxs("div",{className:"flex items-center mt-[20px] md:mt-0 space-x-[10px]",children:[o.jsx("a",{href:"mailto:datnh0708@gmail.com",children:o.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:o.jsxs("g",{children:[o.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),o.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:o.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),o.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:o.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}const G4=()=>{const[t,e]=m.useState(null),[n,r]=m.useState(!0),s=m.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:a=>{e(l=>l?{...l,...a}:null)},justRegistered:s}},vT=m.createContext(null);function ve(){const t=m.useContext(vT);if(!t)throw new Error("auth context not Provided");return t}function Q4({children:t}){return o.jsx(vT.Provider,{value:G4(),children:t})}function K4(){const[t,e]=m.useState({songs:[],playlists:[]}),[n,r]=m.useState([]),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState([]),h=m.useRef(!0),f=m.useRef(!0),p=m.useRef(!0),x=m.useRef(!0);return{uploadedSongs:n,setUploadedSongs:r,playlists:a,setPlaylists:l,favoriteSongs:s,setFavoriteSongs:i,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:h,shouldFetchUserPlaylists:p,shouldFetchFavoriteSongs:f,updateSong:_=>{const S=[...n],E=S.findIndex(w=>w.id===_.id);if(E!==-1){const w={...S[E]};Object.assign(w,_.song),S[E]=w,r(S)}},singers:c,setSingers:u,shouldFetchUserSingers:x}}const wT=m.createContext(null);function X4({children:t}){return o.jsx(wT.Provider,{value:K4(),children:t})}const Pn=()=>{const t=m.useContext(wT);if(!t)throw new Error("SongContext not provided");return t},Bh=[{name:"Red",id:"red",type:"dark",bottom_player_bg:"bg-[#3b1113]",side_bar_bg:"bg-[#391b1c]",content_text:"text-[#ca4954]",content_hover_text:"hover:text-[#ca4954]",content_border:"border-[#ca4954]",content_hover_border:"hover:border-[#ca4954]",content_bg:"bg-[#ca4954] text-[#fff]",modal_bg:"bg-[#4f171c]",content_code:"#ca4954",content_hover_bg:"hover:!bg-[#ca4954] hover:text-[#fff] ",container:"bg-[#2e0f10]",container_code:"#2e0f10",text_color:""},{name:"Black",id:"black",type:"dark",bottom_player_bg:"bg-[#181818]",side_bar_bg:"bg-[#242424]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585]  text-[#fff]",modal_bg:"bg-[#333]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff] ",container:"bg-[#1e1e1e]",container_code:"#1e1e1e",text_color:""},{name:"Deep blue",id:"deep_blue",type:"dark",bottom_player_bg:"bg-[#111f3b]",side_bar_bg:"bg-[#1b2639]",content_text:"text-[#0c9e85]",content_hover_text:"hover:text-[#0c9e85]",content_border:"border-[#0c9e85]",content_hover_border:"hover:border-[#0c9e85]",content_bg:"bg-[#0c9e85]  text-[#fff]",modal_bg:"bg-[#05473c]",content_code:"#0c9e85",content_hover_bg:"hover:!bg-[#0c9e85] hover:text-[#fff] ",container:"bg-[#0f1a2e]",container_code:"#0f1a2e",text_color:""},{name:"White",id:"white",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},{name:"Light green",id:"green_light",type:"light",bottom_player_bg:"bg-[#c0d8d8]",side_bar_bg:"bg-[#dde5e5]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#ced9d9]",container_code:"#ced9d9",text_color:""},{name:"Brown",id:"gray",type:"light",bottom_player_bg:"bg-[#dedad1]",side_bar_bg:"bg-[#d9d7d4]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-white",container_code:"#fff",text_color:""}],Y4={name:"dashboard",id:"dashboard",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#5a9e87]",content_hover_text:"hover:text-[#5a9e87]",content_border:"border-[#5a9e87]",content_hover_border:"hover:border-[#5a9e87]",content_bg:"bg-[#5a9e87] text-[#fff]",modal_bg:"bg-[#417161]",content_code:"#5a9e87",content_hover_bg:"hover:!bg-[#5a9e87] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},_T=[{name:"Tet",id:"tet",type:"light",bottom_player_bg:"bg-[#fdf6e3]",side_bar_bg:"bg-[#fdf6e3]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#f7f0de]",container_code:"#fdf6e3",text_color:"",image:"tet_theme_image.png"}];function bT(t,e){return function(){return t.apply(e,arguments)}}const{toString:J4}=Object.prototype,{getPrototypeOf:jy}=Object,qf=(t=>e=>{const n=J4.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Br=t=>(t=t.toLowerCase(),e=>qf(e)===t),Gf=t=>e=>typeof e===t,{isArray:rl}=Array,Bc=Gf("undefined");function Z4(t){return t!==null&&!Bc(t)&&t.constructor!==null&&!Bc(t.constructor)&&Kn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ST=Br("ArrayBuffer");function e3(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&ST(t.buffer),e}const t3=Gf("string"),Kn=Gf("function"),ET=Gf("number"),Qf=t=>t!==null&&typeof t=="object",n3=t=>t===!0||t===!1,Jd=t=>{if(qf(t)!=="object")return!1;const e=jy(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},r3=Br("Date"),s3=Br("File"),i3=Br("Blob"),a3=Br("FileList"),o3=t=>Qf(t)&&Kn(t.pipe),l3=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Kn(t.append)&&((e=qf(t))==="formdata"||e==="object"&&Kn(t.toString)&&t.toString()==="[object FormData]"))},c3=Br("URLSearchParams"),[u3,d3,h3,f3]=["ReadableStream","Request","Response","Headers"].map(Br),m3=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hu(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),rl(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let l;for(r=0;r<a;r++)l=i[r],e.call(null,t[l],l,t)}}function kT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const ha=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),TT=t=>!Bc(t)&&t!==ha;function T0(){const{caseless:t}=TT(this)&&this||{},e={},n=(r,s)=>{const i=t&&kT(e,s)||s;Jd(e[i])&&Jd(r)?e[i]=T0(e[i],r):Jd(r)?e[i]=T0({},r):rl(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&hu(arguments[r],n);return e}const p3=(t,e,n,{allOwnKeys:r}={})=>(hu(e,(s,i)=>{n&&Kn(s)?t[i]=bT(s,n):t[i]=s},{allOwnKeys:r}),t),g3=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),x3=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},y3=(t,e,n,r)=>{let s,i,a;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)a=s[i],(!r||r(a,t,e))&&!l[a]&&(e[a]=t[a],l[a]=!0);t=n!==!1&&jy(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},v3=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},w3=t=>{if(!t)return null;if(rl(t))return t;let e=t.length;if(!ET(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},_3=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&jy(Uint8Array)),b3=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},S3=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},E3=Br("HTMLFormElement"),k3=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),sb=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),T3=Br("RegExp"),IT=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};hu(n,(s,i)=>{let a;(a=e(s,i,t))!==!1&&(r[i]=a||s)}),Object.defineProperties(t,r)},I3=t=>{IT(t,(e,n)=>{if(Kn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Kn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},C3=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return rl(t)?r(t):r(String(t).split(e)),n},R3=()=>{},j3=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function A3(t){return!!(t&&Kn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const N3=t=>{const e=new Array(10),n=(r,s)=>{if(Qf(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=rl(r)?[]:{};return hu(r,(a,l)=>{const c=n(a,s+1);!Bc(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},P3=Br("AsyncFunction"),F3=t=>t&&(Qf(t)||Kn(t))&&Kn(t.then)&&Kn(t.catch),CT=((t,e)=>t?setImmediate:e?((n,r)=>(ha.addEventListener("message",({source:s,data:i})=>{s===ha&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),ha.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Kn(ha.postMessage)),D3=typeof queueMicrotask<"u"?queueMicrotask.bind(ha):typeof process<"u"&&process.nextTick||CT,O={isArray:rl,isArrayBuffer:ST,isBuffer:Z4,isFormData:l3,isArrayBufferView:e3,isString:t3,isNumber:ET,isBoolean:n3,isObject:Qf,isPlainObject:Jd,isReadableStream:u3,isRequest:d3,isResponse:h3,isHeaders:f3,isUndefined:Bc,isDate:r3,isFile:s3,isBlob:i3,isRegExp:T3,isFunction:Kn,isStream:o3,isURLSearchParams:c3,isTypedArray:_3,isFileList:a3,forEach:hu,merge:T0,extend:p3,trim:m3,stripBOM:g3,inherits:x3,toFlatObject:y3,kindOf:qf,kindOfTest:Br,endsWith:v3,toArray:w3,forEachEntry:b3,matchAll:S3,isHTMLForm:E3,hasOwnProperty:sb,hasOwnProp:sb,reduceDescriptors:IT,freezeMethods:I3,toObjectSet:C3,toCamelCase:k3,noop:R3,toFiniteNumber:j3,findKey:kT,global:ha,isContextDefined:TT,isSpecCompliantForm:A3,toJSONObject:N3,isAsyncFn:P3,isThenable:F3,setImmediate:CT,asap:D3};function de(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}O.inherits(de,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const RT=de.prototype,jT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{jT[t]={value:t}});Object.defineProperties(de,jT);Object.defineProperty(RT,"isAxiosError",{value:!0});de.from=(t,e,n,r,s,i)=>{const a=Object.create(RT);return O.toFlatObject(t,a,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),de.call(a,t.message,e,n,r,s),a.cause=t,a.name=t.name,i&&Object.assign(a,i),a};const L3=null;function I0(t){return O.isPlainObject(t)||O.isArray(t)}function AT(t){return O.endsWith(t,"[]")?t.slice(0,-2):t}function ib(t,e,n){return t?t.concat(e).map(function(s,i){return s=AT(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function M3(t){return O.isArray(t)&&!t.some(I0)}const O3=O.toFlatObject(O,{},null,function(e){return/^is[A-Z]/.test(e)});function Kf(t,e,n){if(!O.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=O.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,S){return!O.isUndefined(S[_])});const r=n.metaTokens,s=n.visitor||h,i=n.dots,a=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(e);if(!O.isFunction(s))throw new TypeError("visitor must be a function");function u(v){if(v===null)return"";if(O.isDate(v))return v.toISOString();if(!c&&O.isBlob(v))throw new de("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(v)||O.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function h(v,_,S){let E=v;if(v&&!S&&typeof v=="object"){if(O.endsWith(_,"{}"))_=r?_:_.slice(0,-2),v=JSON.stringify(v);else if(O.isArray(v)&&M3(v)||(O.isFileList(v)||O.endsWith(_,"[]"))&&(E=O.toArray(v)))return _=AT(_),E.forEach(function(b,I){!(O.isUndefined(b)||b===null)&&e.append(a===!0?ib([_],I,i):a===null?_:_+"[]",u(b))}),!1}return I0(v)?!0:(e.append(ib(S,_,i),u(v)),!1)}const f=[],p=Object.assign(O3,{defaultVisitor:h,convertValue:u,isVisitable:I0});function x(v,_){if(!O.isUndefined(v)){if(f.indexOf(v)!==-1)throw Error("Circular reference detected in "+_.join("."));f.push(v),O.forEach(v,function(E,w){(!(O.isUndefined(E)||E===null)&&s.call(e,E,O.isString(w)?w.trim():w,_,p))===!0&&x(E,_?_.concat(w):[w])}),f.pop()}}if(!O.isObject(t))throw new TypeError("data must be an object");return x(t),e}function ab(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Ay(t,e){this._pairs=[],t&&Kf(t,this,e)}const NT=Ay.prototype;NT.append=function(e,n){this._pairs.push([e,n])};NT.toString=function(e){const n=e?function(r){return e.call(this,r,ab)}:ab;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function $3(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function PT(t,e,n){if(!e)return t;const r=n&&n.encode||$3;O.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(e,n):i=O.isURLSearchParams(e)?e.toString():new Ay(e,n).toString(r),i){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class B3{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){O.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ob=B3,FT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},z3=typeof URLSearchParams<"u"?URLSearchParams:Ay,U3=typeof FormData<"u"?FormData:null,V3=typeof Blob<"u"?Blob:null,H3={isBrowser:!0,classes:{URLSearchParams:z3,FormData:U3,Blob:V3},protocols:["http","https","file","blob","url","data"]},Ny=typeof window<"u"&&typeof document<"u",C0=typeof navigator=="object"&&navigator||void 0,W3=Ny&&(!C0||["ReactNative","NativeScript","NS"].indexOf(C0.product)<0),q3=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),G3=Ny&&window.location.href||"http://localhost",Q3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ny,hasStandardBrowserEnv:W3,hasStandardBrowserWebWorkerEnv:q3,navigator:C0,origin:G3},Symbol.toStringTag,{value:"Module"})),Zt={...Q3,...H3};function K3(t,e){return Kf(t,new Zt.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return Zt.isNode&&O.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function X3(t){return O.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Y3(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function DT(t){function e(n,r,s,i){let a=n[i++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=i>=n.length;return a=!a&&O.isArray(s)?s.length:a,c?(O.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!l):((!s[a]||!O.isObject(s[a]))&&(s[a]=[]),e(n,r,s[a],i)&&O.isArray(s[a])&&(s[a]=Y3(s[a])),!l)}if(O.isFormData(t)&&O.isFunction(t.entries)){const n={};return O.forEachEntry(t,(r,s)=>{e(X3(r),s,n,0)}),n}return null}function J3(t,e,n){if(O.isString(t))try{return(e||JSON.parse)(t),O.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Py={transitional:FT,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=O.isObject(e);if(i&&O.isHTMLForm(e)&&(e=new FormData(e)),O.isFormData(e))return s?JSON.stringify(DT(e)):e;if(O.isArrayBuffer(e)||O.isBuffer(e)||O.isStream(e)||O.isFile(e)||O.isBlob(e)||O.isReadableStream(e))return e;if(O.isArrayBufferView(e))return e.buffer;if(O.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return K3(e,this.formSerializer).toString();if((l=O.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Kf(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),J3(e)):e}],transformResponse:[function(e){const n=this.transitional||Py.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(O.isResponse(e)||O.isReadableStream(e))return e;if(e&&O.isString(e)&&(r&&!this.responseType||s)){const a=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?de.from(l,de.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zt.classes.FormData,Blob:Zt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],t=>{Py.headers[t]={}});const Fy=Py,Z3=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),eF=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(a){s=a.indexOf(":"),n=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!n||e[n]&&Z3[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},lb=Symbol("internals");function Vl(t){return t&&String(t).trim().toLowerCase()}function Zd(t){return t===!1||t==null?t:O.isArray(t)?t.map(Zd):String(t)}function tF(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const nF=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function $p(t,e,n,r,s){if(O.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!O.isString(e)){if(O.isString(r))return e.indexOf(r)!==-1;if(O.isRegExp(r))return r.test(e)}}function rF(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function sF(t,e){const n=O.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class Xf{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const h=Vl(c);if(!h)throw new Error("header name must be a non-empty string");const f=O.findKey(s,h);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=Zd(l))}const a=(l,c)=>O.forEach(l,(u,h)=>i(u,h,c));if(O.isPlainObject(e)||e instanceof this.constructor)a(e,n);else if(O.isString(e)&&(e=e.trim())&&!nF(e))a(eF(e),n);else if(O.isHeaders(e))for(const[l,c]of e.entries())i(c,l,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=Vl(e),e){const r=O.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return tF(s);if(O.isFunction(n))return n.call(this,s,r);if(O.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Vl(e),e){const r=O.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||$p(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(a){if(a=Vl(a),a){const l=O.findKey(r,a);l&&(!n||$p(r,r[l],l,n))&&(delete r[l],s=!0)}}return O.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||$p(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return O.forEach(this,(s,i)=>{const a=O.findKey(r,i);if(a){n[a]=Zd(s),delete n[i];return}const l=e?rF(i):String(i).trim();l!==i&&delete n[i],n[l]=Zd(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return O.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&O.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[lb]=this[lb]={accessors:{}}).accessors,s=this.prototype;function i(a){const l=Vl(a);r[l]||(sF(s,a),r[l]=!0)}return O.isArray(e)?e.forEach(i):i(e),this}}Xf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(Xf.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});O.freezeMethods(Xf);const Dr=Xf;function Bp(t,e){const n=this||Fy,r=e||n,s=Dr.from(r.headers);let i=r.data;return O.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function LT(t){return!!(t&&t.__CANCEL__)}function sl(t,e,n){de.call(this,t??"canceled",de.ERR_CANCELED,e,n),this.name="CanceledError"}O.inherits(sl,de,{__CANCEL__:!0});function MT(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new de("Request failed with status code "+n.status,[de.ERR_BAD_REQUEST,de.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function iF(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function aF(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),h=r[i];a||(a=u),n[s]=c,r[s]=u;let f=i,p=0;for(;f!==s;)p+=n[f++],f=f%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-a<e)return;const x=h&&u-h;return x?Math.round(p*1e3/x):void 0}}function oF(t,e){let n=0,r=1e3/e,s,i;const a=(u,h=Date.now())=>{n=h,s=null,i&&(clearTimeout(i),i=null),t.apply(null,u)};return[(...u)=>{const h=Date.now(),f=h-n;f>=r?a(u,h):(s=u,i||(i=setTimeout(()=>{i=null,a(s)},r-f)))},()=>s&&a(s)]}const zh=(t,e,n=3)=>{let r=0;const s=aF(50,250);return oF(i=>{const a=i.loaded,l=i.lengthComputable?i.total:void 0,c=a-r,u=s(c),h=a<=l;r=a;const f={loaded:a,total:l,progress:l?a/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&h?(l-a)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(f)},n)},cb=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},ub=t=>(...e)=>O.asap(()=>t(...e)),lF=Zt.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Zt.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Zt.origin),Zt.navigator&&/(msie|trident)/i.test(Zt.navigator.userAgent)):()=>!0,cF=Zt.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const a=[t+"="+encodeURIComponent(e)];O.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),O.isString(r)&&a.push("path="+r),O.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function uF(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function dF(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function OT(t,e,n){let r=!uF(e);return t&&r||n==!1?dF(t,e):e}const db=t=>t instanceof Dr?{...t}:t;function ka(t,e){e=e||{};const n={};function r(u,h,f,p){return O.isPlainObject(u)&&O.isPlainObject(h)?O.merge.call({caseless:p},u,h):O.isPlainObject(h)?O.merge({},h):O.isArray(h)?h.slice():h}function s(u,h,f,p){if(O.isUndefined(h)){if(!O.isUndefined(u))return r(void 0,u,f,p)}else return r(u,h,f,p)}function i(u,h){if(!O.isUndefined(h))return r(void 0,h)}function a(u,h){if(O.isUndefined(h)){if(!O.isUndefined(u))return r(void 0,u)}else return r(void 0,h)}function l(u,h,f){if(f in e)return r(u,h);if(f in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,h,f)=>s(db(u),db(h),f,!0)};return O.forEach(Object.keys(Object.assign({},t,e)),function(h){const f=c[h]||s,p=f(t[h],e[h],h);O.isUndefined(p)&&f!==l||(n[h]=p)}),n}const $T=t=>{const e=ka({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:a,auth:l}=e;e.headers=a=Dr.from(a),e.url=PT(OT(e.baseURL,e.url),t.params,t.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(O.isFormData(n)){if(Zt.hasStandardBrowserEnv||Zt.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((c=a.getContentType())!==!1){const[u,...h]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];a.setContentType([u||"multipart/form-data",...h].join("; "))}}if(Zt.hasStandardBrowserEnv&&(r&&O.isFunction(r)&&(r=r(e)),r||r!==!1&&lF(e.url))){const u=s&&i&&cF.read(i);u&&a.set(s,u)}return e},hF=typeof XMLHttpRequest<"u",fF=hF&&function(t){return new Promise(function(n,r){const s=$T(t);let i=s.data;const a=Dr.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,h,f,p,x,v;function _(){x&&x(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let S=new XMLHttpRequest;S.open(s.method.toUpperCase(),s.url,!0),S.timeout=s.timeout;function E(){if(!S)return;const b=Dr.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),F={data:!l||l==="text"||l==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:b,config:t,request:S};MT(function(C){n(C),_()},function(C){r(C),_()},F),S=null}"onloadend"in S?S.onloadend=E:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(E)},S.onabort=function(){S&&(r(new de("Request aborted",de.ECONNABORTED,t,S)),S=null)},S.onerror=function(){r(new de("Network Error",de.ERR_NETWORK,t,S)),S=null},S.ontimeout=function(){let I=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const F=s.transitional||FT;s.timeoutErrorMessage&&(I=s.timeoutErrorMessage),r(new de(I,F.clarifyTimeoutError?de.ETIMEDOUT:de.ECONNABORTED,t,S)),S=null},i===void 0&&a.setContentType(null),"setRequestHeader"in S&&O.forEach(a.toJSON(),function(I,F){S.setRequestHeader(F,I)}),O.isUndefined(s.withCredentials)||(S.withCredentials=!!s.withCredentials),l&&l!=="json"&&(S.responseType=s.responseType),u&&([p,v]=zh(u,!0),S.addEventListener("progress",p)),c&&S.upload&&([f,x]=zh(c),S.upload.addEventListener("progress",f),S.upload.addEventListener("loadend",x)),(s.cancelToken||s.signal)&&(h=b=>{S&&(r(!b||b.type?new sl(null,t,S):b),S.abort(),S=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const w=iF(s.url);if(w&&Zt.protocols.indexOf(w)===-1){r(new de("Unsupported protocol "+w+":",de.ERR_BAD_REQUEST,t));return}S.send(i||null)})},mF=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const h=u instanceof Error?u:this.reason;r.abort(h instanceof de?h:new sl(h instanceof Error?h.message:h))}};let a=e&&setTimeout(()=>{a=null,i(new de(`timeout ${e} of ms exceeded`,de.ETIMEDOUT))},e);const l=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>O.asap(l),c}},pF=mF,gF=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},xF=async function*(t,e){for await(const n of yF(t))yield*gF(n,e)},yF=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},hb=(t,e,n,r)=>{const s=xF(t,e);let i=0,a,l=c=>{a||(a=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:h}=await s.next();if(u){l(),c.close();return}let f=h.byteLength;if(n){let p=i+=f;n(p)}c.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},Yf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",BT=Yf&&typeof ReadableStream=="function",vF=Yf&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),zT=(t,...e)=>{try{return!!t(...e)}catch{return!1}},wF=BT&&zT(()=>{let t=!1;const e=new Request(Zt.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),fb=64*1024,R0=BT&&zT(()=>O.isReadableStream(new Response("").body)),Uh={stream:R0&&(t=>t.body)};Yf&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Uh[e]&&(Uh[e]=O.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new de(`Response type '${e}' is not supported`,de.ERR_NOT_SUPPORT,r)})})})(new Response);const _F=async t=>{if(t==null)return 0;if(O.isBlob(t))return t.size;if(O.isSpecCompliantForm(t))return(await new Request(Zt.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(O.isArrayBufferView(t)||O.isArrayBuffer(t))return t.byteLength;if(O.isURLSearchParams(t)&&(t=t+""),O.isString(t))return(await vF(t)).byteLength},bF=async(t,e)=>{const n=O.toFiniteNumber(t.getContentLength());return n??_F(e)},SF=Yf&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:a,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:h,withCredentials:f="same-origin",fetchOptions:p}=$T(t);u=u?(u+"").toLowerCase():"text";let x=pF([s,i&&i.toAbortSignal()],a),v;const _=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let S;try{if(c&&wF&&n!=="get"&&n!=="head"&&(S=await bF(h,r))!==0){let F=new Request(e,{method:"POST",body:r,duplex:"half"}),D;if(O.isFormData(r)&&(D=F.headers.get("content-type"))&&h.setContentType(D),F.body){const[C,k]=cb(S,zh(ub(c)));r=hb(F.body,fb,C,k)}}O.isString(f)||(f=f?"include":"omit");const E="credentials"in Request.prototype;v=new Request(e,{...p,signal:x,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:E?f:void 0});let w=await fetch(v);const b=R0&&(u==="stream"||u==="response");if(R0&&(l||b&&_)){const F={};["status","statusText","headers"].forEach(j=>{F[j]=w[j]});const D=O.toFiniteNumber(w.headers.get("content-length")),[C,k]=l&&cb(D,zh(ub(l),!0))||[];w=new Response(hb(w.body,fb,C,()=>{k&&k(),_&&_()}),F)}u=u||"text";let I=await Uh[O.findKey(Uh,u)||"text"](w,t);return!b&&_&&_(),await new Promise((F,D)=>{MT(F,D,{data:I,headers:Dr.from(w.headers),status:w.status,statusText:w.statusText,config:t,request:v})})}catch(E){throw _&&_(),E&&E.name==="TypeError"&&/fetch/i.test(E.message)?Object.assign(new de("Network Error",de.ERR_NETWORK,t,v),{cause:E.cause||E}):de.from(E,E&&E.code,t,v)}}),j0={http:L3,xhr:fF,fetch:SF};O.forEach(j0,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const mb=t=>`- ${t}`,EF=t=>O.isFunction(t)||t===null||t===!1,UT={getAdapter:t=>{t=O.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let a;if(r=n,!EF(n)&&(r=j0[(a=String(n)).toLowerCase()],r===void 0))throw new de(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(mb).join(`
`):" "+mb(i[0]):"as no adapter specified";throw new de("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:j0};function zp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new sl(null,t)}function pb(t){return zp(t),t.headers=Dr.from(t.headers),t.data=Bp.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),UT.getAdapter(t.adapter||Fy.adapter)(t).then(function(r){return zp(t),r.data=Bp.call(t,t.transformResponse,r),r.headers=Dr.from(r.headers),r},function(r){return LT(r)||(zp(t),r&&r.response&&(r.response.data=Bp.call(t,t.transformResponse,r.response),r.response.headers=Dr.from(r.response.headers))),Promise.reject(r)})}const VT="1.8.1",Jf={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Jf[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const gb={};Jf.transitional=function(e,n,r){function s(i,a){return"[Axios v"+VT+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,l)=>{if(e===!1)throw new de(s(a," has been removed"+(n?" in "+n:"")),de.ERR_DEPRECATED);return n&&!gb[a]&&(gb[a]=!0,console.warn(s(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,a,l):!0}};Jf.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function kF(t,e,n){if(typeof t!="object")throw new de("options must be an object",de.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const l=t[i],c=l===void 0||a(l,i,t);if(c!==!0)throw new de("option "+i+" must be "+c,de.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new de("Unknown option "+i,de.ERR_BAD_OPTION)}}const eh={assertOptions:kF,validators:Jf},Ur=eh.validators;class Vh{constructor(e){this.defaults=e,this.interceptors={request:new ob,response:new ob}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=ka(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&eh.assertOptions(r,{silentJSONParsing:Ur.transitional(Ur.boolean),forcedJSONParsing:Ur.transitional(Ur.boolean),clarifyTimeoutError:Ur.transitional(Ur.boolean)},!1),s!=null&&(O.isFunction(s)?n.paramsSerializer={serialize:s}:eh.assertOptions(s,{encode:Ur.function,serialize:Ur.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),eh.assertOptions(n,{baseUrl:Ur.spelling("baseURL"),withXsrfToken:Ur.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=i&&O.merge(i.common,i[n.method]);i&&O.forEach(["delete","get","head","post","put","patch","common"],v=>{delete i[v]}),n.headers=Dr.concat(a,i);const l=[];let c=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(n)===!1||(c=c&&_.synchronous,l.unshift(_.fulfilled,_.rejected))});const u=[];this.interceptors.response.forEach(function(_){u.push(_.fulfilled,_.rejected)});let h,f=0,p;if(!c){const v=[pb.bind(this),void 0];for(v.unshift.apply(v,l),v.push.apply(v,u),p=v.length,h=Promise.resolve(n);f<p;)h=h.then(v[f++],v[f++]);return h}p=l.length;let x=n;for(f=0;f<p;){const v=l[f++],_=l[f++];try{x=v(x)}catch(S){_.call(this,S);break}}try{h=pb.call(this,x)}catch(v){return Promise.reject(v)}for(f=0,p=u.length;f<p;)h=h.then(u[f++],u[f++]);return h}getUri(e){e=ka(this.defaults,e);const n=OT(e.baseURL,e.url,e.allowAbsoluteUrls);return PT(n,e.params,e.paramsSerializer)}}O.forEach(["delete","get","head","options"],function(e){Vh.prototype[e]=function(n,r){return this.request(ka(r||{},{method:e,url:n,data:(r||{}).data}))}});O.forEach(["post","put","patch"],function(e){function n(r){return function(i,a,l){return this.request(ka(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}Vh.prototype[e]=n(),Vh.prototype[e+"Form"]=n(!0)});const th=Vh;class Dy{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(l=>{r.subscribe(l),i=l}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,l){r.reason||(r.reason=new sl(i,a,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Dy(function(s){e=s}),cancel:e}}}const TF=Dy;function IF(t){return function(n){return t.apply(null,n)}}function CF(t){return O.isObject(t)&&t.isAxiosError===!0}const A0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(A0).forEach(([t,e])=>{A0[e]=t});const RF=A0;function HT(t){const e=new th(t),n=bT(th.prototype.request,e);return O.extend(n,th.prototype,e,{allOwnKeys:!0}),O.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return HT(ka(t,s))},n}const _t=HT(Fy);_t.Axios=th;_t.CanceledError=sl;_t.CancelToken=TF;_t.isCancel=LT;_t.VERSION=VT;_t.toFormData=Kf;_t.AxiosError=de;_t.Cancel=_t.CanceledError;_t.all=function(e){return Promise.all(e)};_t.spread=IF;_t.isAxiosError=CF;_t.mergeConfig=ka;_t.AxiosHeaders=Dr;_t.formToJSON=t=>DT(O.isHTMLForm(t)?new FormData(t):t);_t.getAdapter=UT.getAdapter;_t.HttpStatusCode=RF;_t.default=_t;const jF=_t,WT="HD-MP3",qT=jF.create({baseURL:{}.VITE_ENDPOINT||"https://express-zingmp3-awx6.vercel.app"}),AF=(t,e)=>(e==null?void 0:e.type)==="date"?new Date(t.toDate()).toLocaleDateString():new Date(t.toDate()).toLocaleString(),fn=()=>JSON.parse(localStorage.getItem(WT)||"{}"),ot=(t,e)=>{const n=fn();return n[t]=e,localStorage.setItem(WT,JSON.stringify(n))},Ms=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},Os=async t=>new Promise(e=>setTimeout(e,t)),GT=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},zc=t=>t?"disable":"",Uc=t=>t?"hidden":"",Zf=(t,e)=>t?e:"";let nh=Bh[3];const NF=fn(),xb=NF.theme;xb&&[...Bh,..._T].forEach(t=>{t.id===xb&&(nh=t)});const PF={theme:{...nh,alpha:nh.type==="light"?"[#000]/5":"[#fff]/5",text_color:nh.type==="light"?"text-[#333]":"text-[#fff]"},isOnMobile:window.innerWidth<768,isDev:!1},FF=(t,e)=>{switch(e.type){case 0:{const n=e.payload.theme;return{...t,theme:{...n,alpha:n.type==="dark"?"[#fff]/5":"[#000]/5",text_color:n.type==="light"?"text-[#333]":"text-[#fff]"}}}}},DF=()=>{const[t,e]=m.useReducer(FF,PF),n=m.useCallback(r=>{console.log("set theme"),e({type:0,payload:{theme:r}})},[]);return{state:t,setTheme:n}},QT=m.createContext(null),LF=({children:t})=>o.jsx(QT.Provider,{value:DF(),children:t}),q=()=>{const t=m.useContext(QT);if(!t)throw new Error("ThemeProvider not provided");const{state:e,...n}=t;return{...e,...n}},MF=()=>{const[t,e]=m.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Somethings went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},KT=m.createContext(null);function OF({children:t}){return o.jsx(KT.Provider,{value:MF(),children:t})}const ge=()=>{const t=m.useContext(KT);if(!t)throw new Error("Toast Context not provided");return t},$F=()=>{const[t,e]=m.useState([]),[n,r]=m.useState([]),s=m.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},XT=m.createContext(null),YT=()=>{const t=m.useContext(XT);if(!t)throw new Error("Navigation context not provided");return t};function JT(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=YT(),s=nr(),i=m.useMemo(()=>s.pathname+s.search,[s]),a=m.useRef(!1);return m.useEffect(()=>{if(!a.current){a.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),o.jsx(o.Fragment,{})}function ZT({children:t}){return o.jsx(XT.Provider,{value:$F(),children:t})}function BF(){const[t,e]=m.useState([]),[n,r]=m.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const eI=m.createContext(null),zF=({children:t})=>o.jsx(eI.Provider,{value:BF(),children:t}),tI=()=>{const t=m.useContext(eI);if(!t)throw new Error("UploadSongProvider not provided");return t},UF=["Songs","Karaoke","Lyric"],VF=["Playing","Lyric"],Hl=fn();function HF(){const[t,e]=m.useState(!1),[n,r]=m.useState(!1),[s,i]=m.useState("Lyric"),[a,l]=m.useState("Lyric"),[c,u]=m.useState(!1),[h,f]=m.useState({lyricSize:Hl.lyricSize||"medium",repeat:Hl.isRepeat||"no",isShuffle:Hl.isShuffle||!1,isCrossFade:Hl.isCrossFade||!1,songBackground:Hl.songBackground||!0,isEnableBeat:!1}),p=m.useRef(!0),x=m.useRef(0),v=m.useRef(!0),_=m.useRef(""),S=m.useRef(!1),E=m.useRef(null),w=m.useRef(null),b=m.useRef(null);return{audioRef:E,themeCodeRef:_,isOpenFullScreen:t,isOpenSongQueue:n,idle:c,setIdle:u,setIsOpenFullScreen:e,setIsOpenSongQueue:r,activeTab:s,setActiveTab:i,desktopTabs:UF,mobileActiveTab:a,setMobileActiveTab:l,mobileTabs:VF,playerConig:h,updatePlayerConfig:F=>{f(D=>({...D,...F}))},firstTimeSongLoaded:p,timelineEleRef:w,currentTimeEleRef:b,startFadeWhenEnd:x,isPlayingNewSong:v,shouldSyncSongDuration:S}}const nI=m.createContext(null);function WF({children:t}){return o.jsx(nI.Provider,{value:HF(),children:t})}function Ye(){const t=m.useContext(nI);if(!t)throw new Error("Player Context not provided");return t}const qF=()=>{const[t,e]=m.useState([]),[n,r]=m.useState(!1),s=m.useRef(!1);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,ranGetLyric:s}},rI=m.createContext(null);function sI({children:t}){return o.jsx(rI.Provider,{value:qF(),children:t})}const GF=()=>{const t=m.useContext(rI);if(!t)throw new Error("Lyric context not found");return t},QF=()=>{const[t,e]=m.useState(!1),[n,r]=m.useState(!1),[s,i]=m.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const h=[...s],f=h.findIndex(p=>p.id===u.id);f===-1?h.push(u):h.splice(f,1),e(!!h.length),i(h)},resetSelect:()=>{e(!1),r(!1),i([])}}},iI=m.createContext(null);function ds({children:t}){return o.jsx(iI.Provider,{value:QF(),children:t})}const fu=()=>{const t=m.useContext(iI);if(!t)throw new Error("SelectSongContext not provided");return t};function aI(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=aI(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function KF(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=aI(t))&&(r&&(r+=" "),r+=e);return r}const yb=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,vb=KF,mu=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return vb(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(u=>{const h=n==null?void 0:n[u],f=i==null?void 0:i[u];if(h===null)return null;const p=yb(h)||yb(f);return s[u][p]}),l=n&&Object.entries(n).reduce((u,h)=>{let[f,p]=h;return p===void 0||(u[f]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,h)=>{let{class:f,className:p,...x}=h;return Object.entries(x).every(v=>{let[_,S]=v;return Array.isArray(S)?S.includes({...i,...l}[_]):{...i,...l}[_]===S})?[...u,f,p]:u},[]);return vb(t,a,c,n==null?void 0:n.class,n==null?void 0:n.className)};function XF({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const YF=m.forwardRef(XF),pu=YF;function JF({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const ZF=m.forwardRef(JF),em=ZF;function eD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const tD=m.forwardRef(eD),nD=tD;function rD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const sD=m.forwardRef(rD),oI=sD;function iD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const aD=m.forwardRef(iD),lI=aD;function oD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const lD=m.forwardRef(oD),Tt=lD;function cD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const uD=m.forwardRef(cD),Ly=uD;function dD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const hD=m.forwardRef(dD),fD=hD;function mD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const pD=m.forwardRef(mD),cI=pD;function gD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const xD=m.forwardRef(gD),My=xD;function yD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const vD=m.forwardRef(yD),Oy=vD;function wD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const _D=m.forwardRef(wD),il=_D;function bD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const SD=m.forwardRef(bD),ED=SD;function kD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const TD=m.forwardRef(kD),gu=TD;function ID({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const CD=m.forwardRef(ID),uI=CD;function RD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const jD=m.forwardRef(RD),dI=jD;function AD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const ND=m.forwardRef(AD),rh=ND;function PD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const FD=m.forwardRef(PD),DD=FD;function LD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const MD=m.forwardRef(LD),$y=MD;function OD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const $D=m.forwardRef(OD),By=$D;function BD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const zD=m.forwardRef(BD),zy=zD;function UD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const VD=m.forwardRef(UD),Uy=VD;function HD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const WD=m.forwardRef(HD),tm=WD;function qD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const GD=m.forwardRef(qD),QD=GD;function KD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const XD=m.forwardRef(KD),Vy=XD;function YD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const JD=m.forwardRef(YD),xu=JD;function ZD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const eL=m.forwardRef(ZD),nm=eL;function tL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const nL=m.forwardRef(tL),N0=nL;function rL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const sL=m.forwardRef(rL),iL=sL;function aL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const oL=m.forwardRef(aL),Hy=oL;function lL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const cL=m.forwardRef(lL),Wy=cL;function uL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const dL=m.forwardRef(uL),Ua=dL;function hL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const fL=m.forwardRef(hL),mL=fL;function pL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const gL=m.forwardRef(pL),P0=gL;function xL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const yL=m.forwardRef(xL),qy=yL;function vL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const wL=m.forwardRef(vL),rm=wL;function _L({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const bL=m.forwardRef(_L),qs=bL;function SL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const EL=m.forwardRef(SL),al=EL;function kL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const TL=m.forwardRef(kL),hI=TL;function IL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const CL=m.forwardRef(IL),Vc=CL;function RL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const jL=m.forwardRef(RL),vr=jL;function AL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"}))}const NL=m.forwardRef(AL),fI=NL;function PL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const FL=m.forwardRef(PL),DL=FL;function LL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const ML=m.forwardRef(LL),OL=ML;function $L({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const BL=m.forwardRef($L),mI=BL;function zL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const UL=m.forwardRef(zL),VL=UL;function HL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const WL=m.forwardRef(HL),qL=WL;function GL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const QL=m.forwardRef(GL),pI=QL;function KL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const XL=m.forwardRef(KL),Fn=XL;function YL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const JL=m.forwardRef(YL),ZL=JL;function eM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const tM=m.forwardRef(eM),Vi=tM,nM=mu("inline-flex space-x-1 font-[500] items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"primary",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function rM({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:a,color:l,hover:c,onClick:u,...h},f){const{theme:p}=q();return o.jsxs("button",{ref:f,type:"button",onClick:x=>u?u(x):"",...h,className:`${l==="primary"?p.content_bg:""}  ${nM({variant:n,size:r,hover:c,rounded:a,className:t})}`,disabled:i||s,children:[i?o.jsx(Tt,{className:"w-6 animate-spin"}):null,!i&&e]})}const le=m.forwardRef(rM);function sM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const iM=m.forwardRef(sM),aM=iM;function oM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const lM=m.forwardRef(oM),cM=lM;function uM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const dM=m.forwardRef(uM),hM=dM;function fM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const mM=m.forwardRef(fM),Gy=mM;function pM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z",clipRule:"evenodd"}))}const gM=m.forwardRef(pM),xM=gM;function yM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const vM=m.forwardRef(yM),wM=vM;function _M({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const bM=m.forwardRef(_M),sm=bM;function SM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const EM=m.forwardRef(SM),gI=EM;function kM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),m.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const TM=m.forwardRef(kM),IM=TM;function CM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const RM=m.forwardRef(CM),F0=RM;function jM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const AM=m.forwardRef(jM),hs=AM;function NM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const PM=m.forwardRef(NM),xI=PM;function It({close:t,title:e}){return o.jsxs("div",{className:"flex justify-between mb-3",children:[o.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:e}),o.jsx("button",{onClick:t,children:o.jsx(xI,{className:"w-7"})})]})}function Qy({close:t}){return o.jsxs("div",{className:"w-[400px] max-w-[calc(90vw-40px)]",children:[o.jsx(It,{close:t,title:"HD MP3"}),o.jsxs("p",{children:[o.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}function Up({onClick:t,theme:e,active:n}){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[o.jsx("div",{onClick:()=>t(e),className:`relative border-l-[20px] ${e.content_border} pt-[100%] rounded-xl ${e.side_bar_bg} ${n?e.content_border:""}`,children:n&&o.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:o.jsx(ED,{className:`${e.content_text} w-[25px]`})})}),o.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function Ky({close:t}){const{theme:e,setTheme:n}=q(),r=c=>{ot("theme",c.id),n(c)},s={songItemContainer:`w-full border-b border-${e.alpha} last:border-none`,icon:"w-6 h-6 mr-2 inline",popupWrapper:"w-[900px] max-w-[calc(90vw-40px)]",themeContainer:"overflow-y-auto overflow-x-hidden no-scrollbar h-[calc(70vh-60px)]  pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap",linkItem:`py-[10px] border-b border-${e.alpha} last:border-none`},i=Bh.map(c=>{const u=c.id===e.id;if(c.type==="light")return o.jsx(Up,{active:u,theme:c,onClick:r},c.id)}),a=Bh.map(c=>{const u=c.id===e.id;if(c.type==="dark")return o.jsx(Up,{active:u,theme:c,onClick:r},c.id)}),l=_T.map(c=>{const u=c.id===e.id;return o.jsx(Up,{active:u,theme:c,onClick:r},c.id)});return o.jsxs("div",{className:s.popupWrapper,children:[o.jsx(It,{close:t,title:"Themes"}),o.jsxs("div",{className:s.themeContainer,children:[o.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Specical"}),o.jsx("div",{className:s.themeList,children:l}),o.jsx("h2",{className:"text-lg font-semibold mb-[10px]",children:"Dark"}),o.jsx("div",{className:s.themeList,children:a}),o.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Light"}),o.jsx("div",{className:s.themeList,children:i})]})]})}function Gs({loading:t,callback:e,label:n,children:r,close:s,desc:i="This action cannot be undone",className:a}){const{theme:l}=q();return o.jsxs("div",{className:`${a||"w-[400px] max-w-[calc(90vw-40px)]"} ${t?"disable":""}`,children:[o.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:n||"Wait a minute"}),i&&o.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),o.jsx("div",{className:"flex space-x-3 mt-5",children:r||o.jsxs(o.Fragment,{children:[o.jsx(le,{onClick:s,className:"bg-white/10 border border-white/10 rounded-full px-3 py-0.5",variant:"primary",size:"clear",children:"Close"}),o.jsx(le,{isLoading:t,className:`${l.content_bg} rounded-full px-3`,variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const FM=[3,5,7,10];function yI({closeModal:t,active:e}){const{theme:n}=q(),r={button:`bg-[#fff]/5 ${n.content_hover_bg} ml-2 mt-2 px-3  py-1 rounded-[99px]`},s=a=>{e(a),t()},i=FM.map(a=>o.jsxs("button",{type:"button",onClick:()=>s(a),className:`${r.button} `,children:[a," songs"]},a));return o.jsxs("div",{className:"w-[300px] max-w-[calc(100vw-40px)]",children:[o.jsx(It,{close:t,title:"Sleep timer"}),o.jsx("div",{children:o.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:i})})]})}function he({className:t}){const{theme:e}=q();return o.jsx("div",{className:`animate-pulse rounded-[4px] ${e.type==="light"?"bg-[#f1f1f1]":"bg-[#808080]"}  ${t}`})}const ol=[...Array(4).keys()].map(t=>o.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[o.jsx(he,{className:"h-[18px] w-[18px]"}),o.jsx(he,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx(he,{className:"h-[20px] mb-[5px] w-[150px]"}),o.jsx(he,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),vI=()=>o.jsx("div",{className:"py-3",children:o.jsx(he,{className:"w-full h-[28px]"})}),Xy=[...Array(2).keys()].map(t=>o.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[o.jsx(he,{className:"pt-[100%] rounded-lg"}),o.jsx(he,{className:"h-[21px] mt-1.5 w-3/4"}),o.jsx(he,{className:"h-[13px] mt-1 w-3/4"})]},t));var DM=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],ec=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=DM.indexOf(r);e=e*83+s}return e},Vp=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},Hp=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},LM=t=>t<0?-1:1,Wp=(t,e)=>LM(t)*Math.pow(Math.abs(t),e),wb=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},MM=t=>{if(!t||t.length<6)throw new wb("The blurhash string must be at least 6 characters");let e=ec(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new wb(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},OM=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Vp(e),Vp(n),Vp(r)]},$M=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[Wp((n-9)/9,2)*e,Wp((r-9)/9,2)*e,Wp((s-9)/9,2)*e]},BM=(t,e,n,r)=>{MM(t),r=r|1;let s=ec(t[0]),i=Math.floor(s/9)+1,a=s%9+1,l=(ec(t[1])+1)/166,c=new Array(a*i);for(let f=0;f<c.length;f++)if(f===0){let p=ec(t.substring(2,6));c[f]=OM(p)}else{let p=ec(t.substring(4+f*2,6+f*2));c[f]=$M(p,l*r)}let u=e*4,h=new Uint8ClampedArray(u*n);for(let f=0;f<n;f++)for(let p=0;p<e;p++){let x=0,v=0,_=0;for(let b=0;b<i;b++)for(let I=0;I<a;I++){let F=Math.cos(Math.PI*p*I/e)*Math.cos(Math.PI*f*b/n),D=c[I+b*a];x+=D[0]*F,v+=D[1]*F,_+=D[2]*F}let S=Hp(x),E=Hp(v),w=Hp(_);h[4*p+0+f*u]=S,h[4*p+1+f*u]=E,h[4*p+2+f*u]=w,h[4*p+3+f*u]=255}return h},zM=BM,UM=Object.defineProperty,VM=Object.defineProperties,HM=Object.getOwnPropertyDescriptors,Hh=Object.getOwnPropertySymbols,wI=Object.prototype.hasOwnProperty,_I=Object.prototype.propertyIsEnumerable,_b=(t,e,n)=>e in t?UM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,D0=(t,e)=>{for(var n in e||(e={}))wI.call(e,n)&&_b(t,n,e[n]);if(Hh)for(var n of Hh(e))_I.call(e,n)&&_b(t,n,e[n]);return t},L0=(t,e)=>VM(t,HM(e)),bI=(t,e)=>{var n={};for(var r in t)wI.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Hh)for(var r of Hh(t))e.indexOf(r)<0&&_I.call(t,r)&&(n[r]=t[r]);return n},SI=class extends m.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:n,width:r}=this.props;if(this.canvas){let s=zM(t,r,e,n),i=this.canvas.getContext("2d"),a=i.createImageData(r,e);a.data.set(s),i.putImageData(a,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:n,width:r}=t,s=bI(t,["hash","height","width"]);return m.createElement("canvas",L0(D0({},s),{height:n,width:r,ref:this.handleRef}))}};SI.defaultProps={height:128,width:128};var WM={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},im=class extends m.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:n,width:r,punch:s,resolutionX:i,resolutionY:a,style:l}=t,c=bI(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return m.createElement("div",L0(D0({},c),{style:L0(D0({display:"inline-block",height:n,width:r},l),{position:"relative"})}),m.createElement(SI,{hash:e,height:a,width:i,punch:s,style:WM}))}};im.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};function pt({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s}){const[i,a]=m.useState(!1),l=m.useRef(null),c=()=>{a(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},u=()=>{const f=l.current;f.src="https://placehold.co/400",a(!0)},h=()=>{console.log("image error"),s?(s(),u()):u()};return o.jsxs(o.Fragment,{children:[!i&&o.jsx(o.Fragment,{children:r?o.jsx(im,{hash:r,height:"100%",width:"100%"}):o.jsx(he,{className:"w-full h-0"})}),o.jsx("img",{onLoad:c,onError:h,className:`${e} ${n} ${i?"":"hidden"}`,src:t||"https://placehold.co/400",ref:l})]})}function yu({children:t,className:e=""}){return o.jsx("div",{className:`pt-[100%] relative rounded-lg overflow-hidden ${e}`,children:o.jsx("div",{className:"absolute inset-0",children:t})})}const Yy="border border-black/10 placeholder:[#888] outline-none py-1.5 px-2",qM=mu("w-full",{variants:{variant:{primary:Yy,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function GM({variant:t,className:e="bg-white/10",...n},r){return o.jsx("input",{ref:r,className:` ${qM({variant:t,className:e})}`,...n})}const rn=m.forwardRef(GM),QM=mu("",{variants:{p:{3:"p-3",2:"p-2",1:"p-1",clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md",sm:"rounded-sm"}},defaultVariants:{p:3,rounded:"xl"}});function Qs({children:t,bg:e="primary",theme:n,className:r,p:s,rounded:i}){return o.jsx("div",{className:` ${e==="primary"?n.modal_bg:""} text-white border-[#fff]/5 border-[1px]  ${QM({p:s,rounded:i,className:r})}`,children:t})}function qp({className:t,icon:e,label:n,to:r,arrowIcon:s,children:i}){return r?o.jsxs(Ce,{className:`w-full flex  justify-between  ${t}`,to:r,children:[o.jsxs("div",{className:"inline-flex items-center ",children:[e,o.jsx("span",{className:"text-lg font-medium",children:n})]}),i,s&&o.jsx("span",{children:s})]}):o.jsx("p",{children:"No onClick"})}const EI="/assets/simon_empty-95813d48.png";function tt({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return o.jsx(o.Fragment,{});case"with-home-button":return o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"}),o.jsx("p",{className:"text-center mt-5",children:o.jsx(Ce,{to:"/",children:o.jsxs(le,{color:"primary",children:[o.jsx(nm,{className:"w-6"}),o.jsx("span",{children:"Home"})]})})})]});case"default":return o.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"})}};return o.jsxs("div",{className:`${n}`,children:[o.jsx("img",{className:"mx-auto",src:EI,alt:""}),r(),t]})}function mr({children:t}){return o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function be({title:t,className:e=""}){return o.jsx("div",{className:`text-xl font-playwriteCU leading-[2.4] ${e}`,children:t})}function kI({colList:t,children:e,className:n=""}){const r={table:"w-full"};return o.jsxs("table",{className:`${r.table} ${n}`,children:[o.jsx("thead",{children:o.jsx("tr",{children:t.map((s,i)=>o.jsx("th",{children:s},i))})}),o.jsx("tbody",{children:e})]})}const KM=({appendOnPortal:t})=>{const[e,n]=m.useState(!1),[r,s]=m.useState(!1),i=m.useRef(null),a=m.useRef(null);return{refs:{triggerRef:i,contentRef:a},setTriggerRef:f=>{i.current=f},setContentRef:f=>{a.current=f},state:{isMounted:r,isOpen:e},setIsMounted:s,setIsOpen:n,appendOnPortal:t,close:()=>{s(!1)},toggle:()=>{r&&s(!1),e||n(!0)}}},TI=m.createContext(null),wr=()=>{const t=m.useContext(TI);return t||{}};function pr({children:t,relativeWrap:e=!0,appendOnPortal:n,...r}){return o.jsx(TI.Provider,{value:KM({...r,appendOnPortal:n}),children:n?t:o.jsx("div",{className:"relative",children:t})})}const gr=m.forwardRef(function({children:t,needButton:e,setIsOpenParent:n},r){const{refs:s,setIsMounted:i,setIsOpen:a,close:l,toggle:c,state:{isMounted:u,isOpen:h}}=wr();return m.useImperativeHandle(r,()=>({close:l})),m.useEffect(()=>{u||(n&&n(!1),setTimeout(()=>{a(!1)},400))},[u]),m.useEffect(()=>(h&&(n&&n(!0),setTimeout(()=>{i(!0)},100)),()=>{h||i(!1)}),[h]),m.useEffect(()=>{if(!h)return;const f=p=>{var x,v;!s.contentRef||!s.triggerRef||(x=s.triggerRef.current)!=null&&x.contains(p.target)||(v=s.contentRef.current)!=null&&v.contains(p.target)||i(!1)};return document.addEventListener("mousedown",f),document.addEventListener("touchstart",f),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("touchstart",f)}},[h]),!e&&m.isValidElement(t)?m.cloneElement(t,{onClick:c,ref:s.triggerRef}):o.jsx("button",{ref:s.triggerRef,onClick:c,children:t})});function xr({children:t,className:e,animationClassName:n,...r}){const{state:{isMounted:s,isOpen:i},refs:a,close:l,appendOnPortal:c,setContentRef:u}=wr(),h=m.useRef(null),f=()=>{const _=a.triggerRef.current,S=a.contentRef.current,E=h.current;if(!_||!S)return;const w=_.getBoundingClientRect(),b={top:w.top+_.clientHeight,left:w.left-S.clientWidth};if(r.appendTo==="portal"){const{origin:I="top right",position:F,spacer:D=8}=r;switch(F){case"right-bottom":{b.top=w.top+_.clientHeight+D,b.left=w.left;break}}const C=b.top+S.clientHeight>window.innerHeight-90;if(C){let k=b.top-S.clientHeight-_.clientHeight;k-60<0&&(k=60),b.top=k}if(E){let k=I;C&&(k="bottom right"),E.style.transformOrigin=k}}S.style.left=`${b.left}px`,S.style.top=`${b.top}px`},p=l,x={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},v=o.jsx("div",{ref:u,className:`popup-content ${c?"fixed z-[99]":"absolute"} ${e||""}`,children:o.jsx("div",{ref:h,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${n||""} ${s?x.mountedContent:x.unMountedContent}`,children:t})});return m.useEffect(()=>{if(c)return i&&(f(),document.addEventListener("wheel",p)),()=>{document.removeEventListener("wheel",p)}},[i]),i?o.jsx(o.Fragment,{children:c?el.createPortal(v,document.getElementById("portals")):v}):o.jsx(o.Fragment,{})}function M0(t,e){const[n,r]=m.useState(e),s=m.useRef(!1);return m.useEffect(()=>{const i=fn()[t]||e;r(i)},[]),m.useEffect(()=>{if(!s.current){s.current=!0;return}ot(t,n)},[n]),[n,r]}function XM({audioEle:t,postLocalStorageKey:e}){const[n,r]=M0(`audio_speed_${e}`,1),[s,i]=M0(`audio_volume_${e}`,100);return m.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function II({className:t="",positions:e="right",bg:n="",...r}){const{theme:s}=q(),{speed:i,volume:a,setVolume:l,setSpeed:c}=XM(r);return o.jsxs(pr,{children:[o.jsx(gr,{children:o.jsx(le,{className:`${s.content_bg} rounded-full ${t}`,children:o.jsx(By,{className:"w-6"})})}),o.jsx(xr,{className:`top-[calc(100%+8px)] ${e==="right"?"left-0":"right-0"} z-[9]`,appendTo:"parent",children:o.jsx(Qs,{bg:"clear",className:`w-[240px] ${n||s.modal_bg} `,theme:s,children:o.jsxs("div",{className:"space-y-[6px]",children:[o.jsxs("div",{className:"flex space-x-1",children:[o.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),o.jsx("input",{className:"w-full",type:"range",step:.1,min:1,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",a,"%"]}),o.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:a,onChange:u=>l(+u.target.value)})]})]})})})]})}function sh({cb:t,active:e,inActiveBg:n="bg-white/10",size:r="default"}){const{theme:s}=q(),i={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return o.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] 
         ${e?s.content_bg:n} `,children:o.jsx("div",{className:`${i.circle} ${e?i.active:i.inActive}`})})}function YM({children:t,className:e,persisted:n=!1,wrapped:r=!0,...s},i){const a=s.variant||"default",{theme:l}=q(),[c,u]=m.useState(a==="default"),[h,f]=m.useState(a==="default"),[p,x]=m.useState(n),v=()=>{h&&f(!1),c||u(!0)},_=()=>{u(!0)},S=()=>{f(!1),x(!1)},E=I=>{x(I)},w=I=>{I.preventDefault(),I.stopPropagation(),!p&&(a==="default"&&s.closeModal&&s.closeModal(),a==="animation"&&S())};m.useImperativeHandle(i,()=>({toggle:v,close:S,open:_,setModalPersist:E})),m.useEffect(()=>{a!=="default"&&(h||setTimeout(()=>{u(!1)},400))},[h]),m.useEffect(()=>{a!=="default"&&c&&setTimeout(()=>{f(!0)},100)},[c]);const b={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return o.jsx(o.Fragment,{children:c&&el.createPortal(o.jsxs("div",{className:"fixed inset-0 z-[99]",children:[o.jsx("div",{onClick:w,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${h?b.mountedLayer:b.unMountedLayer}
                        `}),o.jsx("div",{className:`modal-content absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${h?b.mountedContent:b.unMountedContent}
                        `,children:r?o.jsx(Qs,{className:e||"",theme:l,children:t}):t})]}),document.getElementById("portals"))})}const Oe=m.forwardRef(YM),Jy="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",Zy=({data:t,variant:e="link",active:n,link:r})=>{const s=o.jsxs(yu,{children:[o.jsx(pt,{className:`hover:scale-[1.05] transition-transform object-cover ${n?"brightness-[90%]":""}`,src:t.image_url,blurHashEncode:t.blurhash_encode}),n&&o.jsx(mr,{children:o.jsx("img",{src:Jy,alt:"",className:"w-[30px]"})})]});return(()=>{switch(e){case"link":return o.jsxs(o.Fragment,{children:[o.jsx(Ce,{to:`${r||"/playlist/"+t.id}`,className:"",children:s}),o.jsx("p",{className:"text-lg font-[500] leading-[1.3] line-clamp-1 mt-1.5",children:t.name}),o.jsx("p",{className:"text-sm opacity-[.7] leading-[1.3] line-clamp-1",children:t.is_album?t.singers[0].name:t.distributor})]});case"image":return s}})()};function CI({openModal:t,variant:e}){const{theme:n}=q(),r=a=>{t(a)},s={menuItem:"hover:bg-[#fff]/5 rounded-md text-sm font-[500] px-2 py-2 inline-flex items-center cursor-pointer",icon:"w-5 mr-2",divide:"h-[1px]  w-[calc(100%-20px)] my-[4px] mx-auto bg-[#fff]/5"},i=()=>{switch(e){case"client":return o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[o.jsx(P0,{className:s.icon}),"Themes"]}),o.jsx("div",{className:s.divide}),o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[o.jsx(N0,{className:s.icon}),"Info"]})]});case"dashboard":return o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[o.jsx(P0,{className:s.icon}),"Themes"]}),o.jsx("div",{className:s.divide}),o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[o.jsx(N0,{className:s.icon}),"Info"]})]})}};return o.jsx(o.Fragment,{children:o.jsx(Qs,{theme:n,children:o.jsx("ul",{className:"flex flex-col w-[200px]",children:i()})})})}const JM=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},a)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return o.jsxs("div",{ref:a,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[o.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:o.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[o.jsx(pt,{src:t.image_url,blurHashEncode:t.blurhash_encode}),o.jsx("div",{className:`${l.overlay}`,children:!e&&o.jsx(le,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:o.jsx(qy,{className:"w-10"})})}),e&&o.jsx("div",{className:l.playingGifFrame,children:o.jsx("img",{src:Jy,alt:""})})]})}),r&&o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),o.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:t.singers.map((c,u)=>o.jsx("span",{children:c.name},u))})]})]})},Gp=m.forwardRef(JM);var RI={exports:{}},jI={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vu=m;function ZM(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var eO=typeof Object.is=="function"?Object.is:ZM,tO=vu.useSyncExternalStore,nO=vu.useRef,rO=vu.useEffect,sO=vu.useMemo,iO=vu.useDebugValue;jI.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=nO(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=sO(function(){function c(x){if(!u){if(u=!0,h=x,x=r(x),s!==void 0&&a.hasValue){var v=a.value;if(s(v,x))return f=v}return f=x}if(v=f,eO(h,x))return v;var _=r(x);return s!==void 0&&s(v,_)?(h=x,v):(h=x,f=_)}var u=!1,h,f,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,r,s]);var l=tO(t,i[0],i[1]);return rO(function(){a.hasValue=!0,a.value=l},[l]),iO(l),l};RI.exports=jI;var aO=RI.exports;function oO(t){t()}function lO(){let t=null,e=null;return{clear(){t=null,e=null},notify(){oO(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var bb={notify(){},get:()=>[]};function cO(t,e){let n,r=bb,s=0,i=!1;function a(_){h();const S=r.subscribe(_);let E=!1;return()=>{E||(E=!0,S(),f())}}function l(){r.notify()}function c(){v.onStateChange&&v.onStateChange()}function u(){return i}function h(){s++,n||(n=e?e.addNestedSub(c):t.subscribe(c),r=lO())}function f(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=bb)}function p(){i||(i=!0,h())}function x(){i&&(i=!1,f())}const v={addNestedSub:a,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:x,getListeners:()=>r};return v}var uO=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dO=uO(),hO=()=>typeof navigator<"u"&&navigator.product==="ReactNative",fO=hO(),mO=()=>dO||fO?m.useLayoutEffect:m.useEffect,pO=mO(),Qp=Symbol.for("react-redux-context"),Kp=typeof globalThis<"u"?globalThis:{};function gO(){if(!m.createContext)return{};const t=Kp[Qp]??(Kp[Qp]=new Map);let e=t.get(m.createContext);return e||(e=m.createContext(null),t.set(m.createContext,e)),e}var Fi=gO();function xO(t){const{children:e,context:n,serverState:r,store:s}=t,i=m.useMemo(()=>{const c=cO(s);return{store:s,subscription:c,getServerState:r?()=>r:void 0}},[s,r]),a=m.useMemo(()=>s.getState(),[s]);pO(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),a!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,a]);const l=n||Fi;return m.createElement(l.Provider,{value:i},e)}var yO=xO;function ev(t=Fi){return function(){return m.useContext(t)}}var AI=ev();function NI(t=Fi){const e=t===Fi?AI:ev(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var vO=NI();function wO(t=Fi){const e=t===Fi?vO:NI(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var an=wO(),_O=(t,e)=>t===e;function bO(t=Fi){const e=t===Fi?AI:ev(t),n=(r,s={})=>{const{equalityFn:i=_O}=typeof s=="function"?{equalityFn:s}:s,a=e(),{store:l,subscription:c,getServerState:u}=a;m.useRef(!0);const h=m.useCallback({[r.name](p){return r(p)}}[r.name],[r]),f=aO.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,h,i);return m.useDebugValue(f),f};return Object.assign(n,{withTypes:()=>n}),n}var ae=bO();function Ft(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var SO=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),Sb=SO,Xp=()=>Math.random().toString(36).substring(7).split("").join("."),EO={INIT:`@@redux/INIT${Xp()}`,REPLACE:`@@redux/REPLACE${Xp()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Xp()}`},Wh=EO;function tv(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function PI(t,e,n){if(typeof t!="function")throw new Error(Ft(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Ft(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Ft(1));return n(PI)(t,e)}let r=t,s=e,i=new Map,a=i,l=0,c=!1;function u(){a===i&&(a=new Map,i.forEach((S,E)=>{a.set(E,S)}))}function h(){if(c)throw new Error(Ft(3));return s}function f(S){if(typeof S!="function")throw new Error(Ft(4));if(c)throw new Error(Ft(5));let E=!0;u();const w=l++;return a.set(w,S),function(){if(E){if(c)throw new Error(Ft(6));E=!1,u(),a.delete(w),i=null}}}function p(S){if(!tv(S))throw new Error(Ft(7));if(typeof S.type>"u")throw new Error(Ft(8));if(typeof S.type!="string")throw new Error(Ft(17));if(c)throw new Error(Ft(9));try{c=!0,s=r(s,S)}finally{c=!1}return(i=a).forEach(w=>{w()}),S}function x(S){if(typeof S!="function")throw new Error(Ft(10));r=S,p({type:Wh.REPLACE})}function v(){const S=f;return{subscribe(E){if(typeof E!="object"||E===null)throw new Error(Ft(11));function w(){const I=E;I.next&&I.next(h())}return w(),{unsubscribe:S(w)}},[Sb](){return this}}}return p({type:Wh.INIT}),{dispatch:p,subscribe:f,getState:h,replaceReducer:x,[Sb]:v}}function kO(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:Wh.INIT})>"u")throw new Error(Ft(12));if(typeof n(void 0,{type:Wh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ft(13))})}function TO(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const a=e[i];typeof t[a]=="function"&&(n[a]=t[a])}const r=Object.keys(n);let s;try{kO(n)}catch(i){s=i}return function(a={},l){if(s)throw s;let c=!1;const u={};for(let h=0;h<r.length;h++){const f=r[h],p=n[f],x=a[f],v=p(x,l);if(typeof v>"u")throw l&&l.type,new Error(Ft(14));u[f]=v,c=c||v!==x}return c=c||r.length!==Object.keys(a).length,c?u:a}}function qh(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function IO(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Ft(15))};const a={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(a));return i=qh(...l)(s.dispatch),{...s,dispatch:i}}}function CO(t){return tv(t)&&"type"in t&&typeof t.type=="string"}var FI=Symbol.for("immer-nothing"),Eb=Symbol.for("immer-draftable"),Jn=Symbol.for("immer-state");function jr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var $o=Object.getPrototypeOf;function Ta(t){return!!t&&!!t[Jn]}function $s(t){var e;return t?DI(t)||Array.isArray(t)||!!t[Eb]||!!((e=t.constructor)!=null&&e[Eb])||om(t)||lm(t):!1}var RO=Object.prototype.constructor.toString();function DI(t){if(!t||typeof t!="object")return!1;const e=$o(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===RO}function Gh(t,e){am(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function am(t){const e=t[Jn];return e?e.type_:Array.isArray(t)?1:om(t)?2:lm(t)?3:0}function O0(t,e){return am(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function LI(t,e,n){const r=am(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function jO(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function om(t){return t instanceof Map}function lm(t){return t instanceof Set}function ia(t){return t.copy_||t.base_}function $0(t,e){if(om(t))return new Map(t);if(lm(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=DI(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[Jn];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],l=r[a];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[a]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[a]})}return Object.create($o(t),r)}else{const r=$o(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function nv(t,e=!1){return cm(t)||Ta(t)||!$s(t)||(am(t)>1&&(t.set=t.add=t.clear=t.delete=AO),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>nv(r,!0))),t}function AO(){jr(2)}function cm(t){return Object.isFrozen(t)}var NO={};function Ia(t){const e=NO[t];return e||jr(0,t),e}var Hc;function MI(){return Hc}function PO(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function kb(t,e){e&&(Ia("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function B0(t){z0(t),t.drafts_.forEach(FO),t.drafts_=null}function z0(t){t===Hc&&(Hc=t.parent_)}function Tb(t){return Hc=PO(Hc,t)}function FO(t){const e=t[Jn];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Ib(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Jn].modified_&&(B0(e),jr(4)),$s(t)&&(t=Qh(e,t),e.parent_||Kh(e,t)),e.patches_&&Ia("Patches").generateReplacementPatches_(n[Jn].base_,t,e.patches_,e.inversePatches_)):t=Qh(e,n,[]),B0(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==FI?t:void 0}function Qh(t,e,n){if(cm(e))return e;const r=e[Jn];if(!r)return Gh(e,(s,i)=>Cb(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return Kh(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),Gh(i,(l,c)=>Cb(t,r,s,l,c,n,a)),Kh(t,s,!1),n&&t.patches_&&Ia("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function Cb(t,e,n,r,s,i,a){if(Ta(s)){const l=i&&e&&e.type_!==3&&!O0(e.assigned_,r)?i.concat(r):void 0,c=Qh(t,s,l);if(LI(n,r,c),Ta(c))t.canAutoFreeze_=!1;else return}else a&&n.add(s);if($s(s)&&!cm(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Qh(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&Kh(t,s)}}function Kh(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&nv(e,n)}function DO(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:MI(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=rv;n&&(s=[r],i=Wc);const{revoke:a,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=a,l}var rv={get(t,e){if(e===Jn)return t;const n=ia(t);if(!O0(n,e))return LO(t,n,e);const r=n[e];return t.finalized_||!$s(r)?r:r===Yp(t.base_,e)?(Jp(t),t.copy_[e]=V0(r,t)):r},has(t,e){return e in ia(t)},ownKeys(t){return Reflect.ownKeys(ia(t))},set(t,e,n){const r=OI(ia(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=Yp(ia(t),e),i=s==null?void 0:s[Jn];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(jO(n,s)&&(n!==void 0||O0(t.base_,e)))return!0;Jp(t),U0(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Yp(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Jp(t),U0(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=ia(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){jr(11)},getPrototypeOf(t){return $o(t.base_)},setPrototypeOf(){jr(12)}},Wc={};Gh(rv,(t,e)=>{Wc[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wc.deleteProperty=function(t,e){return Wc.set.call(this,t,e,void 0)};Wc.set=function(t,e,n){return rv.set.call(this,t[0],e,n,t[0])};function Yp(t,e){const n=t[Jn];return(n?ia(n):t)[e]}function LO(t,e,n){var s;const r=OI(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function OI(t,e){if(!(e in t))return;let n=$o(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=$o(n)}}function U0(t){t.modified_||(t.modified_=!0,t.parent_&&U0(t.parent_))}function Jp(t){t.copy_||(t.copy_=$0(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var MO=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const a=this;return function(c=i,...u){return a.produce(c,h=>n.call(this,h,...u))}}typeof n!="function"&&jr(6),r!==void 0&&typeof r!="function"&&jr(7);let s;if($s(e)){const i=Tb(this),a=V0(e,void 0);let l=!0;try{s=n(a),l=!1}finally{l?B0(i):z0(i)}return kb(i,r),Ib(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===FI&&(s=void 0),this.autoFreeze_&&nv(s,!0),r){const i=[],a=[];Ia("Patches").generateReplacementPatches_(e,s,i,a),r(i,a)}return s}else jr(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(a,...l)=>this.produceWithPatches(a,c=>e(c,...l));let r,s;return[this.produce(e,n,(a,l)=>{r=a,s=l}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){$s(t)||jr(8),Ta(t)&&(t=OO(t));const e=Tb(this),n=V0(t,void 0);return n[Jn].isManual_=!0,z0(e),n}finishDraft(t,e){const n=t&&t[Jn];(!n||!n.isManual_)&&jr(9);const{scope_:r}=n;return kb(r,e),Ib(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=Ia("Patches").applyPatches_;return Ta(t)?r(t,e):this.produce(t,s=>r(s,e))}};function V0(t,e){const n=om(t)?Ia("MapSet").proxyMap_(t,e):lm(t)?Ia("MapSet").proxySet_(t,e):DO(t,e);return(e?e.scope_:MI()).drafts_.push(n),n}function OO(t){return Ta(t)||jr(10,t),$I(t)}function $I(t){if(!$s(t)||cm(t))return t;const e=t[Jn];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=$0(t,e.scope_.immer_.useStrictShallowCopy_)}else n=$0(t,!0);return Gh(n,(r,s)=>{LI(n,r,$I(s))}),e&&(e.finalized_=!1),n}var Zn=new MO,BI=Zn.produce;Zn.produceWithPatches.bind(Zn);Zn.setAutoFreeze.bind(Zn);Zn.setUseStrictShallowCopy.bind(Zn);Zn.applyPatches.bind(Zn);Zn.createDraft.bind(Zn);Zn.finishDraft.bind(Zn);function zI(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var $O=zI(),BO=zI,zO=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?qh:qh.apply(null,arguments)};function Rb(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(js(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>CO(r)&&r.type===t,n}var UI=class tc extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,tc.prototype)}static get[Symbol.species](){return tc}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new tc(...e[0].concat(this)):new tc(...e.concat(this))}};function jb(t){return $s(t)?BI(t,()=>{}):t}function Ab(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function UO(t){return typeof t=="boolean"}var VO=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let a=new UI;return n&&(UO(n)?a.push($O):a.push(BO(n.extraArgument))),a},HO="RTK_autoBatch",Nb=t=>e=>{setTimeout(e,t)},WO=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,a=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Nb(10):t.type==="callback"?t.queueNotification:Nb(t.timeout),u=()=>{a=!1,i&&(i=!1,l.forEach(h=>h()))};return Object.assign({},r,{subscribe(h){const f=()=>s&&h(),p=r.subscribe(f);return l.add(h),()=>{p(),l.delete(h)}},dispatch(h){var f;try{return s=!((f=h==null?void 0:h.meta)!=null&&f[HO]),i=!s,i&&(a||(a=!0,c(u))),r.dispatch(h)}finally{s=!0}}})},qO=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new UI(t);return r&&s.push(WO(typeof r=="object"?r:void 0)),s};function GO(t){const e=VO(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:a=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(tv(n))l=TO(n);else throw new Error(js(1));let c;typeof r=="function"?c=r(e):c=e();let u=qh;s&&(u=zO({trace:!1,...typeof s=="object"&&s}));const h=IO(...c),f=qO(h);let p=typeof a=="function"?a(f):f();const x=u(...p);return PI(l,i,x)}function VI(t){const e={},n=[];let r;const s={addCase(i,a){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(js(28));if(l in e)throw new Error(js(29));return e[l]=a,s},addMatcher(i,a){return n.push({matcher:i,reducer:a}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function QO(t){return typeof t=="function"}function KO(t,e){let[n,r,s]=VI(e),i;if(QO(t))i=()=>jb(t());else{const l=jb(t);i=()=>l}function a(l=i(),c){let u=[n[c.type],...r.filter(({matcher:h})=>h(c)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[s]),u.reduce((h,f)=>{if(f)if(Ta(h)){const x=f(h,c);return x===void 0?h:x}else{if($s(h))return BI(h,p=>f(p,c));{const p=f(h,c);if(p===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return h},l)}return a.getInitialState=i,a}var XO=Symbol.for("rtk-slice-createasyncthunk");function YO(t,e){return`${t}/${e}`}function JO({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[XO];return function(s){const{name:i,reducerPath:a=i}=s;if(!i)throw new Error(js(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(e6()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(b,I){const F=typeof b=="string"?b:b.type;if(!F)throw new Error(js(12));if(F in u.sliceCaseReducersByType)throw new Error(js(13));return u.sliceCaseReducersByType[F]=I,h},addMatcher(b,I){return u.sliceMatchers.push({matcher:b,reducer:I}),h},exposeAction(b,I){return u.actionCreators[b]=I,h},exposeCaseReducer(b,I){return u.sliceCaseReducersByName[b]=I,h}};c.forEach(b=>{const I=l[b],F={reducerName:b,type:YO(i,b),createNotation:typeof s.reducers=="function"};n6(I)?s6(F,I,h,e):t6(F,I,h)});function f(){const[b={},I=[],F=void 0]=typeof s.extraReducers=="function"?VI(s.extraReducers):[s.extraReducers],D={...b,...u.sliceCaseReducersByType};return KO(s.initialState,C=>{for(let k in D)C.addCase(k,D[k]);for(let k of u.sliceMatchers)C.addMatcher(k.matcher,k.reducer);for(let k of I)C.addMatcher(k.matcher,k.reducer);F&&C.addDefaultCase(F)})}const p=b=>b,x=new Map;let v;function _(b,I){return v||(v=f()),v(b,I)}function S(){return v||(v=f()),v.getInitialState()}function E(b,I=!1){function F(C){let k=C[b];return typeof k>"u"&&I&&(k=S()),k}function D(C=p){const k=Ab(x,I,()=>new WeakMap);return Ab(k,C,()=>{const j={};for(const[R,N]of Object.entries(s.selectors??{}))j[R]=ZO(N,C,S,I);return j})}return{reducerPath:b,getSelectors:D,get selectors(){return D(F)},selectSlice:F}}const w={name:i,reducer:_,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:S,...E(a),injectInto(b,{reducerPath:I,...F}={}){const D=I??a;return b.inject({reducerPath:D,reducer:_},F),{...w,...E(D,!0)}}};return w}}function ZO(t,e,n,r){function s(i,...a){let l=e(i);return typeof l>"u"&&r&&(l=n()),t(l,...a)}return s.unwrapped=t,s}var sv=JO();function e6(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function t6({type:t,reducerName:e,createNotation:n},r,s){let i,a;if("reducer"in r){if(n&&!r6(r))throw new Error(js(17));i=r.reducer,a=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,a?Rb(t,a):Rb(t))}function n6(t){return t._reducerDefinitionType==="asyncThunk"}function r6(t){return t._reducerDefinitionType==="reducerWithPrepare"}function s6({type:t,reducerName:e},n,r,s){if(!s)throw new Error(js(18));const{payloadCreator:i,fulfilled:a,pending:l,rejected:c,settled:u,options:h}=n,f=s(t,i,h);r.exposeAction(e,f),a&&r.addCase(f.fulfilled,a),l&&r.addCase(f.pending,l),c&&r.addCase(f.rejected,c),u&&r.addMatcher(f.settled,u),r.exposeCaseReducer(e,{fulfilled:a||bd,pending:l||bd,rejected:c||bd,settled:u||bd})}function bd(){}function js(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Pb={queueSongs:fn().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function Zp(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const HI=sv({name:"songQueue",initialState:Pb,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,Zp(t),ot("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,Zp(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),ot("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&Zp(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),ot("queue",t.queueSongs)},resetSongQueue:t=>{ot("queue",[]),Object.assign(t,Pb)}}}),Ve=t=>t.songQueue,{addSongToQueue:um,setCurrentQueueId:rs,removeSongFromQueue:i6,setQueue:a6,resetSongQueue:o6,setIsFetchingRecommend:Fb}=HI.actions,l6=HI.reducer;function wu({className:t="",playlists:e,loading:n}){const{currentSongData:r}=ae(Ve),s=()=>e.length?e.map((i,a)=>{const l=r==null?void 0:r.song.queue_id.includes(i.id);return o.jsx("div",{className:"p-2 w-1/2 md:w-1/4",children:o.jsx(Zy,{active:l,data:i})},a)}):o.jsx(tt,{className:"mx-auto"});return o.jsx(o.Fragment,{children:o.jsxs("div",{className:`flex flex-row flex-wrap -mx-[8px] ${t}`,children:[n&&Xy,!n&&s()]})})}function fs({setTab:t,render:e,tab:n,tabs:r,className:s=""}){const{theme:i}=q(),a={inActiveTab:` hover:bg-${i.alpha}`,activeTab:`${i.content_bg}`};return o.jsx("div",{className:`bg-${i.alpha} p-1.5 space-x-1 rounded-full ${s}`,children:r.map((l,c)=>o.jsx(le,{size:"clear",onClick:u=>{t(l),u.target.blur()},className:`py-1 px-4 ${l===n?a.activeTab:a.inActiveTab}`,children:e(l)},c))})}function c6({user:t},e){return e?o.jsx("p",{className:"text-xl mb-4 ml-2",ref:e,children:t.display_name}):o.jsx("p",{className:"text-xl mb-4 ml-2",children:t.display_name})}m.forwardRef(c6);function WI(){const{theme:t}=q(),{playerConig:{isCrossFade:e,isEnableBeat:n,lyricSize:r,songBackground:s},updatePlayerConfig:i,audioRef:a,shouldSyncSongDuration:l}=Ye(),{currentSongData:c}=ae(Ve),u=p=>{i({lyricSize:p}),ot("lyricSize",p)},h=()=>{if(!a.current||!(c!=null&&c.song))return;const p=!n,x=a.current.currentTime;ot("current_time",x),l.current=!0,a.current.src=p?c.song.beat_url:c.song.song_url,i({isEnableBeat:p})},f={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:`group/text justify-center !hover:brightness-100 font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative ${t.content_hover_bg}`,itemContainer:"flex justify-between  px-3 py-2 items-center min-h-[30px] hover:bg-[#fff]/5",text:"text-sm"};return o.jsx(o.Fragment,{children:o.jsx("div",{className:"w-[240px] sm:w-[220px]",children:o.jsxs(Qs,{p:"clear",className:"text-white py-3",theme:t,children:[o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Lyric size"}),o.jsxs("div",{className:"flex space-x-[8px]",children:[o.jsx(le,{onClick:()=>u("small"),variant:"circle",size:"clear",className:`${r==="small"?t.content_bg:f.disableBtn} ${f.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),o.jsx(le,{onClick:()=>u("medium"),variant:"circle",size:"clear",className:`${r==="medium"?t.content_bg:f.disableBtn} ${f.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),o.jsx(le,{onClick:()=>u("large"),variant:"circle",size:"clear",className:`${r==="large"?t.content_bg:f.disableBtn} ${f.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Song background"}),o.jsx(sh,{size:"thin",active:s,cb:()=>i({songBackground:!s})})]}),(c==null?void 0:c.song.beat_url)&&o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Song beat"}),o.jsx(sh,{size:"thin",active:n,cb:h})]}),o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Cross fade"}),o.jsx(sh,{size:"thin",active:e,cb:()=>i({isCrossFade:!e})})]})]})})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},u6=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},GI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,x=u&63;c||(x=64,a||(p=64)),r.push(n[h],n[f],n[p],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(qI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):u6(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||f==null)throw new d6;const p=i<<2|l>>4;if(r.push(p),u!==64){const x=l<<4&240|u>>2;if(r.push(x),f!==64){const v=u<<6&192|f;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class d6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const h6=function(t){const e=qI(t);return GI.encodeByteArray(e,!0)},Xh=function(t){return h6(t).replace(/\./g,"")},QI=function(t){try{return GI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6=()=>f6().__FIREBASE_DEFAULTS__,p6=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},g6=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&QI(t[1]);return e&&JSON.parse(e)},dm=()=>{try{return m6()||p6()||g6()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},KI=t=>{var e,n;return(n=(e=dm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},XI=t=>{const e=KI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},YI=()=>{var t;return(t=dm())===null||t===void 0?void 0:t.config},JI=t=>{var e;return(e=dm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[Xh(JSON.stringify(n)),Xh(JSON.stringify(a)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function y6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sn())}function v6(){var t;const e=(t=dm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function w6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _6(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function b6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function S6(){const t=sn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function E6(){return!v6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k6(){try{return typeof indexedDB=="object"}catch{return!1}}function T6(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I6="FirebaseError";class ms extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=I6,Object.setPrototypeOf(this,ms.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_u.prototype.create)}}class _u{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?C6(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new ms(s,l,r)}}function C6(t,e){return t.replace(R6,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const R6=/\{\$([^}]+)}/g;function j6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Yh(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(Db(i)&&Db(a)){if(!Yh(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Db(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function A6(t,e){const n=new N6(t,e);return n.subscribe.bind(n)}class N6{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");P6(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=eg),s.error===void 0&&(s.error=eg),s.complete===void 0&&(s.complete=eg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function P6(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function eg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Je(t){return t&&t._delegate?t._delegate:t}class Di{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new x6;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(L6(e))try{this.getOrInitializeService({instanceIdentifier:aa})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=aa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=aa){return this.instances.has(e)}getOptions(e=aa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:D6(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=aa){return this.component?this.component.multipleInstances?e:aa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function D6(t){return t===aa?void 0:t}function L6(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new F6(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ke||(ke={}));const O6={debug:ke.DEBUG,verbose:ke.VERBOSE,info:ke.INFO,warn:ke.WARN,error:ke.ERROR,silent:ke.SILENT},$6=ke.INFO,B6={[ke.DEBUG]:"log",[ke.VERBOSE]:"log",[ke.INFO]:"info",[ke.WARN]:"warn",[ke.ERROR]:"error"},z6=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=B6[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class iv{constructor(e){this.name=e,this._logLevel=$6,this._logHandler=z6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?O6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ke.DEBUG,...e),this._logHandler(this,ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ke.VERBOSE,...e),this._logHandler(this,ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ke.INFO,...e),this._logHandler(this,ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ke.WARN,...e),this._logHandler(this,ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ke.ERROR,...e),this._logHandler(this,ke.ERROR,...e)}}const U6=(t,e)=>e.some(n=>t instanceof n);let Lb,Mb;function V6(){return Lb||(Lb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function H6(){return Mb||(Mb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eC=new WeakMap,H0=new WeakMap,tC=new WeakMap,tg=new WeakMap,av=new WeakMap;function W6(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Ri(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&eC.set(n,t)}).catch(()=>{}),av.set(e,t),e}function q6(t){if(H0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});H0.set(t,e)}let W0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return H0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||tC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ri(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function G6(t){W0=t(W0)}function Q6(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ng(this),e,...n);return tC.set(r,e.sort?e.sort():[e]),Ri(r)}:H6().includes(t)?function(...e){return t.apply(ng(this),e),Ri(eC.get(this))}:function(...e){return Ri(t.apply(ng(this),e))}}function K6(t){return typeof t=="function"?Q6(t):(t instanceof IDBTransaction&&q6(t),U6(t,V6())?new Proxy(t,W0):t)}function Ri(t){if(t instanceof IDBRequest)return W6(t);if(tg.has(t))return tg.get(t);const e=K6(t);return e!==t&&(tg.set(t,e),av.set(e,t)),e}const ng=t=>av.get(t);function X6(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Ri(a);return r&&a.addEventListener("upgradeneeded",c=>{r(Ri(a.result),c.oldVersion,c.newVersion,Ri(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Y6=["get","getKey","getAll","getAllKeys","count"],J6=["put","add","delete","clear"],rg=new Map;function Ob(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rg.get(e))return rg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=J6.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Y6.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return rg.set(e,i),i}G6(t=>({...t,get:(e,n,r)=>Ob(e,n)||t.get(e,n,r),has:(e,n)=>!!Ob(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(e9(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function e9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const q0="@firebase/app",$b="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs=new iv("@firebase/app"),t9="@firebase/app-compat",n9="@firebase/analytics-compat",r9="@firebase/analytics",s9="@firebase/app-check-compat",i9="@firebase/app-check",a9="@firebase/auth",o9="@firebase/auth-compat",l9="@firebase/database",c9="@firebase/data-connect",u9="@firebase/database-compat",d9="@firebase/functions",h9="@firebase/functions-compat",f9="@firebase/installations",m9="@firebase/installations-compat",p9="@firebase/messaging",g9="@firebase/messaging-compat",x9="@firebase/performance",y9="@firebase/performance-compat",v9="@firebase/remote-config",w9="@firebase/remote-config-compat",_9="@firebase/storage",b9="@firebase/storage-compat",S9="@firebase/firestore",E9="@firebase/vertexai-preview",k9="@firebase/firestore-compat",T9="firebase",I9="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0="[DEFAULT]",C9={[q0]:"fire-core",[t9]:"fire-core-compat",[r9]:"fire-analytics",[n9]:"fire-analytics-compat",[i9]:"fire-app-check",[s9]:"fire-app-check-compat",[a9]:"fire-auth",[o9]:"fire-auth-compat",[l9]:"fire-rtdb",[c9]:"fire-data-connect",[u9]:"fire-rtdb-compat",[d9]:"fire-fn",[h9]:"fire-fn-compat",[f9]:"fire-iid",[m9]:"fire-iid-compat",[p9]:"fire-fcm",[g9]:"fire-fcm-compat",[x9]:"fire-perf",[y9]:"fire-perf-compat",[v9]:"fire-rc",[w9]:"fire-rc-compat",[_9]:"fire-gcs",[b9]:"fire-gcs-compat",[S9]:"fire-fst",[k9]:"fire-fst-compat",[E9]:"fire-vertex","fire-js":"fire-js",[T9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh=new Map,R9=new Map,Q0=new Map;function Bb(t,e){try{t.container.addComponent(e)}catch(n){Bs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ca(t){const e=t.name;if(Q0.has(e))return Bs.debug(`There were multiple attempts to register component ${e}.`),!1;Q0.set(e,t);for(const n of Jh.values())Bb(n,t);for(const n of R9.values())Bb(n,t);return!0}function hm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Es(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ji=new _u("app","Firebase",j9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ji.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=I9;function nC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:G0,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw ji.create("bad-app-name",{appName:String(s)});if(n||(n=YI()),!n)throw ji.create("no-options");const i=Jh.get(s);if(i){if(Yh(n,i.options)&&Yh(r,i.config))return i;throw ji.create("duplicate-app",{appName:s})}const a=new M6(s);for(const c of Q0.values())a.addComponent(c);const l=new A9(n,r,a);return Jh.set(s,l),l}function ov(t=G0){const e=Jh.get(t);if(!e&&t===G0&&YI())return nC();if(!e)throw ji.create("no-app",{appName:t});return e}function Zr(t,e,n){var r;let s=(r=C9[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bs.warn(l.join(" "));return}Ca(new Di(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N9="firebase-heartbeat-database",P9=1,qc="firebase-heartbeat-store";let sg=null;function rC(){return sg||(sg=X6(N9,P9,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ji.create("idb-open",{originalErrorMessage:t.message})})),sg}async function F9(t){try{const n=(await rC()).transaction(qc),r=await n.objectStore(qc).get(sC(t));return await n.done,r}catch(e){if(e instanceof ms)Bs.warn(e.message);else{const n=ji.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bs.warn(n.message)}}}async function zb(t,e){try{const r=(await rC()).transaction(qc,"readwrite");await r.objectStore(qc).put(e,sC(t)),await r.done}catch(n){if(n instanceof ms)Bs.warn(n.message);else{const r=ji.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Bs.warn(r.message)}}}function sC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=1024,L9=30*24*60*60*1e3;class M9{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $9(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ub();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=L9}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Bs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ub(),{heartbeatsToSend:r,unsentEntries:s}=O9(this._heartbeatsCache.heartbeats),i=Xh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Bs.warn(n),""}}}function Ub(){return new Date().toISOString().substring(0,10)}function O9(t,e=D9){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Vb(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Vb(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class $9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return k6()?T6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await F9(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return zb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return zb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Vb(t){return Xh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B9(t){Ca(new Di("platform-logger",e=>new Z6(e),"PRIVATE")),Ca(new Di("heartbeat",e=>new M9(e),"PRIVATE")),Zr(q0,$b,t),Zr(q0,$b,"esm2017"),Zr("fire-js","")}B9("");function lv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function iC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const z9=iC,aC=new _u("auth","Firebase",iC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zh=new iv("@firebase/auth");function U9(t,...e){Zh.logLevel<=ke.WARN&&Zh.warn(`Auth (${Va}): ${t}`,...e)}function ih(t,...e){Zh.logLevel<=ke.ERROR&&Zh.error(`Auth (${Va}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(t,...e){throw uv(t,...e)}function Lr(t,...e){return uv(t,...e)}function cv(t,e,n){const r=Object.assign(Object.assign({},z9()),{[e]:n});return new _u("auth","Firebase",r).create(e,{appName:t.name})}function xa(t){return cv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function V9(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&ss(t,"argument-error"),cv(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function uv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return aC.create(t,...e)}function se(t,e,...n){if(!t)throw uv(e,...n)}function ks(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ih(e),new Error(e)}function zs(t,e){t||ks(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function H9(){return Hb()==="http:"||Hb()==="https:"}function Hb(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(H9()||_6()||"connection"in navigator)?navigator.onLine:!0}function q9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,n){this.shortDelay=e,this.longDelay=n,zs(n>e,"Short delay should be less than long delay!"),this.isMobile=y6()||b6()}get(){return W9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(t,e){zs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ks("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ks("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ks("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q9=new Su(3e4,6e4);function hv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ll(t,e,n,r,s={}){return lC(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=bu(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return w6()||(u.referrerPolicy="no-referrer"),oC.fetch()(cC(t,t.config.apiHost,n,l),u)})}async function lC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},G9),e);try{const s=new X9(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Sd(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sd(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Sd(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw Sd(t,"user-disabled",a);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw cv(t,h,u);ss(t,h)}}catch(s){if(s instanceof ms)throw s;ss(t,"network-request-failed",{message:String(s)})}}async function K9(t,e,n,r,s={}){const i=await ll(t,e,n,r,s);return"mfaPendingCredential"in i&&ss(t,"multi-factor-auth-required",{_serverResponse:i}),i}function cC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?dv(t.config,s):`${t.config.apiScheme}://${s}`}class X9{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Lr(this.auth,"network-request-failed")),Q9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Sd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Lr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y9(t,e){return ll(t,"POST","/v1/accounts:delete",e)}async function uC(t,e){return ll(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function J9(t,e=!1){const n=Je(t),r=await n.getIdToken(e),s=fv(r);se(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:pc(ig(s.auth_time)),issuedAtTime:pc(ig(s.iat)),expirationTime:pc(ig(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function ig(t){return Number(t)*1e3}function fv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ih("JWT malformed, contained fewer than 3 sections"),null;try{const s=QI(n);return s?JSON.parse(s):(ih("Failed to decode base64 JWT payload"),null)}catch(s){return ih("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Wb(t){const e=fv(t);return se(e,"internal-error"),se(typeof e.exp<"u","internal-error"),se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ms&&Z9(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Z9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=pc(this.lastLoginAt),this.creationTime=pc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Gc(t,uC(n,{idToken:r}));se(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?dC(i.providerUserInfo):[],l=n$(t.providerData,a),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new X0(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function t$(t){const e=Je(t);await ef(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function n$(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function dC(t){return t.map(e=>{var{providerId:n}=e,r=lv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r$(t,e){const n=await lC(t,{},async()=>{const r=bu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=cC(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",oC.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function s$(t,e){return ll(t,"POST","/v2/accounts:revokeToken",hv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){se(e.idToken,"internal-error"),se(typeof e.idToken<"u","internal-error"),se(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){se(e.length!==0,"internal-error");const n=Wb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await r$(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new Co;return r&&(se(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(se(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(se(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Co,this.toJSON())}_performRefresh(){return ks("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(t,e){se(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ts{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=lv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new e$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new X0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Gc(this,this.stsTokenManager.getToken(this.auth,e));return se(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return J9(this,e)}reload(){return t$(this)}_assign(e){this!==e&&(se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ts(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await ef(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Es(this.auth.app))return Promise.reject(xa(this.auth));const e=await this.getIdToken();return await Gc(this,Y9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,l,c,u,h;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,x=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,v=(a=n.photoURL)!==null&&a!==void 0?a:void 0,_=(l=n.tenantId)!==null&&l!==void 0?l:void 0,S=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,E=(u=n.createdAt)!==null&&u!==void 0?u:void 0,w=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:b,emailVerified:I,isAnonymous:F,providerData:D,stsTokenManager:C}=n;se(b&&C,e,"internal-error");const k=Co.fromJSON(this.name,C);se(typeof b=="string",e,"internal-error"),ii(f,e.name),ii(p,e.name),se(typeof I=="boolean",e,"internal-error"),se(typeof F=="boolean",e,"internal-error"),ii(x,e.name),ii(v,e.name),ii(_,e.name),ii(S,e.name),ii(E,e.name),ii(w,e.name);const j=new Ts({uid:b,auth:e,email:p,emailVerified:I,displayName:f,isAnonymous:F,photoURL:v,phoneNumber:x,tenantId:_,stsTokenManager:k,createdAt:E,lastLoginAt:w});return D&&Array.isArray(D)&&(j.providerData=D.map(R=>Object.assign({},R))),S&&(j._redirectEventId=S),j}static async _fromIdTokenResponse(e,n,r=!1){const s=new Co;s.updateFromServerResponse(n);const i=new Ts({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ef(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];se(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?dC(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Co;l.updateFromIdToken(r);const c=new Ts({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new X0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb=new Map;function Is(t){zs(t instanceof Function,"Expected a class definition");let e=qb.get(t);return e?(zs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,qb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}hC.type="NONE";const Gb=hC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(t,e,n){return`firebase:${t}:${e}:${n}`}class Ro{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ah(this.userKey,s.apiKey,i),this.fullPersistenceKey=ah("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ts._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ro(Is(Gb),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Is(Gb);const a=ah(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const h=await u._get(a);if(h){const f=Ts._fromJSON(e,h);u!==i&&(l=f),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Ro(i,e,r):(i=c[0],l&&await i._set(a,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(a)}catch{}})),new Ro(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yC(e))return"Blackberry";if(vC(e))return"Webos";if(mC(e))return"Safari";if((e.includes("chrome/")||pC(e))&&!e.includes("edge/"))return"Chrome";if(xC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function fC(t=sn()){return/firefox\//i.test(t)}function mC(t=sn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pC(t=sn()){return/crios\//i.test(t)}function gC(t=sn()){return/iemobile/i.test(t)}function xC(t=sn()){return/android/i.test(t)}function yC(t=sn()){return/blackberry/i.test(t)}function vC(t=sn()){return/webos/i.test(t)}function mv(t=sn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function i$(t=sn()){var e;return mv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function a$(){return S6()&&document.documentMode===10}function wC(t=sn()){return mv(t)||xC(t)||vC(t)||yC(t)||/windows phone/i.test(t)||gC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _C(t,e=[]){let n;switch(t){case"Browser":n=Qb(sn());break;case"Worker":n=`${Qb(sn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Va}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,l)=>{try{const c=e(i);a(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l$(t,e={}){return ll(t,"GET","/v2/passwordPolicy",hv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c$=6;class u${constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:c$,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Kb(this),this.idTokenSubscription=new Kb(this),this.beforeStateQueue=new o$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Is(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Ro.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await uC(this,{idToken:e}),r=await Ts._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Es(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ef(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=q9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Es(this.app))return Promise.reject(xa(this));const n=e?Je(e):null;return n&&se(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Es(this.app)?Promise.reject(xa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Es(this.app)?Promise.reject(xa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Is(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await l$(this),n=new u$(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new _u("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await s$(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Is(e)||this._popupRedirectResolver;se(n,this,"argument-error"),this.redirectPersistenceManager=await Ro.create(this,[Is(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(se(l,this,"internal-error"),l.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_C(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&U9(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function fm(t){return Je(t)}class Kb{constructor(e){this.auth=e,this.observer=null,this.addObserver=A6(n=>this.observer=n)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function h$(t){pv=t}function f$(t){return pv.loadJS(t)}function m$(){return pv.gapiScript}function p$(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g$(t,e){const n=hm(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Yh(i,e??{}))return s;ss(s,"already-initialized")}return n.initialize({options:e})}function x$(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Is);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function y$(t,e,n){const r=fm(t);se(r._canInitEmulator,r,"emulator-config-failed"),se(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=bC(e),{host:a,port:l}=v$(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${a}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||w$()}function bC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function v$(t){const e=bC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Xb(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Xb(a)}}}function Xb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function w$(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ks("not implemented")}_getIdTokenResponse(e){return ks("not implemented")}_linkToIdToken(e,n){return ks("not implemented")}_getReauthenticationResolver(e){return ks("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jo(t,e){return K9(t,"POST","/v1/accounts:signInWithIdp",hv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _$="http://localhost";class Ra extends SC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ra(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ss("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=lv(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new Ra(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return jo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,jo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,jo(e,n)}buildRequest(){const e={requestUri:_$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu extends gv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di extends Eu{constructor(){super("facebook.com")}static credential(e){return Ra._fromParams({providerId:di.PROVIDER_ID,signInMethod:di.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return di.credentialFromTaggedObject(e)}static credentialFromError(e){return di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return di.credential(e.oauthAccessToken)}catch{return null}}}di.FACEBOOK_SIGN_IN_METHOD="facebook.com";di.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s extends Eu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ra._fromParams({providerId:_s.PROVIDER_ID,signInMethod:_s.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return _s.credentialFromTaggedObject(e)}static credentialFromError(e){return _s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return _s.credential(n,r)}catch{return null}}}_s.GOOGLE_SIGN_IN_METHOD="google.com";_s.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi extends Eu{constructor(){super("github.com")}static credential(e){return Ra._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hi.credential(e.oauthAccessToken)}catch{return null}}}hi.GITHUB_SIGN_IN_METHOD="github.com";hi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi extends Eu{constructor(){super("twitter.com")}static credential(e,n){return Ra._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return fi.credential(n,r)}catch{return null}}}fi.TWITTER_SIGN_IN_METHOD="twitter.com";fi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Ts._fromIdTokenResponse(e,r,s),a=Yb(r);return new Bo({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Yb(r);return new Bo({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Yb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends ms{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,tf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new tf(e,n,r,s)}}function EC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?tf._fromErrorAndOperation(t,i,e,r):i})}async function b$(t,e,n=!1){const r=await Gc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Bo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S$(t,e,n=!1){const{auth:r}=t;if(Es(r.app))return Promise.reject(xa(r));const s="reauthenticate";try{const i=await Gc(t,EC(r,s,e,t),n);se(i.idToken,r,"internal-error");const a=fv(i.idToken);se(a,r,"internal-error");const{sub:l}=a;return se(t.uid===l,r,"user-mismatch"),Bo._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ss(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E$(t,e,n=!1){if(Es(t.app))return Promise.reject(xa(t));const r="signIn",s=await EC(t,r,e),i=await Bo._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function k$(t,e,n,r){return Je(t).onIdTokenChanged(e,n,r)}function T$(t,e,n){return Je(t).beforeAuthStateChanged(e,n)}function I$(t,e,n,r){return Je(t).onAuthStateChanged(e,n,r)}function kC(t){return Je(t).signOut()}const nf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(nf,"1"),this.storage.removeItem(nf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$=1e3,R$=10;class IC extends TC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=wC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);a$()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,R$):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},C$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}IC.type="LOCAL";const j$=IC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC extends TC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}CC.type="SESSION";const RC=CC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new mm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async u=>u(n.origin,i)),c=await A$(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}mm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,c)=>{const u=xv("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(){return window}function P$(t){es().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(){return typeof es().WorkerGlobalScope<"u"&&typeof es().importScripts=="function"}async function F$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function D$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function L$(){return jC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="firebaseLocalStorageDb",M$=1,rf="firebaseLocalStorage",NC="fbase_key";class ku{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function pm(t,e){return t.transaction([rf],e?"readwrite":"readonly").objectStore(rf)}function O$(){const t=indexedDB.deleteDatabase(AC);return new ku(t).toPromise()}function Y0(){const t=indexedDB.open(AC,M$);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(rf,{keyPath:NC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(rf)?e(r):(r.close(),await O$(),e(await Y0()))})})}async function Jb(t,e,n){const r=pm(t,!0).put({[NC]:e,value:n});return new ku(r).toPromise()}async function $$(t,e){const n=pm(t,!1).get(e),r=await new ku(n).toPromise();return r===void 0?null:r.value}function Zb(t,e){const n=pm(t,!0).delete(e);return new ku(n).toPromise()}const B$=800,z$=3;class PC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Y0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>z$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return jC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mm._getInstance(L$()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await F$(),!this.activeServiceWorker)return;this.sender=new N$(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||D$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Y0();return await Jb(e,nf,"1"),await Zb(e,nf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>$$(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Zb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=pm(s,!1).getAll();return new ku(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),B$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}PC.type="LOCAL";const U$=PC;new Su(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(t,e){return e?Is(e):(se(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv extends SC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return jo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return jo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function V$(t){return E$(t.auth,new yv(t),t.bypassAuthState)}function H$(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),S$(n,new yv(t),t.bypassAuthState)}async function W$(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),b$(n,new yv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return V$;case"linkViaPopup":case"linkViaRedirect":return W$;case"reauthViaPopup":case"reauthViaRedirect":return H$;default:ss(this.auth,"internal-error")}}resolve(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q$=new Su(2e3,1e4);async function G$(t,e,n){if(Es(t.app))return Promise.reject(Lr(t,"operation-not-supported-in-this-environment"));const r=fm(t);V9(t,e,gv);const s=FC(r,n);return new fa(r,"signInViaPopup",e,s).executeNotNull()}class fa extends DC{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,fa.currentPopupAction&&fa.currentPopupAction.cancel(),fa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return se(e,this.auth,"internal-error"),e}async onExecution(){zs(this.filter.length===1,"Popup operations only handle one event");const e=xv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,q$.get())};e()}}fa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q$="pendingRedirect",oh=new Map;class K$ extends DC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=oh.get(this.auth._key());if(!e){try{const r=await X$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}oh.set(this.auth._key(),e)}return this.bypassAuthState||oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function X$(t,e){const n=Z$(e),r=J$(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Y$(t,e){oh.set(t._key(),e)}function J$(t){return Is(t._redirectPersistence)}function Z$(t){return ah(Q$,t.config.apiKey,t.name)}async function eB(t,e,n=!1){if(Es(t.app))return Promise.reject(xa(t));const r=fm(t),s=FC(r,e),a=await new K$(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=10*60*1e3;class nB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rB(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!LC(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Lr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tB&&this.cachedEventUids.clear(),this.cachedEventUids.has(eS(e))}saveEventToCache(e){this.cachedEventUids.add(eS(e)),this.lastProcessedEventTime=Date.now()}}function eS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function LC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function rB(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return LC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sB(t,e={}){return ll(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,aB=/^https?/;async function oB(t){if(t.config.emulator)return;const{authorizedDomains:e}=await sB(t);for(const n of e)try{if(lB(n))return}catch{}ss(t,"unauthorized-domain")}function lB(t){const e=K0(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!aB.test(n))return!1;if(iB.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cB=new Su(3e4,6e4);function tS(){const t=es().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function uB(t){return new Promise((e,n)=>{var r,s,i;function a(){tS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tS(),n(Lr(t,"network-request-failed"))},timeout:cB.get()})}if(!((s=(r=es().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=es().gapi)===null||i===void 0)&&i.load)a();else{const l=p$("iframefcb");return es()[l]=()=>{gapi.load?a():n(Lr(t,"network-request-failed"))},f$(`${m$()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw lh=null,e})}let lh=null;function dB(t){return lh=lh||uB(t),lh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hB=new Su(5e3,15e3),fB="__/auth/iframe",mB="emulator/auth/iframe",pB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xB(t){const e=t.config;se(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?dv(e,mB):`https://${t.config.authDomain}/${fB}`,r={apiKey:e.apiKey,appName:t.name,v:Va},s=gB.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${bu(r).slice(1)}`}async function yB(t){const e=await dB(t),n=es().gapi;return se(n,t,"internal-error"),e.open({where:document.body,url:xB(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pB,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=Lr(t,"network-request-failed"),l=es().setTimeout(()=>{i(a)},hB.get());function c(){es().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wB=500,_B=600,bB="_blank",SB="http://localhost";class nS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function EB(t,e,n,r=wB,s=_B){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},vB),{width:r.toString(),height:s.toString(),top:i,left:a}),u=sn().toLowerCase();n&&(l=pC(u)?bB:n),fC(u)&&(e=e||SB,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[x,v])=>`${p}${x}=${v},`,"");if(i$(u)&&l!=="_self")return kB(e||"",l),new nS(null);const f=window.open(e||"",l,h);se(f,t,"popup-blocked");try{f.focus()}catch{}return new nS(f)}function kB(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB="__/auth/handler",IB="emulator/auth/handler",CB=encodeURIComponent("fac");async function rS(t,e,n,r,s,i){se(t.config.authDomain,t,"auth-domain-config-required"),se(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Va,eventId:s};if(e instanceof gv){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",j6(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries(i||{}))a[h]=f}if(e instanceof Eu){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${CB}=${encodeURIComponent(c)}`:"";return`${RB(t)}?${bu(l).slice(1)}${u}`}function RB({config:t}){return t.emulator?dv(t,IB):`https://${t.authDomain}/${TB}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="webStorageSupport";class jB{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=RC,this._completeRedirectFn=eB,this._overrideRedirectResult=Y$}async _openPopup(e,n,r,s){var i;zs((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await rS(e,n,r,K0(),s);return EB(e,a,xv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await rS(e,n,r,K0(),s);return P$(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(zs(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await yB(e),r=new nB(e);return n.register("authEvent",s=>(se(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ag,{type:ag},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[ag];a!==void 0&&n(!!a),ss(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=oB(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return wC()||mC()||mv()}}const AB=jB;var sS="@firebase/auth",iS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function FB(t){Ca(new Di("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;se(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_C(t)},u=new d$(r,s,i,c);return x$(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ca(new Di("auth-internal",e=>{const n=fm(e.getProvider("auth").getImmediate());return(r=>new NB(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zr(sS,iS,PB(t)),Zr(sS,iS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB=5*60,LB=JI("authIdTokenMaxAge")||DB;let aS=null;const MB=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>LB)return;const s=n==null?void 0:n.token;aS!==s&&(aS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function OB(t=ov()){const e=hm(t,"auth");if(e.isInitialized())return e.getImmediate();const n=g$(t,{popupRedirectResolver:AB,persistence:[U$,j$,RC]}),r=JI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=MB(i.toString());T$(n,a,()=>a(n.currentUser)),k$(n,l=>a(l))}}const s=KI("auth");return s&&y$(n,`http://${s}`),n}function $B(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}h$({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Lr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",$B().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});FB("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function BB(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(h){try{u(r.next(h))}catch(f){a(f)}}function c(h){try{u(r.throw(h))}catch(f){a(f)}}function u(h){h.done?i(h.value):s(h.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function zB(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(h){return c([u,h])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(h){u=[6,h],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wo=function(){return wo=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},wo.apply(this,arguments)},MC=function(t){return{loading:t==null,value:t}},UB=function(){return function(t,e){switch(e.type){case"error":return wo(wo({},t),{error:e.error,loading:!1,value:void 0});case"reset":return MC(e.defaultValue);case"value":return wo(wo({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},VB=function(t){var e=t?t():void 0,n=m.useReducer(UB(),MC(e)),r=n[0],s=n[1],i=m.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),a=m.useCallback(function(c){s({type:"error",error:c})},[]),l=m.useCallback(function(c){s({type:"value",value:c})},[]);return m.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:a,setValue:l,value:r.value}},[r.error,r.loading,i,a,l,r.value])},vv=function(t,e){var n=VB(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,a=n.setValue,l=n.value;return m.useEffect(function(){var c=I$(t,function(u){return BB(void 0,void 0,void 0,function(){var h;return zB(this,function(f){switch(f.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return f.sent(),[3,4];case 3:return h=f.sent(),i(h),[3,4];case 4:return a(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]},HB="firebase",WB="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zr(HB,WB,"app");var oS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ya,OC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,k){function j(){}j.prototype=k.prototype,C.D=k.prototype,C.prototype=new j,C.prototype.constructor=C,C.C=function(R,N,P){for(var A=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)A[ee-2]=arguments[ee];return k.prototype[N].apply(R,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,k,j){j||(j=0);var R=Array(16);if(typeof k=="string")for(var N=0;16>N;++N)R[N]=k.charCodeAt(j++)|k.charCodeAt(j++)<<8|k.charCodeAt(j++)<<16|k.charCodeAt(j++)<<24;else for(N=0;16>N;++N)R[N]=k[j++]|k[j++]<<8|k[j++]<<16|k[j++]<<24;k=C.g[0],j=C.g[1],N=C.g[2];var P=C.g[3],A=k+(P^j&(N^P))+R[0]+3614090360&4294967295;k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+R[1]+3905402710&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+R[2]+606105819&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+R[3]+3250441966&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(P^j&(N^P))+R[4]+4118548399&4294967295,k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+R[5]+1200080426&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+R[6]+2821735955&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+R[7]+4249261313&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(P^j&(N^P))+R[8]+1770035416&4294967295,k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+R[9]+2336552879&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+R[10]+4294925233&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+R[11]+2304563134&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(P^j&(N^P))+R[12]+1804603682&4294967295,k=j+(A<<7&4294967295|A>>>25),A=P+(N^k&(j^N))+R[13]+4254626195&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(j^P&(k^j))+R[14]+2792965006&4294967295,N=P+(A<<17&4294967295|A>>>15),A=j+(k^N&(P^k))+R[15]+1236535329&4294967295,j=N+(A<<22&4294967295|A>>>10),A=k+(N^P&(j^N))+R[1]+4129170786&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+R[6]+3225465664&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+R[11]+643717713&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+R[0]+3921069994&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(j^N))+R[5]+3593408605&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+R[10]+38016083&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+R[15]+3634488961&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+R[4]+3889429448&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(j^N))+R[9]+568446438&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+R[14]+3275163606&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+R[3]+4107603335&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+R[8]+1163531501&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(j^N))+R[13]+2850285829&4294967295,k=j+(A<<5&4294967295|A>>>27),A=P+(j^N&(k^j))+R[2]+4243563512&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^j&(P^k))+R[7]+1735328473&4294967295,N=P+(A<<14&4294967295|A>>>18),A=j+(P^k&(N^P))+R[12]+2368359562&4294967295,j=N+(A<<20&4294967295|A>>>12),A=k+(j^N^P)+R[5]+4294588738&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+R[8]+2272392833&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+R[11]+1839030562&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+R[14]+4259657740&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(j^N^P)+R[1]+2763975236&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+R[4]+1272893353&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+R[7]+4139469664&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+R[10]+3200236656&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(j^N^P)+R[13]+681279174&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+R[0]+3936430074&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+R[3]+3572445317&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+R[6]+76029189&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(j^N^P)+R[9]+3654602809&4294967295,k=j+(A<<4&4294967295|A>>>28),A=P+(k^j^N)+R[12]+3873151461&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^j)+R[15]+530742520&4294967295,N=P+(A<<16&4294967295|A>>>16),A=j+(N^P^k)+R[2]+3299628645&4294967295,j=N+(A<<23&4294967295|A>>>9),A=k+(N^(j|~P))+R[0]+4096336452&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+R[7]+1126891415&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+R[14]+2878612391&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+R[5]+4237533241&4294967295,j=N+(A<<21&4294967295|A>>>11),A=k+(N^(j|~P))+R[12]+1700485571&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+R[3]+2399980690&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+R[10]+4293915773&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+R[1]+2240044497&4294967295,j=N+(A<<21&4294967295|A>>>11),A=k+(N^(j|~P))+R[8]+1873313359&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+R[15]+4264355552&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+R[6]+2734768916&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+R[13]+1309151649&4294967295,j=N+(A<<21&4294967295|A>>>11),A=k+(N^(j|~P))+R[4]+4149444226&4294967295,k=j+(A<<6&4294967295|A>>>26),A=P+(j^(k|~N))+R[11]+3174756917&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~j))+R[2]+718787259&4294967295,N=P+(A<<15&4294967295|A>>>17),A=j+(P^(N|~k))+R[9]+3951481745&4294967295,C.g[0]=C.g[0]+k&4294967295,C.g[1]=C.g[1]+(N+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+N&4294967295,C.g[3]=C.g[3]+P&4294967295}r.prototype.u=function(C,k){k===void 0&&(k=C.length);for(var j=k-this.blockSize,R=this.B,N=this.h,P=0;P<k;){if(N==0)for(;P<=j;)s(this,C,P),P+=this.blockSize;if(typeof C=="string"){for(;P<k;)if(R[N++]=C.charCodeAt(P++),N==this.blockSize){s(this,R),N=0;break}}else for(;P<k;)if(R[N++]=C[P++],N==this.blockSize){s(this,R),N=0;break}}this.h=N,this.o+=k},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var k=1;k<C.length-8;++k)C[k]=0;var j=8*this.o;for(k=C.length-8;k<C.length;++k)C[k]=j&255,j/=256;for(this.u(C),C=Array(16),k=j=0;4>k;++k)for(var R=0;32>R;R+=8)C[j++]=this.g[k]>>>R&255;return C};function i(C,k){var j=l;return Object.prototype.hasOwnProperty.call(j,C)?j[C]:j[C]=k(C)}function a(C,k){this.h=k;for(var j=[],R=!0,N=C.length-1;0<=N;N--){var P=C[N]|0;R&&P==k||(j[N]=P,R=!1)}this.g=j}var l={};function c(C){return-128<=C&&128>C?i(C,function(k){return new a([k|0],0>k?-1:0)}):new a([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return f;if(0>C)return S(u(-C));for(var k=[],j=1,R=0;C>=j;R++)k[R]=C/j|0,j*=4294967296;return new a(k,0)}function h(C,k){if(C.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(C.charAt(0)=="-")return S(h(C.substring(1),k));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var j=u(Math.pow(k,8)),R=f,N=0;N<C.length;N+=8){var P=Math.min(8,C.length-N),A=parseInt(C.substring(N,N+P),k);8>P?(P=u(Math.pow(k,P)),R=R.j(P).add(u(A))):(R=R.j(j),R=R.add(u(A)))}return R}var f=c(0),p=c(1),x=c(16777216);t=a.prototype,t.m=function(){if(_(this))return-S(this).m();for(var C=0,k=1,j=0;j<this.g.length;j++){var R=this.i(j);C+=(0<=R?R:4294967296+R)*k,k*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(v(this))return"0";if(_(this))return"-"+S(this).toString(C);for(var k=u(Math.pow(C,6)),j=this,R="";;){var N=I(j,k).g;j=E(j,N.j(k));var P=((0<j.g.length?j.g[0]:j.h)>>>0).toString(C);if(j=N,v(j))return P+R;for(;6>P.length;)P="0"+P;R=P+R}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function v(C){if(C.h!=0)return!1;for(var k=0;k<C.g.length;k++)if(C.g[k]!=0)return!1;return!0}function _(C){return C.h==-1}t.l=function(C){return C=E(this,C),_(C)?-1:v(C)?0:1};function S(C){for(var k=C.g.length,j=[],R=0;R<k;R++)j[R]=~C.g[R];return new a(j,~C.h).add(p)}t.abs=function(){return _(this)?S(this):this},t.add=function(C){for(var k=Math.max(this.g.length,C.g.length),j=[],R=0,N=0;N<=k;N++){var P=R+(this.i(N)&65535)+(C.i(N)&65535),A=(P>>>16)+(this.i(N)>>>16)+(C.i(N)>>>16);R=A>>>16,P&=65535,A&=65535,j[N]=A<<16|P}return new a(j,j[j.length-1]&-2147483648?-1:0)};function E(C,k){return C.add(S(k))}t.j=function(C){if(v(this)||v(C))return f;if(_(this))return _(C)?S(this).j(S(C)):S(S(this).j(C));if(_(C))return S(this.j(S(C)));if(0>this.l(x)&&0>C.l(x))return u(this.m()*C.m());for(var k=this.g.length+C.g.length,j=[],R=0;R<2*k;R++)j[R]=0;for(R=0;R<this.g.length;R++)for(var N=0;N<C.g.length;N++){var P=this.i(R)>>>16,A=this.i(R)&65535,ee=C.i(N)>>>16,pe=C.i(N)&65535;j[2*R+2*N]+=A*pe,w(j,2*R+2*N),j[2*R+2*N+1]+=P*pe,w(j,2*R+2*N+1),j[2*R+2*N+1]+=A*ee,w(j,2*R+2*N+1),j[2*R+2*N+2]+=P*ee,w(j,2*R+2*N+2)}for(R=0;R<k;R++)j[R]=j[2*R+1]<<16|j[2*R];for(R=k;R<2*k;R++)j[R]=0;return new a(j,0)};function w(C,k){for(;(C[k]&65535)!=C[k];)C[k+1]+=C[k]>>>16,C[k]&=65535,k++}function b(C,k){this.g=C,this.h=k}function I(C,k){if(v(k))throw Error("division by zero");if(v(C))return new b(f,f);if(_(C))return k=I(S(C),k),new b(S(k.g),S(k.h));if(_(k))return k=I(C,S(k)),new b(S(k.g),k.h);if(30<C.g.length){if(_(C)||_(k))throw Error("slowDivide_ only works with positive integers.");for(var j=p,R=k;0>=R.l(C);)j=F(j),R=F(R);var N=D(j,1),P=D(R,1);for(R=D(R,2),j=D(j,2);!v(R);){var A=P.add(R);0>=A.l(C)&&(N=N.add(j),P=A),R=D(R,1),j=D(j,1)}return k=E(C,N.j(k)),new b(N,k)}for(N=f;0<=C.l(k);){for(j=Math.max(1,Math.floor(C.m()/k.m())),R=Math.ceil(Math.log(j)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),P=u(j),A=P.j(k);_(A)||0<A.l(C);)j-=R,P=u(j),A=P.j(k);v(P)&&(P=p),N=N.add(P),C=E(C,A)}return new b(N,C)}t.A=function(C){return I(this,C).h},t.and=function(C){for(var k=Math.max(this.g.length,C.g.length),j=[],R=0;R<k;R++)j[R]=this.i(R)&C.i(R);return new a(j,this.h&C.h)},t.or=function(C){for(var k=Math.max(this.g.length,C.g.length),j=[],R=0;R<k;R++)j[R]=this.i(R)|C.i(R);return new a(j,this.h|C.h)},t.xor=function(C){for(var k=Math.max(this.g.length,C.g.length),j=[],R=0;R<k;R++)j[R]=this.i(R)^C.i(R);return new a(j,this.h^C.h)};function F(C){for(var k=C.g.length+1,j=[],R=0;R<k;R++)j[R]=C.i(R)<<1|C.i(R-1)>>>31;return new a(j,C.h)}function D(C,k){var j=k>>5;k%=32;for(var R=C.g.length-j,N=[],P=0;P<R;P++)N[P]=0<k?C.i(P+j)>>>k|C.i(P+j+1)<<32-k:C.i(P+j);return new a(N,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,OC=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,ya=a}).apply(typeof oS<"u"?oS:typeof self<"u"?self:typeof window<"u"?window:{});var Ed=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $C,nc,BC,ch,J0,zC,UC,VC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,g,y){return d==Array.prototype||d==Object.prototype||(d[g]=y.value),d};function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ed=="object"&&Ed];for(var g=0;g<d.length;++g){var y=d[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function s(d,g){if(g)e:{var y=r;d=d.split(".");for(var T=0;T<d.length-1;T++){var L=d[T];if(!(L in y))break e;y=y[L]}d=d[d.length-1],T=y[d],g=g(T),g!=T&&g!=null&&e(y,d,{configurable:!0,writable:!0,value:g})}}function i(d,g){d instanceof String&&(d+="");var y=0,T=!1,L={next:function(){if(!T&&y<d.length){var M=y++;return{value:g(M,d[M]),done:!1}}return T=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(d){return d||function(){return i(this,function(g,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(d){var g=typeof d;return g=g!="object"?g:d?Array.isArray(d)?"array":g:"null",g=="array"||g=="object"&&typeof d.length=="number"}function u(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function h(d,g,y){return d.call.apply(d.bind,arguments)}function f(d,g,y){if(!d)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,T),d.apply(g,L)}}return function(){return d.apply(g,arguments)}}function p(d,g,y){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,p.apply(null,arguments)}function x(d,g){var y=Array.prototype.slice.call(arguments,1);return function(){var T=y.slice();return T.push.apply(T,arguments),d.apply(this,T)}}function v(d,g){function y(){}y.prototype=g.prototype,d.aa=g.prototype,d.prototype=new y,d.prototype.constructor=d,d.Qb=function(T,L,M){for(var W=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)W[$e-2]=arguments[$e];return g.prototype[L].apply(T,W)}}function _(d){const g=d.length;if(0<g){const y=Array(g);for(let T=0;T<g;T++)y[T]=d[T];return y}return[]}function S(d,g){for(let y=1;y<arguments.length;y++){const T=arguments[y];if(c(T)){const L=d.length||0,M=T.length||0;d.length=L+M;for(let W=0;W<M;W++)d[L+W]=T[W]}else d.push(T)}}class E{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function w(d){return/^[\s\xa0]*$/.test(d)}function b(){var d=l.navigator;return d&&(d=d.userAgent)?d:""}function I(d){return I[" "](d),d}I[" "]=function(){};var F=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function D(d,g,y){for(const T in d)g.call(y,d[T],T,d)}function C(d,g){for(const y in d)g.call(void 0,d[y],y,d)}function k(d){const g={};for(const y in d)g[y]=d[y];return g}const j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(d,g){let y,T;for(let L=1;L<arguments.length;L++){T=arguments[L];for(y in T)d[y]=T[y];for(let M=0;M<j.length;M++)y=j[M],Object.prototype.hasOwnProperty.call(T,y)&&(d[y]=T[y])}}function N(d){var g=1;d=d.split(":");const y=[];for(;0<g&&d.length;)y.push(d.shift()),g--;return d.length&&y.push(d.join(":")),y}function P(d){l.setTimeout(()=>{throw d},0)}function A(){var d=X;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class ee{constructor(){this.h=this.g=null}add(g,y){const T=pe.get();T.set(g,y),this.h?this.h.next=T:this.g=T,this.h=T}}var pe=new E(()=>new we,d=>d.reset());class we{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let ze,H=!1,X=new ee,te=()=>{const d=l.Promise.resolve(void 0);ze=()=>{d.then(xe)}};var xe=()=>{for(var d;d=A();){try{d.h.call(d.g)}catch(y){P(y)}var g=pe;g.j(d),100>g.h&&(g.h++,d.next=g.g,g.g=d)}H=!1};function Ee(){this.s=this.s,this.C=this.C}Ee.prototype.s=!1,Ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Qe(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}Qe.prototype.h=function(){this.defaultPrevented=!0};var Sr=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};l.addEventListener("test",y,g),l.removeEventListener("test",y,g)}catch{}return d}();function sr(d,g){if(Qe.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var y=this.type=d.type,T=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget){if(F){e:{try{I(g.nodeName);var L=!0;break e}catch{}L=!1}L||(g=null)}}else y=="mouseover"?g=d.fromElement:y=="mouseout"&&(g=d.toElement);this.relatedTarget=g,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ir[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&sr.aa.h.call(this)}}v(sr,Qe);var ir={2:"touch",3:"pen",4:"mouse"};sr.prototype.h=function(){sr.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ln="closure_listenable_"+(1e6*Math.random()|0),zu=0;function Uu(d,g,y,T,L){this.listener=d,this.proxy=null,this.src=g,this.type=y,this.capture=!!T,this.ha=L,this.key=++zu,this.da=this.fa=!1}function Ki(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ye(d){this.src=d,this.g={},this.h=0}ye.prototype.add=function(d,g,y,T,L){var M=d.toString();d=this.g[M],d||(d=this.g[M]=[],this.h++);var W=xt(d,g,T,L);return-1<W?(g=d[W],y||(g.fa=!1)):(g=new Uu(g,this.src,M,!!T,L),g.fa=y,d.push(g)),g};function gt(d,g){var y=g.type;if(y in d.g){var T=d.g[y],L=Array.prototype.indexOf.call(T,g,void 0),M;(M=0<=L)&&Array.prototype.splice.call(T,L,1),M&&(Ki(g),d.g[y].length==0&&(delete d.g[y],d.h--))}}function xt(d,g,y,T){for(var L=0;L<d.length;++L){var M=d[L];if(!M.da&&M.listener==g&&M.capture==!!y&&M.ha==T)return L}return-1}var Mn="closure_lm_"+(1e6*Math.random()|0),_n={};function _l(d,g,y,T,L){if(T&&T.once)return Uw(d,g,y,T,L);if(Array.isArray(g)){for(var M=0;M<g.length;M++)_l(d,g[M],y,T,L);return null}return y=Km(y),d&&d[Ln]?d.K(g,y,u(T)?!!T.capture:!!T,L):zw(d,g,y,!1,T,L)}function zw(d,g,y,T,L,M){if(!g)throw Error("Invalid event type");var W=u(L)?!!L.capture:!!L,$e=Gm(d);if($e||(d[Mn]=$e=new ye(d)),y=$e.add(g,y,T,W,M),y.proxy)return y;if(T=WA(),y.proxy=T,T.src=d,T.listener=y,d.addEventListener)Sr||(L=W),L===void 0&&(L=!1),d.addEventListener(g.toString(),T,L);else if(d.attachEvent)d.attachEvent(Hw(g.toString()),T);else if(d.addListener&&d.removeListener)d.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return y}function WA(){function d(y){return g.call(d.src,d.listener,y)}const g=qA;return d}function Uw(d,g,y,T,L){if(Array.isArray(g)){for(var M=0;M<g.length;M++)Uw(d,g[M],y,T,L);return null}return y=Km(y),d&&d[Ln]?d.L(g,y,u(T)?!!T.capture:!!T,L):zw(d,g,y,!0,T,L)}function Vw(d,g,y,T,L){if(Array.isArray(g))for(var M=0;M<g.length;M++)Vw(d,g[M],y,T,L);else T=u(T)?!!T.capture:!!T,y=Km(y),d&&d[Ln]?(d=d.i,g=String(g).toString(),g in d.g&&(M=d.g[g],y=xt(M,y,T,L),-1<y&&(Ki(M[y]),Array.prototype.splice.call(M,y,1),M.length==0&&(delete d.g[g],d.h--)))):d&&(d=Gm(d))&&(g=d.g[g.toString()],d=-1,g&&(d=xt(g,y,T,L)),(y=-1<d?g[d]:null)&&qm(y))}function qm(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[Ln])gt(g.i,d);else{var y=d.type,T=d.proxy;g.removeEventListener?g.removeEventListener(y,T,d.capture):g.detachEvent?g.detachEvent(Hw(y),T):g.addListener&&g.removeListener&&g.removeListener(T),(y=Gm(g))?(gt(y,d),y.h==0&&(y.src=null,g[Mn]=null)):Ki(d)}}}function Hw(d){return d in _n?_n[d]:_n[d]="on"+d}function qA(d,g){if(d.da)d=!0;else{g=new sr(g,this);var y=d.listener,T=d.ha||d.src;d.fa&&qm(d),d=y.call(T,g)}return d}function Gm(d){return d=d[Mn],d instanceof ye?d:null}var Qm="__closure_events_fn_"+(1e9*Math.random()>>>0);function Km(d){return typeof d=="function"?d:(d[Qm]||(d[Qm]=function(g){return d.handleEvent(g)}),d[Qm])}function Ht(){Ee.call(this),this.i=new ye(this),this.M=this,this.F=null}v(Ht,Ee),Ht.prototype[Ln]=!0,Ht.prototype.removeEventListener=function(d,g,y,T){Vw(this,d,g,y,T)};function on(d,g){var y,T=d.F;if(T)for(y=[];T;T=T.F)y.push(T);if(d=d.M,T=g.type||g,typeof g=="string")g=new Qe(g,d);else if(g instanceof Qe)g.target=g.target||d;else{var L=g;g=new Qe(T,d),R(g,L)}if(L=!0,y)for(var M=y.length-1;0<=M;M--){var W=g.g=y[M];L=Vu(W,T,!0,g)&&L}if(W=g.g=d,L=Vu(W,T,!0,g)&&L,L=Vu(W,T,!1,g)&&L,y)for(M=0;M<y.length;M++)W=g.g=y[M],L=Vu(W,T,!1,g)&&L}Ht.prototype.N=function(){if(Ht.aa.N.call(this),this.i){var d=this.i,g;for(g in d.g){for(var y=d.g[g],T=0;T<y.length;T++)Ki(y[T]);delete d.g[g],d.h--}}this.F=null},Ht.prototype.K=function(d,g,y,T){return this.i.add(String(d),g,!1,y,T)},Ht.prototype.L=function(d,g,y,T){return this.i.add(String(d),g,!0,y,T)};function Vu(d,g,y,T){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();for(var L=!0,M=0;M<g.length;++M){var W=g[M];if(W&&!W.da&&W.capture==y){var $e=W.listener,Pt=W.ha||W.src;W.fa&&gt(d.i,W),L=$e.call(Pt,T)!==!1&&L}}return L&&!T.defaultPrevented}function Ww(d,g,y){if(typeof d=="function")y&&(d=p(d,y));else if(d&&typeof d.handleEvent=="function")d=p(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:l.setTimeout(d,g||0)}function qw(d){d.g=Ww(()=>{d.g=null,d.i&&(d.i=!1,qw(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class GA extends Ee{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:qw(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bl(d){Ee.call(this),this.h=d,this.g={}}v(bl,Ee);var Gw=[];function Qw(d){D(d.g,function(g,y){this.g.hasOwnProperty(y)&&qm(g)},d),d.g={}}bl.prototype.N=function(){bl.aa.N.call(this),Qw(this)},bl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xm=l.JSON.stringify,QA=l.JSON.parse,KA=class{stringify(d){return l.JSON.stringify(d,void 0)}parse(d){return l.JSON.parse(d,void 0)}};function Ym(){}Ym.prototype.h=null;function Kw(d){return d.h||(d.h=d.i())}function Xw(){}var Sl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Jm(){Qe.call(this,"d")}v(Jm,Qe);function Zm(){Qe.call(this,"c")}v(Zm,Qe);var Xi={},Yw=null;function Hu(){return Yw=Yw||new Ht}Xi.La="serverreachability";function Jw(d){Qe.call(this,Xi.La,d)}v(Jw,Qe);function El(d){const g=Hu();on(g,new Jw(g))}Xi.STAT_EVENT="statevent";function Zw(d,g){Qe.call(this,Xi.STAT_EVENT,d),this.stat=g}v(Zw,Qe);function ln(d){const g=Hu();on(g,new Zw(g,d))}Xi.Ma="timingevent";function e1(d,g){Qe.call(this,Xi.Ma,d),this.size=g}v(e1,Qe);function kl(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){d()},g)}function Tl(){this.g=!0}Tl.prototype.xa=function(){this.g=!1};function XA(d,g,y,T,L,M){d.info(function(){if(d.g)if(M)for(var W="",$e=M.split("&"),Pt=0;Pt<$e.length;Pt++){var Ae=$e[Pt].split("=");if(1<Ae.length){var Wt=Ae[0];Ae=Ae[1];var qt=Wt.split("_");W=2<=qt.length&&qt[1]=="type"?W+(Wt+"="+Ae+"&"):W+(Wt+"=redacted&")}}else W=null;else W=M;return"XMLHTTP REQ ("+T+") [attempt "+L+"]: "+g+`
`+y+`
`+W})}function YA(d,g,y,T,L,M,W){d.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+L+"]: "+g+`
`+y+`
`+M+" "+W})}function Ka(d,g,y,T){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+ZA(d,y)+(T?" "+T:"")})}function JA(d,g){d.info(function(){return"TIMEOUT: "+g})}Tl.prototype.info=function(){};function ZA(d,g){if(!d.g)return g;if(!g)return null;try{var y=JSON.parse(g);if(y){for(d=0;d<y.length;d++)if(Array.isArray(y[d])){var T=y[d];if(!(2>T.length)){var L=T[1];if(Array.isArray(L)&&!(1>L.length)){var M=L[0];if(M!="noop"&&M!="stop"&&M!="close")for(var W=1;W<L.length;W++)L[W]=""}}}}return Xm(y)}catch{return g}}var Wu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},t1={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ep;function qu(){}v(qu,Ym),qu.prototype.g=function(){return new XMLHttpRequest},qu.prototype.i=function(){return{}},ep=new qu;function ti(d,g,y,T){this.j=d,this.i=g,this.l=y,this.R=T||1,this.U=new bl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new n1}function n1(){this.i=null,this.g="",this.h=!1}var r1={},tp={};function np(d,g,y){d.L=1,d.v=Xu(ps(g)),d.m=y,d.P=!0,s1(d,null)}function s1(d,g){d.F=Date.now(),Gu(d),d.A=ps(d.v);var y=d.A,T=d.R;Array.isArray(T)||(T=[String(T)]),y1(y.i,"t",T),d.C=0,y=d.j.J,d.h=new n1,d.g=L1(d.j,y?g:null,!d.m),0<d.O&&(d.M=new GA(p(d.Y,d,d.g),d.O)),g=d.U,y=d.g,T=d.ca;var L="readystatechange";Array.isArray(L)||(L&&(Gw[0]=L.toString()),L=Gw);for(var M=0;M<L.length;M++){var W=_l(y,L[M],T||g.handleEvent,!1,g.h||g);if(!W)break;g.g[W.key]=W}g=d.H?k(d.H):{},d.m?(d.u||(d.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,g)):(d.u="GET",d.g.ea(d.A,d.u,null,g)),El(),XA(d.i,d.u,d.A,d.l,d.R,d.m)}ti.prototype.ca=function(d){d=d.target;const g=this.M;g&&gs(d)==3?g.j():this.Y(d)},ti.prototype.Y=function(d){try{if(d==this.g)e:{const qt=gs(this.g);var g=this.g.Ba();const Ja=this.g.Z();if(!(3>qt)&&(qt!=3||this.g&&(this.h.h||this.g.oa()||k1(this.g)))){this.J||qt!=4||g==7||(g==8||0>=Ja?El(3):El(2)),rp(this);var y=this.g.Z();this.X=y;t:if(i1(this)){var T=k1(this.g);d="";var L=T.length,M=gs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Yi(this),Il(this);var W="";break t}this.h.i=new l.TextDecoder}for(g=0;g<L;g++)this.h.h=!0,d+=this.h.i.decode(T[g],{stream:!(M&&g==L-1)});T.length=0,this.h.g+=d,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=y==200,YA(this.i,this.u,this.A,this.l,this.R,qt,y),this.o){if(this.T&&!this.K){t:{if(this.g){var $e,Pt=this.g;if(($e=Pt.g?Pt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w($e)){var Ae=$e;break t}}Ae=null}if(y=Ae)Ka(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,sp(this,y);else{this.o=!1,this.s=3,ln(12),Yi(this),Il(this);break e}}if(this.P){y=!0;let Er;for(;!this.J&&this.C<W.length;)if(Er=eN(this,W),Er==tp){qt==4&&(this.s=4,ln(14),y=!1),Ka(this.i,this.l,null,"[Incomplete Response]");break}else if(Er==r1){this.s=4,ln(15),Ka(this.i,this.l,W,"[Invalid Chunk]"),y=!1;break}else Ka(this.i,this.l,Er,null),sp(this,Er);if(i1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qt!=4||W.length!=0||this.h.h||(this.s=1,ln(16),y=!1),this.o=this.o&&y,!y)Ka(this.i,this.l,W,"[Invalid Chunked Response]"),Yi(this),Il(this);else if(0<W.length&&!this.W){this.W=!0;var Wt=this.j;Wt.g==this&&Wt.ba&&!Wt.M&&(Wt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),up(Wt),Wt.M=!0,ln(11))}}else Ka(this.i,this.l,W,null),sp(this,W);qt==4&&Yi(this),this.o&&!this.J&&(qt==4?N1(this.j,this):(this.o=!1,Gu(this)))}else xN(this.g),y==400&&0<W.indexOf("Unknown SID")?(this.s=3,ln(12)):(this.s=0,ln(13)),Yi(this),Il(this)}}}catch{}finally{}};function i1(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function eN(d,g){var y=d.C,T=g.indexOf(`
`,y);return T==-1?tp:(y=Number(g.substring(y,T)),isNaN(y)?r1:(T+=1,T+y>g.length?tp:(g=g.slice(T,T+y),d.C=T+y,g)))}ti.prototype.cancel=function(){this.J=!0,Yi(this)};function Gu(d){d.S=Date.now()+d.I,a1(d,d.I)}function a1(d,g){if(d.B!=null)throw Error("WatchDog timer not null");d.B=kl(p(d.ba,d),g)}function rp(d){d.B&&(l.clearTimeout(d.B),d.B=null)}ti.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(JA(this.i,this.A),this.L!=2&&(El(),ln(17)),Yi(this),this.s=2,Il(this)):a1(this,this.S-d)};function Il(d){d.j.G==0||d.J||N1(d.j,d)}function Yi(d){rp(d);var g=d.M;g&&typeof g.ma=="function"&&g.ma(),d.M=null,Qw(d.U),d.g&&(g=d.g,d.g=null,g.abort(),g.ma())}function sp(d,g){try{var y=d.j;if(y.G!=0&&(y.g==d||ip(y.h,d))){if(!d.K&&ip(y.h,d)&&y.G==3){try{var T=y.Da.g.parse(g)}catch{T=null}if(Array.isArray(T)&&T.length==3){var L=T;if(L[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<d.F)nd(y),ed(y);else break e;cp(y),ln(18)}}else y.za=L[1],0<y.za-y.T&&37500>L[2]&&y.F&&y.v==0&&!y.C&&(y.C=kl(p(y.Za,y),6e3));if(1>=c1(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Zi(y,11)}else if((d.K||y.g==d)&&nd(y),!w(g))for(L=y.Da.g.parse(g),g=0;g<L.length;g++){let Ae=L[g];if(y.T=Ae[0],Ae=Ae[1],y.G==2)if(Ae[0]=="c"){y.K=Ae[1],y.ia=Ae[2];const Wt=Ae[3];Wt!=null&&(y.la=Wt,y.j.info("VER="+y.la));const qt=Ae[4];qt!=null&&(y.Aa=qt,y.j.info("SVER="+y.Aa));const Ja=Ae[5];Ja!=null&&typeof Ja=="number"&&0<Ja&&(T=1.5*Ja,y.L=T,y.j.info("backChannelRequestTimeoutMs_="+T)),T=y;const Er=d.g;if(Er){const sd=Er.g?Er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sd){var M=T.h;M.g||sd.indexOf("spdy")==-1&&sd.indexOf("quic")==-1&&sd.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(ap(M,M.h),M.h=null))}if(T.D){const dp=Er.g?Er.g.getResponseHeader("X-HTTP-Session-Id"):null;dp&&(T.ya=dp,He(T.I,T.D,dp))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-d.F,y.j.info("Handshake RTT: "+y.R+"ms")),T=y;var W=d;if(T.qa=D1(T,T.J?T.ia:null,T.W),W.K){u1(T.h,W);var $e=W,Pt=T.L;Pt&&($e.I=Pt),$e.B&&(rp($e),Gu($e)),T.g=W}else j1(T);0<y.i.length&&td(y)}else Ae[0]!="stop"&&Ae[0]!="close"||Zi(y,7);else y.G==3&&(Ae[0]=="stop"||Ae[0]=="close"?Ae[0]=="stop"?Zi(y,7):lp(y):Ae[0]!="noop"&&y.l&&y.l.ta(Ae),y.v=0)}}El(4)}catch{}}var tN=class{constructor(d,g){this.g=d,this.map=g}};function o1(d){this.l=d||10,l.PerformanceNavigationTiming?(d=l.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function l1(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function c1(d){return d.h?1:d.g?d.g.size:0}function ip(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function ap(d,g){d.g?d.g.add(g):d.h=g}function u1(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}o1.prototype.cancel=function(){if(this.i=d1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function d1(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const y of d.g.values())g=g.concat(y.D);return g}return _(d.i)}function nN(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(c(d)){for(var g=[],y=d.length,T=0;T<y;T++)g.push(d[T]);return g}g=[],y=0;for(T in d)g[y++]=d[T];return g}function rN(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(c(d)||typeof d=="string"){var g=[];d=d.length;for(var y=0;y<d;y++)g.push(y);return g}g=[],y=0;for(const T in d)g[y++]=T;return g}}}function h1(d,g){if(d.forEach&&typeof d.forEach=="function")d.forEach(g,void 0);else if(c(d)||typeof d=="string")Array.prototype.forEach.call(d,g,void 0);else for(var y=rN(d),T=nN(d),L=T.length,M=0;M<L;M++)g.call(void 0,T[M],y&&y[M],d)}var f1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sN(d,g){if(d){d=d.split("&");for(var y=0;y<d.length;y++){var T=d[y].indexOf("="),L=null;if(0<=T){var M=d[y].substring(0,T);L=d[y].substring(T+1)}else M=d[y];g(M,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Ji(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ji){this.h=d.h,Qu(this,d.j),this.o=d.o,this.g=d.g,Ku(this,d.s),this.l=d.l;var g=d.i,y=new jl;y.i=g.i,g.g&&(y.g=new Map(g.g),y.h=g.h),m1(this,y),this.m=d.m}else d&&(g=String(d).match(f1))?(this.h=!1,Qu(this,g[1]||"",!0),this.o=Cl(g[2]||""),this.g=Cl(g[3]||"",!0),Ku(this,g[4]),this.l=Cl(g[5]||"",!0),m1(this,g[6]||"",!0),this.m=Cl(g[7]||"")):(this.h=!1,this.i=new jl(null,this.h))}Ji.prototype.toString=function(){var d=[],g=this.j;g&&d.push(Rl(g,p1,!0),":");var y=this.g;return(y||g=="file")&&(d.push("//"),(g=this.o)&&d.push(Rl(g,p1,!0),"@"),d.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&d.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(Rl(y,y.charAt(0)=="/"?oN:aN,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",Rl(y,cN)),d.join("")};function ps(d){return new Ji(d)}function Qu(d,g,y){d.j=y?Cl(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function Ku(d,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);d.s=g}else d.s=null}function m1(d,g,y){g instanceof jl?(d.i=g,uN(d.i,d.h)):(y||(g=Rl(g,lN)),d.i=new jl(g,d.h))}function He(d,g,y){d.i.set(g,y)}function Xu(d){return He(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Cl(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Rl(d,g,y){return typeof d=="string"?(d=encodeURI(d).replace(g,iN),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function iN(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var p1=/[#\/\?@]/g,aN=/[#\?:]/g,oN=/[#\?]/g,lN=/[#\?@]/g,cN=/#/g;function jl(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function ni(d){d.g||(d.g=new Map,d.h=0,d.i&&sN(d.i,function(g,y){d.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=jl.prototype,t.add=function(d,g){ni(this),this.i=null,d=Xa(this,d);var y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(g),this.h+=1,this};function g1(d,g){ni(d),g=Xa(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function x1(d,g){return ni(d),g=Xa(d,g),d.g.has(g)}t.forEach=function(d,g){ni(this),this.g.forEach(function(y,T){y.forEach(function(L){d.call(g,L,T,this)},this)},this)},t.na=function(){ni(this);const d=Array.from(this.g.values()),g=Array.from(this.g.keys()),y=[];for(let T=0;T<g.length;T++){const L=d[T];for(let M=0;M<L.length;M++)y.push(g[T])}return y},t.V=function(d){ni(this);let g=[];if(typeof d=="string")x1(this,d)&&(g=g.concat(this.g.get(Xa(this,d))));else{d=Array.from(this.g.values());for(let y=0;y<d.length;y++)g=g.concat(d[y])}return g},t.set=function(d,g){return ni(this),this.i=null,d=Xa(this,d),x1(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},t.get=function(d,g){return d?(d=this.V(d),0<d.length?String(d[0]):g):g};function y1(d,g,y){g1(d,g),0<y.length&&(d.i=null,d.g.set(Xa(d,g),_(y)),d.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(var y=0;y<g.length;y++){var T=g[y];const M=encodeURIComponent(String(T)),W=this.V(T);for(T=0;T<W.length;T++){var L=M;W[T]!==""&&(L+="="+encodeURIComponent(String(W[T]))),d.push(L)}}return this.i=d.join("&")};function Xa(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function uN(d,g){g&&!d.j&&(ni(d),d.i=null,d.g.forEach(function(y,T){var L=T.toLowerCase();T!=L&&(g1(this,T),y1(this,L,y))},d)),d.j=g}function dN(d,g){const y=new Tl;if(l.Image){const T=new Image;T.onload=x(ri,y,"TestLoadImage: loaded",!0,g,T),T.onerror=x(ri,y,"TestLoadImage: error",!1,g,T),T.onabort=x(ri,y,"TestLoadImage: abort",!1,g,T),T.ontimeout=x(ri,y,"TestLoadImage: timeout",!1,g,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=d}else g(!1)}function hN(d,g){const y=new Tl,T=new AbortController,L=setTimeout(()=>{T.abort(),ri(y,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:T.signal}).then(M=>{clearTimeout(L),M.ok?ri(y,"TestPingServer: ok",!0,g):ri(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(L),ri(y,"TestPingServer: error",!1,g)})}function ri(d,g,y,T,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),T(y)}catch{}}function fN(){this.g=new KA}function mN(d,g,y){const T=y||"";try{h1(d,function(L,M){let W=L;u(L)&&(W=Xm(L)),g.push(T+M+"="+encodeURIComponent(W))})}catch(L){throw g.push(T+"type="+encodeURIComponent("_badmap")),L}}function Yu(d){this.l=d.Ub||null,this.j=d.eb||!1}v(Yu,Ym),Yu.prototype.g=function(){return new Ju(this.l,this.j)},Yu.prototype.i=function(d){return function(){return d}}({});function Ju(d,g){Ht.call(this),this.D=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Ju,Ht),t=Ju.prototype,t.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=g,this.readyState=1,Nl(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(g.body=d),(this.D||l).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Al(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Nl(this)),this.g&&(this.readyState=3,Nl(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;v1(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function v1(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?Al(this):Nl(this),this.readyState==3&&v1(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Al(this))},t.Qa=function(d){this.g&&(this.response=d,Al(this))},t.ga=function(){this.g&&Al(this)};function Al(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Nl(d)}t.setRequestHeader=function(d,g){this.u.append(d,g)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=g.next();return d.join(`\r
`)};function Nl(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Ju.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function w1(d){let g="";return D(d,function(y,T){g+=T,g+=":",g+=y,g+=`\r
`}),g}function op(d,g,y){e:{for(T in y){var T=!1;break e}T=!0}T||(y=w1(y),typeof d=="string"?y!=null&&encodeURIComponent(String(y)):He(d,g,y))}function st(d){Ht.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(st,Ht);var pN=/^https?$/i,gN=["POST","PUT"];t=st.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,g,y,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ep.g(),this.v=this.o?Kw(this.o):Kw(ep),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(M){_1(this,M);return}if(d=y||"",y=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var L in T)y.set(L,T[L]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())y.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(y.keys()).find(M=>M.toLowerCase()=="content-type"),L=l.FormData&&d instanceof l.FormData,!(0<=Array.prototype.indexOf.call(gN,g,void 0))||T||L||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,W]of y)this.g.setRequestHeader(M,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{E1(this),this.u=!0,this.g.send(d),this.u=!1}catch(M){_1(this,M)}};function _1(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.m=5,b1(d),Zu(d)}function b1(d){d.A||(d.A=!0,on(d,"complete"),on(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,on(this,"complete"),on(this,"abort"),Zu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zu(this,!0)),st.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?S1(this):this.bb())},t.bb=function(){S1(this)};function S1(d){if(d.h&&typeof a<"u"&&(!d.v[1]||gs(d)!=4||d.Z()!=2)){if(d.u&&gs(d)==4)Ww(d.Ea,0,d);else if(on(d,"readystatechange"),gs(d)==4){d.h=!1;try{const W=d.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var T;if(T=W===0){var L=String(d.D).match(f1)[1]||null;!L&&l.self&&l.self.location&&(L=l.self.location.protocol.slice(0,-1)),T=!pN.test(L?L.toLowerCase():"")}y=T}if(y)on(d,"complete"),on(d,"success");else{d.m=6;try{var M=2<gs(d)?d.g.statusText:""}catch{M=""}d.l=M+" ["+d.Z()+"]",b1(d)}}finally{Zu(d)}}}}function Zu(d,g){if(d.g){E1(d);const y=d.g,T=d.v[0]?()=>{}:null;d.g=null,d.v=null,g||on(d,"ready");try{y.onreadystatechange=T}catch{}}}function E1(d){d.I&&(l.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function gs(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<gs(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),QA(g)}};function k1(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function xN(d){const g={};d=(d.g&&2<=gs(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<d.length;T++){if(w(d[T]))continue;var y=N(d[T]);const L=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const M=g[L]||[];g[L]=M,M.push(y)}C(g,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pl(d,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||g}function T1(d){this.Aa=0,this.i=[],this.j=new Tl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pl("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pl("baseRetryDelayMs",5e3,d),this.cb=Pl("retryDelaySeedMs",1e4,d),this.Wa=Pl("forwardChannelMaxRetries",2,d),this.wa=Pl("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new o1(d&&d.concurrentRequestLimit),this.Da=new fN,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=T1.prototype,t.la=8,t.G=1,t.connect=function(d,g,y,T){ln(0),this.W=d,this.H=g||{},y&&T!==void 0&&(this.H.OSID=y,this.H.OAID=T),this.F=this.X,this.I=D1(this,null,this.W),td(this)};function lp(d){if(I1(d),d.G==3){var g=d.U++,y=ps(d.I);if(He(y,"SID",d.K),He(y,"RID",g),He(y,"TYPE","terminate"),Fl(d,y),g=new ti(d,d.j,g),g.L=2,g.v=Xu(ps(y)),y=!1,l.navigator&&l.navigator.sendBeacon)try{y=l.navigator.sendBeacon(g.v.toString(),"")}catch{}!y&&l.Image&&(new Image().src=g.v,y=!0),y||(g.g=L1(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Gu(g)}F1(d)}function ed(d){d.g&&(up(d),d.g.cancel(),d.g=null)}function I1(d){ed(d),d.u&&(l.clearTimeout(d.u),d.u=null),nd(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&l.clearTimeout(d.s),d.s=null)}function td(d){if(!l1(d.h)&&!d.s){d.s=!0;var g=d.Ga;ze||te(),H||(ze(),H=!0),X.add(g,d),d.B=0}}function yN(d,g){return c1(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=g.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=kl(p(d.Ga,d,g),P1(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const L=new ti(this,this.j,d);let M=this.o;if(this.S&&(M?(M=k(M),R(M,this.S)):M=this.S),this.m!==null||this.O||(L.H=M,M=null),this.P)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var T=this.i[y];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(g+=T,4096<g){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=R1(this,L,g),y=ps(this.I),He(y,"RID",d),He(y,"CVER",22),this.D&&He(y,"X-HTTP-Session-Id",this.D),Fl(this,y),M&&(this.O?g="headers="+encodeURIComponent(String(w1(M)))+"&"+g:this.m&&op(y,this.m,M)),ap(this.h,L),this.Ua&&He(y,"TYPE","init"),this.P?(He(y,"$req",g),He(y,"SID","null"),L.T=!0,np(L,y,null)):np(L,y,g),this.G=2}}else this.G==3&&(d?C1(this,d):this.i.length==0||l1(this.h)||C1(this))};function C1(d,g){var y;g?y=g.l:y=d.U++;const T=ps(d.I);He(T,"SID",d.K),He(T,"RID",y),He(T,"AID",d.T),Fl(d,T),d.m&&d.o&&op(T,d.m,d.o),y=new ti(d,d.j,y,d.B+1),d.m===null&&(y.H=d.o),g&&(d.i=g.D.concat(d.i)),g=R1(d,y,1e3),y.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),ap(d.h,y),np(y,T,g)}function Fl(d,g){d.H&&D(d.H,function(y,T){He(g,T,y)}),d.l&&h1({},function(y,T){He(g,T,y)})}function R1(d,g,y){y=Math.min(d.i.length,y);var T=d.l?p(d.l.Na,d.l,d):null;e:{var L=d.i;let M=-1;for(;;){const W=["count="+y];M==-1?0<y?(M=L[0].g,W.push("ofs="+M)):M=0:W.push("ofs="+M);let $e=!0;for(let Pt=0;Pt<y;Pt++){let Ae=L[Pt].g;const Wt=L[Pt].map;if(Ae-=M,0>Ae)M=Math.max(0,L[Pt].g-100),$e=!1;else try{mN(Wt,W,"req"+Ae+"_")}catch{T&&T(Wt)}}if($e){T=W.join("&");break e}}}return d=d.i.splice(0,y),g.D=d,T}function j1(d){if(!d.g&&!d.u){d.Y=1;var g=d.Fa;ze||te(),H||(ze(),H=!0),X.add(g,d),d.v=0}}function cp(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=kl(p(d.Fa,d),P1(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,A1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=kl(p(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ln(10),ed(this),A1(this))};function up(d){d.A!=null&&(l.clearTimeout(d.A),d.A=null)}function A1(d){d.g=new ti(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var g=ps(d.qa);He(g,"RID","rpc"),He(g,"SID",d.K),He(g,"AID",d.T),He(g,"CI",d.F?"0":"1"),!d.F&&d.ja&&He(g,"TO",d.ja),He(g,"TYPE","xmlhttp"),Fl(d,g),d.m&&d.o&&op(g,d.m,d.o),d.L&&(d.g.I=d.L);var y=d.g;d=d.ia,y.L=1,y.v=Xu(ps(g)),y.m=null,y.P=!0,s1(y,d)}t.Za=function(){this.C!=null&&(this.C=null,ed(this),cp(this),ln(19))};function nd(d){d.C!=null&&(l.clearTimeout(d.C),d.C=null)}function N1(d,g){var y=null;if(d.g==g){nd(d),up(d),d.g=null;var T=2}else if(ip(d.h,g))y=g.D,u1(d.h,g),T=1;else return;if(d.G!=0){if(g.o)if(T==1){y=g.m?g.m.length:0,g=Date.now()-g.F;var L=d.B;T=Hu(),on(T,new e1(T,y)),td(d)}else j1(d);else if(L=g.s,L==3||L==0&&0<g.X||!(T==1&&yN(d,g)||T==2&&cp(d)))switch(y&&0<y.length&&(g=d.h,g.i=g.i.concat(y)),L){case 1:Zi(d,5);break;case 4:Zi(d,10);break;case 3:Zi(d,6);break;default:Zi(d,2)}}}function P1(d,g){let y=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(y*=2),y*g}function Zi(d,g){if(d.j.info("Error code "+g),g==2){var y=p(d.fb,d),T=d.Xa;const L=!T;T=new Ji(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Qu(T,"https"),Xu(T),L?dN(T.toString(),y):hN(T.toString(),y)}else ln(2);d.G=0,d.l&&d.l.sa(g),F1(d),I1(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),ln(2)):(this.j.info("Failed to ping google.com"),ln(1))};function F1(d){if(d.G=0,d.ka=[],d.l){const g=d1(d.h);(g.length!=0||d.i.length!=0)&&(S(d.ka,g),S(d.ka,d.i),d.h.i.length=0,_(d.i),d.i.length=0),d.l.ra()}}function D1(d,g,y){var T=y instanceof Ji?ps(y):new Ji(y);if(T.g!="")g&&(T.g=g+"."+T.g),Ku(T,T.s);else{var L=l.location;T=L.protocol,g=g?g+"."+L.hostname:L.hostname,L=+L.port;var M=new Ji(null);T&&Qu(M,T),g&&(M.g=g),L&&Ku(M,L),y&&(M.l=y),T=M}return y=d.D,g=d.ya,y&&g&&He(T,y,g),He(T,"VER",d.la),Fl(d,T),T}function L1(d,g,y){if(g&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Ca&&!d.pa?new st(new Yu({eb:y})):new st(d.pa),g.Ha(d.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function M1(){}t=M1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function rd(){}rd.prototype.g=function(d,g){return new On(d,g)};function On(d,g){Ht.call(this),this.g=new T1(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(d?d["X-WebChannel-Client-Profile"]=g.va:d={"X-WebChannel-Client-Profile":g.va}),this.g.S=d,(d=g&&g.Sb)&&!w(d)&&(this.g.m=d),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!w(g)&&(this.g.D=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new Ya(this)}v(On,Ht),On.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},On.prototype.close=function(){lp(this.g)},On.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.u&&(y={},y.__data__=Xm(d),d=y);g.i.push(new tN(g.Ya++,d)),g.G==3&&td(g)},On.prototype.N=function(){this.g.l=null,delete this.j,lp(this.g),delete this.g,On.aa.N.call(this)};function O1(d){Jm.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const y in g){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}v(O1,Jm);function $1(){Zm.call(this),this.status=1}v($1,Zm);function Ya(d){this.g=d}v(Ya,M1),Ya.prototype.ua=function(){on(this.g,"a")},Ya.prototype.ta=function(d){on(this.g,new O1(d))},Ya.prototype.sa=function(d){on(this.g,new $1)},Ya.prototype.ra=function(){on(this.g,"b")},rd.prototype.createWebChannel=rd.prototype.g,On.prototype.send=On.prototype.o,On.prototype.open=On.prototype.m,On.prototype.close=On.prototype.close,VC=function(){return new rd},UC=function(){return Hu()},zC=Xi,J0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Wu.NO_ERROR=0,Wu.TIMEOUT=8,Wu.HTTP_ERROR=6,ch=Wu,t1.COMPLETE="complete",BC=t1,Xw.EventType=Sl,Sl.OPEN="a",Sl.CLOSE="b",Sl.ERROR="c",Sl.MESSAGE="d",Ht.prototype.listen=Ht.prototype.K,nc=Xw,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,$C=st}).apply(typeof Ed<"u"?Ed:typeof self<"u"?self:typeof window<"u"?window:{});const lS="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=new iv("@firebase/firestore");function Wl(){return ja.logLevel}function K(t,...e){if(ja.logLevel<=ke.DEBUG){const n=e.map(wv);ja.debug(`Firestore (${cl}): ${t}`,...n)}}function Us(t,...e){if(ja.logLevel<=ke.ERROR){const n=e.map(wv);ja.error(`Firestore (${cl}): ${t}`,...n)}}function zo(t,...e){if(ja.logLevel<=ke.WARN){const n=e.map(wv);ja.warn(`Firestore (${cl}): ${t}`,...n)}}function wv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ie(t="Unexpected state"){const e=`FIRESTORE (${cl}) INTERNAL ASSERTION FAILED: `+t;throw Us(e),new Error(e)}function Le(t,e){t||ie()}function ue(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends ms{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class qB{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}}class GB{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class QB{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Le(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new As;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new As,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new As)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Le(typeof r.accessToken=="string"),new HC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Le(e===null||typeof e=="string"),new Xt(e)}}class KB{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class XB{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new KB(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class YB{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class JB{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Le(this.o===void 0);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,K("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Le(typeof n.token=="string"),this.R=n.token,new YB(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZB(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=ZB(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function Uo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new kt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new oe(e)}static min(){return new oe(new kt(0,0))}static max(){return new oe(new kt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,n,r){n===void 0?n=0:n>e.length&&ie(),r===void 0?r=e.length-n:r>e.length-n&&ie(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Qc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Qc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class qe extends Qc{construct(e,n,r){return new qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new qe(n)}static emptyPath(){return new qe([])}}const ez=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ot extends Qc{construct(e,n,r){return new Ot(e,n,r)}static isValidIdentifier(e){return ez.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ot(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new G(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new G(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new G(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ot(n)}static emptyPath(){return new Ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(qe.fromString(e))}static fromName(e){return new Z(qe.fromString(e).popFirst(5))}static empty(){return new Z(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new qe(e.slice()))}}function tz(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=oe.fromTimestamp(r===1e9?new kt(n+1,0):new kt(n,r));return new Li(s,Z.empty(),e)}function nz(t){return new Li(t.readTime,t.key,-1)}class Li{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Li(oe.min(),Z.empty(),-1)}static max(){return new Li(oe.max(),Z.empty(),-1)}}function rz(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Z.comparator(t.documentKey,e.documentKey),n!==0?n:Ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tu(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==sz)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ie(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},c=>r(c))}),a=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(h=>{a[u]=h,++l,l===i&&r(a)},h=>s(h))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function az(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Iu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}_v.oe=-1;function gm(t){return t==null}function sf(t){return t===0&&1/t==-1/0}function oz(t){return typeof t=="number"&&Number.isInteger(t)&&!sf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ha(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){this.comparator=e,this.root=n||Mt.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Mt.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kd(this.root,e,this.comparator,!1)}getReverseIterator(){return new kd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kd(this.root,e,this.comparator,!0)}}class kd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Mt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Mt.RED,this.left=s??Mt.EMPTY,this.right=i??Mt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Mt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Mt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Mt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ie();const e=this.left.check();if(e!==this.right.check())throw ie();return e+(this.isRed()?0:1)}}Mt.EMPTY=null,Mt.RED=!0,Mt.BLACK=!1;Mt.EMPTY=new class{constructor(){this.size=0}get key(){throw ie()}get value(){throw ie()}get color(){throw ie()}get left(){throw ie()}get right(){throw ie()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Mt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new uS(this.data.getIterator())}getIteratorFrom(e){return new uS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Bt(this.comparator);return n.data=e,n}}class uS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.fields=e,e.sort(Ot.comparator)}static empty(){return new Wn([])}unionWith(e){let n=new Bt(Ot.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Wn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Uo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new GC("Invalid base64 string: "+i):i}}(e);return new Ut(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Ut(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ut.EMPTY_BYTE_STRING=new Ut("");const lz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mi(t){if(Le(!!t),typeof t=="string"){let e=0;const n=lz.exec(t);if(Le(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:dt(t.seconds),nanos:dt(t.nanos)}}function dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Aa(t){return typeof t=="string"?Ut.fromBase64String(t):Ut.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Sv(t){const e=t.mapValue.fields.__previous_value__;return bv(e)?Sv(e):e}function Kc(t){const e=Mi(t.mapValue.fields.__local_write_time__.timestampValue);return new kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cz{constructor(e,n,r,s,i,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Xc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Xc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Xc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Na(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bv(t)?4:dz(t)?9007199254740991:uz(t)?10:11:ie()}function is(t,e){if(t===e)return!0;const n=Na(t);if(n!==Na(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Kc(t).isEqual(Kc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Mi(s.timestampValue),l=Mi(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Aa(s.bytesValue).isEqual(Aa(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return dt(s.geoPointValue.latitude)===dt(i.geoPointValue.latitude)&&dt(s.geoPointValue.longitude)===dt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return dt(s.integerValue)===dt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=dt(s.doubleValue),l=dt(i.doubleValue);return a===l?sf(a)===sf(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return Uo(t.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(cS(a)!==cS(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!is(a[c],l[c])))return!1;return!0}(t,e);default:return ie()}}function Yc(t,e){return(t.values||[]).find(n=>is(n,e))!==void 0}function Vo(t,e){if(t===e)return 0;const n=Na(t),r=Na(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=dt(i.integerValue||i.doubleValue),c=dt(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return dS(t.timestampValue,e.timestampValue);case 4:return dS(Kc(t),Kc(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(i,a){const l=Aa(i),c=Aa(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),c=a.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=Ne(l[u],c[u]);if(h!==0)return h}return Ne(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Ne(dt(i.latitude),dt(a.latitude));return l!==0?l:Ne(dt(i.longitude),dt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return hS(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,c,u,h;const f=i.fields||{},p=a.fields||{},x=(l=f.value)===null||l===void 0?void 0:l.arrayValue,v=(c=p.value)===null||c===void 0?void 0:c.arrayValue,_=Ne(((u=x==null?void 0:x.values)===null||u===void 0?void 0:u.length)||0,((h=v==null?void 0:v.values)===null||h===void 0?void 0:h.length)||0);return _!==0?_:hS(x,v)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Td.mapValue&&a===Td.mapValue)return 0;if(i===Td.mapValue)return 1;if(a===Td.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=a.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const p=Ne(c[f],h[f]);if(p!==0)return p;const x=Vo(l[c[f]],u[h[f]]);if(x!==0)return x}return Ne(c.length,h.length)}(t.mapValue,e.mapValue);default:throw ie()}}function dS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ne(t,e);const n=Mi(t),r=Mi(e),s=Ne(n.seconds,r.seconds);return s!==0?s:Ne(n.nanos,r.nanos)}function hS(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Vo(n[s],r[s]);if(i)return i}return Ne(n.length,r.length)}function Ho(t){return Z0(t)}function Z0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Mi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Aa(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Z.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Z0(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Z0(n.fields[a])}`;return s+"}"}(t.mapValue):ie()}function fS(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ex(t){return!!t&&"integerValue"in t}function Ev(t){return!!t&&"arrayValue"in t}function mS(t){return!!t&&"nullValue"in t}function pS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function uh(t){return!!t&&"mapValue"in t}function uz(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function gc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ha(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=gc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=gc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function dz(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.value=e}static empty(){return new Sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!uh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=gc(n)}setAll(e){let n=Ot.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=gc(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());uh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];uh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ha(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Sn(gc(this.value))}}function QC(t){const e=[];return Ha(t.fields,(n,r)=>{const s=new Ot([n]);if(uh(r)){const i=QC(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Jt(e,0,oe.min(),oe.min(),oe.min(),Sn.empty(),0)}static newFoundDocument(e,n,r,s){return new Jt(e,1,n,oe.min(),r,s,0)}static newNoDocument(e,n){return new Jt(e,2,n,oe.min(),oe.min(),Sn.empty(),0)}static newUnknownDocument(e,n){return new Jt(e,3,n,oe.min(),oe.min(),Sn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Jt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Jt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,n){this.position=e,this.inclusive=n}}function gS(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=Z.comparator(Z.fromName(a.referenceValue),n.key):r=Vo(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function xS(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!is(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n="asc"){this.field=e,this.dir=n}}function hz(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{}class wt extends KC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new mz(e,n,r):n==="array-contains"?new xz(e,r):n==="in"?new yz(e,r):n==="not-in"?new vz(e,r):n==="array-contains-any"?new wz(e,r):new wt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new pz(e,r):new gz(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Vo(n,this.value)):n!==null&&Na(this.value)===Na(n)&&this.matchesComparison(Vo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ie()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Or extends KC{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Or(e,n)}matches(e){return XC(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function XC(t){return t.op==="and"}function YC(t){return fz(t)&&XC(t)}function fz(t){for(const e of t.filters)if(e instanceof Or)return!1;return!0}function tx(t){if(t instanceof wt)return t.field.canonicalString()+t.op.toString()+Ho(t.value);if(YC(t))return t.filters.map(e=>tx(e)).join(",");{const e=t.filters.map(n=>tx(n)).join(",");return`${t.op}(${e})`}}function JC(t,e){return t instanceof wt?function(r,s){return s instanceof wt&&r.op===s.op&&r.field.isEqual(s.field)&&is(r.value,s.value)}(t,e):t instanceof Or?function(r,s){return s instanceof Or&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&JC(a,s.filters[l]),!0):!1}(t,e):void ie()}function ZC(t){return t instanceof wt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ho(n.value)}`}(t):t instanceof Or?function(n){return n.op.toString()+" {"+n.getFilters().map(ZC).join(" ,")+"}"}(t):"Filter"}class mz extends wt{constructor(e,n,r){super(e,n,r),this.key=Z.fromName(r.referenceValue)}matches(e){const n=Z.comparator(e.key,this.key);return this.matchesComparison(n)}}class pz extends wt{constructor(e,n){super(e,"in",n),this.keys=eR("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class gz extends wt{constructor(e,n){super(e,"not-in",n),this.keys=eR("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function eR(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Z.fromName(r.referenceValue))}class xz extends wt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ev(n)&&Yc(n.arrayValue,this.value)}}class yz extends wt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Yc(this.value.arrayValue,n)}}class vz extends wt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Yc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Yc(this.value.arrayValue,n)}}class wz extends wt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ev(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Yc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _z{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function yS(t,e=null,n=[],r=[],s=null,i=null,a=null){return new _z(t,e,n,r,s,i,a)}function kv(t){const e=ue(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>tx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),gm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ho(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ho(r)).join(",")),e.ue=n}return e.ue}function Tv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!hz(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!JC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xS(t.startAt,e.startAt)&&xS(t.endAt,e.endAt)}function nx(t){return Z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function bz(t,e,n,r,s,i,a,l){return new ul(t,e,n,r,s,i,a,l)}function Iv(t){return new ul(t)}function vS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function tR(t){return t.collectionGroup!==null}function xc(t){const e=ue(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Bt(Ot.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Jc(i,r))}),n.has(Ot.keyField().canonicalString())||e.ce.push(new Jc(Ot.keyField(),r))}return e.ce}function ts(t){const e=ue(t);return e.le||(e.le=Sz(e,xc(t))),e.le}function Sz(t,e){if(t.limitType==="F")return yS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Jc(s.field,i)});const n=t.endAt?new af(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new af(t.startAt.position,t.startAt.inclusive):null;return yS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function rx(t,e){const n=t.filters.concat([e]);return new ul(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function of(t,e,n){return new ul(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xm(t,e){return Tv(ts(t),ts(e))&&t.limitType===e.limitType}function nR(t){return`${kv(ts(t))}|lt:${t.limitType}`}function so(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>ZC(s)).join(", ")}]`),gm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ho(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ho(s)).join(",")),`Target(${r})`}(ts(t))}; limitType=${t.limitType})`}function ym(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Z.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of xc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,c){const u=gS(a,l,c);return a.inclusive?u<=0:u<0}(r.startAt,xc(r),s)||r.endAt&&!function(a,l,c){const u=gS(a,l,c);return a.inclusive?u>=0:u>0}(r.endAt,xc(r),s))}(t,e)}function Ez(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function rR(t){return(e,n)=>{let r=!1;for(const s of xc(t)){const i=kz(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function kz(t,e,n){const r=t.field.isKeyField()?Z.comparator(e.key,n.key):function(i,a,l){const c=a.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Vo(c,u):ie()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ie()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ha(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return qC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tz=new rt(Z.comparator);function Vs(){return Tz}const sR=new rt(Z.comparator);function rc(...t){let e=sR;for(const n of t)e=e.insert(n.key,n);return e}function iR(t){let e=sR;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ma(){return yc()}function aR(){return yc()}function yc(){return new dl(t=>t.toString(),(t,e)=>t.isEqual(e))}const Iz=new rt(Z.comparator),Cz=new Bt(Z.comparator);function _e(...t){let e=Cz;for(const n of t)e=e.add(n);return e}const Rz=new Bt(Ne);function jz(){return Rz}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sf(e)?"-0":e}}function oR(t){return{integerValue:""+t}}function lR(t,e){return oz(e)?oR(e):Cv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(){this._=void 0}}function Az(t,e,n){return t instanceof Zc?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&bv(i)&&(i=Sv(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof eu?uR(t,e):t instanceof tu?dR(t,e):function(s,i){const a=cR(s,i),l=wS(a)+wS(s.Pe);return ex(a)&&ex(s.Pe)?oR(l):Cv(s.serializer,l)}(t,e)}function Nz(t,e,n){return t instanceof eu?uR(t,e):t instanceof tu?dR(t,e):n}function cR(t,e){return t instanceof nu?function(r){return ex(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Zc extends vm{}class eu extends vm{constructor(e){super(),this.elements=e}}function uR(t,e){const n=hR(e);for(const r of t.elements)n.some(s=>is(s,r))||n.push(r);return{arrayValue:{values:n}}}class tu extends vm{constructor(e){super(),this.elements=e}}function dR(t,e){let n=hR(e);for(const r of t.elements)n=n.filter(s=>!is(s,r));return{arrayValue:{values:n}}}class nu extends vm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function wS(t){return dt(t.integerValue||t.doubleValue)}function hR(t){return Ev(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,n){this.field=e,this.transform=n}}function Pz(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof eu&&s instanceof eu||r instanceof tu&&s instanceof tu?Uo(r.elements,s.elements,is):r instanceof nu&&s instanceof nu?is(r.Pe,s.Pe):r instanceof Zc&&s instanceof Zc}(t.transform,e.transform)}class Fz{constructor(e,n){this.version=e,this.transformResults=n}}class Cn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Cn}static exists(e){return new Cn(void 0,e)}static updateTime(e){return new Cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wm{}function mR(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _m(t.key,Cn.none()):new Cu(t.key,t.data,Cn.none());{const n=t.data,r=Sn.empty();let s=new Bt(Ot.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Hi(t.key,r,new Wn(s.toArray()),Cn.none())}}function Dz(t,e,n){t instanceof Cu?function(s,i,a){const l=s.value.clone(),c=bS(s.fieldTransforms,i,a.transformResults);l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Hi?function(s,i,a){if(!dh(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=bS(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(pR(s)),c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function vc(t,e,n,r){return t instanceof Cu?function(i,a,l,c){if(!dh(i.precondition,a))return l;const u=i.value.clone(),h=SS(i.fieldTransforms,c,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Hi?function(i,a,l,c){if(!dh(i.precondition,a))return l;const u=SS(i.fieldTransforms,c,a),h=a.data;return h.setAll(pR(i)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,a,l){return dh(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function Lz(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=cR(r.transform,s||null);i!=null&&(n===null&&(n=Sn.empty()),n.set(r.field,i))}return n||null}function _S(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Uo(r,s,(i,a)=>Pz(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Cu extends wm{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Hi extends wm{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function pR(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function bS(t,e,n){const r=new Map;Le(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,Nz(a,l,n[s]))}return r}function SS(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,Az(i,a,e))}return r}class _m extends wm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Mz extends wm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Dz(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=vc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=vc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=aR();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const c=mR(a,l);c!==null&&r.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(oe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),_e())}isEqual(e){return this.batchId===e.batchId&&Uo(this.mutations,e.mutations,(n,r)=>_S(n,r))&&Uo(this.baseMutations,e.baseMutations,(n,r)=>_S(n,r))}}class Rv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Le(e.mutations.length===r.length);let s=function(){return Iz}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Rv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $z{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt,Ie;function zz(t){switch(t){default:return ie();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function gR(t){if(t===void 0)return Us("GRPC error has no .code"),z.UNKNOWN;switch(t){case yt.OK:return z.OK;case yt.CANCELLED:return z.CANCELLED;case yt.UNKNOWN:return z.UNKNOWN;case yt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case yt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case yt.INTERNAL:return z.INTERNAL;case yt.UNAVAILABLE:return z.UNAVAILABLE;case yt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case yt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case yt.NOT_FOUND:return z.NOT_FOUND;case yt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case yt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case yt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case yt.ABORTED:return z.ABORTED;case yt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case yt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case yt.DATA_LOSS:return z.DATA_LOSS;default:return ie()}}(Ie=yt||(yt={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vz=new ya([4294967295,4294967295],0);function ES(t){const e=Uz().encode(t),n=new OC;return n.update(e),new Uint8Array(n.digest())}function kS(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ya([n,r],0),new ya([s,i],0)]}class jv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new sc(`Invalid padding: ${n}`);if(r<0)throw new sc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new sc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ya.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(ya.fromNumber(r)));return s.compare(Vz)===1&&(s=new ya([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=ES(e),[r,s]=kS(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new jv(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=ES(e),[r,s]=kS(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ru.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new bm(oe.min(),s,new rt(Ne),Vs(),_e())}}class Ru{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ru(r,n,_e(),_e(),_e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class xR{constructor(e,n){this.targetId=e,this.me=n}}class yR{constructor(e,n,r=Ut.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class TS{constructor(){this.fe=0,this.ge=CS(),this.pe=Ut.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=_e(),n=_e(),r=_e();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ie()}}),new Ru(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=CS()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Le(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Hz{constructor(e){this.Le=e,this.Be=new Map,this.ke=Vs(),this.qe=IS(),this.Qe=new rt(Ne)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ie()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(nx(i))if(r===0){const a=new Z(i.path);this.Ue(n,a,Jt.newNoDocument(a,oe.min()))}else Le(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),c=l?this.Xe(l,e,a):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=Aa(r).toUint8Array()}catch(c){if(c instanceof GC)return zo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new jv(a,s,i)}catch(c){return zo(c instanceof sc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&nx(l.target)){const c=new Z(l.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,Jt.newNoDocument(c,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=_e();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new bm(e,n,this.Qe,this.ke,r);return this.ke=Vs(),this.qe=IS(),this.Qe=new rt(Ne),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new TS,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Bt(Ne),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new TS),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function IS(){return new rt(Z.comparator)}function CS(){return new rt(Z.comparator)}const Wz=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),qz=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Gz=(()=>({and:"AND",or:"OR"}))();class Qz{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function sx(t,e){return t.useProto3Json||gm(e)?e:{value:e}}function lf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vR(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Kz(t,e){return lf(t,e.toTimestamp())}function ns(t){return Le(!!t),oe.fromTimestamp(function(n){const r=Mi(n);return new kt(r.seconds,r.nanos)}(t))}function Av(t,e){return ix(t,e).canonicalString()}function ix(t,e){const n=function(s){return new qe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function wR(t){const e=qe.fromString(t);return Le(kR(e)),e}function ax(t,e){return Av(t.databaseId,e.path)}function og(t,e){const n=wR(e);if(n.get(1)!==t.databaseId.projectId)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Z(bR(n))}function _R(t,e){return Av(t.databaseId,e)}function Xz(t){const e=wR(t);return e.length===4?qe.emptyPath():bR(e)}function ox(t){return new qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function bR(t){return Le(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function RS(t,e,n){return{name:ax(t,e),fields:n.value.mapValue.fields}}function Yz(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ie()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,h){return u.useProto3Json?(Le(h===void 0||typeof h=="string"),Ut.fromBase64String(h||"")):(Le(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Ut.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(u){const h=u.code===void 0?z.UNKNOWN:gR(u.code);return new G(h,u.message||"")}(a);n=new yR(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=og(t,r.document.name),i=ns(r.document.updateTime),a=r.document.createTime?ns(r.document.createTime):oe.min(),l=new Sn({mapValue:{fields:r.document.fields}}),c=Jt.newFoundDocument(s,i,a,l),u=r.targetIds||[],h=r.removedTargetIds||[];n=new hh(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=og(t,r.document),i=r.readTime?ns(r.readTime):oe.min(),a=Jt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new hh([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=og(t,r.document),i=r.removedTargetIds||[];n=new hh([],i,s,null)}else{if(!("filter"in e))return ie();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new Bz(s,i),l=r.targetId;n=new xR(l,a)}}return n}function Jz(t,e){let n;if(e instanceof Cu)n={update:RS(t,e.key,e.value)};else if(e instanceof _m)n={delete:ax(t,e.key)};else if(e instanceof Hi)n={update:RS(t,e.key,e.data),updateMask:oU(e.fieldMask)};else{if(!(e instanceof Mz))return ie();n={verify:ax(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Zc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof eu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof tu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof nu)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw ie()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Kz(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ie()}(t,e.precondition)),n}function Zz(t,e){return t&&t.length>0?(Le(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?ns(s.updateTime):ns(i);return a.isEqual(oe.min())&&(a=ns(i)),new Fz(a,s.transformResults||[])}(n,e))):[]}function eU(t,e){return{documents:[_R(t,e.path)]}}function tU(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=_R(t,s);const i=function(u){if(u.length!==0)return ER(Or.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(h=>function(p){return{field:io(p.field),direction:sU(p.dir)}}(h))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=sx(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function nU(t){let e=Xz(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Le(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const p=SR(f);return p instanceof Or&&YC(p)?p.getFilters():[p]}(n.where));let a=[];n.orderBy&&(a=function(f){return f.map(p=>function(v){return new Jc(ao(v.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(f){let p;return p=typeof f=="object"?f.value:f,gm(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(f){const p=!!f.before,x=f.values||[];return new af(x,p)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const p=!f.before,x=f.values||[];return new af(x,p)}(n.endAt)),bz(e,s,a,i,l,"F",c,u)}function rU(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ie()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function SR(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ao(n.unaryFilter.field);return wt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ao(n.unaryFilter.field);return wt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ao(n.unaryFilter.field);return wt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ao(n.unaryFilter.field);return wt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ie()}}(t):t.fieldFilter!==void 0?function(n){return wt.create(ao(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ie()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Or.create(n.compositeFilter.filters.map(r=>SR(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ie()}}(n.compositeFilter.op))}(t):ie()}function sU(t){return Wz[t]}function iU(t){return qz[t]}function aU(t){return Gz[t]}function io(t){return{fieldPath:t.canonicalString()}}function ao(t){return Ot.fromServerFormat(t.fieldPath)}function ER(t){return t instanceof wt?function(n){if(n.op==="=="){if(pS(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NAN"}};if(mS(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(pS(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NOT_NAN"}};if(mS(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:io(n.field),op:iU(n.op),value:n.value}}}(t):t instanceof Or?function(n){const r=n.getFilters().map(s=>ER(s));return r.length===1?r[0]:{compositeFilter:{op:aU(n.op),filters:r}}}(t):ie()}function oU(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function kR(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n,r,s,i=oe.min(),a=oe.min(),l=Ut.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new vi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new vi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.ct=e}}function cU(t){const e=nU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?of(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(){this.un=new dU}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Li.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Li.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class dU{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Bt(qe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Bt(qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Wo(0)}static kn(){return new Wo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(){this.changes=new dl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Jt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&vc(r.mutation,s,Wn.empty(),kt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,_e()).next(()=>r))}getLocalViewOfDocuments(e,n,r=_e()){const s=ma();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=rc();return i.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ma();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,_e()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=Vs();const a=yc(),l=function(){return yc()}();return n.forEach((c,u)=>{const h=r.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof Hi)?i=i.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),vc(h.mutation,u,h.mutation.getFieldMask(),kt.now())):a.set(u.key,Wn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,h)=>a.set(u,h)),n.forEach((u,h)=>{var f;return l.set(u,new fU(h,(f=a.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const r=yc();let s=new rt((a,l)=>a-l),i=_e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let h=r.get(c)||Wn.empty();h=l.applyToLocalView(u,h),r.set(c,h);const f=(s.get(l.batchId)||_e()).add(c);s=s.insert(l.batchId,f)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,f=aR();h.forEach(p=>{if(!i.has(p)){const x=mR(n.get(p),r.get(p));x!==null&&f.set(p,x),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return U.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return Z.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):tR(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(ma());let l=-1,c=i;return a.next(u=>U.forEach(u,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(h)?U.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,_e())).next(h=>({batchId:l,changes:iR(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Z(n)).next(r=>{let s=rc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=rc();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,c=>{const u=function(f,p){return new ul(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(h=>{h.forEach((f,p)=>{a=a.insert(f,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((c,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,Jt.newInvalidDocument(h)))});let l=rc();return a.forEach((c,u)=>{const h=i.get(c);h!==void 0&&vc(h.mutation,u,Wn.empty(),kt.now()),ym(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ns(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:cU(s.bundledQuery),readTime:ns(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(){this.overlays=new rt(Z.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ma();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=ma(),i=n.length+1,a=new Z(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new rt((u,h)=>u-h);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let h=i.get(u.largestBatchId);h===null&&(h=ma(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=ma(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=s)););return U.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new $z(n,r));let i=this.Ir.get(n);i===void 0&&(i=_e(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(){this.sessionToken=Ut.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(){this.Tr=new Bt(Ct.Er),this.dr=new Bt(Ct.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ct(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ct(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Z(new qe([])),r=new Ct(n,e),s=new Ct(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Z(new qe([])),r=new Ct(n,e),s=new Ct(n,e+1);let i=_e();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Ct(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ct{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Z.comparator(e.key,n.key)||Ne(e.wr,n.wr)}static Ar(e,n){return Ne(e.wr,n.wr)||Z.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Bt(Ct.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Oz(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new Ct(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(a)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ct(n,0),s=new Ct(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Bt(Ne);return n.forEach(s=>{const i=new Ct(s,0),a=new Ct(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Z.isDocumentKey(i)||(i=i.child(""));const a=new Ct(new Z(i),0);let l=new Bt(Ne);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},a),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Le(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new Ct(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ct(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e){this.Mr=e,this.docs=function(){return new rt(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Jt.newInvalidDocument(n))}getEntries(e,n){let r=Vs();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Jt.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Vs();const a=n.path,l=new Z(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||rz(nz(h),r)<=0||(s.has(h.key)||ym(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ie()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new wU(this)}getSize(e){return U.resolve(this.size)}}class wU extends hU{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e){this.persistence=e,this.Nr=new dl(n=>kv(n),Tv),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Nv,this.targetCount=0,this.kr=Wo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Wo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(e,n){this.qr={},this.overlays={},this.Qr=new _v(0),this.Kr=!1,this.Kr=!0,this.$r=new xU,this.referenceDelegate=e(this),this.Ur=new _U(this),this.indexManager=new uU,this.remoteDocumentCache=function(s){return new vU(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new lU(n),this.Gr=new pU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new gU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new yU(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const s=new SU(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class SU extends iz{constructor(e){super(),this.currentSequenceNumber=e}}class Pv{constructor(e){this.persistence=e,this.Jr=new Nv,this.Yr=null}static Zr(e){return new Pv(e)}get Xr(){if(this.Yr)return this.Yr;throw ie()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=Z.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,oe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=_e(),s=_e();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Fv(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return E6()?8:az(sn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new EU;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Wl()<=ke.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",so(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(Wl()<=ke.DEBUG&&K("QueryEngine","Query:",so(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Wl()<=ke.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",so(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ts(n))):U.resolve())}Yi(e,n){if(vS(n))return U.resolve(null);let r=ts(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=of(n,null,"F"),r=ts(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=_e(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,a,c.readTime)?this.Yi(e,of(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return vS(n)||s.isEqual(oe.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?U.resolve(null):(Wl()<=ke.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),so(n)),this.rs(e,a,n,tz(s,-1)).next(l=>l))})}ts(e,n){let r=new Bt(rR(e));return n.forEach((s,i)=>{ym(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Wl()<=ke.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",so(n)),this.Ji.getDocumentsMatchingQuery(e,n,Li.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new rt(Ne),this._s=new dl(i=>kv(i),Tv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function IU(t,e,n,r){return new TU(t,e,n,r)}async function TR(t,e){const n=ue(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let c=_e();for(const u of s){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of i){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:l}))})})}function CU(t,e){const n=ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,h){const f=u.batch,p=f.keys();let x=U.resolve();return p.forEach(v=>{x=x.next(()=>h.getEntry(c,v)).next(_=>{const S=u.docVersions.get(v);Le(S!==null),_.version.compareTo(S)<0&&(f.applyToRemoteDocument(_,u),_.isValidDocument()&&(_.setReadTime(u.commitVersion),h.addEntry(_)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=_e();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function IR(t){const e=ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function RU(t,e){const n=ue(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((h,f)=>{const p=s.get(f);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,f)));let x=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?x=x.withResumeToken(Ut.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,r)),s=s.insert(f,x),function(_,S,E){return _.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(p,x,h)&&l.push(n.Ur.updateTargetData(i,x))});let c=Vs(),u=_e();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(jU(i,a,e.documentUpdates).next(h=>{c=h.Ps,u=h.Is})),!r.isEqual(oe.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return U.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function jU(t,e,n){let r=_e(),s=_e();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=Vs();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(oe.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):K("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:a,Is:s}})}function AU(t,e){const n=ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function NU(t,e){const n=ue(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new vi(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function lx(t,e,n){const r=ue(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Iu(a))throw a;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function jS(t,e,n){const r=ue(t);let s=oe.min(),i=_e();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,u,h){const f=ue(c),p=f._s.get(h);return p!==void 0?U.resolve(f.os.get(p)):f.Ur.getTargetData(u,h)}(r,a,ts(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:oe.min(),n?i:_e())).next(l=>(PU(r,Ez(e),l),{documents:l,Ts:i})))}function PU(t,e,n){let r=t.us.get(e)||oe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class AS{constructor(){this.activeTargetIds=jz()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class FU{constructor(){this.so=new AS,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new AS,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Id=null;function lg(){return Id===null?Id=function(){return 268435456+Math.round(2147483648*Math.random())}():Id++,"0x"+Id.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kt="WebChannelConnection";class OU extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=lg(),c=this.xo(n,r.toUriEncodedString());K("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,a),this.No(n,c,u,s).then(h=>(K("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw zo("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",c,"request:",s),h})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=LU[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=lg();return new Promise((a,l)=>{const c=new $C;c.setWithCredentials(!0),c.listenOnce(BC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ch.NO_ERROR:const h=c.getResponseJson();K(Kt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),a(h);break;case ch.TIMEOUT:K(Kt,`RPC '${e}' ${i} timed out`),l(new G(z.DEADLINE_EXCEEDED,"Request time out"));break;case ch.HTTP_ERROR:const f=c.getStatus();if(K(Kt,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const x=p==null?void 0:p.error;if(x&&x.status&&x.message){const v=function(S){const E=S.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(E)>=0?E:z.UNKNOWN}(x.status);l(new G(v,x.message))}else l(new G(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new G(z.UNAVAILABLE,"Connection failed."));break;default:ie()}}finally{K(Kt,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);K(Kt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=lg(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=VC(),l=UC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=i.join("");K(Kt,`Creating RPC '${e}' stream ${s}: ${h}`,c);const f=a.createWebChannel(h,c);let p=!1,x=!1;const v=new MU({Io:S=>{x?K(Kt,`Not sending because RPC '${e}' stream ${s} is closed:`,S):(p||(K(Kt,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),K(Kt,`RPC '${e}' stream ${s} sending:`,S),f.send(S))},To:()=>f.close()}),_=(S,E,w)=>{S.listen(E,b=>{try{w(b)}catch(I){setTimeout(()=>{throw I},0)}})};return _(f,nc.EventType.OPEN,()=>{x||(K(Kt,`RPC '${e}' stream ${s} transport opened.`),v.yo())}),_(f,nc.EventType.CLOSE,()=>{x||(x=!0,K(Kt,`RPC '${e}' stream ${s} transport closed`),v.So())}),_(f,nc.EventType.ERROR,S=>{x||(x=!0,zo(Kt,`RPC '${e}' stream ${s} transport errored:`,S),v.So(new G(z.UNAVAILABLE,"The operation could not be completed")))}),_(f,nc.EventType.MESSAGE,S=>{var E;if(!x){const w=S.data[0];Le(!!w);const b=w,I=b.error||((E=b[0])===null||E===void 0?void 0:E.error);if(I){K(Kt,`RPC '${e}' stream ${s} received error:`,I);const F=I.status;let D=function(j){const R=yt[j];if(R!==void 0)return gR(R)}(F),C=I.message;D===void 0&&(D=z.INTERNAL,C="Unknown error status: "+F+" with message "+I.message),x=!0,v.So(new G(D,C)),f.close()}else K(Kt,`RPC '${e}' stream ${s} received:`,w),v.bo(w)}}),_(l,zC.STAT_EVENT,S=>{S.stat===J0.PROXY?K(Kt,`RPC '${e}' stream ${s} detected buffering proxy`):S.stat===J0.NOPROXY&&K(Kt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function cg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(t){return new Qz(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,n,r,s,i,a,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new CR(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(Us(n.toString()),Us("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new G(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $U extends RR{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=Yz(this.serializer,e),r=function(i){if(!("targetChange"in i))return oe.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?oe.min():a.readTime?ns(a.readTime):oe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=ox(this.serializer),n.addTarget=function(i,a){let l;const c=a.target;if(l=nx(c)?{documents:eU(i,c)}:{query:tU(i,c)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=vR(i,a.resumeToken);const u=sx(i,a.expectedCount);u!==null&&(l.expectedCount=u)}else if(a.snapshotVersion.compareTo(oe.min())>0){l.readTime=lf(i,a.snapshotVersion.toTimestamp());const u=sx(i,a.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=rU(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=ox(this.serializer),n.removeTarget=e,this.a_(n)}}class BU extends RR{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Le(!!e.streamToken),this.lastStreamToken=e.streamToken,Le(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Le(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=Zz(e.writeResults,e.commitTime),r=ns(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=ox(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Jz(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,ix(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,ix(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new G(z.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class UU{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Us(n),this.D_=!1):K("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Wa(this)&&(K("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=ue(c);u.L_.add(4),await ju(u),u.q_.set("Unknown"),u.L_.delete(4),await Em(u)}(this))})}),this.q_=new UU(r,s)}}async function Em(t){if(Wa(t))for(const e of t.B_)await e(!0)}async function ju(t){for(const e of t.B_)await e(!1)}function jR(t,e){const n=ue(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Ov(n)?Mv(n):hl(n).r_()&&Lv(n,e))}function Dv(t,e){const n=ue(t),r=hl(n);n.N_.delete(e),r.r_()&&AR(n,e),n.N_.size===0&&(r.r_()?r.o_():Wa(n)&&n.q_.set("Unknown"))}function Lv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(oe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}hl(t).A_(e)}function AR(t,e){t.Q_.xe(e),hl(t).R_(e)}function Mv(t){t.Q_=new Hz({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),hl(t).start(),t.q_.v_()}function Ov(t){return Wa(t)&&!hl(t).n_()&&t.N_.size>0}function Wa(t){return ue(t).L_.size===0}function NR(t){t.Q_=void 0}async function HU(t){t.q_.set("Online")}async function WU(t){t.N_.forEach((e,n)=>{Lv(t,e)})}async function qU(t,e){NR(t),Ov(t)?(t.q_.M_(e),Mv(t)):t.q_.set("Unknown")}async function GU(t,e,n){if(t.q_.set("Online"),e instanceof yR&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await cf(t,r)}else if(e instanceof hh?t.Q_.Ke(e):e instanceof xR?t.Q_.He(e):t.Q_.We(e),!n.isEqual(oe.min()))try{const r=await IR(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.N_.get(u);h&&i.N_.set(u,h.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,u)=>{const h=i.N_.get(c);if(!h)return;i.N_.set(c,h.withResumeToken(Ut.EMPTY_BYTE_STRING,h.snapshotVersion)),AR(i,c);const f=new vi(h.target,c,u,h.sequenceNumber);Lv(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){K("RemoteStore","Failed to raise snapshot:",r),await cf(t,r)}}async function cf(t,e,n){if(!Iu(e))throw e;t.L_.add(1),await ju(t),t.q_.set("Offline"),n||(n=()=>IR(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Em(t)})}function PR(t,e){return e().catch(n=>cf(t,n,e))}async function km(t){const e=ue(t),n=Oi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;QU(e);)try{const s=await AU(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,KU(e,s)}catch(s){await cf(e,s)}FR(e)&&DR(e)}function QU(t){return Wa(t)&&t.O_.length<10}function KU(t,e){t.O_.push(e);const n=Oi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function FR(t){return Wa(t)&&!Oi(t).n_()&&t.O_.length>0}function DR(t){Oi(t).start()}async function XU(t){Oi(t).p_()}async function YU(t){const e=Oi(t);for(const n of t.O_)e.m_(n.mutations)}async function JU(t,e,n){const r=t.O_.shift(),s=Rv.from(r,e,n);await PR(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await km(t)}async function ZU(t,e){e&&Oi(t).V_&&await async function(r,s){if(function(a){return zz(a)&&a!==z.ABORTED}(s.code)){const i=r.O_.shift();Oi(r).s_(),await PR(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await km(r)}}(t,e),FR(t)&&DR(t)}async function PS(t,e){const n=ue(t);n.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");const r=Wa(n);n.L_.add(3),await ju(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Em(n)}async function e7(t,e){const n=ue(t);e?(n.L_.delete(2),await Em(n)):e||(n.L_.add(2),await ju(n),n.q_.set("Unknown"))}function hl(t){return t.K_||(t.K_=function(n,r,s){const i=ue(n);return i.w_(),new $U(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:HU.bind(null,t),Ro:WU.bind(null,t),mo:qU.bind(null,t),d_:GU.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ov(t)?Mv(t):t.q_.set("Unknown")):(await t.K_.stop(),NR(t))})),t.K_}function Oi(t){return t.U_||(t.U_=function(n,r,s){const i=ue(n);return i.w_(),new BU(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:XU.bind(null,t),mo:ZU.bind(null,t),f_:YU.bind(null,t),g_:JU.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await km(t)):(await t.U_.stop(),t.O_.length>0&&(K("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new As,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new $v(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bv(t,e){if(Us("AsyncQueue",`${e}: ${t}`),Iu(t))return new G(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Z.comparator(n.key,r.key):(n,r)=>Z.comparator(n.key,r.key),this.keyedMap=rc(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new Ao(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ao)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ao;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(){this.W_=new rt(Z.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ie():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class qo{constructor(e,n,r,s,i,a,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new qo(e,n,Ao.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class n7{constructor(){this.queries=DS(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ue(n),i=s.queries;s.queries=DS(),i.forEach((a,l)=>{for(const c of l.j_)c.onError(r)})})(this,new G(z.ABORTED,"Firestore shutting down"))}}function DS(){return new dl(t=>nR(t),xm)}async function LR(t,e){const n=ue(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new t7,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=Bv(a,`Initialization of query '${so(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&zv(n)}async function MR(t,e){const n=ue(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function r7(t,e){const n=ue(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&zv(n)}function s7(t,e,n){const r=ue(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function zv(t){t.Y_.forEach(e=>{e.next()})}var cx,LS;(LS=cx||(cx={})).ea="default",LS.Cache="cache";class OR{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new qo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=qo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==cx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e){this.key=e}}class BR{constructor(e){this.key=e}}class i7{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=_e(),this.mutatedKeys=_e(),this.Aa=rR(e),this.Ra=new Ao(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new FS,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const p=s.get(h),x=ym(this.query,f)?f:null,v=!!p&&this.mutatedKeys.has(p.key),_=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let S=!1;p&&x?p.data.isEqual(x.data)?v!==_&&(r.track({type:3,doc:x}),S=!0):this.ga(p,x)||(r.track({type:2,doc:x}),S=!0,(c&&this.Aa(x,c)>0||u&&this.Aa(x,u)<0)&&(l=!0)):!p&&x?(r.track({type:0,doc:x}),S=!0):p&&!x&&(r.track({type:1,doc:p}),S=!0,(c||u)&&(l=!0)),S&&(x?(a=a.add(x),i=_?i.add(h):i.delete(h)):(a=a.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((h,f)=>function(x,v){const _=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ie()}};return _(x)-_(v)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,a.length!==0||u?{snapshot:new qo(this.query,e.Ra,i,a,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new FS,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=_e(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new BR(r))}),this.da.forEach(r=>{e.has(r)||n.push(new $R(r))}),n}ba(e){this.Ta=e.Ts,this.da=_e();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return qo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class a7{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class o7{constructor(e){this.key=e,this.va=!1}}class l7{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new dl(l=>nR(l),xm),this.Ma=new Map,this.xa=new Set,this.Oa=new rt(Z.comparator),this.Na=new Map,this.La=new Nv,this.Ba={},this.ka=new Map,this.qa=Wo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function c7(t,e,n=!0){const r=qR(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await zR(r,e,n,!0),s}async function u7(t,e){const n=qR(t);await zR(n,e,!0,!1)}async function zR(t,e,n,r){const s=await NU(t.localStore,ts(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await d7(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&jR(t.remoteStore,s),l}async function d7(t,e,n,r,s){t.Ka=(f,p,x)=>async function(_,S,E,w){let b=S.view.ma(E);b.ns&&(b=await jS(_.localStore,S.query,!1).then(({documents:C})=>S.view.ma(C,b)));const I=w&&w.targetChanges.get(S.targetId),F=w&&w.targetMismatches.get(S.targetId)!=null,D=S.view.applyChanges(b,_.isPrimaryClient,I,F);return OS(_,S.targetId,D.wa),D.snapshot}(t,f,p,x);const i=await jS(t.localStore,e,!0),a=new i7(e,i.Ts),l=a.ma(i.documents),c=Ru.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=a.applyChanges(l,t.isPrimaryClient,c);OS(t,n,u.wa);const h=new a7(e,n,a);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function h7(t,e,n){const r=ue(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!xm(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await lx(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Dv(r.remoteStore,s.targetId),ux(r,s.targetId)}).catch(Tu)):(ux(r,s.targetId),await lx(r.localStore,s.targetId,!0))}async function f7(t,e){const n=ue(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Dv(n.remoteStore,r.targetId))}async function m7(t,e,n){const r=_7(t);try{const s=await function(a,l){const c=ue(a),u=kt.now(),h=l.reduce((x,v)=>x.add(v.key),_e());let f,p;return c.persistence.runTransaction("Locally write mutations","readwrite",x=>{let v=Vs(),_=_e();return c.cs.getEntries(x,h).next(S=>{v=S,v.forEach((E,w)=>{w.isValidDocument()||(_=_.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(x,v)).next(S=>{f=S;const E=[];for(const w of l){const b=Lz(w,f.get(w.key).overlayedDocument);b!=null&&E.push(new Hi(w.key,b,QC(b.value.mapValue),Cn.exists(!0)))}return c.mutationQueue.addMutationBatch(x,u,E,l)}).next(S=>{p=S;const E=S.applyToLocalDocumentSet(f,_);return c.documentOverlayCache.saveOverlays(x,S.batchId,E)})}).then(()=>({batchId:p.batchId,changes:iR(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let u=a.Ba[a.currentUser.toKey()];u||(u=new rt(Ne)),u=u.insert(l,c),a.Ba[a.currentUser.toKey()]=u}(r,s.batchId,n),await Au(r,s.changes),await km(r.remoteStore)}catch(s){const i=Bv(s,"Failed to persist write");n.reject(i)}}async function UR(t,e){const n=ue(t);try{const r=await RU(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Le(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Le(a.va):s.removedDocuments.size>0&&(Le(a.va),a.va=!1))}),await Au(n,r,e)}catch(r){await Tu(r)}}function MS(t,e,n){const r=ue(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=ue(a);c.onlineState=l;let u=!1;c.queries.forEach((h,f)=>{for(const p of f.j_)p.Z_(l)&&(u=!0)}),u&&zv(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function p7(t,e,n){const r=ue(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new rt(Z.comparator);a=a.insert(i,Jt.newNoDocument(i,oe.min()));const l=_e().add(i),c=new bm(oe.min(),new Map,new rt(Ne),a,l);await UR(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),Uv(r)}else await lx(r.localStore,e,!1).then(()=>ux(r,e,n)).catch(Tu)}async function g7(t,e){const n=ue(t),r=e.batch.batchId;try{const s=await CU(n.localStore,e);HR(n,r,null),VR(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Au(n,s)}catch(s){await Tu(s)}}async function x7(t,e,n){const r=ue(t);try{const s=await function(a,l){const c=ue(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(Le(f!==null),h=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,e);HR(r,e,n),VR(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Au(r,s)}catch(s){await Tu(s)}}function VR(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function HR(t,e,n){const r=ue(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function ux(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||WR(t,r)})}function WR(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Dv(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Uv(t))}function OS(t,e,n){for(const r of n)r instanceof $R?(t.La.addReference(r.key,e),y7(t,r)):r instanceof BR?(K("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||WR(t,r.key)):ie()}function y7(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(K("SyncEngine","New document in limbo: "+n),t.xa.add(r),Uv(t))}function Uv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Z(qe.fromString(e)),r=t.qa.next();t.Na.set(r,new o7(n)),t.Oa=t.Oa.insert(n,r),jR(t.remoteStore,new vi(ts(Iv(n.path)),r,"TargetPurposeLimboResolution",_v.oe))}}async function Au(t,e,n){const r=ue(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{a.push(r.Ka(c,e,n).then(u=>{var h;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){s.push(u);const f=Fv.Wi(c.targetId,u);i.push(f)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(c,u){const h=ue(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>U.forEach(u,p=>U.forEach(p.$i,x=>h.persistence.referenceDelegate.addReference(f,p.targetId,x)).next(()=>U.forEach(p.Ui,x=>h.persistence.referenceDelegate.removeReference(f,p.targetId,x)))))}catch(f){if(!Iu(f))throw f;K("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const x=h.os.get(p),v=x.snapshotVersion,_=x.withLastLimboFreeSnapshotVersion(v);h.os=h.os.insert(p,_)}}}(r.localStore,i))}async function v7(t,e){const n=ue(t);if(!n.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());const r=await TR(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new G(z.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Au(n,r.hs)}}function w7(t,e){const n=ue(t),r=n.Na.get(e);if(r&&r.va)return _e().add(r.key);{let s=_e();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function qR(t){const e=ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=UR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=w7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p7.bind(null,e),e.Ca.d_=r7.bind(null,e.eventManager),e.Ca.$a=s7.bind(null,e.eventManager),e}function _7(t){const e=ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=g7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=x7.bind(null,e),e}class uf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Sm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return IU(this.persistence,new kU,e.initialUser,this.serializer)}Ga(e){return new bU(Pv.Zr,this.serializer)}Wa(e){return new FU}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uf.provider={build:()=>new uf};class dx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>MS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=v7.bind(null,this.syncEngine),await e7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new n7}()}createDatastore(e){const n=Sm(e.databaseInfo.databaseId),r=function(i){return new OU(i)}(e.databaseInfo);return function(i,a,l,c){return new zU(i,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new VU(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>MS(this.syncEngine,n,0),function(){return NS.D()?new NS:new DU}())}createSyncEngine(e,n){return function(s,i,a,l,c,u,h){const f=new l7(s,i,a,l,c,u);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ue(s);K("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ju(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}dx.provider={build:()=>new dx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Us("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Xt.UNAUTHENTICATED,this.clientId=WC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{K("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(K("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new As;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Bv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ug(t,e){t.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await TR(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $S(t,e){t.asyncQueue.verifyOperationInProgress();const n=await S7(t);K("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>PS(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>PS(e.remoteStore,s)),t._onlineComponents=e}async function S7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K("FirestoreClient","Using user provided OfflineComponentProvider");try{await ug(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;zo("Error using user provided cache. Falling back to memory cache: "+n),await ug(t,new uf)}}else K("FirestoreClient","Using default OfflineComponentProvider"),await ug(t,new uf);return t._offlineComponents}async function QR(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K("FirestoreClient","Using user provided OnlineComponentProvider"),await $S(t,t._uninitializedComponentsProvider._online)):(K("FirestoreClient","Using default OnlineComponentProvider"),await $S(t,new dx))),t._onlineComponents}function E7(t){return QR(t).then(e=>e.syncEngine)}async function KR(t){const e=await QR(t),n=e.eventManager;return n.onListen=c7.bind(null,e.syncEngine),n.onUnlisten=h7.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=u7.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=f7.bind(null,e.syncEngine),n}function k7(t,e,n={}){const r=new As;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,u){const h=new GR({next:p=>{h.Za(),a.enqueueAndForget(()=>MR(i,f));const x=p.docs.has(l);!x&&p.fromCache?u.reject(new G(z.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&p.fromCache&&c&&c.source==="server"?u.reject(new G(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new OR(Iv(l.path),h,{includeMetadataChanges:!0,_a:!0});return LR(i,f)}(await KR(t),t.asyncQueue,e,n,r)),r.promise}function T7(t,e,n={}){const r=new As;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,u){const h=new GR({next:p=>{h.Za(),a.enqueueAndForget(()=>MR(i,f)),p.fromCache&&c.source==="server"?u.reject(new G(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new OR(l,h,{includeMetadataChanges:!0,_a:!0});return LR(i,f)}(await KR(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YR(t,e,n){if(!n)throw new G(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function I7(t,e,n,r){if(e===!0&&r===!0)throw new G(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function zS(t){if(!Z.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function US(t){if(Z.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Tm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ie()}function as(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Tm(t);throw new G(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function C7(t,e){if(e<=0)throw new G(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}I7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=XR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Im{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new VS({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new VS(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new qB;switch(r.type){case"firstParty":return new XB(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=BS.get(n);r&&(K("ComponentProvider","Removing Datastore"),BS.delete(n),r.terminate())}(this),Promise.resolve()}}function R7(t,e,n,r={}){var s;const i=(t=as(t,Im))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Xt.MOCK_USER;else{l=ZI(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new G(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Xt(u)}t._authCredentials=new GB(new HC(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Wi(this.firestore,e,this._query)}}class Rn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ai(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rn(this.firestore,e,this._key)}}class Ai extends Wi{constructor(e,n,r){super(e,n,Iv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rn(this.firestore,null,new Z(e))}withConverter(e){return new Ai(this.firestore,e,this._path)}}function os(t,e,...n){if(t=Je(t),YR("collection","path",e),t instanceof Im){const r=qe.fromString(e,...n);return US(r),new Ai(t,null,r)}{if(!(t instanceof Rn||t instanceof Ai))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return US(r),new Ai(t.firestore,null,r)}}function tn(t,e,...n){if(t=Je(t),arguments.length===1&&(e=WC.newId()),YR("doc","path",e),t instanceof Im){const r=qe.fromString(e,...n);return zS(r),new Rn(t,null,new Z(r))}{if(!(t instanceof Rn||t instanceof Ai))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return zS(r),new Rn(t.firestore,t instanceof Ai?t.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new CR(this,"async_queue_retry"),this.Vu=()=>{const r=cg();r&&K("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=cg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=cg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new As;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Iu(e))throw e;K("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Us("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=$v.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ie()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class qa extends Im{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new HS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new HS(e),this._firestoreClient=void 0,await e}}}function j7(t,e){const n=typeof t=="object"?t:ov(),r=typeof t=="string"?t:e||"(default)",s=hm(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=XI("firestore");i&&R7(s,...i)}return s}function Cm(t){if(t._terminated)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||A7(t),t._firestoreClient}function A7(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,h){return new cz(l,c,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,XR(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new b7(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Go(Ut.fromBase64String(e))}catch(n){throw new G(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Go(Ut.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Ks(){return new fl("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N7=/^__.*__$/;class P7{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Hi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Cu(e,this.data,n,this.fieldTransforms)}}class JR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Hi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ZR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ie()}}class Wv{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Wv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return df(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ZR(this.Cu)&&N7.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class F7{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Sm(e)}Qu(e,n,r,s=!1){return new Wv({Cu:e,methodName:n,qu:r,path:Ot.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rm(t){const e=t._freezeSettings(),n=Sm(t._databaseId);return new F7(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ej(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Qv("Data must be an object, but it was:",a,r);const l=rj(r,a);let c,u;if(i.merge)c=new Wn(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const p=hx(e,f,n);if(!a.contains(p))throw new G(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);ij(h,p)||h.push(p)}c=new Wn(h),u=a.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=a.fieldTransforms;return new P7(new Sn(l),c,u)}class jm extends Nu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jm}}class qv extends Nu{_toFieldTransform(e){return new fR(e.path,new Zc)}isEqual(e){return e instanceof qv}}class Gv extends Nu{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new nu(e.serializer,lR(e.serializer,this.$u));return new fR(e.path,n)}isEqual(e){return e instanceof Gv&&this.$u===e.$u}}function tj(t,e,n,r){const s=t.Qu(1,e,n);Qv("Data must be an object, but it was:",s,r);const i=[],a=Sn.empty();Ha(r,(c,u)=>{const h=Kv(e,c,n);u=Je(u);const f=s.Nu(h);if(u instanceof jm)i.push(h);else{const p=Pu(u,f);p!=null&&(i.push(h),a.set(h,p))}});const l=new Wn(i);return new JR(a,l,s.fieldTransforms)}function nj(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[hx(e,r,n)],c=[s];if(i.length%2!=0)throw new G(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(hx(e,i[p])),c.push(i[p+1]);const u=[],h=Sn.empty();for(let p=l.length-1;p>=0;--p)if(!ij(u,l[p])){const x=l[p];let v=c[p];v=Je(v);const _=a.Nu(x);if(v instanceof jm)u.push(x);else{const S=Pu(v,_);S!=null&&(u.push(x),h.set(x,S))}}const f=new Wn(u);return new JR(h,f,a.fieldTransforms)}function D7(t,e,n,r=!1){return Pu(n,t.Qu(r?4:3,e))}function Pu(t,e){if(sj(t=Je(t)))return Qv("Unsupported field value:",e,t),rj(t,e);if(t instanceof Nu)return function(r,s){if(!ZR(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let c=Pu(l,s.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Je(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return lR(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=kt.fromDate(r);return{timestampValue:lf(s.serializer,i)}}if(r instanceof kt){const i=new kt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lf(s.serializer,i)}}if(r instanceof Vv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Go)return{bytesValue:vR(s.serializer,r._byteString)};if(r instanceof Rn){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Av(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Hv)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Cv(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Tm(r)}`)}(t,e)}function rj(t,e){const n={};return qC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ha(t,(r,s)=>{const i=Pu(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function sj(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof kt||t instanceof Vv||t instanceof Go||t instanceof Rn||t instanceof Nu||t instanceof Hv)}function Qv(t,e,n){if(!sj(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Tm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function hx(t,e,n){if((e=Je(e))instanceof fl)return e._internalPath;if(typeof e=="string")return Kv(t,e);throw df("Field path arguments must be of type string or ",t,!1,void 0,n)}const L7=new RegExp("[~\\*/\\[\\]]");function Kv(t,e,n){if(e.search(L7)>=0)throw df(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fl(...e.split("."))._internalPath}catch{throw df(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function df(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${r}`),a&&(c+=` in document ${s}`),c+=")"),new G(z.INVALID_ARGUMENT,l+t+c)}function ij(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new M7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Am("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class M7 extends aj{data(){return super.data()}}function Am(t,e){return typeof e=="string"?Kv(t,e):e instanceof fl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O7(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xv{}class Yv extends Xv{}function je(t,e,...n){let r=[];e instanceof Xv&&r.push(e),r=r.concat(n),function(i){const a=i.filter(c=>c instanceof Jv).length,l=i.filter(c=>c instanceof Nm).length;if(a>1||a>0&&l>0)throw new G(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Nm extends Yv{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Nm(e,n,r)}_apply(e){const n=this._parse(e);return oj(e._query,n),new Wi(e.firestore,e.converter,rx(e._query,n))}_parse(e){const n=Rm(e.firestore);return function(i,a,l,c,u,h,f){let p;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new G(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){qS(f,h);const x=[];for(const v of f)x.push(WS(c,i,v));p={arrayValue:{values:x}}}else p=WS(c,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||qS(f,h),p=D7(l,a,f,h==="in"||h==="not-in");return wt.create(u,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function J(t,e,n){const r=e,s=Am("where",t);return Nm._create(s,r,n)}class Jv extends Xv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Jv(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Or.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const c of l)oj(a,c),a=rx(a,c)}(e._query,n),new Wi(e.firestore,e.converter,rx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zv extends Yv{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Zv(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jc(i,a)}(e._query,this._field,this._direction);return new Wi(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new ul(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function $i(t,e="asc"){const n=e,r=Am("orderBy",t);return Zv._create(r,n)}class ew extends Yv{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new ew(e,n,r)}_apply(e){return new Wi(e.firestore,e.converter,of(e._query,this._limit,this._limitType))}}function ru(t){return C7("limit",t),ew._create("limit",t,"F")}function WS(t,e,n){if(typeof(n=Je(n))=="string"){if(n==="")throw new G(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tR(e)&&n.indexOf("/")!==-1)throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(qe.fromString(n));if(!Z.isDocumentKey(r))throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fS(t,new Z(r))}if(n instanceof Rn)return fS(t,n._key);throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Tm(n)}.`)}function qS(t,e){if(!Array.isArray(t)||t.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oj(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class $7{convertValue(e,n="none"){switch(Na(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Aa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ie()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ha(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>dt(a.doubleValue));return new Hv(i)}convertGeoPoint(e){return new Vv(dt(e.latitude),dt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Sv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Kc(e));default:return null}}convertTimestamp(e){const n=Mi(e);return new kt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=qe.fromString(e);Le(kR(r));const s=new Xc(r.get(1),r.get(3)),i=new Z(r.popFirst(5));return s.isEqual(n)||Us(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cj extends aj{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new fh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Am("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class fh extends cj{data(e={}){return super.data(e)}}class B7{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ic(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new fh(this._firestore,this._userDataWriter,r.key,r,new ic(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new fh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ic(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new fh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ic(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return l.type!==0&&(u=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),h=a.indexOf(l.doc.key)),{type:z7(l.type),doc:c,oldIndex:u,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function z7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ie()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t){t=as(t,Rn);const e=as(t.firestore,qa);return k7(Cm(e),t._key).then(n=>W7(e,t,n))}class uj extends $7{constructor(e){super(),this.firestore=e}convertBytes(e){return new Go(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Rn(this.firestore,null,n)}}function ml(t){t=as(t,Wi);const e=as(t.firestore,qa),n=Cm(e),r=new uj(e);return O7(t._query),T7(n,t._query).then(s=>new B7(e,r,t,s))}function U7(t,e,n,...r){t=as(t,Rn);const s=as(t.firestore,qa),i=Rm(s);let a;return a=typeof(e=Je(e))=="string"||e instanceof fl?nj(i,"updateDoc",t._key,e,n,r):tj(i,"updateDoc",t._key,e),Pm(s,[a.toMutation(t._key,Cn.exists(!0))])}function V7(t){return Pm(as(t.firestore,qa),[new _m(t._key,Cn.none())])}function H7(t,e){const n=as(t.firestore,qa),r=tn(t),s=lj(t.converter,e);return Pm(n,[ej(Rm(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Cn.exists(!1))]).then(()=>r)}function Pm(t,e){return function(r,s){const i=new As;return r.asyncQueue.enqueueAndForget(async()=>m7(await E7(r),s,i)),i.promise}(Cm(t),e)}function W7(t,e,n){const r=n.docs.get(e._key),s=new uj(t);return new cj(t,s,e._key,r,new ic(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Rm(e)}set(e,n,r){this._verifyNotCommitted();const s=dg(e,this._firestore),i=lj(s.converter,n,r),a=ej(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,Cn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=dg(e,this._firestore);let a;return a=typeof(n=Je(n))=="string"||n instanceof fl?nj(this._dataReader,"WriteBatch.update",i._key,n,r,s):tj(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,Cn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=dg(e,this._firestore);return this._mutations=this._mutations.concat(new _m(n._key,Cn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new G(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function dg(t,e){if((t=Je(t)).firestore!==e)throw new G(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Qo(){return new qv("serverTimestamp")}function tw(t){return new Gv("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(t){return Cm(t=as(t,qa)),new q7(t,e=>Pm(t,e))}(function(e,n=!0){(function(s){cl=s})(Va),Ca(new Di("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new qa(new QB(r.getProvider("auth-internal")),new JB(r.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new G(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xc(u.options.projectId,h)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Zr(lS,"4.7.3",e),Zr(lS,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj="firebasestorage.googleapis.com",hj="storageBucket",G7=2*60*1e3,Q7=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct extends ms{constructor(e,n,r=0){super(hg(e),`Firebase Storage: ${n} (${hg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ct.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return hg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var lt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(lt||(lt={}));function hg(t){return"storage/"+t}function nw(){const t="An unknown error occurred, please check the error payload for server response.";return new ct(lt.UNKNOWN,t)}function K7(t){return new ct(lt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function X7(t){return new ct(lt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Y7(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ct(lt.UNAUTHENTICATED,t)}function J7(){return new ct(lt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Z7(t){return new ct(lt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function e8(){return new ct(lt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function t8(){return new ct(lt.CANCELED,"User canceled the upload/download.")}function n8(t){return new ct(lt.INVALID_URL,"Invalid URL '"+t+"'.")}function r8(t){return new ct(lt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function s8(){return new ct(lt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+hj+"' property when initializing the app?")}function i8(){return new ct(lt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function a8(){return new ct(lt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function o8(t){return new ct(lt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function fx(t){return new ct(lt.INVALID_ARGUMENT,t)}function fj(){return new ct(lt.APP_DELETED,"The Firebase app was deleted.")}function l8(t){return new ct(lt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wc(t,e){return new ct(lt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ql(t){throw new ct(lt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=qn.makeFromUrl(e,n)}catch{return new qn(e,"")}if(r.path==="")return r;throw r8(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+s+a,"i"),c={bucket:1,path:3};function u(I){I.path_=decodeURIComponent(I.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",x=new RegExp(`^https?://${f}/${h}/b/${s}/o${p}`,"i"),v={bucket:1,path:3},_=n===dj?"(?:storage.googleapis.com|storage.cloud.google.com)":n,S="([^?#]*)",E=new RegExp(`^https?://${_}/${s}/${S}`,"i"),b=[{regex:l,indices:c,postModify:i},{regex:x,indices:v,postModify:u},{regex:E,indices:{bucket:1,path:2},postModify:u}];for(let I=0;I<b.length;I++){const F=b[I],D=F.regex.exec(e);if(D){const C=D[F.indices.bucket];let k=D[F.indices.path];k||(k=""),r=new qn(C,k),F.postModify(r);break}}if(r==null)throw n8(e);return r}}class c8{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u8(t,e,n){let r=1,s=null,i=null,a=!1,l=0;function c(){return l===2}let u=!1;function h(...S){u||(u=!0,e.apply(null,S))}function f(S){s=setTimeout(()=>{s=null,t(x,c())},S)}function p(){i&&clearTimeout(i)}function x(S,...E){if(u){p();return}if(S){p(),h.call(null,S,...E);return}if(c()||a){p(),h.call(null,S,...E);return}r<64&&(r*=2);let b;l===1?(l=2,b=0):b=(r+Math.random())*1e3,f(b)}let v=!1;function _(S){v||(v=!0,p(),!u&&(s!==null?(S||(l=2),clearTimeout(s),f(0)):S||(l=1)))}return f(0),i=setTimeout(()=>{a=!0,_(!0)},n),_}function d8(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h8(t){return t!==void 0}function f8(t){return typeof t=="object"&&!Array.isArray(t)}function rw(t){return typeof t=="string"||t instanceof String}function GS(t){return sw()&&t instanceof Blob}function sw(){return typeof Blob<"u"}function QS(t,e,n,r){if(r<e)throw fx(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw fx(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function mj(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var va;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(va||(va={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m8(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e,n,r,s,i,a,l,c,u,h,f,p=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,v)=>{this.resolve_=x,this.reject_=v,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Cd(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const l=i.getErrorCode()===va.NO_ERROR,c=i.getStatus();if(!l||m8(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===va.ABORT;r(!1,new Cd(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new Cd(u,i))})},n=(r,s)=>{const i=this.resolve_,a=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());h8(c)?i(c):i()}catch(c){a(c)}else if(l!==null){const c=nw();c.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,c)):a(c)}else if(s.canceled){const c=this.appDelete_?fj():t8();a(c)}else{const c=e8();a(c)}};this.canceled_?n(!1,new Cd(!1,null,!0)):this.backoffId_=u8(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&d8(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Cd{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function g8(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function x8(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function y8(t,e){e&&(t["X-Firebase-GMPID"]=e)}function v8(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function w8(t,e,n,r,s,i,a=!0){const l=mj(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return y8(u,e),g8(u,n),x8(u,i),v8(u,r),new p8(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _8(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function b8(...t){const e=_8();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(sw())return new Blob(t);throw new ct(lt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function S8(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E8(t){if(typeof atob>"u")throw o8("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class fg{constructor(e,n){this.data=e,this.contentType=n||null}}function k8(t,e){switch(t){case Kr.RAW:return new fg(pj(e));case Kr.BASE64:case Kr.BASE64URL:return new fg(gj(t,e));case Kr.DATA_URL:return new fg(I8(e),C8(e))}throw nw()}function pj(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=t.charCodeAt(++n);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function T8(t){let e;try{e=decodeURIComponent(t)}catch{throw wc(Kr.DATA_URL,"Malformed data URL.")}return pj(e)}function gj(t,e){switch(t){case Kr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw wc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Kr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw wc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=E8(e)}catch(s){throw s.message.includes("polyfill")?s:wc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class xj{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw wc(Kr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=R8(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function I8(t){const e=new xj(t);return e.base64?gj(Kr.BASE64,e.rest):T8(e.rest)}function C8(t){return new xj(t).contentType}function R8(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,n){let r=0,s="";GS(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(GS(this.data_)){const r=this.data_,s=S8(r,e,n);return s===null?null:new mi(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new mi(r,!0)}}static getBlob(...e){if(sw()){const n=e.map(r=>r instanceof mi?r.data_:r);return new mi(b8.apply(null,n))}else{const n=e.map(a=>rw(a)?k8(Kr.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(a=>{for(let l=0;l<a.length;l++)s[i++]=a[l]}),new mi(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yj(t){let e;try{e=JSON.parse(t)}catch{return null}return f8(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j8(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function A8(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function vj(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N8(t,e){return e}class cn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||N8}}let Rd=null;function P8(t){return!rw(t)||t.length<2?t:vj(t)}function wj(){if(Rd)return Rd;const t=[];t.push(new cn("bucket")),t.push(new cn("generation")),t.push(new cn("metageneration")),t.push(new cn("name","fullPath",!0));function e(i,a){return P8(a)}const n=new cn("name");n.xform=e,t.push(n);function r(i,a){return a!==void 0?Number(a):a}const s=new cn("size");return s.xform=r,t.push(s),t.push(new cn("timeCreated")),t.push(new cn("updated")),t.push(new cn("md5Hash",null,!0)),t.push(new cn("cacheControl",null,!0)),t.push(new cn("contentDisposition",null,!0)),t.push(new cn("contentEncoding",null,!0)),t.push(new cn("contentLanguage",null,!0)),t.push(new cn("contentType",null,!0)),t.push(new cn("metadata","customMetadata",!0)),Rd=t,Rd}function F8(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new qn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function D8(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const a=n[i];r[a.local]=a.xform(r,e[a.server])}return F8(r,t),r}function _j(t,e,n){const r=yj(e);return r===null?null:D8(t,r,n)}function L8(t,e,n,r){const s=yj(e);if(s===null||!rw(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(u=>{const h=t.bucket,f=t.fullPath,p="/b/"+a(h)+"/o/"+a(f),x=Fm(p,n,r),v=mj({alt:"media",token:u});return x+v})[0]}function M8(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class iw{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(t){if(!t)throw nw()}function O8(t,e){function n(r,s){const i=_j(t,s,e);return bj(i!==null),i}return n}function $8(t,e){function n(r,s){const i=_j(t,s,e);return bj(i!==null),L8(i,s,t.host,t._protocol)}return n}function Sj(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=J7():s=Y7():n.getStatus()===402?s=X7(t.bucket):n.getStatus()===403?s=Z7(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Ej(t){const e=Sj(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=K7(t.path)),i.serverResponse=s.serverResponse,i}return n}function B8(t,e,n){const r=e.fullServerUrl(),s=Fm(r,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,l=new iw(s,i,$8(t,n),a);return l.errorHandler=Ej(e),l}function z8(t,e){const n=e.fullServerUrl(),r=Fm(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(c,u){}const l=new iw(r,s,a,i);return l.successCodes=[200,204],l.errorHandler=Ej(e),l}function U8(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function V8(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=U8(null,e)),r}function H8(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function l(){let b="";for(let I=0;I<2;I++)b=b+Math.random().toString().slice(2);return b}const c=l();a["Content-Type"]="multipart/related; boundary="+c;const u=V8(e,r,s),h=M8(u,n),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",x=mi.getBlob(f,r,p);if(x===null)throw i8();const v={name:u.fullPath},_=Fm(i,t.host,t._protocol),S="POST",E=t.maxUploadRetryTime,w=new iw(_,S,O8(t,n),E);return w.urlParams=v,w.headers=a,w.body=x.uploadData(),w.errorHandler=Sj(e),w}class W8{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=va.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=va.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=va.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw ql("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ql("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ql("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ql("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ql("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class q8 extends W8{initXhr(){this.xhr_.responseType="text"}}function aw(){return new q8}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,n){this._service=e,n instanceof qn?this._location=n:this._location=qn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Pa(e,n)}get root(){const e=new qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vj(this._location.path)}get storage(){return this._service}get parent(){const e=j8(this._location.path);if(e===null)return null;const n=new qn(this._location.bucket,e);return new Pa(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw l8(e)}}function G8(t,e,n){t._throwIfRoot("uploadBytes");const r=H8(t.storage,t._location,wj(),new mi(e,!0),n);return t.storage.makeRequestWithTokens(r,aw).then(s=>({metadata:s,ref:t}))}function Q8(t){t._throwIfRoot("getDownloadURL");const e=B8(t.storage,t._location,wj());return t.storage.makeRequestWithTokens(e,aw).then(n=>{if(n===null)throw a8();return n})}function K8(t){t._throwIfRoot("deleteObject");const e=z8(t.storage,t._location);return t.storage.makeRequestWithTokens(e,aw)}function X8(t,e){const n=A8(t._location.path,e),r=new qn(t._location.bucket,n);return new Pa(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y8(t){return/^[A-Za-z]+:\/\//.test(t)}function J8(t,e){return new Pa(t,e)}function kj(t,e){if(t instanceof ow){const n=t;if(n._bucket==null)throw s8();const r=new Pa(n,n._bucket);return e!=null?kj(r,e):r}else return e!==void 0?X8(t,e):t}function Z8(t,e){if(e&&Y8(e)){if(t instanceof ow)return J8(t,e);throw fx("To use ref(service, url), the first argument must be a Storage instance.")}else return kj(t,e)}function KS(t,e){const n=e==null?void 0:e[hj];return n==null?null:qn.makeFromBucketSpec(n,t)}function eV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:ZI(s,t.app.options.projectId))}class ow{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=dj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=G7,this._maxUploadRetryTime=Q7,this._requests=new Set,s!=null?this._bucket=qn.makeFromBucketSpec(s,this._host):this._bucket=KS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qn.makeFromBucketSpec(this._url,e):this._bucket=KS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){QS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){QS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Pa(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new c8(fj());{const a=w8(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const XS="@firebase/storage",YS="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj="storage";function Ij(t,e,n){return t=Je(t),G8(t,e,n)}function Cj(t){return t=Je(t),Q8(t)}function tV(t){return t=Je(t),K8(t)}function lw(t,e){return t=Je(t),Z8(t,e)}function nV(t=ov(),e){t=Je(t);const r=hm(t,Tj).getImmediate({identifier:e}),s=XI("storage");return s&&rV(r,...s),r}function rV(t,e,n,r={}){eV(t,e,n,r)}function sV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new ow(n,r,s,e,Va)}function iV(){Ca(new Di(Tj,sV,"PUBLIC").setMultipleInstances(!0)),Zr(XS,YS,""),Zr(XS,YS,"esm2017")}iV();const cw=nC({apiKey:"AIzaSyDS7lgm2PwJBFrYE6ZHSYJfqcQw2TLC878",appId:"1:938280289868:web:e36c48cfbd55e4a8de96e",projectId:"zingmp3-clone-61799",storageBucket:"zingmp3-clone-61799.appspot.com",authDomain:"zingmp3-clone-61799.firebaseapp.com",messagingSenderId:"938280289868"}),Fe=j7(cw),Fa=OB(cw),aV=new _s,uw=nV(cw),oV="/assets/user-default-971f59df.png";function mx({className:t}){const[e]=vv(Fa),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return o.jsx("div",{className:n.imageFrame,children:o.jsx(pt,{src:(e==null?void 0:e.photoURL)||oV,className:"w-full"})})}function lV({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,isWrapped:s,...i},a){const[l,c]=m.useState(!1),{theme:u}=q(),{setTriggerRef:h,state:f}=wr(),{onClick:p}=i,x=m.useRef(null),v=()=>{"ontouchstart"in document.documentElement||c(!0)},_=()=>{c(!1)};m.useEffect(()=>{const w=x.current;if(w)return h&&h(w),w.addEventListener("mouseenter",v),w.addEventListener("mouseleave",_),()=>{w.removeEventListener("mouseenter",v),w.removeEventListener("mouseleave",_)}},[]);const S={container:`${u.modal_bg} text-white`},E=o.jsx(o.Fragment,{children:m.isValidElement(t)&&o.jsxs(o.Fragment,{children:[Object.keys(i).length?m.cloneElement(t,{ref:x,onClick:p}):m.cloneElement(t,{ref:x}),!(f!=null&&f.isOpen)&&l&&o.jsx("div",{className:`${S.container} absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md ${n} ${e}`,children:r})]})});if(m.isValidElement(t))return o.jsx(o.Fragment,{children:s?E:o.jsx("div",{className:"relative",children:E})})}const Ns=m.forwardRef(lV);function dw(){const{setSuccessToast:t}=ge(),{close:e}=wr(),n=()=>{navigator.clipboard.writeText(location.href),t("Link copied"),e()};return o.jsxs("button",{onClick:n,children:[o.jsx(iL,{className:"w-5"}),o.jsx("span",{children:"Copy link"})]})}function px(t){return o.jsxs("div",{className:"w-1/3 md:w-1/5 px-2",children:[t.variant==="skeleton"&&o.jsxs(o.Fragment,{children:[o.jsx(he,{className:"pt-[100%] rounded-full"}),o.jsx(he,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&o.jsxs(o.Fragment,{children:[o.jsx(Ce,{to:`/singer/${t.singer.id}`,children:o.jsx(yu,{className:"!rounded-full",children:o.jsx(pt,{src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),o.jsx("p",{className:"mt-1 text-center text-lg",children:t.singer.name})]})]})}const cV="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Lu=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=cV[n[t]&63];return e};const uV=!1,An=os(Fe,"Songs"),$r=os(Fe,"Playlists"),hf=os(Fe,"Singers");os(Fe,"Lyrics");const Dm=async({collectionName:t,id:e,msg:n})=>{await V7(tn(Fe,t,e))},ls=async({collectionName:t,id:e,msg:n})=>Fu(tn(Fe,t,e)),qi=async({collectionName:t,data:e,msg:n})=>await H7(os(Fe,t),e),en=async({collectionName:t,id:e,data:n,msg:r})=>await U7(tn(Fe,t,e),n),hw=async({file:t,folder:e,namePrefix:n,msg:r})=>{const s=n.replace("@gmail.com","")+"_"+t.name.replaceAll(" ","").toLowerCase(),i=lw(uw,`${e+s}`),a=await Ij(i,t);return{fileURL:await Cj(a.ref),filePath:a.metadata.fullPath}},dV=async({blob:t,folder:e,msg:n})=>{const r=Date.now()+".jpg",s=lw(uw,`${e+r}`),i=await Ij(s,t);return{fileURL:await Cj(i.ref),filePath:i.metadata.fullPath}},jn=async({filePath:t,msg:e})=>{try{const n=lw(uw,t);await tV(n)}catch(n){console.log({error:n})}},Rj=async t=>{await jn({filePath:t.song_file_path,msg:">>> api: delete song file"}),t.beat_file_path&&await jn({filePath:t.beat_file_path,msg:">>> api: delete song's image file"}),t.image_file_path&&await jn({filePath:t.image_file_path,msg:">>> api: delete song's image file"})},hV=async t=>{const e=Date.now(),n=await qT.post("/api/image/encode",t);let r="";n&&(r=n.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},fV=async t=>{const e=new FormData;e.append("file",t);const n=Date.now(),r=await qT.post("/api/image/optimize",e,{responseType:"blob"});let s;r&&(s=r.data);const i=(Date.now()-n)/1e3;return console.log(">>> api: optimize finished after",i),s};async function Nn(t,e){const n=await ml(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:Lu(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function cs(t){const e=await ml(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function ff(t){const e=await ml(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}const Gi=async({imageFile:t,blob:e})=>{let n=e;if(t&&(n=await fV(t)),!n)throw new Error("File not found");const r=dV({blob:n,folder:"/images/"}),{encode:s}=await hV(n),{filePath:i,fileURL:a}=await r;return{image_file_path:i,image_url:a,blurhash_encode:s}},jj=["Newest","Popular"],mV=()=>jj.reduce((t,e)=>{const n={playlists:[],shouldFetching:!0};return{...t,[e]:n}},{});function pV(){const[t,e]=m.useState(mV),{setErrorToast:n}=ge(),[r,s]=m.useState("Newest"),[i,a]=m.useState(!0),l=async()=>{try{const c={...t[r]};if(a(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=je($r,J("is_official","==",!0),J("is_public","==",!0),$i("updated_at","desc"),ru(20));break;case"Popular":u=je($r,J("is_official","==",!0),J("is_public","==",!0),$i("like","desc"),ru(20));break}if(u){const h=await cs(u);c.playlists=h,e(f=>({...f,[r]:c}))}}else await Os(100)}catch(c){console.log({message:c}),n()}finally{a(!1)}};return m.useEffect(()=>(l(),()=>{a(!0)}),[r]),{isFetching:i,playlistMap:t,getPlaylist:l,tabs:jj,tab:r,setTab:s}}function gV(){const{getPlaylist:t,isFetching:e,playlistMap:n,...r}=pV();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Playlist"}),o.jsx("div",{className:"flex space-x-2 my-2",children:o.jsx(fs,{render:s=>s,...r})}),o.jsx(wu,{loading:e,playlists:n[r.tab].playlists})]})})}const Aj=["Newest","Popular"],xV=()=>Aj.reduce((t,e)=>{const n={songs:[],shouldFetching:!0};return{...t,[e]:n}},{});function yV(){const[t,e]=m.useState(xV),{setErrorToast:n}=ge(),[r,s]=m.useState("Newest"),[i,a]=m.useState(!0),l=async()=>{try{const c={...t[r]};if(a(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=je(An,J("is_official","==",!0),$i("updated_at","desc"),ru(20));break;case"Popular":u=je(An,J("is_official","==",!0),$i("like","desc"),ru(20));break}if(u){const h=await Nn(u);c.songs=h,e(f=>({...f,[r]:c}))}}else await Os(100)}catch(c){console.log({message:c}),n()}finally{a(!1)}};return m.useEffect(()=>(l(),()=>{a(!0)}),[r]),{isFetching:i,songMap:t,tabs:Aj,tab:r,setTab:s}}function vV({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const wV=m.forwardRef(vV),_V=wV;function bV({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const SV=m.forwardRef(bV),EV=SV;function kV({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const TV=m.forwardRef(kV),IV=TV;function CV({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const RV=m.forwardRef(CV),jV=RV;function Nj({children:t,className:e=""}){const{theme:n}=q();return o.jsx("div",{className:`rounded-md py-2 ${n.modal_bg} text-white ${e}`,children:t})}function pl({children:t,className:e=""}){const n={container:"hover:[&>*:not(div.absolute)]:bg-white/5 [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center"};return o.jsx("div",{className:`${n.container} ${e}`,children:t})}const fw=(t,e,n="rgba(255,255,255,.15)")=>`linear-gradient(to right, ${t} ${e}%, ${n} ${e}%, ${n}`;function mw({audioEle:t,baseColor:e,color:n,progressLineRef:r,setStatusFromParent:s,statusFromParent:i}){const{theme:a}=q(),[l,c]=m.useState("paused"),[u,h]=m.useState(!1),f=i||l,p=s||c,x=m.useRef(""),v=m.useRef(f),_=()=>{try{t.play(),h(!0)}catch{}},S=()=>{t==null||t.pause(),b()},E=()=>{f==="playing"?S():f==="paused"&&_()},w=()=>{p("playing")},b=()=>{p("paused")},I=R=>{if(!t)return;const N=+(R||t.currentTime/t.duration*100).toFixed(1);r!=null&&r.current&&(r.current.style.background=fw(n||x.current,N,e))},F=()=>{const N=t.currentTime/(t.duration/100);I(+N.toFixed(1))},D=()=>{console.log("error"),p("error")},C=R=>{t.currentTime=R,I(),f!=="playing"&&_()},k=R=>{t.currentTime=t.currentTime+R},j=R=>{t.currentTime=t.currentTime-R};return m.useEffect(()=>{if(t)return t.addEventListener("error",D),t.addEventListener("pause",b),t.addEventListener("playing",w),r!=null&&r.current&&t.addEventListener("timeupdate",F),()=>{t.removeEventListener("error",D),t.removeEventListener("pause",b),t.removeEventListener("playing",w),r!=null&&r.current&&t.removeEventListener("timeupdate",F)}},[t]),m.useEffect(()=>{x.current=a.content_code,f!=="playing"&&I()},[a]),m.useEffect(()=>{v.current=f},[f]),{play:_,pause:S,seek:C,handlePlayPause:E,status:f,forward:k,backward:j,isClickPlay:u,statusRef:v}}const AV=()=>({playStatus:"paused",isLoaded:!0,countDown:0}),Pj=sv({name:"playStatus",initialState:()=>AV(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)}}}),Dn=t=>t.playStatus,{setPlayStatus:Lt}=Pj.actions,NV=Pj.reducer;function Xs({variant:t}){const e=an(),{currentQueueId:n,queueSongs:r,currentSongData:s}=ae(Ve),i=m.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(rs(l)),e(Lt({playStatus:"loading"}));const u=r.map(f=>f[i]);if(!r.length||r.length!==c.length||!!c.find(f=>!u.includes(f[i])))return console.log("set queue"),e(a6({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function Fj(t,e){const[n,r]=m.useState(t);return m.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const pw={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function JS(t,e){const n=m.useRef(),[r,s]=m.useState(0),[i,a]=m.useState(0);return m.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,pw]),m.useEffect(()=>{n.current||(t(),a(Math.random()*10))},[r]),()=>s(Math.random()*10)}const mg={currentPlaylist:null,playlistSongs:[]},Dj=sv({name:"currentPlaylist",initialState:mg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:Lu(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=mg.currentPlaylist,t.playlistSongs=mg.playlistSongs}}}),gl=t=>t.currentPlaylist,{addSongsToPlaylist:wY,removeSong:_Y,setCurrentPlaylist:PV,updateCurrentPlaylist:FV,resetCurrentPlaylist:DV,setPlaylistSong:bY}=Dj.actions,LV=Dj.reducer;function MV(){const t=an(),{setErrorToast:e}=ge(),{user:n,loading:r}=ve(),s=za(),[i,a]=m.useState(!0),l=async()=>{if(!s.id)return;const h=await ls({collectionName:"Playlists",id:s.id,msg:">>> api get playlist"});if(h.exists())return{...h.data(),id:h.id}},c=async h=>{if(!h.song_ids.length)return[];const f=je(An,J(Ks(),"in",h.song_ids)),p=await ml(f);return p.docs.length?p.docs.map(v=>({id:v.id,...v.data(),queue_id:`${Lu(4)}_${h.id}}`})):[]},u=async()=>{try{if(!s.id)return;a(!0);const h=await l();if(!h||!(n?h.owner_email===n.email&&!h.is_official:!1)&&!h.is_public)return;const p=await c(h);t(PV({playlist:h,songs:p}))}catch(h){console.log({message:h}),e()}finally{a(!1)}};return m.useEffect(()=>{if(!r)return u(),()=>{t(DV())}},[r]),{isFetching:i}}function Lj({active:t}){const{audioRef:e}=Ye();if(!e.current)throw new Error("useSongLyric !audioRef.current");const{playStatus:n}=ae(Dn),{currentSongData:r}=ae(Ve),{setLoading:s,setSongLyrics:i,songLyrics:a,loading:l,ranGetLyric:c}=GF(),[u,h]=m.useState(!1),f=m.useRef(),p=async()=>{try{if(!r||!r.song.lyric_id)return s(!1);s(!0);const v=await ls({collectionName:"Lyrics",id:r.song.lyric_id});if(v.exists()){const _=v.data();typeof _.lyrics=="string"?i(JSON.parse(_.lyrics||"[]")):i(_.lyrics)}}catch(v){console.log({message:v})}finally{s(!1)}},x=()=>{clearTimeout(f.current),h(!1),s(!0),i([]),c.current=!1};return m.useEffect(()=>{const v=async()=>{h(!0)};return e.current.addEventListener("loadeddata",v),()=>{var _;(_=e.current)==null||_.removeEventListener("loadeddata",v)}},[]),m.useEffect(()=>{a.length||u&&t&&(c.current||(c.current=!0,f.current=setTimeout(()=>{p()},500)))},[u,t]),m.useEffect(()=>{if(n==="error"){s(!1);return}return()=>{x()}},[r,n==="error"]),{songLyrics:a,loading:l,playStatus:n}}function Mj(){const t=an(),{setSuccessToast:e}=ge();return{action:r=>{switch(r.variant){case"add":t(um({songs:r.songs})),e("Song added to queue");break;case"remove":t(i6({index:r.index}))}}}}function Oj(){const{setPlaylists:t}=Pn(),{setErrorToast:e,setSuccessToast:n}=ge(),[r,s]=m.useState(!1);return{isFetching:r,handleAddPlaylist:async(a,l,c)=>{try{if(s(!0),l){const x=await Gi({imageFile:l});Object.assign(a,x)}const u=await qi({collectionName:"Playlists",data:a}),h=await Fu(u),f={...h.data(),id:h.id},{push:p=!0}=c||{};return p&&t(x=>[f,...x]),n("Playlist created"),f}catch(u){console.log(u),e()}finally{s(!1)}}}}function OV(){const{playlists:t,setPlaylists:e}=Pn(),{setErrorToast:n,setSuccessToast:r}=ge(),[s,i]=m.useState(!1);return{isFetching:s,addToPlaylist:async({song:l,playlist:c})=>{try{i(!0);const u={song_ids:[l.id,...c.song_ids]},h={...c,...u};await en({collectionName:"Playlists",id:c.id,data:u});const f=[...t],p=f.findIndex(x=>x.id===c.id);p!==-1&&(f[p]=h,e(f)),r("Song added")}catch(u){console.log({message:u}),n()}finally{i(!1)}}}}const gx=t=>({name:"",image_url:"",song_url:"",beat_url:"",beat_file_path:"",duration:0,like:0,lyric_id:"",image_file_path:"",song_file_path:"",blurhash_encode:"",singer_map:{},genre_map:{},genres:[],singers:[],is_official:!1,size:0,created_at:Qo(),updated_at:Qo(),...t}),xx=t=>({name:"",song_ids:[],image_url:"",singers:[],singer_map:{},genre_map:{},genres:[],is_album:!1,like:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_path:"",created_at:Qo(),updated_at:Qo(),...t}),ZS=({owner_email:t,distributor:e,...n})=>xx({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),mf=t=>({name:"",description:"",image_file_path:"",image_url:"",like:0,created_at:Qo(),blurhash_encode:"",...t}),eE=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}};function $j(t){const[e,n]=m.useState(),[r,s]=m.useState(),i=m.useRef(null),a=f=>{e&&n({...e,...f})},l=m.useMemo(()=>t.variant==="add"?!0:!t.playlist||!e?!1:e.name!==t.playlist.name||e.like!==t.playlist.like||e.is_public!==t.playlist.is_public,[e]),c=!!r,u=m.useMemo(()=>{const f=!!(e!=null&&e.name)&&l;return t.variant==="add"?f:f||c},[c,l,e]),h=()=>{switch(t.variant){case"add":return xx({distributor:t.user.display_name,owner_email:t.user.email});case"edit":const{id:f,updated_at:p,...x}=t.playlist;return xx(x)}};return m.useEffect(()=>{var f;t.variant==="add"&&((f=i.current)==null||f.focus()),n(h())},[]),m.useEffect(()=>{r&&a({image_url:URL.createObjectURL(r)})},[r]),{playlistData:e,imageFile:r,setImageFile:s,updatePlaylistData:a,setPlaylistData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function xl({close:t,isLoading:e,submit:n,...r}){const{theme:s}=q(),{imageFile:i,setImageFile:a,playlistData:l,updatePlaylistData:c,isChanged:u,isChangeImage:h,inputRef:f,isValidToSubmit:p}=$j(r),x=async()=>{l&&(!u&&!h||n(l,i))},v=_=>{var S;(S=_.target.files)!=null&&S.length&&a(_.target.files[0])};if(l)return o.jsxs(o.Fragment,{children:[o.jsx(It,{close:t,title:r.variant==="add"?"Add playlist":"Edit playlist"}),o.jsxs("div",{className:"md:flex md:space-x-3",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:o.jsx(pt,{className:"object-cover object-center h-full",blurHashEncode:l.blurhash_encode,src:l.image_url})}),o.jsx("input",{ref:f,onChange:v,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),o.jsx("div",{className:"space-x-2 flex",children:o.jsx(le,{className:`${s.content_bg}`,size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:o.jsx(al,{className:"w-5"})})})})]}),o.jsxs("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",children:"Name"}),o.jsx(rn,{id:"name",ref:f,type:"text",placeholder:"name...",value:l.name,onChange:_=>c({name:_.target.value})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Public"}),o.jsx(sh,{inActiveBg:"bg-black/10",active:l.is_public,cb:()=>c({is_public:!l.is_public})})]})]})]}),o.jsx("p",{className:"text-right mt-5 md:mt-0",children:o.jsx(le,{isLoading:e,color:"primary",onClick:x,disabled:!p,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function Lm(){const t=an(),{user:e,updateUserData:n}=ve(),{setPlaylists:r,playlists:s}=Pn(),[i,a]=m.useState(!1),{setSuccessToast:l,setErrorToast:c}=ge(),u=Vt();return{isFetching:i,action:async f=>{try{if(!e)throw new Error("user not found");a(!0);const p=Du(Fe),x=tn(Fe,"Users",e.email),v=tn(Fe,"Playlists",f.playlist.id);switch(f.variant){case"like":{if(!e)throw Error();const _=[...e.liked_playlist_ids],S=_.findIndex(I=>I===f.playlist.id),E=S===-1;E?_.unshift(f.playlist.id):_.splice(S,1);const w={liked_playlist_ids:_},b={like:tw(E?1:-1)};p.update(x,w),p.update(v,b),await p.commit(),r(E?I=>[f.playlist,...I]:I=>I.filter(F=>F.id!==f.playlist.id)),n(w);break}case"edit":{const{data:_,playlist:S,imageFile:E}=f,w={...S,..._};if(E){const C=await Gi({imageFile:E});S.image_file_path&&await jn({filePath:S.image_file_path}),Object.assign(w,C)}await en({collectionName:"Playlists",data:w,id:S.id,msg:">>> api: update playlist doc"});const b=[...s],I=b.findIndex(C=>C.id===S.id);I!==-1&&(b[I]=w,r(b));const{updated_at:F,...D}=w;t(FV(D)),l("Playlist edited");break}case"delete":{const{playlist:_}=f;_.image_file_path&&await jn({filePath:_.image_file_path});const S={liked_playlist_ids:e.liked_playlist_ids.filter(w=>w!==_.id)};p.delete(v),p.update(x,S),await Promise.all([p.commit(),_.image_file_path?jn({filePath:_.image_file_path}):()=>{}]);const E=s.filter(w=>w.id!==_.id);r(E),n(S),u("/my-music");break}}}catch(p){console.log({message:p}),c()}finally{a(!1)}},user:e}}function gw(){const{user:t}=ve(),{setErrorToast:e}=ge(),{handleAddPlaylist:n,isFetching:r}=Oj(),{action:s,isFetching:i}=Lm();return{isFetching:r||i,myMusicAddPlaylist:async(c,u)=>{try{if(!t)return;const h=await n(c,u,{push:!1});h&&await s({variant:"like",playlist:h})}catch(h){console.log({error:h}),e()}}}}function xw({song:t,closeModal:e}){const{user:n}=ve(),{playlists:r}=Pn(),{theme:s}=q(),{addToPlaylist:i,isFetching:a}=OV(),{myMusicAddPlaylist:l,isFetching:c}=gw(),u=m.useRef(null),h=n?r.filter(x=>x.owner_email===n.email&&!x.is_official):[],f=async x=>{await i({playlist:x,song:t}),e()},p=async(x,v)=>{var _;x.song_ids=[t.id],await l(x,v),(_=u.current)==null||_.close(),e()};if(n)return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"w-[300px] max-h-[80vh] max-w-[calc(90vw-40px)] flex flex-col ",children:[o.jsx(It,{close:e,title:"Playlists"}),o.jsx("div",{className:`flex-grow flex flex-col overflow-auto space-y-2 ${a?"disable":""}`,children:h.length?h.map((x,v)=>{const _=x.song_ids.includes(t.id);return o.jsxs("button",{disabled:_,onClick:()=>f(x),className:`flex rounded-md p-2 ${s.content_hover_bg} bg-white/10`,children:[o.jsx(Ua,{className:"w-5 mr-2"}),o.jsx("span",{children:x.name})]},v)}):o.jsx(tt,{variant:"less"})}),o.jsxs(le,{className:`${s.content_bg} mt-5 rounded-full justify-center`,onClick:()=>{var x;return(x=u.current)==null?void 0:x.open()},children:[o.jsx(vr,{className:"w-5"}),o.jsx("span",{children:"Add new playlist"})]})]}),o.jsx(Oe,{variant:"animation",ref:u,children:o.jsx(xl,{close:()=>{var x;return(x=u.current)==null?void 0:x.close()},submit:p,isLoading:a||c,variant:"add",user:n})})]})}function yw({modalRef:t,song:e}){const{user:n}=ve();return n?o.jsx(Oe,{variant:"animation",ref:t,children:o.jsx(xw,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},song:e})}):o.jsx(o.Fragment,{})}function vw({modalRef:t}){const{user:e}=ve(),{close:n}=wr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?o.jsxs("button",{onClick:r,children:[o.jsx(hs,{className:"w-5"}),o.jsx("span",{children:"Add to playlist"})]}):o.jsx(o.Fragment,{})}function $V({song:t,index:e}){const{action:n}=Mj(),{close:r}=wr(),s=m.useRef(null),i=()=>{n({variant:"remove",index:e}),r()};return o.jsxs(o.Fragment,{children:[o.jsxs(Mm,{song:t,children:[!1,o.jsxs("button",{onClick:i,children:[o.jsx(Wy,{className:"w-5"}),o.jsx("span",{children:"Remove"})]}),o.jsx(vw,{modalRef:s}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(em,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(yw,{song:t,modalRef:s})]})}function BV({song:t,modalRef:e}){const{user:n}=ve(),{updateSong:r}=Pn(),[s,i]=m.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[a,l]=m.useState(!1),[c,u]=m.useState(),{setErrorToast:h,setSuccessToast:f}=ge(),p=m.useMemo(()=>t.name!==s.name||t.singers[0].name!==s.singer,[s]),x=!!s.name&&!!s.singer&&p||c;return{isFetching:a,isChanged:p,songData:s,isValidToSubmit:x,handleSubmit:async()=>{var S,E;try{if(!n||!x)return;l(!0),(S=e.current)==null||S.setModalPersist(!0);const{id:w,...b}=t;if(p){if(!s.name||!s.singer)return;b.name=s.name,b.singers=[{...b.singers[0],name:s.singer}]}if(c){const I=await Gi({imageFile:c});Object.assign(b,I),t.image_file_path&&await jn({filePath:t.image_file_path})}await en({collectionName:"Songs",data:b,id:t.id}),r({id:t.id,song:b}),f("Song edited"),(E=e.current)==null||E.close()}catch(w){console.log({message:w}),h()}finally{l(!1)}},imageFile:c,setImageFile:u,handleInput:(S,E)=>{i({...s,[S]:E})}}}function zV({song:t,modalRef:e}){const{theme:n}=q(),r=m.useRef(null),{isValidToSubmit:s,songData:i,setImageFile:a,isFetching:l,handleSubmit:c,handleInput:u}=BV({song:t,modalRef:e}),h=p=>{const x=p.target.files;x!=null&&x.length&&(a(x[0]),u("image_url",URL.createObjectURL(x[0])))},f=p=>{var x;p.stopPropagation(),(x=e.current)==null||x.close()};return o.jsxs("div",{className:`${zc(l)} w-[500px] max-h-[80vh] max-w-[90vw] text-white flex flex-col`,children:[o.jsx("input",{ref:r,id:"image-input",type:"file",accept:"image/*",onChange:h,className:"hidden"}),o.jsx(It,{title:"Edit song",close:()=>{var p;return(p=e.current)==null?void 0:p.close()}}),o.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:o.jsx(pt,{className:"object-cover h-full",src:i.image_url})}),o.jsx("label",{htmlFor:"image-input",className:`inline-block cursor-pointer hover:brightness-90 px-[20px] py-[5px] ${n.content_bg} rounded-full text-[14px]`,children:o.jsx(al,{className:"w-5"})})]}),o.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"name",className:"",children:"Name"}),o.jsx(rn,{value:i.name,type:"text",id:"name",onChange:p=>u("name",p.target.value),placeholder:t.name})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"singer",className:"",children:"Singer"}),o.jsx(rn,{value:i.singer,onChange:p=>u("singer",p.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),o.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[o.jsx(le,{onClick:f,className:"rounded-full",children:"Close"}),o.jsx(le,{isLoading:l,onClick:c,disabled:!s,className:`${n.content_bg} rounded-full`,variant:"primary",children:"Save"})]})]})}function ww(){const{user:t,updateUserData:e}=ve(),{setErrorToast:n,setSuccessToast:r}=ge(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:a}=Pn(),[l,c]=m.useState(!1);return{loading:l,action:async h=>{try{if(c(!0),!t)throw new Error("User not found");const f=Du(Fe),p=tn(Fe,"Users",t.email),x=tn(Fe,"Songs",h.song.id);switch(h.variant){case"delete":{const v=s.filter(S=>S.id!==h.song.id),_={liked_song_ids:t.liked_song_ids.filter(S=>S!==h.song.id)};if(f.update(p,_),f.delete(x),h.song.lyric_id){const S=tn(Fe,"Lyrics",h.song.lyric_id);f.delete(S)}await Promise.all([f.commit(),Rj(h.song)]),i(v),r(`'${h.song.name}' deleted`);break}case"like":{if(!t)return;const v=[...t.liked_song_ids],_=v.findIndex(b=>b===h.song.id),S=_===-1;S?v.unshift(h.song.id):v.splice(_,1);const E={liked_song_ids:v},w={like:tw(S?1:-1)};f.update(p,E),f.update(x,w),await f.commit(),e(E),a.current=!0;break}}}catch(f){console.log({message:f}),n()}finally{c(!1)}}}}function _w({song:t}){const{close:e}=wr(),{action:n}=Mj(),r=()=>{n({variant:"add",songs:[t]}),e()};return o.jsxs("button",{onClick:r,children:[o.jsx(vr,{className:"w-5"}),o.jsx("span",{children:"Add to queue"})]})}function UV({song:t}){const{close:e}=wr(),[n,r]=m.useState(""),s=m.useRef(null),i=m.useRef(null),{action:a,loading:l}=ww(),c=p=>{var x;r(p),(x=s.current)==null||x.open(),e()},u=()=>{var p;(p=s.current)==null||p.close()},h=async()=>{await a({variant:"delete",song:t}),u()},f=()=>{switch(n){case"":return o.jsx(o.Fragment,{});case"delete":return o.jsx(Gs,{callback:h,loading:l,close:u,label:`Delete ' ${t.name} ' ?`});case"edit":return o.jsx(zV,{modalRef:s,song:t});case"add-to-playlist":return o.jsx(xw,{closeModal:u,song:t})}};return o.jsxs(o.Fragment,{children:[o.jsxs(Mm,{song:t,children:[!1,o.jsx(_w,{song:t}),o.jsx(vw,{modalRef:i}),o.jsxs("button",{onClick:()=>c("edit"),children:[o.jsx(pu,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(Ce,{to:`lyric/${t.id}`,children:[o.jsx(Uy,{className:"w-5"}),o.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),o.jsxs("button",{onClick:()=>c("delete"),children:[o.jsx(Fn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(em,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(Oe,{variant:"animation",ref:s,children:f()}),o.jsx(yw,{song:t,modalRef:i})]})}function VV({song:t}){const e=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs(Mm,{song:t,children:[!1,o.jsx(_w,{song:t}),o.jsx(vw,{modalRef:e}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(em,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(yw,{song:t,modalRef:e})]})}function HV({song:t}){const{isFetching:e}=Lm();return o.jsx(o.Fragment,{children:o.jsxs(Mm,{song:t,children:[!1,o.jsx(_w,{song:t}),o.jsx("button",{children:e?o.jsx(Tt,{className:"w-5 animate-spin"}):o.jsxs(o.Fragment,{children:[o.jsx(Wy,{className:"w-5"}),o.jsx("span",{children:"Remove"})]})}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(em,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]})})}function WV({song:t}){return o.jsx("div",{className:"px-2 mb-3",children:o.jsxs("div",{className:"p-3 bg-[#fff]/5 rounded-md flex",children:[o.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:o.jsx(pt,{src:t.image_url,className:"object-cover object-center w-full"})}),o.jsxs("div",{className:"ml-1 text-sm",children:[o.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),o.jsx("p",{className:"opacity-70 line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function Mm({children:t,song:e}){const{theme:n}=q();return o.jsx(xr,{appendTo:"portal",className:"w-[240px]",children:o.jsxs(Qs,{className:"py-2",p:"clear",theme:n,children:[o.jsx(WV,{song:e}),o.jsx(pl,{children:t}),o.jsxs("p",{className:"text-xs text-center opacity-70 mt-3",children:["By ",e.distributor]})]})})}function tE({song:t,index:e,variant:n}){const{theme:r}=q(),[s,i]=m.useState(!1),a=()=>{switch(n){case"queue-song":return o.jsx($V,{song:t,index:e});case"own-song":return o.jsx(UV,{song:t});case"own-playlist":return o.jsx(HV,{song:t});default:return o.jsx(VV,{song:t})}},l=()=>{switch(n){case"queue-song":case"recent-song":return o.jsx(o.Fragment,{});default:return o.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${s?"hidden":"md:block"}`,children:Ms(t.duration)})}},c={button:`hover:bg-${r.alpha} p-2 rounded-full`},u=()=>s?`${r.content_bg}`:"block md:hidden";return o.jsx(o.Fragment,{children:o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{setIsOpenParent:i,children:o.jsx(Ns,{isWrapped:!0,content:"Menu",children:o.jsx("button",{type:"button",className:`block group-hover/main:block ${c.button} ${u()}`,children:o.jsx(il,{className:"w-5"})})})}),l(),a()]})})}function qV({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{theme:i}=q(),{action:a,loading:l}=ww(),c=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},u=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},h=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":i.content_text;default:return i.content_text}},f={button:`hover:bg-${i.alpha} rounded-full`};return o.jsx("button",{onClick:()=>a({variant:"like",song:e}),className:`${f.button} ${c()} group-hover/main:block md:hidden ${s} ${u()}`,children:l?o.jsx(Tt,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(sm,{className:`w-5 ${h()}`}):o.jsx(xu,{className:"w-5"})})})}function GV({onClick:t,isChecked:e,isSelected:n}){return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:t,className:`mr-2 md:mr-3 group-hover/main:block ${e?"block":"md:hidden "}`,children:n?o.jsx(Gy,{className:"w-[18px]"}):o.jsx(pI,{className:"w-[18px]"})}),o.jsx("button",{className:`mr-3 hidden group-hover/main:hidden group-hover/main:mr-[0px] md:block ${Zf(e,"md:hidden")}`,children:o.jsx(Ua,{className:"w-[18px]"})})]})}function QV({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:a="",imageUrl:l,...c}){const{theme:u,isOnMobile:h}=q(),{isChecked:f,selectedSongs:p,selectSong:x}=fu(),v=m.useMemo(()=>p?p.indexOf(t)!=-1:!1,[p]),_=()=>{f!==void 0&&x(t)},S={button:`${u.content_hover_bg} p-[8px] rounded-full`,checkboxButton:"mr-3 text-[inherit]",itemContainer:`w-full sm:group/container flex flex-row rounded justify-between p-[10px] border-b border-${u.alpha} last:border-none`,imageFrame:" relative rounded-[4px] overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40",ctaWrapper:"flex items-center justify-end flex-shrink-0"},E=m.useMemo(()=>{switch(c.variant){default:return o.jsxs("div",{className:` ${S.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[o.jsx("img",{src:Jy,alt:"",className:`"h-[18px] w-[18px] ${Uc(!r)}`}),o.jsx("button",{onClick:e,className:`${Uc(r)} `,children:o.jsx(IV,{className:"w-[24px] text-white"})})]})}},[r,e]),w=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-sm";default:return""}},b=()=>{switch(c.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},I=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},F=N=>{if(!h)return;const P=N.target;console.log(P.tagName),P.tagName!=="A"&&e()},D=o.jsxs(o.Fragment,{children:[n&&o.jsx(GV,{isChecked:f,isSelected:v,onClick:_}),o.jsxs("div",{className:"flex-grow flex",onClick:F,children:[o.jsxs("div",{className:`${S.imageFrame} ${b()}`,children:[o.jsx(pt,{src:l||t.image_url,blurHashEncode:t.blurhash_encode}),E]}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsxs("h5",{className:`line-clamp-1 font-medium overflow-hidden ${w()}`,children:[t.name,!1]}),o.jsx("div",{className:`opacity-[.7] line-clamp-1 ${I()}`,children:t.singers.map((N,P)=>N.id?o.jsx(Ce,{to:`/singer/${N.id}`,className:`${u.content_hover_text}  hover:underline`,children:(P?", ":"")+N.name},P):o.jsxs("span",{children:[" ",(P?", ":"")+N.name]},P))})]})]})]}),C=()=>{switch(c.variant){case"queue-song":case"recent-song":return D;default:return o.jsx("div",{className:"flex flex-grow overflow-hidden",children:D})}},k=()=>{switch(c.variant){case"queue-song":case"recent-song":return o.jsx(tE,{variant:c.variant,song:t,index:i});default:return o.jsx("div",{className:"flex justify-center md:w-[60px]",children:o.jsx(tE,{variant:c.variant,song:t,index:i})})}},j=o.jsxs("div",{className:"flex items-center",children:[s!=null&&o.jsx(qV,{className:"p-2",isSongActive:r,songVariant:c.variant,isLiked:s,song:t}),k()]});return(()=>{switch(c.variant){case"queue-song":case"recent-song":return o.jsxs("div",{className:`${S.itemContainer} group/main ${r?`${u.content_bg} text-white`:`hover:bg-${u.alpha}`}`,children:[C(),j]});default:return o.jsxs("div",{className:`${S.itemContainer} ${a} group/main ${r||v?`bg-${u.alpha}`:`hover:bg-${u.alpha}`}`,children:[C(),j]})}})()}function Ys({songs:t,setSong:e,getActive:n,songVariant:r,imageUrl:s,isHasCheckBox:i=!0}){const{user:a}=ve(),{currentSongData:l}=ae(Ve);return t.length?t.map((c,u)=>{const h=a?c.owner_email===a.email&&c.is_official===!1:!1;return o.jsx(QV,{active:l?n?n(c,l.song):c.id===l.song.id:!1,onClick:()=>e(c),variant:r||(h?"own-song":"system-song"),isHasCheckBox:i,isLiked:a?a.liked_song_ids.includes(c.id):null,song:c,imageUrl:s,index:u},c.queue_id)}):o.jsx(tt,{variant:"less"})}function KV(){const t=an(),{setSuccessToast:e}=ge(),{selectedSongs:n,resetSelect:r}=fu(),s=()=>{t(um({songs:n})),e("songs added to queue"),r()};return o.jsxs("button",{onClick:s,children:[o.jsx(vr,{className:"w-5"}),o.jsx("span",{className:"",children:"Add to queue"})]})}function XV({modalRef:t}){const{user:e}=ve(),{selectedSongs:n}=fu(),{myMusicAddPlaylist:r,isFetching:s}=gw(),i=async(a,l)=>{var c;a.song_ids=n.map(u=>u.id),await r(a,l),(c=t.current)==null||c.close()};return e?o.jsx(Oe,{variant:"animation",ref:t,children:o.jsx(xl,{close:()=>{var a;return(a=t.current)==null?void 0:a.close()},submit:i,isLoading:s,variant:"add",user:e})}):o.jsx(o.Fragment,{})}function YV({modalRef:t}){const{user:e}=ve(),{close:n}=wr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?o.jsxs("button",{onClick:r,children:[o.jsx(hs,{className:"w-5"}),o.jsx("span",{children:"Add to playlist"})]}):o.jsx(o.Fragment,{})}function JV(){const t=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsx(ZV,{children:o.jsx(YV,{modalRef:t})}),o.jsx(XV,{modalRef:t})]})}function ZV({children:t}){const{theme:e}=q();return o.jsx(xr,{appendTo:"portal",children:o.jsx(Qs,{className:"py-2",p:"clear",theme:e,children:o.jsx(pl,{children:t})})})}function eH({variant:t}){const e=()=>{switch(t){default:return o.jsx(JV,{})}};return o.jsx(o.Fragment,{children:o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{children:o.jsx("button",{className:"!p-1.5",type:"button",children:o.jsx(il,{className:"w-5"})})}),e()]})})}function Om({children:t,variant:e,selectAll:n}){const{theme:r}=q(),{user:s}=ve(),{isSelectAll:i,isChecked:a,resetSelect:l,selectedSongs:c}=fu(),u=o.jsxs(o.Fragment,{children:[n&&o.jsx("button",{onClick:n,className:"ml-[10px]",children:i?o.jsx(gu,{className:"w-[20px]"}):o.jsx(pI,{className:"w-[20px]"})}),o.jsx("p",{className:"font-playwriteCU mr-1",children:c.length}),o.jsxs("div",{className:`flex space-x-2 items-center ${r.type==="light"?"[&>button]:bg-black/5":"[&>button]:bg-white/5"}  [&>button]:inline-flex [&>button]:space-x-1 [&>button]:py-1 [&>button]:px-2 [&>button]:rounded-full hover:[&>button]:brightness-95`,children:[o.jsx(KV,{}),s&&o.jsx(eH,{variant:e})]}),o.jsx("button",{onClick:l,className:"p-1 flex-shrink-0",children:o.jsx(Vi,{className:"w-[20px]"})})]});return o.jsx("div",{className:"flex items-center space-x-2 h-[44px] mb-3",children:a?u:t})}function bw(){const t=an();return ae(Ve),{getRecommend:async n=>{try{console.log("getRecommend"),t(Fb(!0));const r=n.genres.map(l=>J(`genre_map.${l.id}`,"==",!0),ru(20)),s=J(Ks(),"!=",n.id),i=je(An,...r,s),a=await Nn(i);t(um({songs:a})),t(Fb(!1))}catch{}}}}function tH(){const{isFetching:t,songMap:e,...n}=yV(),{handleSetSong:r}=Xs({variant:"songs"}),{getRecommend:s}=bw(),i=a=>{r(a.queue_id,[a]),s(a)};return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Song"}),o.jsx("div",{className:"flex space-x-1 my-2 p-1",children:o.jsx(fs,{render:a=>a,...n})}),o.jsxs(ds,{children:[o.jsx(Om,{variant:"system-song",children:o.jsx("p",{className:"font-[500] opacity-[.5]",children:"Songs"})}),t&&ol,!t&&o.jsx(Ys,{songs:e[n.tab].songs,setSong:a=>i(a)})]})]})})}function nH(){const{user:t}=ve(),[e,n]=m.useState([]),[r,s]=m.useState(!0);return{isFetching:r,recentPlaylists:e,getRecentPlaylist:async()=>{try{if(t){if(t.recent_song_ids.length){const a=je($r,J(Ks(),"in",t.recent_song_ids)),l=await cs(a);n(l)}}else{const a=fn()["recent-playlists"]||[];n(a)}}catch(a){console.log({message:a})}finally{s(!1)}}}}function rH(){const{currentSongData:t}=ae(Ve),e=m.useRef(!1),{isFetching:n,getRecentPlaylist:r,recentPlaylists:s}=nH();m.useEffect(()=>{e.current||(e.current=!0,r())},[]);const i={playlistItem:"w-1/4 p-[8px] max-[800px]:w-1/2"},a=()=>s.map((l,c)=>{const u=t==null?void 0:t.song.queue_id.includes(l.id);return o.jsx("div",{className:i.playlistItem,children:o.jsx(Zy,{active:u,data:l})},c)});return n?o.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:Xy}):s.length?o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Recent listening"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:a()})]})}):o.jsx(o.Fragment,{})}function $m(){const{user:t}=ve(),[e,n]=m.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await G$(Fa,aV);break}case"logout":{await kC(Fa);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function sH(){const{theme:t}=q(),{loading:e,user:n}=ve(),{action:r}=$m(),s=async()=>{try{await r("login")}catch(a){console.log(a)}finally{}},i={icon:"w-7 mr-2 inline",linkItem:`py-3 border-b text-lg border-${t.alpha} last:border-none`,button:`${t.content_bg} rounded-full`};return o.jsxs("div",{className:"block md:hidden",children:[o.jsx(be,{title:"Library",className:"mb-1"}),e?[...Array(3).keys()].map(a=>o.jsx(vI,{},a)):o.jsx(o.Fragment,{children:n?o.jsxs(o.Fragment,{children:[o.jsx(qp,{to:"/my-music",className:i.linkItem,icon:o.jsx(Ua,{className:i.icon+t.content_text}),label:"All songs",arrowIcon:o.jsx(rh,{className:"w-6"})}),o.jsx(qp,{to:"/my-music",className:i.linkItem,icon:o.jsx(xu,{className:i.icon+t.content_text}),label:"Favorite",arrowIcon:o.jsx(rh,{className:"w-6"})}),o.jsx(qp,{to:"/my-music",className:i.linkItem,icon:o.jsx($y,{className:i.icon+t.content_text}),label:"Recent",arrowIcon:o.jsx(rh,{className:"w-6"})})]}):o.jsxs(le,{onClick:s,className:`${t.content_bg} rounded-md`,children:[o.jsx(Ly,{className:"w-7"}),o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Login"})]})})]})}function iH(){const{theme:t}=q(),{loading:e,user:n}=ve(),r=m.useRef(null),{action:s}=$m(),[i,a]=m.useState(""),l=()=>{var p;return(p=r.current)==null?void 0:p.toggle()},c=p=>{var x;a(p),(x=r.current)==null||x.toggle()},u=async()=>{try{await s("logout")}catch(p){console.log("signOut error",{message:p})}finally{l()}},h=m.useMemo(()=>{switch(i){case"theme":return o.jsx(Ky,{close:l});case"info":return o.jsx(Qy,{close:l});case"logout":return o.jsx(Gs,{close:l,callback:u,loading:!1,label:"Log out ?"})}},[i]),f={linkItem:`py-3 text-lg w-full border-b border-${t.alpha} space-x-2 last:border-none flex items-center`,icon:"w-7"};return o.jsxs("div",{className:"md:hidden",children:[o.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),n&&o.jsxs("div",{className:`bg-${t.alpha} p-3 rounded-md flex mb-3`,children:[o.jsx(mx,{className:"h-[65px] w-[65px]"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-lg font-[500]",children:n.display_name}),o.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),e?[...Array(3).keys()].map(p=>o.jsx(vI,{},p)):o.jsxs("div",{className:"",children:[o.jsxs("button",{className:f.linkItem,onClick:()=>c("theme"),children:[o.jsx(P0,{className:f.icon}),o.jsx("span",{children:"Theme"})]}),o.jsxs("button",{className:f.linkItem,onClick:()=>c("info"),children:[o.jsx(N0,{className:f.icon}),o.jsx("span",{children:"Info"})]}),(n==null?void 0:n.role)==="ADMIN"&&o.jsxs(Ce,{to:"/dashboard",className:f.linkItem,children:[o.jsx(zy,{className:f.icon}),o.jsx("span",{children:"Dashboard"})]}),n&&o.jsxs("button",{className:f.linkItem,onClick:()=>c("logout"),children:[o.jsx(Ly,{className:f.icon}),o.jsx("span",{children:"Logout"})]})]}),o.jsx(Oe,{ref:r,variant:"animation",children:h})]})}function aH(){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(sH,{}),o.jsx(rH,{}),o.jsx(gV,{}),o.jsx(tH,{}),o.jsx(iH,{})]}),o.jsx(Wf,{})]})}function Bj(){const{user:t,updateUserData:e}=ve();return{updatePlaylist:async r=>{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const a={recent_playlist_ids:[...t.recent_playlist_ids,r.id]};await en({collectionName:"Users",data:a,id:t.email}),e(a)}}else{const s=fn()["recent-playlists"]||[];s.find(a=>a.id===r.id)||(s.push(r),ot("recent-playlists",s))}}}}const oH=o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:o.jsx(he,{className:"h-[20px] w-[90px]"})}),ol]});function lH({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=ae(gl),{handleSetSong:s}=Xs({variant:"playlist"}),{updatePlaylist:i}=Bj(),a=(r==null?void 0:r.is_album)&&!!(r!=null&&r.image_url),l=c=>{if(!r)return;s(c.queue_id,n)&&i(r)};return e?oH:o.jsx(o.Fragment,{children:o.jsxs(ds,{children:[!!n.length&&o.jsx(Om,{variant:t==="others-playlist"?"system-song":"own-playlist",children:o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),o.jsx(Ys,{imageUrl:a?r.image_url:"",songs:n,setSong:c=>l(c),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function Js(){const t=an(),{playerConig:{isShuffle:e,repeat:n,isCrossFade:r},updatePlayerConfig:s,firstTimeSongLoaded:i,audioRef:a,timelineEleRef:l,currentTimeEleRef:c,isPlayingNewSong:u,themeCodeRef:h,shouldSyncSongDuration:f}=Ye(),{currentSongData:p,queueSongs:x}=ae(Ve),{playStatus:v}=ae(Dn),_=m.useRef(0),S=()=>{l.current&&c.current&&(c.current.innerText="0:00",l.current.style.background="rgba(255, 255, 255, 0.15)")},E=async()=>{try{if(console.log("call play"),f.current){f.current=!1;const N=fn().current_time||0;a.current.currentTime=N}await a.current.play(),u.current&&(r&&(a.current.volume=0),u.current=!1)}catch{}},w=()=>{a.current.pause()},b=()=>{v==="playing"&&w(),v==="paused"&&E()},I=R=>{const N=l.current,P=c.current,A=R||a.current.currentTime;if(a.current.duration&&N){const ee=A/(a.current.duration/100);N.style.background=fw(h.current,+ee.toFixed(1))}P&&(P.innerText=Ms(A)||"0:00")};return{toggleRepeat:()=>{let R;switch(n){case"no":R="one";break;case"one":R="all";break;case"all":R="no";break;default:R="no"}ot("repeat",R),s({repeat:R})},toggleShuffle:()=>{const R=!e;s({isShuffle:R}),ot("isShuffle",R)},next:()=>{if(!p)return;let R=p.index+1,N;R<x.length?N=x[R]:(R=0,N=x[0]),t(rs(N.queue_id))},previous:()=>{if(!p)return;let R=p.index-1,N;R>=0?N=x[R]:(N=x[x.length-1],R=x.length-1),t(rs(N.queue_id))},repeat:n,isShuffle:e,updateProgressElement:I,handleSeek:R=>{const N=R.target;if(l.current){const P=N.getBoundingClientRect(),ee=(R.clientX-P.left)/l.current.offsetWidth,pe=Math.round(ee*a.current.duration),we=a.current.currentTime;if(_.current&&Math.abs(we-_.current)<1&&Math.abs(pe-_.current)<1)return;I(pe),i.current?ot("current_time",pe):a.current.currentTime=pe,_.current=pe}},handlePlayPause:b,play:E,pause:w,resetForNewSong:S}}function pg({onClick:t,children:e,text:n}){const{theme:r}=q(),{playlistSongs:s}=ae(gl);return o.jsxs(le,{onClick:t,disabled:!s.length,size:"clear",className:`rounded-full px-5 py-1 ${r.content_bg}`,children:[e,o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function cH(){const{currentPlaylist:t,playlistSongs:e}=ae(gl),{currentSongData:n}=ae(Ve),{playStatus:r}=ae(Dn),{handlePlayPause:s}=Js(),{handleSetSong:i}=Xs({variant:"playlist"}),{updatePlaylist:a}=Bj(),l=()=>{if(!t)return;const c=e[0];i(c.queue_id,e)&&a(t)};if(!t)return o.jsx(o.Fragment,{});if(n!=null&&n.song.queue_id.includes(t.id))switch(r){case"playing":case"waiting":return o.jsx(pg,{text:"Pause",onClick:s,children:o.jsx(rm,{className:"w-7 mr-1"})});case"loading":case"paused":return o.jsx(pg,{text:"Continue",onClick:s,children:o.jsx(Vc,{className:"w-7 mr-1"})})}return o.jsx(pg,{text:"Play",onClick:l,children:o.jsx(Vc,{className:"w-7 mr-1"})})}function uH({isLiked:t,playlist:e,className:n="p-1.5"}){const{theme:r}=q(),{action:s,isFetching:i}=Lm(),a={button:`bg-${r.alpha} hover:brightness-90 rounded-full w-[40px] flex justify-center`};return o.jsx("button",{onClick:()=>s({variant:"like",playlist:e}),className:` ${a.button} ${n}`,children:i?o.jsx(Tt,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(sm,{className:`w-5 ${r.content_text}`}):o.jsx(xu,{className:"w-5"})})})}function dH(){return o.jsx(o.Fragment,{children:o.jsx(zj,{children:o.jsx(dw,{})})})}function hH(){const{currentPlaylist:t}=ae(gl),{close:e}=wr(),[n,r]=m.useState(""),s=m.useRef(null),{action:i,isFetching:a}=Lm(),l=f=>{var p;r(f),e(),(p=s.current)==null||p.open()},c=()=>{var f;return(f=s.current)==null?void 0:f.close()},u=async(f,p)=>{t&&(await i({variant:"edit",playlist:t,data:f,imageFile:p}),c())},h=()=>{if(!t)return o.jsx(o.Fragment,{});switch(n){case"":return o.jsx(o.Fragment,{});case"edit":return o.jsx(xl,{isLoading:a,playlist:t,submit:u,variant:"edit",close:c});case"delete":return o.jsx(Gs,{loading:a,label:`Delete playist ' ${t.name} ' ?`,callback:()=>i({variant:"delete",playlist:t}),close:c})}};return o.jsxs(o.Fragment,{children:[o.jsxs(zj,{children:[o.jsx(dw,{}),o.jsxs("button",{onClick:()=>l("edit"),children:[o.jsx(qs,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs("button",{onClick:()=>l("delete"),children:[o.jsx(Fn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]})]}),o.jsx(Oe,{variant:"animation",ref:s,children:h()})]})}function zj({children:t}){return o.jsx(xr,{className:"left-[calc(100%)] bottom-full w-[120px]",animationClassName:"origin-top-left",appendTo:"parent",children:o.jsx(Nj,{children:o.jsx(pl,{children:t})})})}function fH({variant:t}){const{theme:e}=q(),[n,r]=m.useState(!1),s=m.useRef(null);return o.jsx(o.Fragment,{children:o.jsxs(pr,{children:[o.jsx(gr,{setIsOpenParent:r,ref:s,children:o.jsx(le,{size:"clear",className:`rounded-full p-2.5 ${n?e.content_bg:"bg-"+e.alpha} $
            } `,children:o.jsx(pu,{className:"w-5"})})}),t==="others-playlist"?o.jsx(dH,{}):o.jsx(hH,{})]})})}function yr(t){const e=["","K","M","B"],n=Math.log10(Math.abs(t))/3|0;return n===0?t.toString():(t/Math.pow(10,n*3)).toFixed(1)+e[n]}function mH({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{theme:s}=q(),{currentSongData:i}=ae(Ve),a=t?i==null?void 0:i.song.queue_id.includes(`${t.id}`):!1,l={container:"flex flex-col md:flex-row lg:flex-col",smallText:"text-xs"},c=()=>t?o.jsxs(o.Fragment,{children:[o.jsx(Ce,{className:`block hover:underline ${s.content_hover_text} ${l.smallText}`,to:`/singer/${t.singers[0].id}}`,children:t.singers[0].name}),o.jsxs("p",{className:l.smallText,children:[o.jsx("span",{className:"text-red-500",children:"❤ "}),yr(t.like)]})]}):o.jsx(o.Fragment,{}),u=()=>{if(!t)return o.jsx(o.Fragment,{});switch(r){case"my-playlist":return o.jsx("p",{className:l.smallText,children:t.is_public?"Public":"Private"});case"others-playlist":return o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:l.smallText,children:[o.jsx("span",{className:"text-red-500",children:"❤ "}),yr(t.like)]}),o.jsx("p",{className:l.smallText,children:t.singers.map((h,f)=>o.jsx("span",{children:(f?", ":"")+h.name}))}),o.jsxs("p",{className:l.smallText,children:["Last update:"," ",AF(t.updated_at,{type:"date"})]})]})}};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:l.container,children:[o.jsx("div",{className:"w-full flex-shrink-0 px-10 md:w-1/3 md:px-0 lg:w-full",children:e?o.jsx(he,{className:"pt-[100%] rounded-lg"}):t&&o.jsx(Zy,{data:t,active:a,variant:"image"})}),o.jsxs("div",{className:"flex flex-col text-center mt-3 md:text-left md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:text-center",children:[e?o.jsxs("div",{className:"space-y-1 my-3",children:[o.jsx(he,{className:"h-[24px] w-[170px]"}),o.jsx(he,{className:"h-[17px] w-[170px]"}),o.jsx(he,{className:"h-[17px] w-[60px]"}),o.jsx(he,{className:"h-[17px] w-[100px]"})]}):t&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-xl font-[600] leading-[1.2]",children:t.name}),o.jsx("div",{className:"mt-2.5 text-[#666]",children:t.is_album?c():u()})]}),t&&o.jsxs("div",{className:"flex flex-col items-center mt-3 md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[o.jsx(cH,{}),o.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0",children:[o.jsx(fH,{variant:r}),r!=="my-playlist"&&n!==null&&o.jsx(uH,{isLiked:n,playlist:t})]})]})]})]})})}function Uj(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=YT(),i=nr(),a=Vt(),l=m.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const f=[...t],p=f.pop();p&&(n.current=!1,s(x=>[...x,l]),r(f),a(p))},forward:()=>{const f=[...e],p=f.pop();p&&(n.current=!1,r(x=>[...x,l]),s(f),a(p))},goHome:()=>{a("/")}}}function Mu({className:t=""}){const{backward:e,behind:n,goHome:r}=Uj(),s=()=>{n.length?e():r()};return o.jsx(le,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?o.jsx(dI,{className:"w-6"}):o.jsx(nm,{className:"w-6"})})}function pH(){const{currentPlaylist:t}=ae(gl),{user:e}=ve(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=MV();return!s&&!t?o.jsx(mr,{children:o.jsx(tt,{variant:"with-home-button"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-5",children:o.jsx(Mu,{})}),o.jsxs("div",{className:"lg:flex lg:-mx-3",children:[o.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:o.jsx(mH,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),o.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:o.jsx("div",{className:"mt-[30px] lg:mt-0",children:o.jsx(lH,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]}),o.jsx(Wf,{})]})}function Vj({tab:t}){const{user:e}=ve(),{setUploadedSongs:n,setFavoriteSongs:r,shouldFetchUserSongs:s,shouldFetchFavoriteSongs:i,favoriteSongs:a,uploadedSongs:l}=Pn(),{setErrorToast:c}=ge(),[u,h]=m.useState(!0),f=async()=>{if(e)try{switch(t){case"favorite":{if(i.current){if(i.current=!1,e.liked_song_ids.length){const p=je(An,J(Ks(),"in",e.liked_song_ids)),x=await Nn(p),v=[];e.liked_song_ids.forEach(_=>{const S=x.find(E=>E.id===_);S&&v.push(S)}),r(v)}}else await Os(100);break}case"uploaded":if(s.current){s.current=!1;const p=je(An,J("owner_email","==",e.email),J("is_official","==",!1)),x=await Nn(p);n(x)}else await Os(100)}}catch(p){console.log({message:p}),c()}finally{h(!1)}};return m.useEffect(()=>{f()},[]),{isFetching:u,uploadedSongs:l,favoriteSongs:a,user:e}}function gH(){const{handleSetSong:t}=Xs({variant:"songs"}),{favoriteSongs:e,user:n,isFetching:r}=Vj({tab:"favorite"}),s=i=>{t(i.queue_id,e)};if(n)return o.jsxs(ds,{children:[o.jsx(Om,{variant:"favorite-song",children:r?o.jsx(he,{className:"h-[20px] w-[90px]"}):o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[e.length," Songs"]})}),r&&ol,!r&&o.jsx(o.Fragment,{children:e.length?o.jsx(o.Fragment,{children:o.jsx(Ys,{setSong:s,songs:e})}):o.jsx(tt,{})})]})}function xH({song:t}){return o.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[o.jsxs("div",{className:"flex-grow flex",children:[o.jsx(Ua,{className:"w-[18px] mr-2.5"}),o.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:o.jsx(pt,{src:t.image_url})}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),o.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx(Tt,{className:"animate-spin w-5"}),o.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function yH(){const{theme:t}=q(),{uploadingSongs:e,isUploading:n}=tI(),{handleSetSong:r}=Xs({variant:"songs"}),{uploadedSongs:s,isFetching:i,user:a}=Vj({tab:"uploaded"}),l=u=>{r(u,s)},c=m.useMemo(()=>i?0:e.length+s.length,[e,s,i]);return a?o.jsxs(ds,{children:[o.jsx(Om,{variant:"uploaded-song",children:i?o.jsx(o.Fragment,{children:o.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:o.jsx(he,{className:"h-[20px] w-[90px]"})})}):o.jsxs("div",{className:"flex justify-between items-center w-full",children:[o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[c," Songs"]}),o.jsx("button",{disabled:n,children:o.jsxs("label",{className:`${t.content_bg} items-center space-x-1 hover:opacity-80 py-1 rounded-full flex px-4 cursor-pointer`,htmlFor:"song_upload",children:[o.jsx(My,{className:"w-5"}),o.jsx("span",{className:"",children:"Upload"})]})})]})}),o.jsxs("div",{className:"",children:[i&&ol,!i&&o.jsx(o.Fragment,{children:c?o.jsxs(o.Fragment,{children:[!!s.length&&o.jsx(Ys,{setSong:u=>l(u.queue_id),songs:s,songVariant:"own-song"}),e.map((u,h)=>o.jsx(xH,{song:u},h))]}):o.jsx(tt,{})})]})]}):o.jsx(o.Fragment,{})}function Hj(){const{user:t}=ve(),{setPlaylists:e,shouldFetchUserPlaylists:n,playlists:r}=Pn(),{setErrorToast:s}=ge(),[i,a]=m.useState(!0);return{isFetching:i,playlists:r,user:t,setIsFetching:a,getPlaylist:async()=>{try{if(!t)return;if(a(!0),n.current){n.current=!1;const c=je($r,J(Ks(),"in",t.liked_playlist_ids)),h=(await cs(c)).filter(f=>!f.is_official&&f.owner_email===t.email?!0:!!f.is_public);e(h)}else await Os(100)}catch(c){console.log({message:c}),s()}finally{a(!1)}}}}function vH(){const{user:t}=ve(),{myMusicAddPlaylist:e,isFetching:n}=gw(),r=m.useRef(null),s=()=>{var a;return(a=r.current)==null?void 0:a.close()},i=async(a,l)=>{await e(a,l),s()};if(t)return o.jsxs(o.Fragment,{children:[o.jsxs(le,{onClick:()=>{var a;return(a=r.current)==null?void 0:a.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[o.jsx(hs,{className:"w-6"}),o.jsx("span",{children:"Add new playlist"})]}),o.jsx(Oe,{ref:r,variant:"animation",children:o.jsx("div",{className:"max-h-[80vh] max-w-[85vw] w-[400px]",children:o.jsx(xl,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function wH(){const{isFetching:t,playlists:e,getPlaylist:n}=Hj();return m.useEffect(()=>{n()},[]),o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(be,{title:"Playlist"}),o.jsx(vH,{})]}),o.jsx(wu,{loading:t,playlists:e})]})})}function _H(){const{user:t}=ve(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=Pn(),{setErrorToast:s}=ge(),[i,a]=m.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:a,getSinger:async()=>{try{if(!t)return;if(a(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=je(hf,J(Ks(),"in",t.liked_singer_ids)),u=await ff(c);n(u)}else await Os(100)}catch(c){console.log({message:c}),s()}finally{a(!1)}}}}function bH(){const{isFetching:t,singers:e,getSinger:n}=_H(),r=[...Array(3).keys()].map(s=>o.jsx(px,{variant:"skeleton"},s));return m.useEffect(()=>{n()},[]),t?o.jsxs(o.Fragment,{children:[o.jsx(he,{className:"h-[48px] w-[160px]"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:r})]}):!t&&!e.length?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Singers"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.map((s,i)=>o.jsx(px,{variant:"singer-item",singer:s},i))})]})})}function SH(){const[t,e]=m.useState("Favorite");return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(Mu,{}),o.jsx(wH,{}),o.jsx(bH,{}),o.jsxs("div",{children:[o.jsx(be,{title:"Songs"}),o.jsx("div",{className:"flex space-x-2 my-3",children:o.jsx(fs,{render:n=>n,setTab:e,tab:t,tabs:["Favorite","Uploaded"]})}),t==="Favorite"?o.jsx(gH,{}):o.jsx(yH,{})]})]}),o.jsx(Wf,{})]})}const EH=()=>{const[t,e]=m.useState(),[n,r]=m.useState(""),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState(!1),[h,f]=m.useState(!1),[p,x]=m.useState(),v=m.useRef(0),_=m.useMemo(()=>p!==void 0?a[p]:void 0,[p,a]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:a,setLyrics:l,updateLyric:(E,w)=>{l(b=>{const I={...b[E],...w};return b[E]=I,[...b]})},isFetching:c,setIsFetching:u,isChanged:h,setIsChanged:f,start:v,selectLyricIndex:p,setSelectLyricIndex:x,currentLyric:_}},Wj=m.createContext(null);function kH({children:t}){return o.jsx(Wj.Provider,{value:EH(),children:t})}const vn=()=>{const t=m.useContext(Wj);if(!t)throw new Error("Edit lyric context not found");return t};function TH({audioEle:t,isClickPlay:e,song:n}){const{start:r,baseLyricArr:s,lyrics:i,setLyrics:a,setIsChanged:l,setIsFetching:c,baseLyric:u}=vn(),{setErrorToast:h,setSuccessToast:f}=ge(),p=i.length>=s.length,x=e&&!!s.length&&!p,v=()=>{if(!t||!s.length||p||!n)return;const w=+t.currentTime.toFixed(1);if(r.current===w)return;const b=s[i.length],I=eE({start:r.current,end:w,text:b});if(r.current=w,a(F=>[...F,I]),s.length===i.length+2){const F=s[s.length-1],D=eE({start:r.current,end:n.duration,text:F});a(C=>[...C,D])}l(!0)},_=()=>{if(i.length&&t){const w=i[i.length-1].start;r.current=w,t.currentTime=w,a(b=>b.slice(0,-1)),l(!0)}},S=()=>{if(!n)return;const w={song_id:n.id,base:u,lyrics:JSON.stringify(i)};ot("temp-lyric",w)};return{addLyric:v,removeLyric:_,isEnableAddBtn:x,submit:async()=>{try{if(c(!0),!n)return;const w=Du(Fe),b={lyrics:JSON.stringify(i),base:u},I=tn(Fe,"Songs",n.id);if(n.lyric_id){const F=tn(Fe,"Lyrics",n.lyric_id);w.update(F,b)}else{const F=tn(os(Fe,"Lyrics")),D={lyric_id:F.id,updated_at:Qo()};w.set(F,b),w.update(I,D)}await w.commit(),f("Edit lyric successful"),l(!1),ot("temp-lyric","")}catch(w){console.log({error:w}),h(),S()}finally{c(!1)}}}}function IH({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=ge(),{song:r,setSong:s}=vn(),[i,a]=m.useState(),[l,c]=m.useState(!1);return{songFile:i,song:r,setSongFile:a,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{filePath:h,fileURL:f}=await hw({file:i,folder:"/songs/",namePrefix:"beat"}),p={beat_url:f,beat_file_path:h};await en({collectionName:"Songs",id:r.id,data:p}),r.beat_file_path&&jn({filePath:r.beat_file_path}),s(()=>({...r,...p})),n("Upload song beat successful"),t()}catch(h){console.log({error:h}),e()}finally{c(!1)}}}}function CH({closeModal:t}){const{theme:e}=q(),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:a}=IH({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return o.jsxs("div",{className:"w-[500px] max-w-[80vw] flex flex-col",children:[o.jsx(It,{title:"Song beat",close:t}),o.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a&&(n||(a==null?void 0:a.beat_url))&&o.jsx("audio",{src:n?URL.createObjectURL(n):a.beat_url,controls:!0}),o.jsx(le,{size:"clear",children:o.jsx("label",{htmlFor:"song_upload",className:`${e.content_bg} seld-start rounded-full px-5 py-1.5 cursor-pointer mt-2`,children:o.jsx(My,{className:"w-5"})})}),o.jsx(le,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const RH=40;function jH({closeModal:t}){const{theme:e}=q(),{baseLyric:n,setBaseLyric:r,baseLyricArr:s,setIsChanged:i,lyrics:a}=vn(),[l,c]=m.useState(n),u=m.useRef(null),h=m.useRef(null),f=()=>{const x=l.split(/\r?\n/).filter(v=>v).filter(v=>v.trim()).join(`\r
`);r(x),i(!0),t()};function p(x){const v=[...s];return v[x]=`<div style="color: transparent; border-radius: 4px; background-color: ${e.content_code}">${v[x]}</div>`,v.join(`\r
`)}return m.useEffect(()=>{if(a.length&&u.current&&h.current){const x=RH*(a.length-1);u.current.scrollTop=x,h.current.style.paddingBottom=x+"px"}},[]),m.useEffect(()=>{const x=()=>{if(u.current&&h.current){const v=u.current.scrollTop;h.current.scrollTop=v}};return u.current&&u.current.addEventListener("scroll",x),()=>{u.current&&u.current.removeEventListener("scroll",x)}},[]),o.jsxs("div",{className:"w-[500px] max-w-[85vw]",children:[o.jsx(It,{close:t,title:"Edit lyric"}),o.jsxs("div",{className:"relative h-[60vh] overflow-hidden rounded-md bg-white/10 ",children:[o.jsx("div",{ref:h,className:"whitespace-break-spaces text-transparent px-2 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:p(a.length===s.length?a.length-1:a.length)}}),o.jsx("textarea",{style:{resize:"none"},ref:u,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full no-scrollbar",value:l,onChange:x=>c(x.target.value)})]}),o.jsx("p",{className:"ml-auto mt-5",children:o.jsx(le,{onClick:f,color:"primary",className:"rounded-full",children:"Save"})})]})}function AH(){const{theme:t}=q(),{song:e}=vn(),[n,r]=m.useState(""),s=m.useRef(null),i=m.useRef(null),a=u=>{var h,f;r(u),(h=s.current)==null||h.open(),(f=i.current)==null||f.close()},l=()=>{var u;return(u=s.current)==null?void 0:u.close()},c=()=>{if(n)switch(n){case"lyric":return o.jsx(jH,{closeModal:l});case"tutorial":return o.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[o.jsx(It,{title:"Tutorial",close:l}),o.jsx("div",{className:"h-[500px] max-h-[75vh] overflow-y-auto no-scrollbar",children:o.jsx("img",{className:"w-full border rounded-[16px]",src:"",alt:""})})]});case"song-beat":return e&&o.jsx(CH,{closeModal:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs(pr,{children:[o.jsx(gr,{ref:i,children:o.jsx(le,{size:"clear",className:`${t.content_bg} h-[36px] w-[36px] justify-center rounded-full mt-2`,children:o.jsx(il,{className:"w-6"})})}),o.jsx(xr,{className:"top-[calc(100%+8px)] right-0 z-[9]",appendTo:"parent",children:o.jsx(Nj,{className:"w-[140px]",children:o.jsxs(pl,{children:[o.jsxs("button",{onClick:()=>a("lyric"),children:[o.jsx(qs,{className:"w-5"}),o.jsx("span",{children:"Edit lyric"})]}),o.jsxs("button",{onClick:()=>a("tutorial"),children:[o.jsx(fI,{className:"w-5"}),o.jsx("span",{children:"Tutorial"})]}),o.jsxs("button",{onClick:()=>a("song-beat"),children:[o.jsx(Ua,{className:"w-5"}),o.jsx("span",{children:"Song beat"})]})]})})})]}),o.jsx(Oe,{variant:"animation",ref:s,children:c()})]})}function NH({audioEle:t},e){const{theme:n}=q(),{song:r,lyrics:s}=vn(),i=m.useRef(null),{backward:a,forward:l,handlePlayPause:c,pause:u,seek:h,status:f,isClickPlay:p}=mw({audioEle:t,progressLineRef:i}),{addLyric:x,removeLyric:v,isEnableAddBtn:_,submit:S}=TH({audioEle:t,isClickPlay:p,song:r});m.useImperativeHandle(e,()=>({seek:h,pause:u,submit:S}));const E=()=>{if(!p&&s.length){const I=s[s.length-1].end;t.currentTime=I}c()},w={button:`mt-2 ml-2 space-x-1 ${n.content_bg} rounded-full`,icon:"w-6",arrow:"before:content-[''] before:absolute before:-translate-x-1/2 before:left-[27px]  before:bottom-[calc(100%-1px)] before:z-[-1] before:border-8 before:border-transparent before:border-b-amber-800"},b=()=>{switch(f){case"error":return o.jsx(tm,{className:"w-6"});case"playing":return o.jsx(rm,{className:"w-6"});case"paused":return o.jsx(Vc,{className:"w-6"});case"waiting":return o.jsx(Tt,{className:"w-6 animate-spin"})}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2",children:[o.jsx(II,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),o.jsx(le,{className:w.button,onClick:E,children:b()}),o.jsxs(le,{disabled:!_,onClick:x,className:w.button,children:[o.jsx(vr,{className:"w-6"}),o.jsx("span",{children:"Add"})]}),o.jsxs(le,{disabled:!s.length,onClick:v,className:w.button,children:[o.jsx(Wy,{className:"w-6"}),o.jsx("span",{children:"Remove"})]}),o.jsxs(le,{onClick:()=>a(2),className:w.button,children:[o.jsx(Oy,{className:"w-6"}),o.jsx("span",{children:"2s"})]}),o.jsxs(le,{onClick:()=>l(2),className:w.button,children:[o.jsx("span",{children:"2s"}),o.jsx(Vy,{className:"w-6"})]}),o.jsx("div",{className:"ml-auto",children:o.jsx(AH,{})})]}),o.jsx("div",{ref:i,style:{backgroundColor:"rgba(255,255,255,.3)"},className:"h-1 rounded-full mt-3 w-full"})]})}const PH=m.forwardRef(NH);function FH({lyric:t,openModal:e,seek:n,theme:r,isLast:s}){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[o.jsx("button",{className:`text-[18px] ${r.content_hover_text}`,onClick:()=>n(t.start),children:Ms(+t.start)}),o.jsxs("p",{className:"font-[700] select-none flex items-center",children:[t.text,o.jsx("button",{onClick:e,className:"ml-1",children:o.jsx(IM,{className:"w-5"})})]}),s&&t.end!==t.start&&o.jsx("button",{className:`${r.content_hover_text} pt-[10px]`,onClick:()=>n(t.end),children:Ms(+t.end)})]})})}function DH({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"disable";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"disable"}};return m.useEffect(()=>{n==="active"&&scroll()},[n]),o.jsx("p",{ref:s,className:`${e} transition-transform duration-[.3s] origin-left select-none font-[700] ${i()}`,children:t})}const qj=m.forwardRef(DH);function LH(){const{lyrics:t}=vn(),e=m.useRef(null);return m.useEffect(()=>{e.current&&GT(e.current)},[t.length]),{activeLyricRef:e}}function MH({controlRef:t,modalRef:e}){const{theme:n}=q(),{baseLyricArr:r,lyrics:s,setSelectLyricIndex:i,song:a}=vn(),{activeLyricRef:l}=LH(),c=h=>{var f;(f=t.current)==null||f.seek(h)},u=h=>{var f;typeof h=="number"&&(i(h),(f=e.current)==null||f.open())};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:`flex-grow  overflow-auto flex  no-scrollbar md:text-lg rounded-xl px-2 pt-3 mt-3 ${n.side_bar_bg}`,children:[o.jsx("div",{className:"w-1/2",children:r.length?o.jsx(o.Fragment,{children:r.map((h,f)=>{let p=f===s.length?"active":f<s.length?"done":"coming";return p==="done"&&f===r.length-1&&(p="active"),o.jsx(qj,{ref:p==="active"?l:null,activeColor:n.type==="light"?n.content_text:"",className:"pt-[38px] mr-[24px]",status:p,text:h},f)})}):o.jsx("p",{children:"..."})}),o.jsx("div",{className:"w-1/2 ",children:!!(s!=null&&s.length)&&a&&s.map((h,f)=>o.jsx(FH,{openModal:()=>u(f),seek:c,lyric:h,isLast:f===s.length-1&&f!==r.length-1,theme:n},f))})]})})}function OH({audioRef:t}){const{user:e}=ve(),{baseLyric:n,setSong:r,song:s,setBaseLyricArr:i,setBaseLyric:a,setLyrics:l,isChanged:c,lyrics:u,setIsChanged:h,isFetching:f,start:p}=vn(),[x,v]=m.useState(!0),_=m.useRef(!1),S=za(),E=I=>{if(!I.length)return;const F=I.length-1;if(t.current){const D=I[F].end;p.current=D}},w=()=>{if(!s)return;const I={song_id:s.id,base:n,lyrics:JSON.stringify(u)};ot("temp-lyric",I)},b=async()=>{try{if(!S.id)throw new Error("");const I=await ls({collectionName:"Songs",id:S.id});if(!I.exists())throw new Error("");const F={...I.data(),id:I.id,queue_id:""};if(F.lyric_id){const D=await ls({collectionName:"Lyrics",id:F.lyric_id});if(D.exists()){const{base:C,lyrics:k}=D.data(),j=JSON.parse(k);a(C),l(j),E(j)}}r(F)}catch(I){console.log({message:I})}finally{v(!1)}};return m.useEffect(()=>{_.current||(_.current=!0,b())},[e]),m.useEffect(()=>{(()=>{if(!s)return;const{base:F,lyrics:D,song_id:C}=fn()["temp-lyric"]||{};if(C===s.id){const k=JSON.parse(D);a(F),l(k),E(k),h(!0)}})()},[s]),m.useEffect(()=>{if(!n)return;const I=n.split(/\r?\n/);i(I)},[n]),m.useEffect(()=>{if(!c)return;const I=F=>{F.preventDefault(),w()};return window.addEventListener("beforeunload",I),()=>{window.removeEventListener("beforeunload",I)}},[c,n,u]),{isFetching:x,song:s,isChanged:c,isSubmitting:f}}function Gj(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const $H=["Edit","Record"];function BH(){const[t,e]=m.useState(0),[n,r]=m.useState(),[s,i]=m.useState(""),[a,l]=m.useState([[]]),[c,u]=m.useState([]),[h,f]=m.useState(!1),[p,x]=m.useState("Edit"),[v,_]=m.useState("paused"),S=m.useRef(null),E=m.useRef(null),w=m.useRef(null),b=m.useRef(null),I=m.useRef(null),F=m.useRef(null),D=m.useRef(null),C=m.useRef(null),k=m.useRef(),j=m.useRef(!1),R=m.useRef(0),N=m.useRef(0),P=m.useRef(0),A=m.useRef([]),ee=m.useRef([]),pe=m.useRef(!0),we=m.useRef(!1),ze=m.useMemo(()=>s.split(" ").filter(te=>te.trim()),[s]),H=m.useMemo(()=>ze.map((te,xe)=>({text:te,positions:a[xe]})),[s,a]),X=m.useMemo(()=>{const te=[];return H.forEach(xe=>{const Ee=Gj(xe.text,xe.positions);te.push(...Ee)}),te.filter(xe=>xe)},[s,a]);return{eleRefs:{endTimeRangeRef:E,overlayRef:S,startTimeRangeRef:w,startRefText:b,endRefText:I,currentWordRef:F,growInputRef:D,tempWordRef:C},tabProps:{tab:p,setTab:x,tabs:$H},eventRefs:{playWhenSpaceRef:pe,moveArrowToGrowRef:we},currentWords:ze,currentWordsData:H,currentSplitWords:X,actuallyEndRef:R,playerRef:k,actuallyStartRef:N,tempActuallyStartRef:P,wordsRatioRef:A,mergedGrowListRef:ee,isChangedRef:j,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:h,SetIsOpenEditLyricModal:f,setStatus:_,status:v,text:s,setText:i,cut:a,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const Qj=m.createContext(null);function zH({children:t}){return o.jsx(Qj.Provider,{value:BH(),children:t})}const Nt=()=>{const t=m.useContext(Qj);if(!t)throw new Error("LyricEditorProvider not found");return t};function Kj(t,e){const n=`lyric_${Lu(4)}`,r=document.querySelector("style");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(!t.length)return s+="100%{width:100%}}",r.innerText=s,n;let i=t.reduce((u,h)=>u+h,0);const a=[];let l=0,c=0;for(let u=0;u<e.length-1;u++){const h=e[u],f=t[u];c+=h,l+=f,a.push({progress:Math.round(l/i*100),width:c})}for(const u of a)s+=`${u.progress}%{width:${u.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function UH({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:a,status:l,setStatus:c}=Nt(),{play:u,pause:h,statusRef:f}=mw({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:p}=e,x=()=>{h(),p.current&&(p.current.style.animation="none")},v=()=>{if(t.currentTime=r.current,!s.current&&p.current){const E=Kj(a.current,i.current);p.current.style.animation=`${E} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},_=()=>{f.current==="paused"?v():x()},S=()=>{if(+t.currentTime.toFixed(1)>=n.current)return x()};return m.useEffect(()=>{if(t)return t.addEventListener("timeupdate",S),()=>{t.removeEventListener("timeupdate",S)}},[]),{handlePlayPause:_,_pause:x,_play:v,status:l}}function VH({audioEle:t}){const{playerRef:e}=Nt(),{_play:n,_pause:r,handlePlayPause:s}=UH({audioEle:t});return m.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),o.jsx(o.Fragment,{})}function HH({audioEle:t}){const{tabProps:e}=Nt(),{theme:n}=q();return o.jsxs(o.Fragment,{children:[o.jsx(VH,{audioEle:t}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(fs,{className:"bg-white/10",...e,render:r=>r}),o.jsx(II,{positions:"left",bg:n.content_bg,className:"bg-transparent hover:bg-white/10",audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})}function WH(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=vn(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:a,cut:l}=Nt();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:a};t(n,u),e(!0)}}}function qH({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=vn(),{isChangedRef:s,playerRef:i}=Nt(),{updateLyricTune:a}=WH(),l=()=>{a(),t()},c=u=>{var h;if(typeof n=="number")switch(s.current&&(s.current=!1,a()),(h=i.current)==null||h.pause(),u){case"next":if(n===r.length-1)return;e(f=>f+1);break;case"prev":if(n===0)return;e(f=>f-1);break}};return o.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[o.jsxs(le,{color:"primary",disabled:n===0,onClick:()=>c("prev"),className:"font-playwriteCU",children:[o.jsx(Oy,{className:"w-6"}),o.jsx("span",{children:"Previous"})]}),o.jsxs(le,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),className:"font-playwriteCU",children:[o.jsx("span",{children:"Next"}),o.jsx(Vy,{className:"w-6"})]}),o.jsx(le,{disabled:!s.current,color:"primary",onClick:l,className:"font-playwriteCU",children:"Ok"})]})}function GH(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=Nt(),s=a=>{var l;if(a.key===" "){if(!r.playWhenSpaceRef.current)return;a.preventDefault(),(l=e.current)==null||l.handlePlayPause()}if(a.key==="ArrowRight"||a.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(a.key){case"ArrowRight":a.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":a.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=a=>{if(!r.moveArrowToGrowRef.current)return;const l=a.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(h=>h.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};m.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const Xj=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function Sw(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,a)=>{const l=e[a].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((h,f)=>(s++,+(h+f).toFixed(1)),0);r.push(u)}}),r}function QH(){const{selectLyricIndex:t,currentLyric:e}=vn(),{eleRefs:n,actuallyEndRef:r,mergedGrowListRef:s,actuallyStartRef:i,wordsRatioRef:a,setGrowList:l,setCut:c,setText:u,currentWords:h}=Nt(),{tempWordRef:f,endTimeRangeRef:p,startTimeRangeRef:x,startRefText:v,endRefText:_}=n;m.useEffect(()=>{if(!f.current)return;const S=Xj(f.current);a.current=S},[h]),m.useEffect(()=>{if(!e)return;const S=e.tune.grow,E=e.text.split(" ").filter(b=>b.trim());u(e.text),c(e.cut);const w=Sw(E,e.cut,S);l(S),s.current=w,_.current&&v.current&&x.current&&p.current&&(i.current=e!=null&&e.tune?e.tune.start:e.start,v.current.innerText=`${e.start} / ${i.current}`,x.current.max=e.end+"",x.current.value=i.current+"",r.current=e!=null&&e.tune?e.tune.end:e.end,_.current.innerText=`${r.current} / ${e.end}`,p.current.max=e.end+"",p.current.value=r.current+"")},[t])}function KH({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:a,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:h}=Nt(),[f,p]=m.useState(!1),[x,v]=m.useState([]),_=m.useRef(Date.now()),S=m.useRef(!1),E=m.useRef(!1),w=()=>{const P=+((Date.now()-_.current)/1e3).toFixed(1);v(A=>[...A,P])},b=()=>{var P;_.current=Date.now(),S.current||(S.current=!0,(P=e.current)==null||P.play(),p(!0))},I=()=>{S.current&&w()},F=P=>{P.key===" "&&(E.current||(P.preventDefault(),E.current=!0,b()))},D=P=>{P.key===" "&&(P.preventDefault(),I(),E.current=!1)},j={onPointerDown:()=>{b()},onPointerUp:()=>{I()}},R=()=>{var P;(P=e.current)==null||P.pause(),S.current=!1,v([]),p(!1)},N=()=>{n.current=!0,i(x);const P=Sw(h,a,x);c.current=P,s("Edit"),R()};return m.useEffect(()=>{x.length===u.length&&N()},[x]),m.useEffect(()=>{var P;if(r==="Record")return(P=e.current)==null||P.pause(),window.addEventListener("keydown",F),window.addEventListener("keyup",D),t.currentTime=l.current,()=>{var A;(A=e.current)==null||A.pause(),window.removeEventListener("keydown",F),window.removeEventListener("keyup",D)}},[r]),{localGrowList:x,buttonProps:j,clear:R,isRecording:f}}function XH({audioEle:t}){const{currentSplitWords:e}=Nt(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=KH({audioEle:t});return o.jsxs(o.Fragment,{children:[o.jsx(le,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:o.jsx(Vi,{className:"w-6"})}),o.jsxs("div",{className:"h-[240px] flex flex-col justify-center",children:[o.jsx("div",{className:"md:text-xl font-[700]",children:e.map((a,l)=>o.jsxs("span",{className:`${l<r.length?"text-[#ffed00]":""} leading-[1]`,children:[a," "]},l))}),o.jsx("p",{className:"mt-5 text-center md:hidden",children:o.jsx(le,{...n,color:"primary",children:"Record"})})]})]})}function YH(){const{currentLyric:t}=vn(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:a}=Nt(),{startRefText:l,endRefText:c}=e;return{setEndPoint:x=>{if(!t)return;const v=+x.toFixed(1);n.current=!0,r.current=v,c.current&&(c.current.textContent=`${v} / ${t.end}`),i.current&&(r.current=v,s.current=v-1)},setStartPoint:x=>{if(!t)return;const v=+x.toFixed(1);n.current=!0,s.current=v,l.current&&(l.current.textContent=`${t.start} / ${v}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:x=>{x.variant==="range"&&x.value<1||(n.current=!0,a(v=>{const _=[...v];let S=_[x.index];switch(x.variant){case"range":S=x.value;break;case"button":S=+(x.action==="minus"?S-.2:S+.2).toFixed(1)}return _[x.index]=S,_}))}}}function JH(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=YH(),{currentLyric:s}=vn(),{wordIndex:i,growList:a,eleRefs:l}=Nt();return s?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mt-5 space-x-2",children:[o.jsxs("label",{htmlFor:"start",className:"flex-shrink-0 w-[150px]",children:["Start: ",o.jsx("span",{ref:l.startRefText})]}),o.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),o.jsxs("div",{className:"flex items-center mt-3 space-x-2",children:[o.jsxs("label",{htmlFor:"end",className:"flex-shrink-0 w-[150px]",children:["End: ",o.jsx("span",{ref:l.endRefText})]}),o.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),o.jsxs("div",{className:"flex items-center mt-3",children:[o.jsxs("label",{htmlFor:"grow",className:"flex-shrink-0 w-[150px] mr-2 leading-[1]",children:["Grow: ",a[i]]}),o.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:30,step:.2,className:"w-full",value:a[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):o.jsx(o.Fragment,{})}function ZH(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:a}=Nt(),[l,c]=m.useState(!1),u=m.useRef(null),h=()=>{if(!u.current)return;const f=u.current.value.split(/\r?\n/).filter(v=>v).map(v=>v.trim()).join(" ").split(" ").filter(v=>v).join(" ");n(f);const p=f.split(" ").map(()=>0),x=f.split(" ").map(()=>[]);s(x),i(p),r.current=p,c(!1)};return m.useEffect(()=>{l?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,u.current&&(u.current.value=a)):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[l]),o.jsxs("div",{className:"mt-3 relative pt-5",children:[o.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:l?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>c(!1),children:o.jsx(Vi,{className:"w-5"})}),o.jsx("button",{onClick:h,children:o.jsx(gu,{className:"w-5"})})]}):o.jsx("button",{onClick:()=>c(!0),children:o.jsx(qs,{className:"w-5"})})}),o.jsx("div",{className:"flex justify-center",children:l?o.jsx("textarea",{ref:u,className:`${Yy} w-full mt-3 bg-white/10`}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[a,o.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[#ffed00] whitespace-nowrap w-0",children:a})]})})})]})}function eW({text:t,openModal:e,isShowScissor:n,index:r}){const{theme:s}=q(),{growList:i,setWordIndex:a,wordIndex:l,eventRefs:c,eleRefs:u}=Nt(),h=l===r,f=()=>{var p;r!==-1&&(a(r),c.moveArrowToGrowRef.current=!0,(p=u.growInputRef.current)==null||p.focus())};return o.jsxs("div",{ref:p=>h?u.currentWordRef.current=p:{},style:{flexGrow:i[r]!==0?i[r]:1},onClick:f,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center border ${s.content_border} ${h?s.content_bg:"bg-"+s.alpha}`,children:[o.jsx("span",{children:t}),n&&h&&o.jsx(le,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-black/10 p-1.5",children:o.jsx(mI,{className:"w-5"})})]})}function tW({wordData:t,wordIndex:e,closeModal:n}){const{theme:r}=q(),{currentLyric:s,selectLyricIndex:i}=vn(),{setCut:a,cut:l}=Nt(),[c,u]=m.useState(t.positions),h=m.useMemo(()=>Gj(t.text,c).filter(v=>v),[c]),f=m.useMemo(()=>t.text.split(""),[]),p=v=>{const _=[...c],S=c.findIndex(E=>E===v);S===-1?_.push(v):_.splice(S,1),u(_)},x=()=>{if(!s||i===void 0)return;const v=c.sort((S,E)=>S-E),_=[...l];_[e]=v,a(_),n()};return o.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[o.jsx(be,{title:"Split word "}),o.jsx("div",{className:"flex justify-center space-x-5",children:h.map((v,_)=>o.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:v},_))}),o.jsx("div",{className:"mt-3 flex justify-center",children:f.map((v,_)=>{const S=c.includes(_);return o.jsxs("div",{children:[f.length>1&&_?o.jsx("button",{onClick:()=>p(_),className:` p-1 rounded-full ${S?r.content_bg:"hover:bg-black/10"}`,children:o.jsx(mI,{className:"w-5"})}):"",o.jsx("span",{className:"text-[50px] font-[500]",children:v})]},_)})}),o.jsx("p",{className:"mt-5 text-right",children:o.jsx(le,{onClick:x,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function nW(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=Nt(),[r,s]=m.useState(),i=m.useRef(null),a=m.useMemo(()=>{const u={},h=e.map(p=>p.positions.length);let f=0;return h.forEach((p,x)=>{p===0?(u[f]=x,f++):p>0&&[...Array(p+1).keys()].forEach(()=>{u[f]=x,f++})}),u},[e]),l=m.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var h;s(u),(h=i.current)==null||h.open()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex h-[44px] mt-5",children:t.map((u,h)=>{const f=a[h],p=n[f];return o.jsx(eW,{isShowScissor:p?p.length>1:!1,index:h,openModal:()=>c(f),text:u},h)})}),o.jsx(Oe,{variant:"animation",ref:i,children:l&&r!==void 0&&o.jsx(tW,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function rW(){const{status:t,playerRef:e}=Nt();return o.jsx(le,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?o.jsx(rm,{className:"w-6"}):o.jsx(Vc,{className:"w-6"})})}function sW(){const{eventRefs:t,tabProps:{tab:e}}=Nt();m.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function iW({closeModal:t}){const{song:e}=vn(),{eleRefs:n,currentWords:r,tabProps:s}=Nt();GH(),QH(),sW();const i=m.useRef(null);return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"max-w-[90vw] w-[600px] relative",children:[o.jsx(It,{title:"Edit lyric",close:t}),o.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),o.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((a,l)=>o.jsxs("span",{children:[a,o.jsx("span",{children:" "})]},l))}),i.current&&o.jsx(HH,{audioEle:i.current}),o.jsxs("div",{className:"mt-5",children:[i.current&&o.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:o.jsx(XH,{audioEle:i.current})}),o.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[o.jsx(rW,{}),o.jsx(JH,{}),o.jsx(ZH,{}),o.jsx(nW,{})]})]}),o.jsx(qH,{closeModal:t})]})})}function aW(t){return o.jsx(zH,{children:o.jsx(iW,{...t})})}function oW({children:t}){const{theme:e}=q(),n=m.useRef(null),r=m.useRef(null),s=m.useRef(null),{isFetching:i,song:a,isChanged:l,isSubmitting:c}=OH({audioRef:r}),u=()=>{var h,f;(h=n.current)==null||h.pause(),(f=n.current)==null||f.submit()};return o.jsxs(o.Fragment,{children:[o.jsx("audio",{className:"hidden",ref:r,src:a==null?void 0:a.song_url}),i?o.jsx(mr,{children:o.jsx(Tt,{className:"w-6 animate-spin"})}):a&&o.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden",children:[t,o.jsx(be,{title:` Edit lyric - ${a==null?void 0:a.name}`}),o.jsx("div",{className:"mt-3",children:r.current&&o.jsxs(o.Fragment,{children:[o.jsx(PH,{audioEle:r.current,ref:n}),o.jsx(Oe,{persisted:!0,variant:"animation",ref:s,children:o.jsx(aW,{closeModal:()=>{var h;return(h=s.current)==null?void 0:h.close()}})})]})}),o.jsx(MH,{modalRef:s,controlRef:n}),o.jsx(le,{className:`${e.content_bg} font-playwriteCU self-end md:self-start rounded-full mt-5 `,variant:"primary",disabled:!l,isLoading:c,onClick:u,children:"Save"})]})]})}function Yj(){return o.jsx(kH,{children:o.jsx(oW,{})})}function lW(){return o.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full",children:[o.jsx(Mu,{className:"mb-1 self-start"}),o.jsx(Yj,{})]})}const cW=["Song","Playlist","Singers"],uW={songs:[],playlists:[],singers:[]};function dW(){const[t,e]=m.useState(!1),[n,r]=m.useState("Song"),s=xT(),[i,a]=m.useState(uW),l=u=>{a(h=>({...h,...u}))},c=async()=>{try{const u=s[0].get("q");if(!u)return;switch(n){case"Song":{const h=je(An,J("is_official","==",!0),J("name",">=",u),J("name","<=",u+"")),f=await Nn(h);l({songs:f});break}case"Playlist":{const h=je($r,J("is_public","==",!0),J("name",">=",u),J("name","<=",u+"")),f=await cs(h);l({playlists:f});break}case"Singers":{const h=je(hf,J("name",">=",u),J("name","<=",u+"")),f=await ff(h);l({singers:f});break}}}catch(u){console.log({message:u})}finally{e(!1)}};return m.useEffect(()=>(c(),()=>{e(!0)}),[s[0].get("q"),n]),m.useEffect(()=>()=>{r("Song")},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:c,result:i,tabs:cW}}function hW(){const{isFetching:t,result:e,tab:n,setTab:r,tabs:s}=dW(),{handleSetSong:i}=Xs({variant:"search-bar"}),{getRecommend:a}=bw(),l=h=>{i(h.queue_id,[h]),a(h)},c=()=>{switch(n){case"Song":return ol;case"Playlist":return o.jsx("div",{className:"flex",children:Xy})}},u=()=>{switch(n){case"Song":return e.songs.length?o.jsx(Ys,{setSong:l,songs:e.songs}):o.jsx(tt,{className:"mx-auto"});case"Playlist":return e.playlists.length?o.jsx(wu,{loading:!1,playlists:e.playlists}):o.jsx(tt,{className:"mx-auto"});case"Singers":return e.singers.length?o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.singers.map((h,f)=>o.jsx(px,{variant:"singer-item",singer:h},f))}):o.jsx(tt,{className:"mx-auto"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-5",children:o.jsx(Mu,{})}),o.jsxs("div",{className:"flex items-center mt-3",children:[o.jsx("div",{className:"text-2xl font-bold",children:"Result"}),o.jsx("div",{className:`ml-5 ${t?"disable":""}`,children:o.jsx(fs,{tabs:s,render:h=>h,tab:n,setTab:r})})]}),o.jsx(ds,{children:o.jsxs("div",{className:"mt-5",children:[t&&c(),!t&&u()]})})]})}function fW(){const{theme:t}=q();return o.jsxs(mr,{children:[o.jsx("h1",{className:`text-[30px] font-bold ${t.text_color}`,children:"Page Not found"}),o.jsx("p",{className:"text-center",children:o.jsx(Ce,{to:"/",className:`${t.content_bg} inline-block mt-5 text-center rounded-full px-5 py-1.5 cursor-pointer`,children:"Go home"})})]})}function mW(){const{theme:t}=q(),e=Vt(),n=async()=>{await kC(Fa),e("/login")};return o.jsxs("div",{className:`${t.container} flex flex-col justify-center items-center min-h-screen`,children:[o.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.text_color}`,children:"Unauthorized"}),o.jsx(le,{onClick:n,variant:"primary",className:`${t.content_bg} font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]`,children:"Exit"})]})}function pW(){const[t]=vv(Fa),{theme:e}=q(),{action:n}=$m(),r=Vt(),s=async()=>{try{await n("login")}catch(i){console.log(i)}};return m.useEffect(()=>{if(t){r("/");return}},[]),o.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${e.container} ${e.text_color}`,children:[o.jsx(le,{onClick:s,variant:"default",className:`${e.content_bg} font-bold text-[#fff] text-[30px] rounded-full`,children:"Login with google"})," "]})}function gW(){const[t,e]=m.useState(),[n,r]=m.useState(!0),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:a,albums:c,setAlbums:u,setPlaylists:l}}const Jj=m.createContext(null);function xW({children:t}){return o.jsx(Jj.Provider,{value:gW(),children:t})}function Zs(){const t=m.useContext(Jj);if(!t)throw new Error("SingerProvider not provided");return t}let yW="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",vW=(t=21)=>{let e="",n=t|0;for(;n--;)e+=yW[Math.random()*64|0];return e};function wW(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:a}=Zs(),{setErrorToast:l}=ge(),c=za(),u=m.useRef(!1),h=async()=>{try{if(!c.id)return;const f=await ls({collectionName:"Singers",id:c.id});if(!f.exists())return;const p={...f.data(),id:c.id},x=je(An,J(`singer_map.${p.id}`,"==",!0)),v=await Nn(x,{getQueueId:()=>vW(4)+"_"+p.id}),_=je($r,J(`singer_map.${p.id}`,"==",!0)),S=await cs(_),E=[],w=[];S.forEach(b=>b.is_album?w.push(b):E.push(b)),s(v),e(p),a(E),n(w)}catch(f){console.log({error:f}),l()}finally{t(!1)}};return m.useEffect(()=>{u.current||(u.current=!0,h())},[]),{singer:i,isFetching:r}}function gg({onClick:t,children:e}){const{songs:n}=Zs();return o.jsx(le,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function _W(){const{songs:t,singer:e}=Zs(),{playStatus:n}=ae(Dn),{currentSongData:r}=ae(Ve),{handleSetSong:s}=Xs({variant:"playlist"}),{handlePlayPause:i}=Js(),a=()=>{const l=t[0];s(l.queue_id,t)};if(e&&r!=null&&r.song.queue_id.includes(e.id))switch(n){case"loading":case"paused":return o.jsx(gg,{onClick:i,children:o.jsx(F0,{className:"w-7"})});default:return o.jsx(gg,{onClick:i,children:o.jsx(gI,{className:"w-7"})})}else return o.jsx(gg,{onClick:a,children:o.jsx(F0,{className:"w-7"})})}function bW(){const{user:t,updateUserData:e}=ve(),{setSingers:n}=Pn(),[r,s]=m.useState(!1);return{likeSinger:async({singer:a})=>{try{if(s(!0),!t)return;const l=Du(Fe),c=tn(Fe,"Users",t.email),u=tn(Fe,"Singers",a.id),h=[...t.liked_singer_ids],f=h.findIndex(_=>_===a.id),p=f===-1;p?h.unshift(a.id):h.splice(f,1);const x={liked_singer_ids:h},v={like:tw(p?1:-1)};l.update(c,x),l.update(u,v),await l.commit(),n(p?_=>[a,..._]:_=>_.filter(S=>S.id!==a.id)),e(x)}catch(l){console.log({error:l})}finally{s(!1)}},isFetching:r,user:t}}function SW(){const{theme:t}=q(),{singer:e}=Zs(),{likeSinger:n,isFetching:r,user:s}=bW(),i=m.useMemo(()=>s&&e?s.liked_singer_ids.includes(e.id):!1,[s]);return e?o.jsx("button",{onClick:()=>n({singer:e}),className:`rounded-full p-2  ${i?t.content_bg:"bg-"+t.alpha}`,children:r?o.jsx(Tt,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:i?o.jsx(sm,{className:"w-5"}):o.jsx(xu,{className:"w-5"})})}):o.jsx(o.Fragment,{})}function EW(){const{theme:t}=q(),[e,n]=m.useState(""),r=m.useRef(null),{singer:s}=Zs(),i=a=>{var l;n(a),(l=r.current)==null||l.open()};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>i("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),o.jsx("div",{className:"!mt-auto",children:o.jsxs("div",{className:"space-x-2 flex items-end",children:[o.jsx(_W,{}),o.jsx(SW,{}),o.jsxs(pr,{children:[o.jsx(gr,{children:o.jsx("button",{className:`p-2 bg-${t.alpha} hover:brightness-95 rounded-full`,children:o.jsx(il,{className:"w-5"})})}),o.jsx(xr,{appendTo:"parent",children:o.jsx(Qs,{theme:t,p:"clear",className:"py-2",children:o.jsx(pl,{className:"w-[140px]",children:o.jsx(dw,{})})})})]})]})}),e&&o.jsx(Oe,{ref:r,variant:"animation",children:e==="more"&&s&&o.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:s.description})})]})}function kW(){const{theme:t}=q(),{isFetching:e,singer:n}=Zs();return!e&&!n?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:`md:flex bg-transparent relative z-0 pb-5 md:p-10 ${t.text_color} `,children:[o.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:o.jsxs("div",{className:"relative h-full w-full",children:[o.jsx("div",{className:`absolute z-[-5] inset-0 ${t.type==="light"?"bg-white/50":"bg-black/50"}  `}),o.jsx("img",{src:(n==null?void 0:n.image_url)||EI,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),o.jsx("div",{className:"w-[70%] z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:e?o.jsx(he,{className:"pt-[100%] "}):o.jsx(yu,{children:o.jsx(pt,{src:n==null?void 0:n.image_url,blurHashEncode:n==null?void 0:n.blurhash_encode})})}),o.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?o.jsxs(o.Fragment,{children:[o.jsx(he,{className:"h-[60px] w-full md:w-[200px]"}),o.jsx(he,{className:"h-[24px] w-[200px]"}),o.jsx(he,{className:"h-[120px] w-full md:w-[100%]"})]}):n&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:n.name}),o.jsxs("p",{children:[o.jsx("span",{className:"text-red-500",children:"❤ "}),yr(n.like)]}),o.jsx("p",{className:"line-clamp-2",children:n.description}),o.jsx(EW,{})]})})]})})}function TW(){const{handleSetSong:t}=Xs({variant:"songs"}),{isFetching:e,songs:n}=Zs();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Popular Songs"}),o.jsx(ds,{children:e?ol:o.jsx(Ys,{songs:n,setSong:r=>t(r.queue_id,[r])})})]})})}function IW(){const{isFetching:t,playlists:e}=Zs();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Popular Playlists"}),o.jsx(wu,{playlists:e,loading:t})]})})}function CW(){const{albums:t,isFetching:e}=Zs();return o.jsxs(o.Fragment,{children:[o.jsx(be,{title:"Albums"}),o.jsx(wu,{playlists:t,loading:e})]})}function RW(){const{isFetching:t,singer:e}=wW();return!t&&!e?o.jsx(mr,{children:o.jsx(tt,{variant:"with-home-button"})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(Mu,{}),o.jsx(kW,{}),o.jsx(TW,{}),o.jsx(CW,{}),o.jsx(IW,{})]}),o.jsx(Wf,{})]})}function jW(){return o.jsx(xW,{children:o.jsx(RW,{})})}function AW(){return o.jsx(o.Fragment,{children:o.jsx("div",{className:"",children:o.jsx("p",{children:"This is dashboard page"})})})}const NW=["All","Result"];function PW(){const{uploadedSongs:t,setUploadedSongs:e}=Pn(),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=os(Fe,"Songs"),x=je(p,J("name",">=",n),J("name","<=",n+""),J("is_official","==",!0)),v=await Nn(x);e(v),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},h=async()=>{try{i(!0);const f=os(Fe,"Songs"),p=je(f,J("is_official","==",!0),$i("updated_at","desc")),x=await Nn(p);e(x)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&h()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,uploadedSongs:t,tab:a,setTab:l,tabs:NW}}const nE=mu("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[#5a9e87] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function FW({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:a,type:l="button",variant:c,disabled:u,rounded:h,className:f,active:p,href:x},v){const _=u||e,S="before:shadow-none translate-y-[2px]";return o.jsx(o.Fragment,{children:x?o.jsx(Ce,{to:x,className:`${nE({variant:c,size:s,color:i,fontWeight:a,rounded:h,border:r,className:f})} ${p?S:""}`,children:n}):o.jsx("button",{ref:v,type:l||"button",onClick:t,disabled:_,className:`${nE({variant:c,size:s,color:p?"primary":i,border:r,fontWeight:a,className:f})} ${p?S:""}`,children:e?o.jsx(Tt,{className:"w-6 animate-spin"}):n})})}const ce=m.forwardRef(FW),DW=mu("border-[2px] p-3 border-b-[6px] rounded-[14px]",{variants:{colors:{primary:"bg-white border-[#e1e1e1]",second:"bg-[#cee9b6] border-[#4a826f]",third:"bg-white border-[#4a826f]",clear:""}},defaultVariants:{colors:"primary"}});function pn({children:t,onClick:e,colors:n,className:r=""}){return o.jsx("div",{onClick:()=>e?e():{},className:`${DW({colors:n,className:r})} `,children:t})}function Ou({className:t=""}){return o.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:o.jsx(Tt,{className:"w-6 animate-spin"})})}function ei({children:t}){return o.jsx("div",{className:"bg-white  overflow-hidden p-3 rounded-lg",children:t})}function _r({children:t,className:e="w-[400px]"}){return o.jsx("div",{className:`max-h-[80vh] max-w-[90vw] ${e}`,children:t})}function yl({children:t,className:e=""}){const n=`mt-2 ml-2 flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${e}`;return o.jsx("div",{className:n,children:t})}function LW({children:t,...e},n){return o.jsx(Oe,{variant:"animation",wrapped:!1,...e,ref:n,children:o.jsx(ei,{children:t})})}const br=m.forwardRef(LW);function vl({handleSubmit:t,setValue:e,value:n,className:r="",inputRef:s}){const i=a=>{a.preventDefault(),n.trim()&&t(a)};return o.jsx(pn,{className:r,children:o.jsxs("form",{onSubmit:i,className:"flex gap-2 justify-between items-center",children:[o.jsxs("div",{className:"relative flex-grow flex items-center text-[#333]",children:[o.jsx(rn,{type:"text",ref:s,value:n,onChange:a=>e(a.target.value),placeholder:"..."}),n&&o.jsx("button",{type:"button",onClick:()=>{e("")},className:"absolute right-3",children:o.jsx(Vi,{className:"w-6"})})]}),o.jsx(ce,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:o.jsx(Hy,{className:"w-6"})})]})})}function MW(){const[t,e]=m.useState(),[n,r]=m.useState(),[s,i]=m.useState([]);return{imageFile:n,setImageFile:r,playlist:t,setPlaylist:e,songs:s,setSongs:i,updatePlaylistData:l=>{t&&e({...t,...l})}}}const Zj=m.createContext(null);function OW({children:t}){return o.jsx(Zj.Provider,{value:MW(),children:t})}const Ew=()=>{const t=m.useContext(Zj);if(!t)throw new Error("PlaylistProvider not provided");return t};function Bm(){const{user:t}=ve(),{playlist:e,songs:n,setSongs:r,updatePlaylistData:s}=Ew(),[i,a]=m.useState(!1),l=Vt(),{setErrorToast:c,setSuccessToast:u}=ge(),h=async(p,x)=>{const v={};p.forEach(S=>v[S.id]=!0);const _={singers:p,singer_map:v};await en({collectionName:"Playlists",id:x,data:_}),s(_)};return{isFetching:i,action:async p=>{try{if(!t)throw new Error("User not found");if(!e)throw new Error("playlist not found");switch(a(!0),p.variant){case"delete-playlist":{await Promise.all([Dm({collectionName:"Playlists",id:e.id}),e.image_file_path?jn({filePath:e.image_file_path}):()=>{}]),l("/dashboard/playlist");break}case"add-songs":{const x=[...n,...p.songs],_={song_ids:x.map(S=>S.id)};await en({collectionName:"Playlists",id:e.id,data:_,msg:">>> api: update playlist doc"}),s(_),r(x),u("Songs added");break}case"edit-playlist":{const x={...e,...p.playlist};if(p.imageFile){const v=await Gi({imageFile:p.imageFile});e.image_file_path&&await jn({filePath:e.image_file_path}),Object.assign(x,v)}await en({collectionName:"Playlists",data:x,id:e.id,msg:">>> api: set playlist doc"}),s(x),u("Playlist edited");break}case"remove-song":{const x=n.filter(_=>_.id!==p.song.id),v={song_ids:x.map(_=>_.id)};await en({collectionName:"Playlists",id:e.id,data:v,msg:">>> api: update playlist doc"}),r(x),u(`'${p.song.name}' removed`);break}case"update-image":{const x={image_url:p.song.image_url,blurhash_encode:p.song.blurhash_encode,image_file_path:""};e.image_file_path&&await jn({filePath:e.image_file_path}),await en({collectionName:"Playlists",data:x,id:e.id,msg:">>> api: set playlist doc"}),s(x),u("Playlist edited;");break}case"remove-singer":{const x=e.singers.filter(v=>v.id!==p.singer.id);h(x,e.id),u("Singer removed");break}case"add-singer":{const x=[...e.singers];if(x.find(_=>_.id===p.singer.id))return;x.push(p.singer),h(x,e.id),u("Singer added");break}}}catch(x){console.log({message:x}),c("")}finally{a(!1)}},playlist:e}}function $W({song:t}){const{action:e,isFetching:n,playlist:r}=Bm(),{close:s}=wr(),i=m.useRef(null),a={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},l=()=>{var u;(u=i.current)==null||u.open(),s()},c=async u=>{var h;switch(u.variant){case"remove-song":await e({variant:"remove-song",song:u.song});break;case"update-image":await e({variant:"update-image",song:u.song});break;case"add-singer":await e({variant:"add-singer",singer:u.singer}),(h=i.current)==null||h.close()}s()};return o.jsxs(o.Fragment,{children:[o.jsxs(eA,{song:t,children:[o.jsxs("button",{onClick:()=>c({variant:"remove-song",song:t}),children:[o.jsx(Fn,{className:"w-5"}),o.jsx("span",{children:"Remove"})]}),o.jsxs("button",{onClick:l,children:[o.jsx(vr,{className:"w-5"}),o.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&o.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>c({variant:"update-image",song:t}),children:[o.jsx(al,{className:"w-5"}),o.jsx("span",{children:"Set playlist image"})]}),n&&o.jsx("div",{className:a.overlay,children:o.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),o.jsx(br,{ref:i,children:o.jsxs(_r,{children:[o.jsx(be,{title:"Singers"}),o.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map((u,h)=>o.jsx("button",{onClick:()=>c({variant:"add-singer",singer:u}),children:u.name},h))})]})})]})}function BW(){const{setUploadedSongs:t,uploadedSongs:e}=Pn(),[n,r]=m.useState(!1),{setSuccessToast:s,setErrorToast:i}=ge();return{actions:async l=>{try{r(!0);const c=Du(Fe),u=tn(Fe,"Songs",l.song.id);switch(l.variant){case"delete":{const h=e.filter(f=>f.id!==l.song.id);if(c.delete(u),l.song.lyric_id){const f=tn(Fe,"Lyrics",l.song.lyric_id);c.delete(f)}await Promise.all([c.commit(),Rj(l.song)]),t(h),s(`'${l.song.name}' deleted`);break}}}catch(c){console.log({message:c}),i()}finally{r(!1)}},isFetching:n}}function zW({song:t}){const{close:e}=wr(),{actions:n,isFetching:r}=BW(),[s,i]=m.useState(""),a=m.useRef(null),l=()=>{var f;return(f=a.current)==null?void 0:f.close()},c=f=>{var p;i(f),e(),(p=a.current)==null||p.open()},u=async f=>{switch(f.variant){case"delete":await n({variant:"delete",song:t})}l()},h=()=>{switch(s){case"":return o.jsx(o.Fragment,{});case"edit":case"delete":return o.jsx(Gs,{loading:r,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",callback:()=>u({variant:"delete",song:t}),close:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs(eA,{song:t,children:[o.jsxs(Ce,{to:`/dashboard/song/${t.id}/edit`,children:[o.jsx(pu,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(Ce,{to:`/dashboard/lyric/${t.id}`,children:[o.jsx(Uy,{className:"w-5"}),o.jsx("span",{children:"Lyric"})]}),o.jsxs("button",{onClick:()=>c("delete"),children:[o.jsx(Fn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]})]}),o.jsx(Oe,{ref:a,variant:"animation",children:h()})]})}function UW({song:t}){return o.jsx("div",{className:"px-2 mb-3",children:o.jsxs("div",{className:"p-3 bg-white/10 rounded-md flex",children:[o.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:o.jsx(pt,{className:"object-cover h-full",src:t.image_url})}),o.jsxs("div",{className:"ml-2 text-sm",children:[o.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),o.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function eA({song:t,children:e}){const{theme:n}=q();return o.jsx(o.Fragment,{children:o.jsx(xr,{className:"w-[260px]",appendTo:"portal",children:o.jsxs(Qs,{p:"clear",className:"py-2",theme:n,children:[o.jsx(UW,{song:t}),o.jsx(pl,{className:"hover:[&>*:not(div.absolute)]:bg-black/5",children:e}),o.jsxs("p",{className:"text-sm text-center opacity-70 mt-3",children:["Provided by ",t.distributor]})]})})})}function VW({song:t,variant:e}){const n=()=>{switch(e){case"songs":return o.jsx(zW,{song:t});case"playlist":return o.jsx($W,{song:t})}};return o.jsx(o.Fragment,{children:o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{children:o.jsx(ce,{size:"clear",color:"second",className:"p-1",children:o.jsx(il,{className:"w-5"})})}),n()]})})}function tA({song:t,className:e="",variant:n}){return o.jsxs("tr",{className:e,children:[o.jsx("td",{children:o.jsx(Ce,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),o.jsx("td",{children:t.singers.map((r,s)=>o.jsxs(Ce,{className:"hover:underline",to:`/dashboard/singer/${r.id}`,children:[!!s&&", ",r.name]},s))}),o.jsx("td",{children:yr(t.like)}),o.jsx("td",{children:o.jsx(VW,{variant:n,song:t})})]})}function nA({value:t,setValue:e,inputRef:n}){return o.jsxs(pn,{className:"flex gap-2 justify-between items-center",children:[o.jsx(rn,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),o.jsx(ce,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?o.jsx(Vi,{className:"w-6"}):o.jsx(Hy,{className:"w-6"})})]})}function Qi({className:t="",children:e,...n}){return o.jsx(pn,{children:o.jsx("div",{className:"rounded-md overflow-hidden",children:o.jsx(kI,{className:`[&_td]:text-sm hover:[&_tr]:bg-black/5 [&_tbody_tr]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 ${t}`,...n,children:e})})})}function HW(){const{isFetching:t,uploadedSongs:e,tabs:n,setTab:r,tab:s,...i}=PW();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Songs"}),o.jsxs("div",{className:"flex justify-between items-start mt-3",children:[o.jsx(vl,{...i}),o.jsxs(ce,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[o.jsx(hs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),o.jsx("div",{className:`mt-5 w-fit ${s==="All"?"pointer-events-none":""} self-start`,children:o.jsx(fs,{tabs:n,render:a=>a,tab:s,setTab:r})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(he,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Qi,{colList:["Name","Singer","Like"],children:e.length?e.map((a,l)=>o.jsx(tA,{variant:"songs",song:a},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:3,className:"text-center",children:o.jsx(tt,{})})})})]})]})}function WW(){const[t,e]=m.useState(),[n,r]=m.useState(),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState(),[h,f]=m.useState(),[p,x]=m.useState(),v=m.useRef("add");return{imageFile:c,setImageFile:u,songFile:t,setSongFile:e,songData:n,song:h,setSong:f,variant:v,setSongData:r,updateSongData:b=>{n&&r({...n,...b})},singers:s,setSingers:i,setGenres:l,genres:a,selectGenre:b=>{const I=[...a],F=I.findIndex(D=>D.id===b.id);F===-1?I.push(b):I.splice(F,1),l(I)},selectSinger:b=>{const I=[...s],F=I.findIndex(D=>D.id===b.id);F===-1?I.push(b):I.splice(F,1),i(I)},imageBlob:p,setImageBlob:x,resetAddSongContext:b=>{e(void 0),r(b),i([]),l([])}}}const rA=m.createContext(null);function qW({children:t}){return o.jsx(rA.Provider,{value:WW(),children:t})}const Ga=()=>{const t=m.useContext(rA);if(!t)throw new Error("AddSongProvider not provided");return t};function sA(){const{setSongFile:t}=Ga(),e=m.useRef(null),n=r=>{var s;(s=r.target.files)!=null&&s.length&&t(r.target.files[0])};return o.jsxs(o.Fragment,{children:[o.jsx("input",{ref:e,onChange:n,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o.jsx(ce,{className:"",size:"clear",children:o.jsx("label",{htmlFor:"song_upload",className:"inline-flex p-1.5 cursor-pointer",children:o.jsx(My,{className:"w-6"})})})]})}function GW(){const[t,e]=m.useState([]),n=m.useRef(!0);return{genres:t,shouldFetchGenre:n,setGenres:e}}const iA=m.createContext(null);function QW({children:t}){return o.jsx(iA.Provider,{value:GW(),children:t})}const kw=()=>{const t=m.useContext(iA);if(!t)throw new Error("GenreProvider is not provided");return t};function aA(){const{setGenres:t,genres:e}=kw(),{setErrorToast:n,setSuccessToast:r}=ge(),[s,i]=m.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(f=>f.name===l.name))return await Os(100),n("Genre already exist");const u=await qi({collectionName:"Genres",data:{name:l.name}}),h={name:l.name,id:u.id};return t(f=>[h,...f]),i(!1),r("Add genre successful"),h}case"edit":{await en({collectionName:"Genres",data:{name:l.name},id:l.id});const c=[...e],u=c.findIndex(f=>f.id===l.id),h={...e[u]};Object.assign(h,{name:l.name}),c[u]=h,t(c),r("Edit genre successful");break}case"delete":{await Dm({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function oA(){const{genres:t,setGenres:e,shouldFetchGenre:n}=kw(),[r,s]=m.useState(!0);return{api:async()=>{try{if(n.current){n.current=!1;const a=os(Fe,"Genres"),l=je(a);console.log(">>> fetch genres");const c=await ml(l);if(c.docs){const u=c.docs.map(h=>({...h.data(),id:h.id}));e(u)}}else await Os(100)}catch(a){console.log(a)}finally{s(!1)}},isFetching:r,setIsFetching:s,genres:t,shouldFetchGenre:n}}function lA(){const{genres:t}=kw(),[e,n]=m.useState(""),r=Fj(e,800),s=m.useMemo(()=>r?t.filter(i=>i.name.includes(r)):t,[r,t]);return{value:e,setValue:n,_genres:s}}function KW({afterSearched:t=()=>{}}){const[e,n]=m.useState(""),[r,s]=m.useState(!1),[i,a]=m.useState(!1),[l,c]=m.useState([]),{setErrorToast:u}=ge();return{value:e,isShowResult:i,setValue:n,result:l,handleSubmit:async f=>{try{f.preventDefault(),f.stopPropagation(),s(!0),a(!0);const p=os(Fe,"Singers"),x=je(p,J("name",">=",e),J("name","<=",e+"")),v=await ml(x);if(v.docs){const _=v.docs.map(S=>({...S.data(),id:S.id}));c(_),t()}}catch(p){console.log({message:p}),u()}finally{s(!1)}},isFetching:r}}function XW(){const{setSuccessToast:t,setErrorToast:e}=ge(),[n,r]=m.useState(!1);return{isFetching:n,addSinger:async({data:i})=>{try{r(!0);const a=await qi({collectionName:"Singers",data:i}),c={...(await Fu(a)).data(),id:a.id};return r(!1),t("Add singer successful"),c}catch(a){console.log({error:a}),e()}finally{r(!1)}}}}function YW({closeModal:t,afterSubmit:e,singerName:n}){const[r,s]=m.useState(mf({name:n})),{addSinger:i,isFetching:a}=XW(),l=r.name,c=(f,p)=>{s({...r,[f]:p.trim()})},u=async()=>{const f=await i({data:r});f&&e&&e(f),t()},h={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};return o.jsxs(ei,{className:"w-[450px]",children:[o.jsx(It,{close:t,title:"Add singer"}),o.jsx("div",{className:"space-y-3 overflow-auto",children:o.jsxs("div",{className:h.inputGroup,children:[o.jsx("label",{className:h.label,children:"Customer name:"}),o.jsx(rn,{value:r.name,onChange:f=>c("name",f.target.value),placeholder:"Enter name...",className:h.input})]})}),o.jsx("div",{className:"text-center mt-5",children:o.jsxs(ce,{disabled:!l,loading:a,onClick:()=>l&&u(),children:[o.jsx(gu,{className:"w-6"}),o.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function Tw({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,...i}=KW({}),a=m.useRef(null),l=()=>{var c;return(c=a.current)==null?void 0:c.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(_r,{children:[o.jsx(It,{title:"Singers",close:e}),o.jsx(vl,{...i}),o.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:r&&(s?o.jsx(Ou,{className:"h-full"}):o.jsx(o.Fragment,{children:n.length?n.map((c,u)=>o.jsx(pn,{onClick:()=>t(c),children:o.jsx("p",{className:"text-lg",children:c.name})},u)):o.jsx(o.Fragment,{children:o.jsx(tt,{})})}))}),o.jsx("p",{className:"text-center mt-auto",children:o.jsxs(ce,{onClick:()=>{var c;return(c=a.current)==null?void 0:c.open()},children:[o.jsx(hs,{className:"w-6"}),o.jsx("span",{children:"Add new singer"})]})})]}),o.jsx(Oe,{ref:a,wrapped:!1,variant:"animation",children:o.jsx(YW,{afterSubmit:t,singerName:i.value,closeModal:l})})]})}function JW(){const{singers:t,selectSinger:e}=Ga(),n=m.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"",children:[o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsx(be,{title:"Singer"}),o.jsx(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:o.jsx(hs,{className:"w-6"})})]}),o.jsx(pn,{className:" mt-1",children:o.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,a)=>o.jsxs(yl,{children:[o.jsx("span",{children:i.name}),o.jsx("div",{className:"flex",children:o.jsx("button",{onClick:()=>e(i),children:o.jsx(Fn,{className:"w-5"})})})]},a)):"..."})})]}),o.jsx(br,{ref:n,children:o.jsx(Tw,{closeModal:r,choose:s})})]})}function ZW({audioEle:t,variant:e}){const n=m.useRef(null),{status:r,handlePlayPause:s}=mw({audioEle:t,baseColor:"rgba(0,0,0,.10)",color:"#5a9e87",progressLineRef:n}),i=()=>{switch(r){case"error":return o.jsx(tm,{className:"w-6"});case"playing":return o.jsx(rm,{className:"w-6"});case"paused":return o.jsx(Vc,{className:"w-6"});case"waiting":return o.jsx(Tt,{className:"w-6 animate-spin"})}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-end justify-between",children:[o.jsx(ce,{className:"p-1.5",size:"clear",onClick:s,children:i()}),e==="add"&&o.jsx(sA,{})]}),o.jsx("div",{style:{backgroundColor:"rgab(0,0,0,.05)"},ref:n,className:"h-1 rounded-full mt-3 w-full"})]})}function Iw({closeModal:t,afterSubmit:e,...n}){const[r,s]=m.useState(n.type==="add"?n.genreName||"":n.genre.name),{action:i,isFetching:a}=aA(),{setErrorToast:l}=ge(),c=m.useRef(null),u=!!r,h=async()=>{try{switch(n.type){case"add":const x=await i({type:"add",name:r});x&&e&&e(x);break;case"edit":await i({type:"edit",name:r,id:n.genre.id});break}}catch(x){console.log(x),l()}finally{t()}},f={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};m.useEffect(()=>{var x;(x=c.current)==null||x.focus()},[]);const p=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return o.jsxs(ei,{className:"w-[450px]",children:[o.jsx(It,{close:t,title:p}),o.jsx("div",{className:"space-y-3 overflow-auto",children:o.jsxs("div",{className:f.inputGroup,children:[o.jsx("label",{className:f.label,children:"Genre name:"}),o.jsx(rn,{ref:c,value:r,onChange:x=>s(x.target.value),placeholder:"Enter name...",className:f.input})]})}),o.jsx("div",{className:"text-center mt-5",children:o.jsxs(ce,{disabled:!u,loading:a,onClick:()=>u&&h(),children:[o.jsx(gu,{className:"w-6"}),o.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function eq({closeModal:t,choose:e}){const{_genres:n,...r}=lA(),s=m.useRef(null),i=m.useRef(null),a=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=oA();return m.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),o.jsxs(o.Fragment,{children:[o.jsxs(_r,{children:[o.jsx(It,{title:"Genre",close:t}),o.jsx(nA,{inputRef:i,...r}),o.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?o.jsx(Ou,{className:"h-full"}):o.jsx(o.Fragment,{children:n.length?n.map((u,h)=>o.jsx(pn,{onClick:()=>e(u),children:o.jsx("p",{className:"text-lg",children:u.name})},h)):o.jsx(o.Fragment,{children:o.jsx(tt,{})})})}),o.jsx("p",{className:"text-center mt-auto",children:o.jsxs(ce,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[o.jsx(vr,{className:"w-6"}),o.jsx("span",{children:"Add new genre"})]})})]}),o.jsx(Oe,{ref:s,wrapped:!1,variant:"animation",children:o.jsx(Iw,{afterSubmit:e,genreName:r.value,type:"add",closeModal:a})})]})}function tq(){const{genres:t,selectGenre:e}=Ga(),n=m.useRef(null),r=i=>{e(i),s()},s=()=>{var i;return(i=n.current)==null?void 0:i.close()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"",children:[o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsx(be,{title:"Genre"}),o.jsx(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:o.jsx(hs,{className:"w-6"})})]}),o.jsx(pn,{className:"mt-1",children:o.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,a)=>o.jsxs(yl,{children:[o.jsx("span",{children:i.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e(i),children:o.jsx(Fn,{className:"w-5"})})})]},a)):"..."})})]}),o.jsx(br,{ref:n,children:o.jsx(eq,{closeModal:s,choose:r})})]})}const nq="End-Of-Stream";class ft extends Error{constructor(){super(nq)}}class rq{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new ft;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const a=this.peekQueue.pop();if(!a)throw new Error("peekData should be defined");const l=Math.min(a.length,s);e.set(a.subarray(0,l),n+i),i+=l,s-=l,l<a.length&&this.peekQueue.push(a.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const a=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,a);if(l===0)break;i+=l,s-=l}return i}}class sq extends rq{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new ft;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class cA{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new ft;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new ft;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new ft;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new ft;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const iq=256e3;class aq extends cA{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new ft;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const a=new Uint8Array(r.length+i);return s=await this.peekBuffer(a,{mayBeLess:r.mayBeLess}),e.set(a.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof ft)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new ft}return s}async ignore(e){const n=Math.min(iq,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,a=await this.readBuffer(r,{length:Math.min(n,i)});if(a<0)return a;s+=a}return s}}class oq extends cA{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new ft;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function uA(t,e){return new aq(new sq(t),e)}function Ko(t,e){return new oq(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var zm=function(t,e,n,r,s){var i,a,l=s*8-r-1,c=(1<<l)-1,u=c>>1,h=-7,f=n?s-1:0,p=n?-1:1,x=t[e+f];for(f+=p,i=x&(1<<-h)-1,x>>=-h,h+=l;h>0;i=i*256+t[e+f],f+=p,h-=8);for(a=i&(1<<-h)-1,i>>=-h,h+=r;h>0;a=a*256+t[e+f],f+=p,h-=8);if(i===0)i=1-u;else{if(i===c)return a?NaN:(x?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-u}return(x?-1:1)*a*Math.pow(2,i-r)},Um=function(t,e,n,r,s,i){var a,l,c,u=i*8-s-1,h=(1<<u)-1,f=h>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=r?0:i-1,v=r?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+f>=1?e+=p/c:e+=p*Math.pow(2,1-f),e*c>=2&&(a++,c/=2),a+f>=h?(l=0,a=h):a+f>=1?(l=(e*c-1)*Math.pow(2,s),a=a+f):(l=e*Math.pow(2,f-1)*Math.pow(2,s),a=0));s>=8;t[n+x]=l&255,x+=v,l/=256,s-=8);for(a=a<<s|l,u+=s;u>0;t[n+x]=a&255,x+=v,a/=256,u-=8);t[n+x-v]|=_*128};function fe(t){return new DataView(t.buffer,t.byteOffset)}const me={len:1,get(t,e){return fe(t).getUint8(e)},put(t,e,n){return fe(t).setUint8(e,n),e+1}},Pe={len:2,get(t,e){return fe(t).getUint16(e,!0)},put(t,e,n){return fe(t).setUint16(e,n,!0),e+2}},Me={len:2,get(t,e){return fe(t).getUint16(e)},put(t,e,n){return fe(t).setUint16(e,n),e+2}},pf={len:3,get(t,e){const n=fe(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=fe(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},gn={len:3,get(t,e){const n=fe(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=fe(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},Y={len:4,get(t,e){return fe(t).getUint32(e,!0)},put(t,e,n){return fe(t).setUint32(e,n,!0),e+4}},re={len:4,get(t,e){return fe(t).getUint32(e)},put(t,e,n){return fe(t).setUint32(e,n),e+4}},su={len:1,get(t,e){return fe(t).getInt8(e)},put(t,e,n){return fe(t).setInt8(e,n),e+1}},Cs={len:2,get(t,e){return fe(t).getInt16(e)},put(t,e,n){return fe(t).setInt16(e,n),e+2}},lq={len:2,get(t,e){return fe(t).getInt16(e,!0)},put(t,e,n){return fe(t).setInt16(e,n,!0),e+2}},cq={len:3,get(t,e){const n=pf.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=fe(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Cw={len:3,get(t,e){const n=gn.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=fe(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},Xn={len:4,get(t,e){return fe(t).getInt32(e)},put(t,e,n){return fe(t).setInt32(e,n),e+4}},ut={len:4,get(t,e){return fe(t).getInt32(e,!0)},put(t,e,n){return fe(t).setInt32(e,n,!0),e+4}},hn={len:8,get(t,e){return fe(t).getBigUint64(e,!0)},put(t,e,n){return fe(t).setBigUint64(e,n,!0),e+8}},gf={len:8,get(t,e){return fe(t).getBigInt64(e,!0)},put(t,e,n){return fe(t).setBigInt64(e,n,!0),e+8}},Rw={len:8,get(t,e){return fe(t).getBigUint64(e)},put(t,e,n){return fe(t).setBigUint64(e,n),e+8}},dA={len:8,get(t,e){return fe(t).getBigInt64(e)},put(t,e,n){return fe(t).setBigInt64(e,n),e+8}},uq={len:2,get(t,e){return zm(t,e,!1,10,this.len)},put(t,e,n){return Um(t,n,e,!1,10,this.len),e+this.len}},dq={len:2,get(t,e){return zm(t,e,!0,10,this.len)},put(t,e,n){return Um(t,n,e,!0,10,this.len),e+this.len}},hA={len:4,get(t,e){return fe(t).getFloat32(e)},put(t,e,n){return fe(t).setFloat32(e,n),e+4}},hq={len:4,get(t,e){return fe(t).getFloat32(e,!0)},put(t,e,n){return fe(t).setFloat32(e,n,!0),e+4}},yx={len:8,get(t,e){return fe(t).getFloat64(e)},put(t,e,n){return fe(t).setFloat64(e,n),e+8}},fq={len:8,get(t,e){return fe(t).getFloat64(e,!0)},put(t,e,n){return fe(t).setFloat64(e,n,!0),e+8}},mq={len:10,get(t,e){return zm(t,e,!1,63,this.len)},put(t,e,n){return Um(t,n,e,!1,63,this.len),e+this.len}},pq={len:10,get(t,e){return zm(t,e,!0,63,this.len)},put(t,e,n){return Um(t,n,e,!0,63,this.len),e+this.len}};class gq{constructor(e){this.len=e}get(e,n){}}class wn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class ne{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class xq{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const yq=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:xq,Float16_BE:uq,Float16_LE:dq,Float32_BE:hA,Float32_LE:hq,Float64_BE:yx,Float64_LE:fq,Float80_BE:mq,Float80_LE:pq,INT16_BE:Cs,INT16_LE:lq,INT24_BE:Cw,INT24_LE:cq,INT32_BE:Xn,INT32_LE:ut,INT64_BE:dA,INT64_LE:gf,INT8:su,IgnoreType:gq,StringType:ne,UINT16_BE:Me,UINT16_LE:Pe,UINT24_BE:gn,UINT24_LE:pf,UINT32_BE:re,UINT32_LE:Y,UINT64_BE:Rw,UINT64_LE:hn,UINT8:me,Uint8ArrayType:wn},Symbol.toStringTag,{value:"Module"})),vq=Object.prototype.toString,wq="[object Uint8Array]",_q="[object ArrayBuffer]";function fA(t,e,n){return t?t.constructor===e?!0:vq.call(t)===n:!1}function mA(t){return fA(t,Uint8Array,wq)}function bq(t){return fA(t,ArrayBuffer,_q)}function Sq(t){return mA(t)||bq(t)}function Eq(t){if(!mA(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function kq(t){if(!Sq(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const jd={utf8:new globalThis.TextDecoder("utf8")};function jw(t,e="utf8"){return kq(t),jd[e]??(jd[e]=new globalThis.TextDecoder(e)),jd[e].decode(t)}function pA(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const Tq=new globalThis.TextEncoder;function Iq(t){return pA(t),Tq.encode(t)}const Cq=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Aw(t){Eq(t);let e="";for(let n=0;n<t.length;n++)e+=Cq[t[n]];return e}const rE={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function sE(t){if(pA(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=rE[t[r*2]],i=rE[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function iE(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function gA(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let a=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){a=!1;break}if(a)return i}return-1}function Rq(t,e){return gA(t,e)!==-1}function jq(t){return[...t].map(e=>e.charCodeAt(0))}function Aq(t,e=0){const n=Number.parseInt(new ne(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const Nq={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Pq=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],Fq=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],aE=4100;async function xA(t){return new Dq().fromBuffer(t)}function Vr(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class Dq{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(Ko(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await uA(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=aE}=n;let s,i;const a=e.getReader({mode:"byob"});try{const{value:u,done:h}=await a.read(new Uint8Array(r));if(i=u,!h&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(f){if(!(f instanceof ft))throw f;s=void 0}i=u}finally{a.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,h){h.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return Vr(this.buffer,e,n)}checkString(e,n){return this.check(jq(e),n)}async parse(e){if(this.buffer=new Uint8Array(aE),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(Nq);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new ne(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new ne(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=gA(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof ft))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),Vr(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:Vr(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:Vr(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:Vr(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:Vr(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:Vr(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new ne(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),Rq(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof ft))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(me);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const h=new Uint8Array(u+1);return await e.readBuffer(h),h}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),h=new DataView(l.buffer),f=new DataView(c.buffer,c.length-u,u);return{id:iE(h),len:iE(f)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new ne(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new ne(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new ne(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(Xn),type:await e.readToken(new ne(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(hn))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(Vr(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),Vr(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(Vr(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new ne(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),Aq(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?Me:Pe);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?Me:Pe);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?Me:Pe).get(this.buffer,2),r=(e?re:Y).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(Pq);new Set(Fq);var Nw={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var oE=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,Lq=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,yA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,Mq=/\\([\u000b\u0020-\u00ff])/g,Oq=/([\\"])/g,vA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Nw.format=$q;Nw.parse=Bq;function $q(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!vA.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),a=0;a<i.length;a++){if(s=i[a],!yA.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+Uq(e[s])}return r}function Bq(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?zq(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!vA.test(r))throw new TypeError("invalid media type");var s=new Vq(r.toLowerCase());if(n!==-1){var i,a,l;for(oE.lastIndex=n;a=oE.exec(e);){if(a.index!==n)throw new TypeError("invalid parameter format");n+=a[0].length,i=a[1].toLowerCase(),l=a[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace(Mq,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function zq(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function Uq(t){var e=String(t);if(yA.test(e))return e;if(e.length>0&&!Lq.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(Oq,"\\$1")+'"'}function Vq(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var Hq=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,Wq=qq;function qq(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=Hq.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new Gq(n,r,s)}function Gq(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var vx={exports:{}},xg,lE;function Qq(){if(lE)return xg;lE=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;xg=function(h,f){f=f||{};var p=typeof h;if(p==="string"&&h.length>0)return a(h);if(p==="number"&&isFinite(h))return f.long?c(h):l(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))};function a(h){if(h=String(h),!(h.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h);if(f){var p=parseFloat(f[1]),x=(f[2]||"ms").toLowerCase();switch(x){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function l(h){var f=Math.abs(h);return f>=r?Math.round(h/r)+"d":f>=n?Math.round(h/n)+"h":f>=e?Math.round(h/e)+"m":f>=t?Math.round(h/t)+"s":h+"ms"}function c(h){var f=Math.abs(h);return f>=r?u(h,f,r,"day"):f>=n?u(h,f,n,"hour"):f>=e?u(h,f,e,"minute"):f>=t?u(h,f,t,"second"):h+" ms"}function u(h,f,p,x){var v=f>=p*1.5;return Math.round(h/p)+" "+x+(v?"s":"")}return xg}function Kq(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=a,n.humanize=Qq(),n.destroy=u,Object.keys(t).forEach(h=>{n[h]=t[h]}),n.names=[],n.skips=[],n.formatters={};function e(h){let f=0;for(let p=0;p<h.length;p++)f=(f<<5)-f+h.charCodeAt(p),f|=0;return n.colors[Math.abs(f)%n.colors.length]}n.selectColor=e;function n(h){let f,p=null,x,v;function _(...S){if(!_.enabled)return;const E=_,w=Number(new Date),b=w-(f||w);E.diff=b,E.prev=f,E.curr=w,f=w,S[0]=n.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let I=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(D,C)=>{if(D==="%%")return"%";I++;const k=n.formatters[C];if(typeof k=="function"){const j=S[I];D=k.call(E,j),S.splice(I,1),I--}return D}),n.formatArgs.call(E,S),(E.log||n.log).apply(E,S)}return _.namespace=h,_.useColors=n.useColors(),_.color=n.selectColor(h),_.extend=r,_.destroy=n.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(x!==n.namespaces&&(x=n.namespaces,v=n.enabled(h)),v),set:S=>{p=S}}),typeof n.init=="function"&&n.init(_),_}function r(h,f){const p=n(this.namespace+(typeof f>"u"?":":f)+h);return p.log=this.log,p}function s(h){n.save(h),n.namespaces=h,n.names=[],n.skips=[];let f;const p=(typeof h=="string"?h:"").split(/[\s,]+/),x=p.length;for(f=0;f<x;f++)p[f]&&(h=p[f].replace(/\*/g,".*?"),h[0]==="-"?n.skips.push(new RegExp("^"+h.slice(1)+"$")):n.names.push(new RegExp("^"+h+"$")))}function i(){const h=[...n.names.map(l),...n.skips.map(l).map(f=>"-"+f)].join(",");return n.enable(""),h}function a(h){if(h[h.length-1]==="*")return!0;let f,p;for(f=0,p=n.skips.length;f<p;f++)if(n.skips[f].test(h))return!1;for(f=0,p=n.names.length;f<p;f++)if(n.names[f].test(h))return!0;return!1}function l(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function c(h){return h instanceof Error?h.stack||h.message:h}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var Xq=Kq;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=a(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let h=0,f=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(h++,p==="%c"&&(f=h))}),c.splice(f,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function a(){try{return localStorage}catch{}}t.exports=Xq(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(vx,vx.exports);var Yq=vx.exports;const Be=QE(Yq);var wx;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(wx||(wx={}));var Da;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(Da||(Da={}));function at(t,e,n){return(t[e]&1<<n)!==0}function $n(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function wA(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function Jq(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function bt(t,e){if(t[0]===255&&t[1]===254)return bt(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return bt(Jq(t),e)}return new ne(t.length,e).get(t,0)}function pi(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function Te(t,e,n,r){const s=e+~~(n/8),i=n%8;let a=t[s];a&=255>>i;const l=8-i,c=r-l;return c<0?a>>=8-i-r:c>0&&(a<<=c,a|=Te(t,e,n+l,c)),a}function Vn(t,e,n){return Te(t,e,n,1)===1}function Zq(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function eG(t){return 10*Math.log10(t)}function tG(t){return 10**(t/10)}function nG(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:tG(n)}:{dB:eG(n),ratio:n}}}var iu;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(iu||(iu={}));var cE;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(cE||(cE={}));var uE;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(uE||(uE={}));const _A={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},_x={len:10,get:(t,e)=>({fileIdentifier:new ne(3,"ascii").get(t,e),version:{major:su.get(t,e+3),revision:su.get(t,e+4)},flags:{unsynchronisation:at(t,e+5,7),isExtendedHeader:at(t,e+5,6),expIndicator:at(t,e+5,5),footer:at(t,e+5,4)},size:_A.get(t,e+6)})},dE={len:10,get:(t,e)=>({size:re.get(t,e),extendedFlags:Me.get(t,e+4),sizeOfPadding:re.get(t,e+6),crcDataPresent:at(t,e+4,31)})},bA={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},bx={len:4,get:(t,e)=>({encoding:bA.get(t,e),language:new ne(3,"latin1").get(t,e+1)})},hE={len:6,get:(t,e)=>{const n=bx.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:me.get(t,e+4),contentType:me.get(t,e+5)}}},xf={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function rG(t){return xf[t]&&!xf[t].multiple}function sG(t){return!xf[t].multiple||xf[t].unique||!1}class Gn{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}Gn.maxRatingScore=1;const iG={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class aG extends Gn{constructor(){super(["ID3v1"],iG)}}class $u extends Gn{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const oG={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class Pw extends $u{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*Gn.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],oG)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=bt(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?Y.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=Pw.toRating(e.value);break}}}const lG={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class Fw extends Gn{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],lG)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=Fw.toRating(e.value),e.id=n[0];break}}}}const cG={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class uG extends $u{constructor(){super(["ID3v2.2"],cG)}}const dG={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class hG extends $u{constructor(){super(["APEv2"],dG)}}const fG={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},mG="iTunes";class fE extends $u{constructor(){super([mG],fG)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const pG={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class yf extends Gn{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*Gn.maxRatingScore}}constructor(){super(["vorbis"],pG)}postMap(e){if(e.id==="RATING")e.value=yf.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=yf.toRating(n[1],e.value,1),e.id=n[0]}}}const gG={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class xG extends Gn{constructor(){super(["exif"],gG)}}const yG={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class vG extends $u{constructor(){super(["matroska"],yG)}}const wG={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class _G extends Gn{constructor(){super(["AIFF"],wG)}}class bG{constructor(){this.tagMappers={},[new aG,new uG,new Pw,new fE,new fE,new yf,new hG,new Fw,new xG,new vG,new _G].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const ea=Be("music-metadata:collector"),SG=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class EG{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new bG;let n=1;for(const r of SG)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){ea(`streamInfo: type=${e.type?Da[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;ea(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){ea(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:kG(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=Gn.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=Gn.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=Gn.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=Gn.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=nG(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await xA(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;ea(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(rG(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return ea(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!sG(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):ea(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return ea(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function kG(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class rr{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const TG=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,Ke={len:4,get:(t,e)=>{const n=jw(t.slice(e,e+Ke.len),"latin1");if(!n.match(TG))throw new Error(`FourCC contains invalid characters: ${Zq(n)} "${n}"`);return n},put:(t,e,n)=>{const r=Iq(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var _o;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(_o||(_o={}));const mE={len:52,get:(t,e)=>({ID:Ke.get(t,e),version:Y.get(t,e+4)/1e3,descriptorBytes:Y.get(t,e+8),headerBytes:Y.get(t,e+12),seekTableBytes:Y.get(t,e+16),headerDataBytes:Y.get(t,e+20),apeFrameDataBytes:Y.get(t,e+24),apeFrameDataBytesHigh:Y.get(t,e+28),terminatingDataBytes:Y.get(t,e+32),fileMD5:new wn(16).get(t,e+36)})},IG={len:24,get:(t,e)=>({compressionLevel:Pe.get(t,e),formatFlags:Pe.get(t,e+2),blocksPerFrame:Y.get(t,e+4),finalFrameBlocks:Y.get(t,e+8),totalFrames:Y.get(t,e+12),bitsPerSample:Pe.get(t,e+16),channel:Pe.get(t,e+18),sampleRate:Y.get(t,e+20)})},ar={len:32,get:(t,e)=>({ID:new ne(8,"ascii").get(t,e),version:Y.get(t,e+8),size:Y.get(t,e+12),fields:Y.get(t,e+16),flags:SA(Y.get(t,e+20))})},yg={len:8,get:(t,e)=>({size:Y.get(t,e),flags:SA(Y.get(t,e+4))})};function SA(t){return{containsHeader:Ad(t,31),containsFooter:Ad(t,30),isHeader:Ad(t,29),readOnly:Ad(t,0),dataType:(t&6)>>1}}function Ad(t,e){return(t&1<<e)!==0}const ta=Be("music-metadata:parser:APEv2"),pE="APEv2",gE="APETAGEX";class Xr extends rr{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new Xr;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(ar.len);await e.randomRead(r,0,ar.len,n-ar.len);const s=ar.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?ta(`APE Header found at offset=${n-ar.len}`):(ta(`APE Footer found at offset=${n-ar.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=ar.get(n,n.length-ar.len);if(s.ID!==gE)throw new Error("Unexpected APEv2 Footer ID preamble value.");Ko(n);const i=new Xr;return i.init(e,Ko(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<ar.len){ta("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(ar);if(e.ID===gE)return await this.tokenizer.ignore(ar.len),this.parseTags(e);if(ta(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),Xr.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(mE);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-mE.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-ar.len;ta(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<yg.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(yg);r-=yg.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let a=$n(n,0,n.length);const l=await this.tokenizer.readToken(new ne(a,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case _o.text_utf8:{const u=(await this.tokenizer.readToken(new ne(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(h=>this.metadata.addTag(pE,l,h)));break}case _o.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),a=$n(c,0,c.length);const u=jw(c.slice(0,a)),h=c.slice(a+1);await this.metadata.addTag(pE,l,{description:u,data:h})}break;case _o.external_info:ta(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case _o.reserved:ta(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(IG);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",Xr.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const Nd=Be("music-metadata:parser:ID3v1"),vf=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],Pd={len:128,get:(t,e)=>{const n=new eo(3).get(t,e);return n==="TAG"?{header:n,title:new eo(30).get(t,e+3),artist:new eo(30).get(t,e+33),album:new eo(30).get(t,e+63),year:new eo(4).get(t,e+93),comment:new eo(28).get(t,e+97),zeroByte:me.get(t,e+127),track:me.get(t,e+126),genre:me.get(t,e+127)}:null}};class eo{constructor(e){this.len=e,this.stringType=new ne(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=wA(r),r=r.trim(),r.length>0?r:void 0}}class Dw extends rr{static getGenre(e){if(e<vf.length)return vf[e]}async parse(){if(!this.tokenizer.fileInfo.size){Nd("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new Xr;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-Pd.len;if(this.tokenizer.position>e){Nd("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(Pd,e);if(n){Nd("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-Pd.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=Dw.getGenre(n.genre);s&&await this.addTag("genre",s)}else Nd("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-Pd.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const xE=Be("music-metadata:id3v2:frame-parser"),Tr="latin1";function CG(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=yE(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=yE(r)),r&&e.push(r)),e}function yE(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return vf[Number.parseInt(t)]}class Bn{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=bA.get(e,0),a=e.length;let l=0,c=[];const u=Bn.getNullTerminatorLength(s);let h;switch(xE(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let f;try{f=bt(e.slice(1),s).replace(/\x00+$/,"")}catch(p){if(p instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${p.message}`);break}throw p}switch(n){case"TMCL":case"TIPL":case"IPLS":c=Bn.functionList(this.splitValue(n,f));break;case"TRK":case"TRCK":case"TPOS":c=f;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,f);break;case"TCO":case"TCON":c=this.splitValue(n,f).map(p=>CG(p)).reduce((p,x)=>p.concat(x),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,f):[f],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,f):[f]}break}case"TXXX":{const f=Bn.readIdentifierAndData(e,l+1,a,s);c={description:f.id,text:this.splitValue(n,bt(f.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const f={};switch(l+=1,this.major){case 2:f.format=bt(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:h=$n(e,l,a,Tr),f.format=bt(e.slice(l,h),Tr),l=h+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}f.format=Bn.fixPictureMimeType(f.format),f.type=iu[e[l]],l+=1,h=$n(e,l,a,s),f.description=bt(e.slice(l,h),s),l=h+u,f.data=e.slice(l,a),c=f}break;case"CNT":case"PCNT":c=re.get(e,0);break;case"SYLT":{const f=hE.get(e,0);l+=hE.len;const p={descriptor:"",language:f.language,contentType:f.contentType,timeStampFormat:f.timeStampFormat,syncText:[]};let x=!1;for(;l<a;){const v=Bn.readNullTerminatedString(e.subarray(l),f.encoding);if(l+=v.len,x){const _=re.get(e,l);l+=re.len,p.syncText.push({text:v.text,timestamp:_})}else p.descriptor=v.text,x=!0}c=p;break}case"ULT":case"USLT":case"COM":case"COMM":{const f=bx.get(e,l);l+=bx.len;const p=Bn.readNullTerminatedString(e.subarray(l),f.encoding);l+=p.len;const x=Bn.readNullTerminatedString(e.subarray(l),f.encoding);c={language:f.language,descriptor:p.text,text:x.text};break}case"UFID":{const f=Bn.readIdentifierAndData(e,l,a,Tr);c={owner_identifier:f.id,identifier:f.data};break}case"PRIV":{const f=Bn.readIdentifierAndData(e,l,a,Tr);c={owner_identifier:f.id,data:f.data};break}case"POPM":{h=$n(e,l,a,Tr);const f=bt(e.slice(l,h),Tr);l=h+1;const p=a-l;c={email:f,rating:me.get(e,l),counter:p>=5?re.get(e,l+1):void 0};break}case"GEOB":{h=$n(e,l+1,a,s);const f=bt(e.slice(l+1,h),Tr);l=h+1,h=$n(e,l,a-l,s);const p=bt(e.slice(l,h),Tr);l=h+1,h=$n(e,l,a-l,s);const x=bt(e.slice(l,h),Tr);c={type:f,filename:p,description:x,data:e.slice(l+1,a)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":h=$n(e,l+1,a,s),c=bt(e.slice(l,h),Tr);break;case"WXXX":{h=$n(e,l+1,a,s);const f=bt(e.slice(l+1,h),s);l=h+(s==="utf-16le"?2:1),c={description:f,url:bt(e.slice(l,a),Tr)};break}case"WFD":case"WFED":c=bt(e.slice(l+1,$n(e,l+1,a,s)),s);break;case"MCDI":{c=e.slice(0,a);break}default:xE(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=$n(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:bt(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),Bn.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=$n(e,n,r,s),a=bt(e.slice(n,i),s);return n=i+Bn.getNullTerminatorLength(s),{id:a,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const vE=new TextDecoder("ascii");class Ar{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:at(e,0,6),file_alter_preservation:at(e,0,5),read_only:at(e,0,4)},format:{grouping_identity:at(e,1,7),compression:at(e,1,3),encryption:at(e,1,2),unsynchronisation:at(e,1,1),data_length_indicator:at(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const a=new Bn(r,i);switch(r){case 2:return a.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=Ar.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(_x);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(dE),n=e.size-dE.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new wn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(Ar.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=Ar.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const a=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+a.length);n+=a.length;const c=Ar.readFrameData(l,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:a.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:vE.decode(e.slice(0,3)),length:gn.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:vE.decode(e.slice(0,4)),length:(n===4?_A:re).get(e,4),flags:Ar.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const RG={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class jG{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=Me.get(e,n+8)-16398,s=Me.get(e,n+8+2),i={numChannels:Me.get(e,n),numSampleFrames:re.get(e,n+2),sampleSize:Me.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=Ke.get(e,n+18),this.len>22){const a=me.get(e,n+22);if(a>0){const l=(a+1)%2;if(23+a+l===this.len)i.compressionName=new ne(a,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const vg={len:8,get:(t,e)=>({chunkID:Ke.get(t,e),chunkSize:Number(BigInt(re.get(t,e+4)))})},wg=Be("music-metadata:parser:aiff");class AG extends rr{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(vg)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(Ke);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=vg.len;){wg(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(vg),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof ft)wg("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new jG(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??RG[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new wn(e.chunkSize)),r=Ko(n);return await new Ar().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return wg(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new ne(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class ${static fromBin(e,n=0){return new $($.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${Aw(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case $.AudioMedia.str:return"audio";case $.VideoMedia.str:return"video";case $.CommandMedia.str:return"command";case $.Degradable_JPEG_Media.str:return"degradable-jpeg";case $.FileTransferMedia.str:return"file-transfer";case $.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(sE(e.slice(19,23)),8),n.set(sE(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return $.encode(this.str)}}$.HeaderObject=new $("75B22630-668E-11CF-A6D9-00AA0062CE6C");$.DataObject=new $("75B22636-668E-11CF-A6D9-00AA0062CE6C");$.SimpleIndexObject=new $("33000890-E5B1-11CF-89F4-00A0C90349CB");$.IndexObject=new $("D6E229D3-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexObject=new $("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");$.TimecodeIndexObject=new $("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");$.FilePropertiesObject=new $("8CABDCA1-A947-11CF-8EE4-00C00C205365");$.StreamPropertiesObject=new $("B7DC0791-A9B7-11CF-8EE6-00C00C205365");$.HeaderExtensionObject=new $("5FBF03B5-A92E-11CF-8EE3-00C00C205365");$.CodecListObject=new $("86D15240-311D-11D0-A3A4-00A0C90348F6");$.ScriptCommandObject=new $("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");$.MarkerObject=new $("F487CD01-A951-11CF-8EE6-00C00C205365");$.BitrateMutualExclusionObject=new $("D6E229DC-35DA-11D1-9034-00A0C90349BE");$.ErrorCorrectionObject=new $("75B22635-668E-11CF-A6D9-00AA0062CE6C");$.ContentDescriptionObject=new $("75B22633-668E-11CF-A6D9-00AA0062CE6C");$.ExtendedContentDescriptionObject=new $("D2D0A440-E307-11D2-97F0-00A0C95EA850");$.ContentBrandingObject=new $("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");$.StreamBitratePropertiesObject=new $("7BF875CE-468D-11D1-8D82-006097C9A2B2");$.ContentEncryptionObject=new $("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");$.ExtendedContentEncryptionObject=new $("298AE614-2622-4C17-B935-DAE07EE9289C");$.DigitalSignatureObject=new $("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");$.PaddingObject=new $("1806D474-CADF-4509-A4BA-9AABCB96AAE8");$.ExtendedStreamPropertiesObject=new $("14E6A5CB-C672-4332-8399-A96952065B5A");$.AdvancedMutualExclusionObject=new $("A08649CF-4775-4670-8A16-6E35357566CD");$.GroupMutualExclusionObject=new $("D1465A40-5A79-4338-B71B-E36B8FD6C249");$.StreamPrioritizationObject=new $("D4FED15B-88D3-454F-81F0-ED5C45999E24");$.BandwidthSharingObject=new $("A69609E6-517B-11D2-B6AF-00C04FD908E9");$.LanguageListObject=new $("7C4346A9-EFE0-4BFC-B229-393EDE415C85");$.MetadataObject=new $("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");$.MetadataLibraryObject=new $("44231C94-9498-49D1-A141-1D134E457054");$.IndexParametersObject=new $("D6E229DF-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexParametersObject=new $("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");$.TimecodeIndexParametersObject=new $("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");$.CompatibilityObject=new $("26F18B5D-4584-47EC-9F5F-0E651F0452C9");$.AdvancedContentEncryptionObject=new $("43058533-6981-49E6-9B74-AD12CB86D58C");$.AudioMedia=new $("F8699E40-5B4D-11CF-A8FD-00805F5C442B");$.VideoMedia=new $("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");$.CommandMedia=new $("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");$.JFIF_Media=new $("B61BE100-5B4E-11CF-A8FD-00805F5C442B");$.Degradable_JPEG_Media=new $("35907DE0-E415-11CF-A917-00805F5C442B");$.FileTransferMedia=new $("91BD222C-F21C-497A-8B6D-5AA86BFC0185");$.BinaryMedia=new $("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");$.ASF_Index_Placeholder_Object=new $("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function NG(t){return PG[t]}function Vm(t){return pi(bt(t,"utf-16le"))}const PG=[Vm,wE,FG,DG,LG,EA,wE];function wE(t){return new Uint8Array(t)}function FG(t,e=0){return EA(t,e)===1}function DG(t,e=0){return Y.get(t,e)}function LG(t,e=0){return hn.get(t,e)}function EA(t,e=0){return Pe.get(t,e)}var _E;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(_E||(_E={}));const MG={len:30,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(hn.get(t,e+16)),numberOfHeaderObjects:Y.get(t,e+24)})},oa={len:24,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(hn.get(t,e+16))})};class Qa{constructor(e){this.len=Number(e.objectSize)-oa.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:Lw.fromBuffer(s)});else{const i=NG(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class bE extends Qa{get(e,n){return null}}class Sx extends Qa{get(e,n){return{fileId:$.fromBin(e,n),fileSize:hn.get(e,n+16),creationDate:hn.get(e,n+24),dataPacketsCount:hn.get(e,n+32),playDuration:hn.get(e,n+40),sendDuration:hn.get(e,n+48),preroll:hn.get(e,n+56),flags:{broadcast:at(e,n+64,24),seekable:at(e,n+64,25)},minimumDataPacketSize:Y.get(e,n+68),maximumDataPacketSize:Y.get(e,n+72),maximumBitrate:Y.get(e,n+76)}}}Sx.guid=$.FilePropertiesObject;class Ex extends Qa{get(e,n){return{streamType:$.decodeMediaType($.fromBin(e,n)),errorCorrectionType:$.fromBin(e,n+8)}}}Ex.guid=$.StreamPropertiesObject;class kx{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:$.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}kx.guid=$.HeaderExtensionObject;const OG={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function SE(t){const e=await t.readNumber(Pe);return(await t.readToken(new ne(e*2,"utf-16le"))).replace("\0","")}async function $G(t){const e=await t.readToken(OG),n=[];for(let r=0;r<e.entryCount;++r)n.push(await zG(t));return n}async function BG(t){const e=await t.readNumber(Pe),n=new Uint8Array(e);return await t.readBuffer(n),n}async function zG(t){const e=await t.readNumber(Pe);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await SE(t),description:await SE(t),information:await BG(t)}}class La extends Qa{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let a=0;a<La.contentDescTags.length;++a){const l=s.getUint16(a*2,!0);if(l>0){const c=La.contentDescTags[a],u=i+l;r.push({id:c,value:Vm(e.slice(n+i,n+u))}),i=u}}return r}}La.guid=$.ContentDescriptionObject;La.contentDescTags=["Title","Author","Copyright","Description","Rating"];class Tx extends Qa{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let a=2;for(let l=0;l<i;l+=1){const c=s.getUint16(a,!0);a+=2;const u=Vm(e.slice(n+a,n+a+c));a+=c;const h=s.getUint16(a,!0);a+=2;const f=s.getUint16(a,!0);a+=2;const p=e.slice(n+a,n+a+f);a+=f,this.postProcessTag(r,u,h,p)}return r}}Tx.guid=$.ExtendedContentDescriptionObject;class Ix extends Qa{get(e,n){const r=new DataView(e.buffer,n);return{startTime:hn.get(e,n),endTime:hn.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:at(e,n+40,0),seekableFlag:at(e,n+40,1),resendLiveCleanpointsFlag:at(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}Ix.guid=$.ExtendedStreamPropertiesObject;class wf extends Qa{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let a=2;for(let l=0;l<i;l+=1){a+=4;const c=s.getUint16(a,!0);a+=2;const u=s.getUint16(a,!0);a+=2;const h=s.getUint32(a,!0);a+=4;const f=Vm(e.slice(n+a,n+a+c));a+=c;const p=e.slice(n+a,n+a+h);a+=h,this.postProcessTag(r,f,u,p)}return r}}wf.guid=$.MetadataObject;class Cx extends wf{}Cx.guid=$.MetadataLibraryObject;class Lw{static fromBuffer(e){return new Lw(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let a=5;for(;r.getUint16(a)!==0;)a+=2;const l=new ne(a-5,"utf-16le").get(e,5);for(;r.getUint16(a)!==0;)a+=2;const c=new ne(a-5,"utf-16le").get(e,5);return{type:iu[s],format:l,description:c,size:i,data:e.slice(a+4)}}}const Fd=Be("music-metadata:parser:ASF"),UG="asf";class VG extends rr{async parse(){const e=await this.tokenizer.readToken(MG);if(!e.objectId.equals($.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){Fd("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(oa);switch(Fd("header GUID=%s",r.objectId.str),r.objectId.str){case Sx.guid.str:{const s=await this.tokenizer.readToken(new Sx(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case Ex.guid.str:{const s=await this.tokenizer.readToken(new Ex(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case kx.guid.str:{const s=await this.tokenizer.readToken(new kx);await this.parseExtensionObject(s.extensionDataSize);break}case La.guid.str:n=await this.tokenizer.readToken(new La(r)),await this.addTags(n);break;case Tx.guid.str:n=await this.tokenizer.readToken(new Tx(r)),await this.addTags(n);break;case $.CodecListObject.str:{const s=await $G(this.tokenizer);s.forEach(a=>{this.metadata.addStreamInfo({type:a.type.videoCodec?Da.video:Da.audio,codecName:a.codecName})});const i=s.filter(a=>a.type.audioCodec).map(a=>a.codecName).join("/");this.metadata.setFormat("codec",i);break}case $.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-oa.len);break;case $.PaddingObject.str:Fd("Padding: %s bytes",r.objectSize-oa.len),await this.tokenizer.ignore(r.objectSize-oa.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),Fd("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new bE(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(UG,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(oa),r=n.objectSize-oa.len;switch(n.objectId.str){case Ix.guid.str:await this.tokenizer.readToken(new Ix(n));break;case wf.guid.str:{const s=await this.tokenizer.readToken(new wf(n));await this.addTags(s);break}case Cx.guid.str:{const s=await this.tokenizer.readToken(new Cx(n));await this.addTags(s);break}case $.PaddingObject.str:await this.tokenizer.ignore(r);break;case $.CompatibilityObject.str:this.tokenizer.ignore(r);break;case $.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new bE(n));break}e-=n.objectSize}while(e>0)}}class au{static fromBase64(e){return au.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new au(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=iu[re.get(e,n)];n+=4;const s=re.get(e,n);n+=4;const i=new ne(s,"utf-8").get(e,n);n+=s;const a=re.get(e,n);n+=4;const l=new ne(a,"utf-8").get(e,n);n+=a;const c=re.get(e,n);n+=4;const u=re.get(e,n);n+=4;const h=re.get(e,n);n+=4;const f=re.get(e,n);n+=4;const p=re.get(e,n);n+=4;const x=Uint8Array.from(e.slice(n,n+p));return{type:r,format:i,description:l,width:c,height:u,colour_depth:h,indexed_color:f,data:x}}}const Dd={len:7,get:(t,e)=>({packetType:me.get(t,e),vorbis:new ne(6,"ascii").get(t,e+1)})},HG={len:23,get:(t,e)=>({version:Y.get(t,e+0),channelMode:me.get(t,e+4),sampleRate:Y.get(t,e+5),bitrateMax:Y.get(t,e+9),bitrateNominal:Y.get(t,e+13),bitrateMin:Y.get(t,e+17)})},_g=Be("music-metadata:parser:ID3");class Hm extends rr{constructor(){super(...arguments),this.id3parser=new Ar}static async startsWithID3v2Header(e){return(await e.peekToken(_x)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof ft)_g("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),_g("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new Dw().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(_x)).fileIdentifier==="ID3")return _g("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class kA{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=Y.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const to=Be("music-metadata:parser:ogg:vorbis1");class Ma{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=Ma.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,a)=>{const l=a.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(Ma.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new kA(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){to("Ignore picture");return}n=au.fromBase64(n),to(`Push picture: id=${e}, format=${n.format}`)}else to(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),to("Parse first page");const r=Dd.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=HG.get(n,Dd.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),to("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=Dd.get(e,0);switch(to("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,Dd.len)}}async parseUserCommentList(e,n){const r=Y.get(e,n);n+=4,n+=r;let s=Y.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const WG=Be("music-metadata:parser:FLAC");var vs;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(vs||(vs={}));class qG extends Hm{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new Ma(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(Ke)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(GG),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(WG(`blockHeader type=${e.type}, length=${e.length}`),e.type){case vs.STREAMINFO:return this.parseBlockStreamInfo(e.length);case vs.PADDING:this.padding+=e.length;break;case vs.APPLICATION:break;case vs.SEEKTABLE:break;case vs.VORBIS_COMMENT:return this.parseComment(e.length);case vs.CUESHEET:break;case vs.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==EE.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(EE);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new wn(e)),r=new kA(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let a=0;a<s;a++)i[a]=r.parseUserComment();await Promise.all(i.map(a=>this.vorbisParser.addTag(a.key,a.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new au(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const GG={len:4,get:(t,e)=>({lastBlock:at(t,e,7),type:Te(t,e,1,7),length:gn.get(t,e+1)})},EE={len:34,get:(t,e)=>({minimumBlockSize:Me.get(t,e),maximumBlockSize:Me.get(t,e+2)/1e3,minimumFrameSize:gn.get(t,e+4),maximumFrameSize:gn.get(t,e+7),sampleRate:gn.get(t,e+10)>>4,channels:Te(t,e+12,4,3)+1,bitsPerSample:Te(t,e+12,7,5)+1,totalSamples:Te(t,e+13,4,36),fileMD5:new wn(16).get(t,e+18)})},TA=Be("music-metadata:parser:MP4:atom"),_f={len:8,get:(t,e)=>{const n=re.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new ne(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(re.put(t,e,Number(n.length)),Ke.put(t,e+4,n.name))},QG=Rw,kE={len:4,get:(t,e)=>({type:new ne(4,"ascii").get(t,e)})};class IA{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&TA(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const Xo={len:4,get:(t,e)=>{const n=re.get(t,e)-2082844800;return new Date(n*1e3)}};class KG extends IA{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:me.get(e,n+0),flags:gn.get(e,n+1),creationTime:Xo.get(e,n+4),modificationTime:Xo.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),language:Me.get(e,n+20),quality:Me.get(e,n+22)}}}class XG extends IA{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:me.get(e,n),flags:gn.get(e,n+1),creationTime:Xo.get(e,n+4),modificationTime:Xo.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),preferredRate:re.get(e,n+20),preferredVolume:Me.get(e,n+24),previewTime:re.get(e,n+72),previewDuration:re.get(e,n+76),posterTime:re.get(e,n+80),selectionTime:re.get(e,n+84),selectionDuration:re.get(e,n+88),currentTime:re.get(e,n+92),nextTrackID:re.get(e,n+96)}}}class YG{constructor(e){this.len=e}get(e,n){return{type:{set:me.get(e,n+0),type:gn.get(e,n+1)},locale:gn.get(e,n+4),value:new wn(this.len-8).get(e,n+8)}}}class JG{constructor(e){this.len=e}get(e,n){return{version:me.get(e,n),flags:gn.get(e,n+1),name:new ne(this.len-4,"utf-8").get(e,n+4)}}}class ZG{constructor(e){this.len=e}get(e,n){return{version:me.get(e,n),flags:gn.get(e,n+1),creationTime:Xo.get(e,n+4),modificationTime:Xo.get(e,n+8),trackId:re.get(e,n+12),duration:re.get(e,n+20),layer:Me.get(e,n+24),alternateGroup:Me.get(e,n+26),volume:Me.get(e,n+28)}}}const TE={len:8,get:(t,e)=>({version:me.get(t,e),flags:gn.get(t,e+1),numberOfEntries:re.get(t,e+4)})};class eQ{constructor(e){this.len=e}get(e,n){return{dataFormat:Ke.get(e,n),dataReferenceIndex:Me.get(e,n+10),description:new wn(this.len-12).get(e,n+12)}}}class tQ{constructor(e){this.len=e}get(e,n){const r=TE.get(e,n);n+=TE.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const a=re.get(e,n);n+=re.len,s.push(new eQ(a).get(e,n)),n+=a}return{header:r,table:s}}}const IE={len:8,get(t,e){return{version:Cs.get(t,e),revision:Cs.get(t,e+2),vendor:Xn.get(t,e+4)}}},nQ={len:12,get(t,e){return{numAudioChannels:Cs.get(t,e+0),sampleSize:Cs.get(t,e+2),compressionId:Cs.get(t,e+4),packetSize:Cs.get(t,e+6),sampleRate:Me.get(t,e+8)+Me.get(t,e+10)/1e4}}};class Mw{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=Xn.get(e,n+4);return{version:su.get(e,n+0),flags:Cw.get(e,n+1),numberOfEntries:r,entries:CA(e,this.token,n+8,this.len-8,r)}}}const rQ={len:8,get(t,e){return{count:Xn.get(t,e+0),duration:Xn.get(t,e+4)}}};class sQ extends Mw{constructor(e){super(e,rQ),this.len=e}}const iQ={len:12,get(t,e){return{firstChunk:Xn.get(t,e),samplesPerChunk:Xn.get(t,e+4),sampleDescriptionId:Xn.get(t,e+8)}}};class aQ extends Mw{constructor(e){super(e,iQ),this.len=e}}class oQ{constructor(e){this.len=e}get(e,n){const r=Xn.get(e,n+8);return{version:su.get(e,n),flags:Cw.get(e,n+1),sampleSize:Xn.get(e,n+4),numberOfEntries:r,entries:CA(e,Xn,n+12,this.len-12,r)}}}class lQ extends Mw{constructor(e){super(e,Xn),this.len=e}}class cQ{constructor(e){this.len=e}get(e,n){const r=Cs.get(e,n+0);return new ne(r,"utf-8").get(e,n+2)}}function CA(t,e,n,r,s){if(TA(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let a=0;a<s;++a)i.push(e.get(t,n)),n+=e.len;return i}const uQ=Be("music-metadata:parser:MP4:Atom");class bf{static async readAtom(e,n,r,s){const i=e.position,a=await e.readToken(_f);a.length===BigInt(1)&&(a.length=await e.readToken(QG));const c=new bf(a,a.length===BigInt(1),r),u=c.getPayloadLength(s);return uQ(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await bf.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(_f)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const Hr=Be("music-metadata:parser:MP4"),dQ="iTunes",CE={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function RE(t,e,n){return n.indexOf(t)===e}class Sf extends rr{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new XG(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new KG(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=re.len;)r.push(await this.tokenizer.readNumber(re)),e-=re.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new ZG(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(kE);e-=kE.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}Hr(`ftyp: ${n.join("/")}`);const r=n.filter(RE).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new tQ(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new aQ(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new sQ(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new oQ(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new lQ(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new ne(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=yq[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(_f)).name==="\0\0\0\0"){const a=`Error at offset=${this.tokenizer.position}: box.id=0`;Hr(a),this.addWarning(a);break}}catch(i){if(i instanceof Error){const a=`Error at offset=${this.tokenizer.position}: ${i.message}`;Hr(a),this.addWarning(a)}else throw i;break}const s=await bf.readAtom(this.tokenizer,(i,a)=>this.handleAtom(i,a),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(a=>{const l={},c=CE[a.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${a.dataFormat}>`,a.description){const{description:u}=a;u.sampleRate>0&&(l.type=Da.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(RE).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,h)=>u+h)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const a=CE[i.dataFormat];a&&this.metadata.setFormat("lossless",!a.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);Hr(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(dQ,e,n)}addWarning(e){Hr(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const a=await this.tokenizer.readToken(new JG(i));n+=`:${a.name}`;break}default:{const a=await this.tokenizer.readToken(new wn(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${Aw(a)} ascii=${jw(a,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new YG(Number(n.header.length)-_f.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=me.get(r.value,3),i=me.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=me.get(r.value,1),i=vf[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:Hr(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,Sf.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,Sf.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,me.get(r.value,0));break;case 66:await this.addTag(e,Me.get(r.value,0));break;case 67:await this.addTag(e,re.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=IE.get(e.description,r);return r+=IE.len,s.version===0||s.version===1?n.description=nQ.get(e.description,r):Hr(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new cQ(c));Hr(`Chapter ${i+1}: ${u}`);const h={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};Hr(`Chapter title=${h.title}, offset=${h.sampleOffset}/${this.tracks[0].duration}`),s.push(h)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),Hr(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,a=1,l=this.getSamplesPerChunk(a,n.sampleToChunkTable),c=0;for(;a<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++a,l=this.getSamplesPerChunk(a,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var jE;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(jE||(jE={}));var AE;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(AE||(AE={}));const NE={len:2,get:(t,e)=>{const n=Te(t,e,0,3),r=Te(t,e,6,1),s=Te(t,e,7,9)/10;if(n>0)return{type:Te(t,e,0,3),origin:Te(t,e,3,3),adjustment:r?-s:s}}},hQ={len:27,get:(t,e)=>{const n=re.get(t,e+2);return{revision:Te(t,e,0,4),vbr_method:Te(t,e,4,4),lowpass_filter:100*me.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:NE.get(t,6),album_gain:NE.get(t,8),music_length:re.get(t,e+20),music_crc:me.get(t,e+24),header_crc:Me.get(t,e+24)}}},PE=new ne(4,"ascii"),bg=new ne(6,"ascii"),fQ={len:4,get:(t,e)=>({frames:Vn(t,e,31),bytes:Vn(t,e,30),toc:Vn(t,e,29),vbrScale:Vn(t,e,28)})};async function mQ(t){const e=await t.readToken(fQ),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(re)),e.bytes&&(n.streamSize=await t.readToken(re)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(re)),await t.peekToken(new ne(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new ne(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const a=s[0].split(".").map(l=>Number.parseInt(l,10));a[0]>=3&&a[1]>=90&&(n.lame.extended=await t.readToken(hQ))}}return n}const zn=Be("music-metadata:parser:mpeg"),FE=1024,DE={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},pQ=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class jt{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=Te(e,n+1,3,2),this.layer=jt.LayerDescription[Te(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!Vn(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return jt.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=Te(e,n+2,0,4),this.sampRateFreqIndex=Te(e,n+2,4,2),this.padding=Vn(e,n+2,6),this.privateBit=Vn(e,n+2,7),this.channelModeIndex=Te(e,n+3,0,2),this.modeExtension=Te(e,n+3,2,2),this.isCopyrighted=Vn(e,n+3,4),this.isOriginalMedia=Vn(e,n+3,5),this.emphasis=Te(e,n+3,7,2),this.version=jt.VersionID[this.versionIndex],this.channelMode=jt.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){zn("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=Te(e,n+2,0,2);this.codec="AAC",this.codecProfile=DE.AudioObjectTypes[r],zn(`MPEG-4 audio-codec=${this.codec}`);const s=Te(e,n+2,2,4);this.samplingRate=DE.SamplingFrequencies[s],zn(`sampling-rate=${this.samplingRate}`);const i=Te(e,n+2,7,3);this.mp4ChannelConfig=pQ[i],zn(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=Te(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return jt.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:jt.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}jt.SyncByte1=255;jt.SyncByte2=224;jt.VersionID=[2.5,null,2,1];jt.LayerDescription=[0,3,2,1];jt.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];jt.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};jt.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};jt.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const LE={len:4,get:(t,e)=>new jt(t,e)};function gQ(t){return`V${Math.floor((100-t)/10)}`}class xQ extends Hm{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(FE),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof ft){if(zn("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;zn(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;zn("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:FE,mayBeLess:!0}),this.syncPeek.len<=163)throw new ft;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=jt.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),zn(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(zn(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(jt.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new ft;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=LE.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&zn("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();zn(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=LE.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=Te(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),zn(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Cs),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new wn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(PE);switch(this.offset+=PE.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=gQ(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(bg);if(this.frame_size!==null&&this.frame_size>=this.offset+bg.len)return this.offset+=bg.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await mQ(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${pi(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),zn("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const ME=Be("music-metadata:parser:musepack:sv8"),yQ=new ne(2,"latin1"),OE={len:5,get:(t,e)=>({crc:Y.get(t,e),streamVersion:me.get(t,e+4)})},$E={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][Te(t,e,0,3)],maxUsedBands:Te(t,e,3,5),channelCount:Te(t,e+1,0,4)+1,msUsed:Vn(t,e+1,4),audioBlockFrames:Te(t,e+1,5,3)})};class vQ{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(yQ),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};ME(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(OE);e-=OE.len,Object.assign(n,r),ME(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const a=await this.tokenizer.readToken($E);return e-=$E.len,Object.assign(n,a),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(me);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const wQ=Be("music-metadata:parser:musepack");class _Q extends rr{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(Ke)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new vQ(this.tokenizer);do{const n=await e.readPacketHeader();switch(wQ(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),Xr.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class bQ{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(Y);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(Y),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const SQ={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:Te(t,e+3,0,4),streamMajorVersion:Te(t,e+3,4,4),frameCount:Y.get(t,e+4),maxLevel:Pe.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][Te(t,e+10,0,2)],link:Te(t,e+10,2,2),profile:Te(t,e+10,4,4),maxBand:Te(t,e+11,0,6),intensityStereo:Vn(t,e+11,6),midSideStereo:Vn(t,e+11,7),titlePeak:Pe.get(t,e+12),titleGain:Pe.get(t,e+14),albumPeak:Pe.get(t,e+16),albumGain:Pe.get(t,e+18),lastFrameLength:Y.get(t,e+20)>>>20&2047,trueGapless:Vn(t,e+23,0)};return n.lastFrameLength=n.trueGapless?Y.get(t,20)>>>20&2047:0,n}},BE=Be("music-metadata:parser:musepack");class EQ extends rr{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(SQ);if(e.signature!=="MP+")throw new Error("Unexpected magic number");BE(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new bQ(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),BE(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),Xr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const zE=Be("music-metadata:parser:musepack");class kQ extends Hm{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new ne(3,"latin1"));let n;switch(e){case"MP+":{zE("Musepack stream-version 7"),n=new EQ;break}case"MPC":{zE("Musepack stream-version 8"),n=new _Q;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class TQ{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new ne(8,"ascii").get(e,n+0),version:me.get(e,n+8),channelCount:me.get(e,n+9),preSkip:Pe.get(e,n+10),inputSampleRate:Y.get(e,n+12),outputGain:Pe.get(e,n+16),channelMapping:me.get(e,n+18)}}}class IQ extends Ma{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new TQ(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new ne(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const CQ={len:80,get:(t,e)=>({speex:new ne(8,"ascii").get(t,e+0),version:wA(new ne(20,"ascii").get(t,e+8)),version_id:ut.get(t,e+28),header_size:ut.get(t,e+32),rate:ut.get(t,e+36),mode:ut.get(t,e+40),mode_bitstream_version:ut.get(t,e+44),nb_channels:ut.get(t,e+48),bitrate:ut.get(t,e+52),frame_size:ut.get(t,e+56),vbr:ut.get(t,e+60),frames_per_packet:ut.get(t,e+64),extra_headers:ut.get(t,e+68),reserved1:ut.get(t,e+72),reserved2:ut.get(t,e+76)})},RQ=Be("music-metadata:parser:ogg:speex");class jQ extends Ma{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){RQ("First Ogg/Speex page");const r=CQ.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const AQ={len:42,get:(t,e)=>({id:new ne(7,"ascii").get(t,e),vmaj:me.get(t,e+7),vmin:me.get(t,e+8),vrev:me.get(t,e+9),vmbw:Me.get(t,e+10),vmbh:Me.get(t,e+17),nombr:gn.get(t,e+37),nqual:me.get(t,e+40)})},Sg=Be("music-metadata:parser:ogg:theora");class NQ{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Sg("flush")}calculateDuration(e){Sg("duration calculation not implemented")}async parseFirstPage(e,n){Sg("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=AQ.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const xs=Be("music-metadata:parser:ogg");class Ow{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let a=n;a<n+r;++a)i+=s.getUint8(a);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:Ow.sum(e,n,this.len)}}}class Wm extends rr{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){xs("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(Wm.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,xs("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new Ow(e));xs("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new wn(n.totalPageSize));if(xs("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":xs("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new Ma(this.metadata,this.options);break;case"OpusHea":xs("Set page consumer to Ogg/Opus"),this.pageConsumer=new IQ(this.metadata,this.options,this.tokenizer);break;case"Speex  ":xs("Set page consumer to Ogg/Speex"),this.pageConsumer=new jQ(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":xs("Set page consumer to Ogg/Theora"),this.pageConsumer=new NQ(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof ft?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),xs("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}Wm.Header={len:27,get:(t,e)=>({capturePattern:Ke.get(t,e),version:me.get(t,e+4),headerType:{continued:at(t,e+5,0),firstPage:at(t,e+5,1),lastPage:at(t,e+5,2)},absoluteGranulePosition:Number(hn.get(t,e+6)),streamSerialNumber:Y.get(t,e+14),pageSequenceNo:Y.get(t,e+18),pageChecksum:Y.get(t,e+22),page_segments:me.get(t,e+26)})};const Gl={len:8,get:(t,e)=>({chunkID:new ne(4,"latin1").get(t,e),chunkSize:Y.get(t,e+4)})};class PQ{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new ne(this.tagHeader.chunkSize,"ascii").get(e,n)}}var Rx;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(Rx||(Rx={}));class FQ{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:Pe.get(e,n),nChannels:Pe.get(e,n+2),nSamplesPerSec:Y.get(e,n+4),nAvgBytesPerSec:Y.get(e,n+8),nBlockAlign:Pe.get(e,n+12),wBitsPerSample:Pe.get(e,n+14)}}}class DQ{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:Y.get(e,n)}}}const UE={len:420,get:(t,e)=>({description:pi(new ne(256,"ascii").get(t,e)).trim(),originator:pi(new ne(32,"ascii").get(t,e+256)).trim(),originatorReference:pi(new ne(32,"ascii").get(t,e+288)).trim(),originationDate:pi(new ne(10,"ascii").get(t,e+320)).trim(),originationTime:pi(new ne(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:Y.get(t,e+338),timeReferenceHigh:Y.get(t,e+342),version:Pe.get(t,e+346),umid:new wn(64).get(t,e+348),loudnessValue:Pe.get(t,e+412),maxTruePeakLevel:Pe.get(t,e+414),maxMomentaryLoudness:Pe.get(t,e+416),maxShortTermLoudness:Pe.get(t,e+418)})},ai=Be("music-metadata:parser:RIFF");class LQ extends rr{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(Gl);if(ai(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof ft))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(Ke);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-Ke.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=Gl.len;){const n=await this.tokenizer.readToken(Gl);switch(e-=Gl.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,ai(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new DQ(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new FQ(n));let s=Rx[r.wFormatTag];s||(ai(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new wn(n.chunkSize)),s=Ko(r);await new Ar().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(UE);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-UE.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":ai(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:ai(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(ai("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new ne(4,"latin1"));switch(ai("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),ai(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(Gl),r=new PQ(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,pi(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const MQ=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],Ld={len:32,get:(t,e)=>{const n=Y.get(t,e+24),r={BlockID:Ke.get(t,e),blockSize:Y.get(t,e+4),version:Pe.get(t,e+8),totalSamples:Y.get(t,e+12),blockIndex:Y.get(t,e+16),blockSamples:Y.get(t,e+20),flags:{bitsPerSample:(1+Ef(n,0,2))*8,isMono:Gr(n,2),isHybrid:Gr(n,3),isJointStereo:Gr(n,4),crossChannel:Gr(n,5),hybridNoiseShaping:Gr(n,6),floatingPoint:Gr(n,7),samplingRate:MQ[Ef(n,23,4)],isDSD:Gr(n,31)},crc:new wn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Eg={len:1,get:(t,e)=>({functionId:Ef(t[e],0,6),isOptional:Gr(t[e],5),isOddSize:Gr(t[e],6),largeBlock:Gr(t[e],7)})};function Gr(t,e){return Ef(t,e,1)===1}function Ef(t,e,n){return t>>>e&4294967295>>>32-n}const na=Be("music-metadata:parser:WavPack");class OQ extends rr{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),Xr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(Ke)!=="wvpk")break;const n=await this.tokenizer.readToken(Ld);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");na(`WavPack header blockIndex=${n.blockIndex}, len=${Ld.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(Ld.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Ld.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Eg.len;){const s=await this.tokenizer.readToken(Eg),i=await this.tokenizer.readNumber(s.largeBlock?pf:me),a=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(a),na(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${a.length}`),s.functionId){case 0:break;case 14:{na("ID_DSD_BLOCK");const l=1<<me.get(a,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:na("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",a);break;case 47:na(`ID_BLOCK_CHECKSUM: checksum=${Aw(a)}`);break;default:na(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=Eg.len+(s.largeBlock?pf.len:me.len)+i*2,na(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const Md={len:12,get:(t,e)=>({id:Ke.get(t,e),size:hn.get(t,e+4)})},$Q={len:16,get:(t,e)=>({fileSize:gf.get(t,e),metadataPointer:gf.get(t,e+8)})};var VE;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(VE||(VE={}));const BQ={len:40,get:(t,e)=>({formatVersion:ut.get(t,e),formatID:ut.get(t,e+4),channelType:ut.get(t,e+8),channelNum:ut.get(t,e+12),samplingFrequency:ut.get(t,e+16),bitsPerSample:ut.get(t,e+20),sampleCount:gf.get(t,e+24),blockSizePerChannel:ut.get(t,e+32)})},kg=Be("music-metadata:parser:DSF");class zQ extends Hm{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(Md);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken($Q);if(r.metadataPointer===BigInt(0))kg("No ID3v2 tag present");else return kg(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new Ar().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=Md.len;){const n=await this.tokenizer.readToken(Md);switch(kg(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(BQ);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-Md.len);break}e-=n.size}}}const no={len:12,get:(t,e)=>({chunkID:Ke.get(t,e),chunkSize:dA.get(t,e+4)})},un=Be("music-metadata:parser:aiff");class UQ extends rr{async parse(){const e=await this.tokenizer.readToken(no);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(Ke)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(Ke.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=no.len;){const n=await this.tokenizer.readToken(no);un(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(no.len)+n.chunkSize}}async readData(e){un(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(Y);un(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(Ke)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(Ke.len));break}case"ID3":{const s=await this.tokenizer.readToken(new wn(Number(e.chunkSize))),i=Ko(s);await new Ar().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:un(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(un(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(un(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(no);un(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(re);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken(Me);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt(Me.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(Ke)).trim(),a=await this.tokenizer.readToken(me),l=await this.tokenizer.readToken(new ne(a,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken(Me),a=await this.tokenizer.readToken(me),l=await this.tokenizer.readToken(me),c=await this.tokenizer.readToken(re);un(`ABSS ${i}:${a}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken(Me);un(`LSCO lsConfig=${i}`);break}default:un(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(un(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(no.len)+n.chunkSize,un(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){un(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=Ke.len;){const r=await this.tokenizer.readToken(Ke);un(`Channel[ID=${r}]`),n.push(r),e-=BigInt(Ke.len)}return un(`Channels: ${n.join(", ")}`),n}}var B;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(B||(B={}));const VQ={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:B.uint},17143:{name:"ebmlReadVersion",value:B.uint},17138:{name:"ebmlMaxIDWidth",value:B.uint},17139:{name:"ebmlMaxSizeWidth",value:B.uint},17026:{name:"docType",value:B.string},17031:{name:"docTypeVersion",value:B.uint},17029:{name:"docTypeReadVersion",value:B.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:B.binary},21420:{name:"position",value:B.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:B.uid},29572:{name:"filename",value:B.string},3979555:{name:"prevUID",value:B.uid},3965867:{name:"prevFilename",value:B.string},4110627:{name:"nextUID",value:B.uid},4096955:{name:"nextFilename",value:B.string},2807729:{name:"timecodeScale",value:B.uint},17545:{name:"duration",value:B.float},17505:{name:"dateUTC",value:B.uint},31657:{name:"title",value:B.string},19840:{name:"muxingApp",value:B.string},22337:{name:"writingApp",value:B.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:B.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:B.uid},171:{name:"prevSize",value:B.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:B.uint},29637:{name:"uid",value:B.uid},131:{name:"trackType",value:B.uint},185:{name:"flagEnabled",value:B.bool},136:{name:"flagDefault",value:B.bool},21930:{name:"flagForced",value:B.bool},156:{name:"flagLacing",value:B.bool},28135:{name:"minCache",value:B.uint},28136:{name:"maxCache",value:B.uint},2352003:{name:"defaultDuration",value:B.uint},2306383:{name:"timecodeScale",value:B.float},21358:{name:"name",value:B.string},2274716:{name:"language",value:B.string},134:{name:"codecID",value:B.string},25506:{name:"codecPrivate",value:B.binary},2459272:{name:"codecName",value:B.string},3839639:{name:"codecSettings",value:B.string},3883072:{name:"codecInfoUrl",value:B.string},2536e3:{name:"codecDownloadUrl",value:B.string},170:{name:"codecDecodeAll",value:B.bool},28587:{name:"trackOverlay",value:B.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:B.bool},21432:{name:"stereoMode",value:B.uint},176:{name:"pixelWidth",value:B.uint},186:{name:"pixelHeight",value:B.uint},21680:{name:"displayWidth",value:B.uint},21690:{name:"displayHeight",value:B.uint},21683:{name:"aspectRatioType",value:B.uint},3061028:{name:"colourSpace",value:B.uint},3126563:{name:"gammaValue",value:B.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:B.float},30901:{name:"outputSamplingFrequency",value:B.float},159:{name:"channels",value:B.uint},148:{name:"channels",value:B.uint},32123:{name:"channelPositions",value:B.binary},25188:{name:"bitDepth",value:B.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:B.uint},20530:{name:"scope",value:B.bool},20531:{name:"type",value:B.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:B.uint},16981:{name:"contentCompSettings",value:B.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:B.uint},18402:{name:"contentEncKeyID",value:B.binary},18403:{name:"contentSignature ",value:B.binary},18404:{name:"ContentSigKeyID  ",value:B.binary},18405:{name:"contentSigAlgo ",value:B.uint},18406:{name:"contentSigHashAlgo ",value:B.uint}}},25188:{name:"bitDepth",value:B.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:B.uid},183:{name:"positions",container:{247:{name:"track",value:B.uint},241:{name:"clusterPosition",value:B.uint},21368:{name:"blockNumber",value:B.uint},234:{name:"codecState",value:B.uint},219:{name:"reference",container:{150:{name:"time",value:B.uint},151:{name:"cluster",value:B.uint},21343:{name:"number",value:B.uint},235:{name:"codecState",value:B.uint}}},240:{name:"relativePosition",value:B.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:B.string},18030:{name:"name",value:B.string},18016:{name:"mimeType",value:B.string},18012:{name:"data",value:B.binary},18094:{name:"uid",value:B.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:B.uid},145:{name:"timeStart",value:B.uint},146:{name:"timeEnd",value:B.uid},152:{name:"hidden",value:B.bool},17816:{name:"enabled",value:B.uid},143:{name:"track",container:{137:{name:"trackNumber",value:B.uid},128:{name:"display",container:{133:{name:"string",value:B.string},17276:{name:"language ",value:B.string},17278:{name:"country ",value:B.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:B.uid},25540:{name:"tagChapterUID",value:B.uint},25542:{name:"tagAttachmentUID",value:B.uid},25546:{name:"targetType",value:B.string},26826:{name:"targetTypeValue",value:B.uint},25545:{name:"tagEditionUID",value:B.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:B.string},17543:{name:"string",value:B.string},17541:{name:"binary",value:B.binary},17530:{name:"language",value:B.string},17531:{name:"languageIETF",value:B.string},17540:{name:"default",value:B.bool}}}}}}}}}}},ro=Be("music-metadata:parser:ebml");var Nr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Nr||(Nr={}));class HQ{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(B.uint,n=>this.readUint(n)),this.parserMap.set(B.string,n=>this.readString(n)),this.parserMap.set(B.binary,n=>this.readBuffer(n)),this.parserMap.set(B.uid,async n=>this.readBuffer(n)),this.parserMap.set(B.bool,n=>this.readFlag(n)),this.parserMap.set(B.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(RA(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const a=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof ft)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case Nr.ReadNext:if(i.id,ro(`Read element: name=${la(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${a}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,a)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const h=await u(i);s[l.name]=h,await r.elementValue(l,h,a)}}break;case Nr.SkipElement:ro(`Go to next element: name=${la(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`);break;case Nr.IgnoreElement:ro(`Ignore element: name=${la(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),await this.tokenizer.ignore(i.len);break;case Nr.SkipSiblings:ro(`Ignore remaining container, at: name=${la(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Nr.TerminateParsing:return ro(`Terminate parsing at element: name=${la(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:ro(`parseEbml: parent=${la(e)}, unknown child: id=${i.id.toString(16)} at position=${a}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(me);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:Tg(e,e.length),len:Tg(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(hA);case 8:return this.tokenizer.readNumber(yx);case 10:return this.tokenizer.readNumber(yx);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return Tg(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new ne(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function Tg(t,e){return Number(WQ(t,e))}function WQ(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),Rw.get(n,0)}catch{return BigInt(-1)}}function RA(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,RA(e)}),t}function la(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${la(t.parent)}/`),e+t.name}const Od=Be("music-metadata:parser:matroska");class qQ extends rr{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new HQ(this.tokenizer);Od("Initializing DTD end MatroskaIterator"),await n.iterate(VQ,e,{startNext:r=>{switch(r.id){case 475249515:return Od(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Nr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return Od(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),Nr.SkipElement}}return Nr.IgnoreElement;default:return Nr.ReadNext}},elementValue:async(r,s,i)=>{switch(Od(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const a=s,l=a.timecodeScale?a.timecodeScale:1e6;if(typeof a.duration=="number"){const c=a.duration*l/1e9;await this.addTag("segment:title",a.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const a=s;if(a!=null&&a.entries){a.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=a.entries.filter(c=>c.trackType===Da.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const a=s;await Promise.all(a.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?wx[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async h=>{const f=h.string?h.string:h.binary;await this.addTag(`${u}:${h.name}`,f)}))}))}break;case 423732329:{const a=s;await Promise.all(a.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const kf=Be("music-metadata:parser:factory");function GQ(t){const e=Nw.parse(t),n=Wq(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function QQ(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=jA(n)||jx(r)||jx(s);return i||kf(`No parser found for MIME-type / extension: ${n}`),KQ(t,i,e)}async function KQ(t,e,n){if(!e){kf("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=jx(t.fileInfo.path)),!e){const a=await xA(i);if(!a)throw new Error("Failed to determine audio format");if(kf(`Guessed file type is mime=${a.mime}, extension=${a.ext}`),e=jA(a.mime),!e)throw new Error(`Guessed MIME-type not supported: ${a.mime}`)}}const r=await XQ(e),s=new EG(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function jx(t){if(!t)return;switch(YQ(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function XQ(t){switch(t){case"aiff":return new AG;case"adts":case"mpeg":return new xQ;case"apev2":return new Xr;case"asf":return new VG;case"dsf":return new zQ;case"dsdiff":return new UQ;case"flac":return new qG;case"mp4":return new Sf;case"musepack":return new kQ;case"ogg":return new Wm;case"riff":return new LQ;case"wavpack":return new OQ;case"matroska":return new qQ;default:throw new Error(`Unknown parser type: ${t}`)}}function YQ(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function jA(t){let e;if(!t)return;try{e=GQ(t)}catch{kf(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function JQ(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),ZQ(t.stream(),n,e)}function ZQ(t,e,n={}){return eK(uA(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function eK(t,e){return QQ(t,e)}const AA=async t=>{var l;if(!t)return;const e=await JQ(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:[]})};function tK(t){const{setErrorToast:e,setSuccessToast:n}=ge(),{songFile:r,imageFile:s,setSong:i,setImageFile:a,updateSongData:l,setSongData:c,resetAddSongContext:u,songData:h,singers:f,song:p,genres:x,setGenres:v,setSingers:_,imageBlob:S,setImageBlob:E,...w}=Ga(),[b,I]=m.useState(!1),F=m.useRef(null),D=m.useMemo(()=>t.variant==="add"?!0:!p||!h?!1:h.name!==p.name||f.length!==p.singers.length||h.like!==p.like||x.length!==p.genres.length,[h,p,f,x]),C=!!s,k=m.useMemo(()=>{const ee=!!(h!=null&&h.name)&&!!f.length&&!!x.length&&D;return t.variant==="add"?ee:ee||C},[C,D,f,x,h]),j=()=>{switch(t.variant){case"add":return gx({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":const{id:ee,updated_at:pe,...we}=t.song;return _(we.singers),v(we.genres),gx(we)}},R=()=>{var ee,pe;switch(t.variant){case"add":(ee=F.current)==null||ee.close(),setTimeout(()=>u(j()),500);break;case"edit":(pe=F.current)==null||pe.close()}},N=async()=>{if(!r)return;const ee=await AA(r);if(ee){const pe={name:ee.name,duration:Math.floor(ee.duration),size:Math.floor(r.size/1024),image_url:""};if(ee.image){const we=new Blob([ee.image]);E(we),pe.image_url=URL.createObjectURL(we)}l(pe)}},P=()=>{const ee={},pe={};return x.forEach(we=>ee[we.id]=!0),f.forEach(we=>pe[we.id]=!0),{genre_map:ee,singer_map:pe}},A=async()=>{var ee,pe;try{if(!k||!h)return;const we={...h};if(I(!0),s||S){const ze=await Gi({imageFile:s,blob:S});t.variant==="edit"&&(p!=null&&p.image_file_path)&&jn({filePath:p.image_file_path,msg:">>> api: Delete image file"}),Object.assign(we,ze)}switch(t.variant){case"add":{if(!r)return;const{filePath:ze,fileURL:H}=await hw({file:r,folder:"/songs/",msg:">>> api: upload song file",namePrefix:"song"}),X={singers:f,genres:x,song_url:H,song_file_path:ze,...P()};Object.assign(we,X),await qi({collectionName:"Songs",data:we,msg:">>> api: set song doc"}),n(),(ee=F.current)==null||ee.open();break}case"edit":{if(!p)return;if(D){const ze={singers:f,genres:x,...P()};Object.assign(we,ze)}p&&i({...p,...we}),a(void 0),await en({collectionName:"Songs",id:p.id,data:we}),n(),(pe=F.current)==null||pe.open()}}}catch(we){console.log(we),e()}finally{I(!1)}};return m.useEffect(()=>{c(j())},[]),m.useEffect(()=>{r&&N()},[r]),m.useEffect(()=>{s&&l({image_url:URL.createObjectURL(s)})},[s]),{isValidToSubmit:k,handleSubmit:A,isFetching:b,updateSongData:l,songFile:r,songData:h,genres:x,singers:f,modalRef:F,handleCloseModalAfterFinished:R,...w}}function nK({handleCloseModal:t,variant:e}){return o.jsxs(ei,{children:[o.jsx(be,{title:"Finished"}),o.jsx(pt,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),o.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[o.jsxs(ce,{href:"/dashboard/song",children:[o.jsx(oI,{className:"w-6"}),o.jsx("span",{children:"Songs"})]}),o.jsxs(ce,{onClick:t,children:[o.jsx(vr,{className:"w-6"}),o.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function rK(){const{setImageFile:t,songData:e,updateSongData:n,imageBlob:r,setImageBlob:s}=Ga(),i=m.useRef(null),a=m.useRef(null),l=u=>{var h;(h=u.target.files)!=null&&h.length&&t(u.target.files[0])},c=()=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),n({image_url:""}))};return o.jsxs(o.Fragment,{children:[o.jsx(ce,{className:"",size:"clear",children:o.jsxs("label",{htmlFor:"image_upload",className:"inline-flex p-1.5 space-x-1 cursor-pointer md:px-3",children:[o.jsx(al,{className:"w-6"}),o.jsx("span",{className:"hidden md:block",children:"Change image"})]})}),r&&o.jsx(ce,{onClick:c,className:"h-[36px] justify-center w-[36px]",size:"clear",children:o.jsx(Vi,{className:"w-6"})}),(e==null?void 0:e.image_url)&&o.jsxs(ce,{onClick:()=>{var u;return(u=a.current)==null?void 0:u.open()},className:"p-1.5 justify-center md:px-3",size:"clear",children:[o.jsx(fI,{className:"w-6"}),o.jsx("span",{className:"hidden md:block",children:"Image info"})]}),o.jsx("input",{ref:i,onChange:l,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),(e==null?void 0:e.image_url)&&o.jsx(br,{variant:"animation",ref:a,wrapped:!1,children:o.jsxs(_r,{children:[o.jsxs("p",{children:["Url: ",e==null?void 0:e.image_url]}),o.jsxs("p",{children:["Hash: ",e==null?void 0:e.blurhash_encode]})]})})]})}function sK(){const t=m.useRef(null),{songData:e,updateSongData:n}=Ga(),[r,s]=m.useState({name:e==null?void 0:e.name,like:e==null?void 0:e.like}),i=l=>{s(c=>({...c,...l}))},a=()=>{var l;n(r),(l=t.current)==null||l.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{onClick:()=>{var l;return(l=t.current)==null?void 0:l.open()},className:"p-1.5 justify-center md:px-3",size:"clear",children:[o.jsx(qs,{className:"w-6"}),o.jsx("span",{className:"hidden md:block",children:"Edit"})]}),o.jsx(br,{variant:"animation",wrapped:!1,ref:t,children:o.jsxs(_r,{children:[o.jsx(It,{title:"Edit song",close:()=>{var l;return(l=t.current)==null?void 0:l.close()}}),o.jsxs("div",{className:"space-y-2.5",children:[o.jsxs("div",{children:[o.jsx("p",{children:"Name:"}),o.jsx(rn,{className:"bg-black/10",value:r==null?void 0:r.name,onChange:l=>i({name:l.target.value})})]}),o.jsxs("div",{className:"t",children:[o.jsx("p",{children:"Like:"}),o.jsx(rn,{className:"bg-black/10",value:r==null?void 0:r.like,onChange:l=>isNaN(+l.target.value)?{}:i({like:+l.target.value})})]})]}),o.jsx("p",{className:"mt-6 text-right",children:o.jsx(ce,{onClick:a,children:"Ok"})})]})})]})}function NA(t){const{isFetching:e,handleSubmit:n,updateSongData:r,songData:s,isValidToSubmit:i,songFile:a,modalRef:l,handleCloseModalAfterFinished:c}=tK(t),u=m.useRef(null);return t.variant==="add"&&!a?o.jsx(mr,{children:o.jsx(sA,{})}):o.jsxs("div",{className:"w-full md:max-w-[800px] md:mx-auto",children:[o.jsx("audio",{ref:u,src:t.variant==="add"?URL.createObjectURL(a):(s==null?void 0:s.song_url)||"",className:"hidden"}),s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"md:flex md:space-x-5",children:[o.jsxs("div",{className:"flex flex-col items-center md:w-1/3 md:block space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] mx-auto bg-black/5 rounded-lg overflow-hidden",children:o.jsx(pt,{className:"object-cover h-full",blurHashEncode:s.blurhash_encode,src:s.image_url})}),t.variant==="edit"&&o.jsxs("div",{className:"w-full",children:[o.jsx(be,{title:s.name}),o.jsxs(pn,{className:"[&>*]:text-sm ",children:[o.jsxs("p",{children:["Duration: ",Ms(s.duration)]}),o.jsxs("p",{children:["Size: ",s.size," kb"]}),o.jsxs("p",{className:"mt-1 font-[500]",children:[o.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",yr(s.like)]})]})]}),o.jsx("div",{className:"w-full",children:o.jsxs("div",{className:"-mt-2 -ml-2 flex flex-wrap w-full [&_button]:mt-2 [&_button]:ml-2",children:[o.jsx(rK,{}),t.variant==="edit"&&o.jsx(sK,{})]})})]}),o.jsxs("div",{className:"mt-5 md:mt-0 space-y-3 flex-grow",children:[u.current&&o.jsx(ZW,{variant:t.variant,audioEle:u.current}),t.variant==="add"&&o.jsx(pn,{children:o.jsxs("span",{children:["Duration: ",Ms(s.duration)," , Size: ",s.size,"kb"]})}),t.variant==="add"&&o.jsxs("div",{className:"",children:[o.jsx(be,{title:"Name"}),o.jsx(rn,{value:s.name,onChange:h=>r({name:h.target.value})})]}),o.jsx(JW,{}),o.jsx(tq,{})]})]}),o.jsx("p",{className:"text-center mt-5",children:o.jsxs(ce,{onClick:n,disabled:!i,loading:e,children:[o.jsx(Gy,{className:"w-6"}),o.jsx("span",{children:"Ok"})]})}),o.jsx(Oe,{persisted:t.variant==="add",ref:l,wrapped:!1,variant:"animation",children:o.jsx(nK,{variant:t.variant,handleCloseModal:c})})]})]})}function iK(){const{user:t}=ve();if(t)return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{className:"mb-5",title:"Add Song"}),o.jsx(NA,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function aK(){const[t,e]=m.useState(!0),[n,r]=m.useState(),s=m.useRef(!1),i=Vt(),{setErrorToast:a}=ge();return{song:n,isFetching:t,getSong:async c=>{try{const u=await ls({collectionName:"Songs",id:c});if(!u.exists())return i("/dashboard/song");const h={...u.data(),id:u.id,queue_id:""};r(h)}catch(u){console.log(u),a()}finally{e(!1)}},ranEffect:s}}function oK(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=aK(),{variant:s,setSong:i}=Ga(),a=za();return m.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!a.songId)return;t(a.songId)}},[]),m.useEffect(()=>{n&&i(n)},[n]),e?o.jsx(mr,{children:o.jsx(Ou,{})}):n?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{className:"mb-5",title:"Edit Song"}),o.jsx(NA,{song:n,variant:"edit"})]}):o.jsx(o.Fragment,{})}const lK=["All","Result"];function cK(){const{setPlaylists:t,playlists:e}=Pn(),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=je($r,J("is_official","==",!0),J("is_album","==",!1),J("name",">=",n),J("name","<=",n+"")),x=await cs(p);t(x),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},h=async()=>{try{i(!0);const f=je($r,J("is_official","==",!0),J("is_album","==",!1),$i("updated_at","desc")),p=await cs(f);t(p)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&h()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,playlists:e,tab:a,setTab:l,tabs:lK}}function uK(){const{user:t}=ve(),{handleAddPlaylist:e,isFetching:n}=Oj(),r=m.useRef(null),s=()=>{var a;return(a=r.current)==null?void 0:a.close()},i=async(a,l)=>{a.is_official=!0,await e(a,l),s()};if(t)return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{onClick:()=>{var a;return(a=r.current)==null?void 0:a.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[o.jsx(hs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),o.jsx(Oe,{ref:r,variant:"animation",children:o.jsx(_r,{className:"w-[500px]",children:o.jsx(xl,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function dK(){const{isFetching:t,playlists:e,tab:n,tabs:r,setTab:s,...i}=cK();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Playlists"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(vl,{...i}),o.jsx(uK,{})]}),o.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:o.jsx(fs,{tabs:r,render:a=>a,tab:n,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(he,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Qi,{colList:["Name","Like",""],children:e.length?e.map((a,l)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(Ce,{className:"hover:underline",to:`/dashboard/playlist/${a.id}`,children:a.name})}),o.jsx("td",{children:yr(a.like)}),o.jsx("td",{children:"-"})]},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:4,children:o.jsx(tt,{})})})})]})]})}function hK(){const[t,e]=m.useState([]),[n,r]=m.useState(""),[s,i]=m.useState(!1),{setErrorToast:a}=ge();return{isFetching:s,value:n,songs:t,setValue:r,handleSubmit:async c=>{try{c.preventDefault(),i(!0);const u=je(An,J("name",">=",n),J("name","<=",n+""),J("is_official","==",!0)),h=await Nn(u);e(h)}catch(u){console.log({message:u}),a()}finally{i(!1)}}}}function fK({closeModal:t,submit:e,isLoading:n}){const{theme:r}=q(),{songs:s,isFetching:i,...a}=hK(),{selectedSongs:l,selectSong:c}=fu(),u=async()=>{l.length&&(e(l),t())},h=m.useMemo(()=>{const p=l.map(x=>x.id);return s.filter(x=>!p.includes(x.id))},[s,l]),f={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-black/10 p-2",songItem:"rounded-md w-full p-1 text-left"};return o.jsx(o.Fragment,{children:o.jsxs(_r,{className:"w-[750px] h-[500px] flex flex-col overflow-hidden",children:[o.jsx(It,{close:t,title:"Add song"}),o.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2",children:[o.jsxs("div",{className:`${f.col}`,children:[o.jsx(vl,{...a}),o.jsx("div",{className:`${f.box} flex-grow mt-3`,children:o.jsx("div",{className:"h-full overflow-auto pace-y-2",children:i?o.jsx(Ou,{className:"h-full"}):h.map((p,x)=>o.jsx("button",{onClick:()=>c(p),className:`${f.songItem} bg-black/10 ${r.content_hover_bg}`,children:o.jsx("h5",{className:"",children:p.name})},x))})})]}),o.jsxs("div",{className:`${f.col} mt-3 md:mt-0`,children:[o.jsx("div",{className:"font-[500] mb-3",children:"Selected:"}),o.jsx("div",{className:`${f.box} flex-grow overflow-auto space-y-2 `,children:l.map((p,x)=>o.jsx("button",{onClick:()=>c(p),className:`${f.songItem} ${r.content_bg} hover:bg-black/10 hover:text-black`,children:o.jsx("h5",{className:"",children:p.name})},x))})]})]}),o.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:o.jsxs(ce,{disabled:!l.length,loading:n,onClick:u,children:[o.jsx(gu,{className:"w-6"}),o.jsx("span",{children:"Add"})]})})]})})}function PA(t){return o.jsx(ds,{children:o.jsx(fK,{...t})})}function $w({children:t}){return o.jsx("div",{className:"-ml-2 -mt-2 [&_button]:mt-2 [&_button]:ml-2 [&_button]:p-1.5 md:[&_button]:px-3  [&_span]:hidden md:[&_span]:block",children:t})}function mK(){const[t,e]=m.useState(""),n=m.useRef(null),{action:r,playlist:s,isFetching:i}=Bm(),a=h=>{var f,p;e(h),t==="add-song-to-playlist"&&((f=n.current)==null||f.setModalPersist(!0)),(p=n.current)==null||p.open()},l=()=>{var h;return(h=n.current)==null?void 0:h.close()},c=async h=>{await r(h),l()},u=()=>{switch(t){case"":return o.jsx(o.Fragment,{});case"edit":return s?o.jsx(o.Fragment,{children:o.jsx(_r,{className:"w-[500px]",children:o.jsx(xl,{submit:(h,f)=>c({variant:"edit-playlist",playlist:h,imageFile:f}),variant:"edit",isLoading:i,playlist:s,close:l})})}):"Playlist is undefined";case"delete":return o.jsx(Gs,{loading:i,label:"Delete playlist ?",callback:()=>c({variant:"delete-playlist"}),close:l});case"add-song-to-playlist":return o.jsx(PA,{isLoading:i,submit:h=>c({variant:"add-songs",songs:h}),closeModal:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs($w,{children:[o.jsxs(ce,{onClick:()=>a("edit"),size:"clear",children:[o.jsx(qs,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(ce,{onClick:()=>a("delete"),size:"clear",children:[o.jsx(Fn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]}),o.jsxs(ce,{onClick:()=>a("add-song-to-playlist"),size:"clear",children:[o.jsx(jV,{className:"w-5"}),o.jsx("span",{children:"Add song"})]})]}),o.jsx(Oe,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(ei,{className:"w-[unset]",children:u()})})]})}function pK(){const[t,e]=m.useState(!0),{setSongs:n,setPlaylist:r,playlist:s,songs:i}=Ew(),a=m.useRef(!1),l=za(),c=Vt(),{setErrorToast:u}=ge(),h=async()=>{try{if(!l.id)return;const f=await ls({collectionName:"Playlists",id:l.id});if(!f.exists())return c("/dashboard/playlist");const p={...f.data(),id:f.id};if(p.song_ids.length){const x=je(An,J(Ks(),"in",p.song_ids)),v=await Nn(x);n(v)}r(p)}catch(f){console.log(f),u()}finally{e(!1)}};return m.useEffect(()=>{a.current||(a.current=!0,h())},[]),{songs:i,playlist:s,isFetching:t}}function gK({singer:t}){const{action:e}=Bm();return o.jsxs(o.Fragment,{children:[o.jsx(Ce,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:o.jsx(Fn,{className:"w-5"})})})]})}function xK(t){const{playlist:e}=Ew(),{updatePlaylistData:n,playlistData:r,isValidToSubmit:s}=$j(t),{action:i,isFetching:a}=Bm(),l=m.useRef(null),c=m.useRef(null),u=async()=>{var h;!r||!s||(await i({variant:"edit-playlist",playlist:r}),(h=l.current)==null||h.close())};if(e)return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("p",{className:"mt-1 font-[500]",children:[o.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",yr(e.like)]}),o.jsx("button",{className:"",onClick:()=>{var h;return(h=l.current)==null?void 0:h.open()},children:o.jsx(qs,{className:"w-5"})})]}),o.jsx(br,{wrapped:!1,variant:"animation",ref:l,children:o.jsxs(_r,{children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"like",children:"Like"}),o.jsx(rn,{id:"like",ref:c,type:"number",value:(r==null?void 0:r.like)+"",onChange:h=>n({like:+h.target.value})})]}),o.jsx("p",{className:"text-right mt-5 md:mt-0",children:o.jsx(ce,{loading:a,color:"primary",onClick:u,disabled:!s,className:"font-playwriteCU rounded-full",children:"Save"})})]})})]})}function yK(){const{isFetching:t,songs:e,playlist:n}=pK(),r=m.useMemo(()=>e.reduce((s,i)=>s+i.duration,0),[e]);return t?o.jsx(mr,{children:o.jsx(Ou,{})}):n?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Edit playlist",className:"mb-3"}),o.jsxs("div",{className:"md:flex md:-mx-3",children:[o.jsxs("div",{className:"space-y-2.5 md:px-3",children:[o.jsx("div",{className:"w-[200px] h-[200px] mx-auto",children:o.jsx(yu,{children:o.jsx(pt,{className:"object-cover h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})})}),o.jsxs("div",{children:[o.jsx(be,{title:n.name}),o.jsxs(pn,{className:"mt-1",children:[o.jsx("p",{children:n.is_public?"Public":"Private"}),o.jsxs("p",{children:[e.length," songs - ",Ms(r)]}),o.jsx(xK,{variant:"edit",playlist:n})]})]}),o.jsx(mK,{})]}),o.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[o.jsx(be,{title:"Singers"}),o.jsx(pn,{className:"mt-1",children:n.singers.length?o.jsx("div",{className:"-mt-2 -ml-2 flex ",children:n.singers.map((s,i)=>o.jsx(yl,{children:o.jsx(gK,{singer:s})},i))}):o.jsx(tt,{})}),o.jsx(be,{title:"Songs",className:"mt-3"}),o.jsx(pn,{className:"mt-1",children:o.jsx("div",{className:"overflow-hidden",children:o.jsx(kI,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer","Like",""],children:e.length?e.map((s,i)=>o.jsx(tA,{variant:"playlist",song:s},i)):o.jsx("tr",{children:o.jsx("td",{colSpan:3,children:o.jsx(tt,{})})})})})})]})]})]}):o.jsx(o.Fragment,{})}function vK(t){const{setErrorToast:e,setSuccessToast:n}=ge(),{singer:r,setSinger:s,setSingers:i}=Ws(),[a,l]=m.useState(),[c,u]=m.useState(),[h,f]=m.useState(!1),p=m.useRef(null),x=b=>{a&&l({...a,...b})},v=m.useMemo(()=>t.variant==="add"?!0:!r||!a?!1:a.name!==r.name||a.description!==r.description||a.like!==r.like,[a]),_=!!c,S=m.useMemo(()=>{const b=!!(a!=null&&a.name)&&v;return t.variant==="add"?b:b||_},[_,v,a]),E=async()=>{try{if(!S||!a)return;f(!0);const b={...a};if(c){const I=await Gi({imageFile:c});Object.assign(b,I)}switch(t.variant){case"add":{const I=await qi({collectionName:"Singers",data:b}),F={...a,id:I.id};i(D=>[F,...D]),n("Add singer successful");break}case"edit":{if(!r)return;await en({collectionName:"Singers",id:r.id,data:b}),s({...r,...b}),n("Edit singer successful")}}}catch(b){console.log(b),e()}finally{f(!1),t.closeModal()}},w=()=>{switch(t.variant){case"add":return mf({});case"edit":if(!r)throw new Error("");const{id:b,...I}=r;return mf(I)}};return m.useEffect(()=>{var b;t.variant==="add"&&((b=p.current)==null||b.focus()),l(w())},[]),m.useEffect(()=>{c&&x({image_url:URL.createObjectURL(c)})},[c]),m.useEffect(()=>{var b;(b=p.current)==null||b.focus()},[]),{singerData:a,imageFile:c,setImageFile:u,updateSingerData:x,setSingerData:l,inputRef:p,handleSubmit:E,isFetching:h,isValidToSubmit:S}}function FA(t){const{theme:e}=q(),{setImageFile:n,singerData:r,handleSubmit:s,isFetching:i,isValidToSubmit:a,updateSingerData:l,inputRef:c}=vK(t),u=h=>{var f;(f=h.target.files)!=null&&f.length&&n(h.target.files[0])};if(r)return o.jsxs(_r,{className:"w-[700px] flex flex-col md:block",children:[o.jsx(It,{close:t.closeModal,title:t.variant==="add"?"Add singer":"Edit singer"}),o.jsxs("div",{className:"flex-grow overflow-auto md:flex md:flex-[unset] md:overflow-hidden",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:o.jsx(pt,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),o.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",id:"image_upload",className:"hidden"}),o.jsx("div",{className:"space-x-2 flex",children:o.jsx(ce,{className:`${e.content_bg}`,size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:o.jsx(al,{className:"w-5"})})})})]}),o.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Name:"}),o.jsx(rn,{ref:c,type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:r.name,onChange:h=>l({name:h.target.value})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Description:"}),o.jsx("textarea",{placeholder:"...",id:"description",className:`${Yy} w-full bg-[#f1f1f1] rounded-md min-h-[100px]`,value:r.description,onChange:h=>l({description:h.target.value})})]}),t.variant==="edit"&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),o.jsx(rn,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:r.like+"",onChange:h=>l({like:+h.target.value})})]})]})]}),o.jsx("p",{className:"text-right mt-3",children:o.jsx(ce,{loading:i,color:"primary",onClick:s,disabled:!a,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function wK(){const t=m.useRef(null),e=()=>{var n;return(n=t.current)==null?void 0:n.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[o.jsx(hs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),o.jsx(Oe,{wrapped:!1,ref:t,variant:"animation",children:o.jsx(ei,{className:"w-[unset]",children:o.jsx(FA,{closeModal:e,variant:"add"})})})]})}const _K=["All","Result"];function bK(){const{setSingers:t,singers:e}=Ws(),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=je(hf,J("name",">=",n),J("name","<=",n+"")),x=await ff(p);t(x),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},h=async()=>{try{i(!0);const f=je(hf,$i("created_at","desc")),p=await ff(f);t(p)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&h()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,singers:e,tab:a,setTab:l,tabs:_K}}function SK(){const{isFetching:t,singers:e,tabs:n,tab:r,setTab:s,...i}=bK();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Singer"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(vl,{...i}),o.jsx(wK,{})]}),o.jsx("div",{className:`mt-5 w-fit ${r==="All"?"pointer-events-none":""} self-start`,children:o.jsx(fs,{tabs:n,render:a=>a,tab:r,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(he,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Qi,{colList:["Name","Like"],children:e.length?e.map((a,l)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(Ce,{className:"hover:underline",to:`/dashboard/singer/${a.id}`,children:a.name})}),o.jsx("td",{children:yr(a.like)})]},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(tt,{})})})})]})]})}function EK({value:t}){const e=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[o.jsx(vr,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),o.jsx(Oe,{ref:e,variant:"animation",wrapped:!1,children:o.jsx(Iw,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function kK({genre:t}){const[e,n]=m.useState(""),r=m.useRef(null),{action:s,isFetching:i}=aA(),a=u=>{var h;n(u),(h=r.current)==null||h.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return o.jsxs(o.Fragment,{children:[o.jsxs(yl,{children:[o.jsx("span",{children:t.name}),o.jsxs("div",{children:[o.jsx("button",{className:"",onClick:()=>a("edit"),children:o.jsx(qs,{className:"w-5"})}),o.jsx("button",{onClick:()=>a("delete"),children:o.jsx(Fn,{className:"w-5"})})]})]}),o.jsxs(Oe,{variant:"animation",ref:r,wrapped:!1,children:[e==="edit"&&o.jsx(Iw,{type:"edit",genre:t,closeModal:l}),e==="delete"&&o.jsx(ei,{children:o.jsx(Gs,{callback:c,close:l,loading:i,label:`Delete genre '${t.name}'`})})]})]})}function TK(){const{isFetching:t,api:e}=oA(),{_genres:n,...r}=lA();return m.useEffect(()=>{e()},[]),o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Genres"}),o.jsxs("div",{className:"flex justify-between items-start mt-3",children:[o.jsx(nA,{...r}),o.jsx(EK,{value:r.value})]}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(he,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(o.Fragment,{children:n.length?o.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(s=>o.jsx(kK,{genre:s},s.id))}):o.jsx(tt,{})})]})]})}function IK(){return o.jsx(Yj,{})}function CK(){const{setErrorToast:t}=ge(),{singer:e,setSinger:n}=Ws(),[r,s]=m.useState(!1),i=Vt();return{isFetching:r,action:async l=>{try{switch(l.variant){case"delete":{if(!e)throw new Error("");s(!0),await Dm({collectionName:"Singers",id:e.id}),e.image_file_path&&await jn({filePath:e.image_file_path}),s(!1),i("/dashboard/singer");break}}}catch(c){console.log({message:c}),t("")}finally{s(!1)}},singer:e,setSinger:n}}function RK(){const[t,e]=m.useState(""),n=m.useRef(null),{action:r,isFetching:s,singer:i}=CK(),a=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>a("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),o.jsx("div",{className:"mt-3 md:!mt-auto",children:o.jsxs($w,{children:[o.jsxs(ce,{onClick:()=>a("edit"),className:"md:px-3",size:"clear",children:[o.jsx(qs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Edit singer"})]}),o.jsxs(ce,{onClick:()=>a("delete"),className:"md:px-3",size:"clear",children:[o.jsx(Fn,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Delete"})]})]})}),o.jsxs(br,{ref:n,children:[t==="more"&&i&&o.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:i.description}),t==="edit"&&o.jsx(FA,{closeModal:l,variant:"edit"}),t==="delete"&&i&&o.jsx(Gs,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),close:l})]})]})}function jK(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=Ws(),{setErrorToast:s}=ge(),{setIsFetching:i}=Bu(),a=za(),l=Vt(),c=m.useRef(!1),u=async()=>{try{if(!a.id)return;const h=await ls({collectionName:"Singers",id:a.id});h.exists()||l("/dashboard/singer");const f={...h.data(),id:a.id},p=je(An,J(`singer_map.${f.id}`,"==",!0)),x=await Nn(p),v=je($r,J(`singer_map.${f.id}`,"==",!0)),_=await cs(v),S=[],E=[];_.forEach(w=>w.is_album?E.push(w):S.push(w)),t(f),n(S),r(E),e(x)}catch(h){console.log({error:h}),s()}finally{i(!1)}};m.useEffect(()=>{c.current||(c.current=!0,u())},[])}function AK(){const[t,e]=m.useState(!0);return{isFetching:t,setIsFetching:e}}const DA=m.createContext(null);function NK({children:t}){return jK(),t}function PK({children:t}){return o.jsx(DA.Provider,{value:AK(),children:o.jsx(NK,{children:t})})}function Bu(){const t=m.useContext(DA);if(!t)throw new Error;return t}function FK(){const{singer:t}=Ws(),{isFetching:e}=Bu();return!e&&!t?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"md:flex",children:[o.jsx("div",{className:"w-[260px] h-[260px] mx-auto md:m-unset",children:e?o.jsx(he,{className:"pt-[100%] "}):o.jsx(yu,{children:o.jsx(pt,{src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})})}),o.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?o.jsxs(o.Fragment,{children:[o.jsx(he,{className:"h-[60px] w-full md:w-[200px]"}),o.jsx(he,{className:"h-[120px] w-full md:w-[70%]"}),o.jsx(he,{className:"h-[17px] w-[200px]"})]}):t&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:t.name}),o.jsxs("p",{children:[o.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",yr(t.like)]}),o.jsx("p",{className:"line-clamp-2",children:t.description}),o.jsx(RK,{})]})})]})})}function DK(){const{songs:t}=Ws(),{isFetching:e}=Bu();return o.jsxs(o.Fragment,{children:[o.jsx(be,{title:"Songs"}),o.jsx(ds,{children:e?o.jsx(he,{className:"h-[100px]"}):o.jsx(Qi,{colList:["Name","Singer"],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(Ce,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),o.jsx("td",{children:n.singers.map((s,i)=>o.jsx(Ce,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(tt,{})})})})})]})}function LK(){const{playlists:t}=Ws(),{isFetching:e}=Bu();return o.jsxs(o.Fragment,{children:[o.jsx(be,{title:"Playlists"}),e&&o.jsx(he,{className:"h-[100px]"}),!e&&o.jsx(Qi,{colList:["Name",""],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(Ce,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),o.jsx("td",{children:"-"})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(tt,{})})})})]})}function MK(){const[t,e]=m.useState(),[n,r]=m.useState([]),[s,i]=m.useState(),[a,l]=m.useState(),[c,u]=m.useState();return{singer:t,setSinger:e,songs:n,setSongs:r,updateAlbumData:f=>{s&&i({...s,...f})},albumData:s,imageFile:a,setImageFile:l,setAlbumData:i,album:c,setAlbum:u}}const LA=m.createContext(null);function OK({children:t}){return o.jsx(LA.Provider,{value:MK(),children:t})}function wl(){const t=m.useContext(LA);if(!t)throw new Error("AddAlbumProvider not provided");return t}function $K(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,setSongs:i,album:a,singer:l,songs:c,setAlbum:u,setImageFile:h,setAlbumData:f}=wl(),{setSuccessToast:p,setErrorToast:x}=ge(),[v,_]=m.useState(!1),S=m.useRef(!1),E=m.useMemo(()=>t.variant==="add"?!0:!a||!s||!l?!1:s.name!==a.name||l.id!==a.singers[0].id||s.like!==a.like||!!c.find(D=>!a.song_ids.includes(D.id)),[s,a,l,c]),w=!!e,b=m.useMemo(()=>{const D=!!E&&!!s&&!!s.name&&!!l&&!!c.length;return t.variant==="add"?D:D||w},[w,E,s,l,c]),I=async()=>{try{if(!s||!l)return;if(_(!0),e){const D=await Gi({imageFile:e});Object.assign(s,D)}switch(s.singers=[l],s.singer_map={[l.id]:!0},s.song_ids=c.map(D=>D.id),t.variant){case"add":{const D=await qi({collectionName:"Playlists",data:s}),C=await Fu(D),k={...C.data(),id:C.id};t.callback(k),p("Album created");break}case"edit":{if(!a)return;await en({collectionName:"Playlists",data:s,id:a.id}),u({...a,...s}),p("Album edited");break}}}catch(D){console.log(D),x()}finally{_(!1),h(void 0)}},F=async()=>{switch(t.variant){case"add":f(ZS({owner_email:t.user.email,distributor:t.user.email})),r(t.singer);break;case"edit":const{id:D,song_ids:C,singers:k,...j}=t.album;if(C){const R=je(An,J(Ks(),"in",C)),N=await Nn(R);i(N)}u(t.album),r(k[0]),f(ZS({...j,song_ids:C,singers:k}));break}};return m.useEffect(()=>{S.current||(S.current=!0,F())},[]),m.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:I,isFetching:v,isValidToSubmit:b}}function BK(){const{singer:t,setSinger:e,albumData:n,updateAlbumData:r}=wl(),s=m.useRef(null),i=a=>{var l;e(a),(l=s.current)==null||l.close()};if(n)return o.jsxs(o.Fragment,{children:[o.jsxs(pn,{className:"space-y-2.5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-lg",htmlFor:"name",children:"Name"}),o.jsx(rn,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:a=>r({name:a.target.value})})]}),o.jsxs("div",{className:"flex items-center space-x-1.5",children:[o.jsx("p",{className:"text-lg",children:"Singer"}),t?o.jsxs(yl,{className:"mt-0",children:[o.jsx("span",{children:t.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e(void 0),children:o.jsx(Fn,{className:"w-5"})})})]}):o.jsx(ce,{size:"clear",className:"p-1.5",onClick:()=>{var a;return(a=s.current)==null?void 0:a.open()},children:o.jsx(vr,{className:"w-5"})})]})]}),o.jsx(br,{ref:s,children:o.jsx(Tw,{choose:i,closeModal:()=>{var a;return(a=s.current)==null?void 0:a.close()}})})]})}function zK(){const{songs:t,setSongs:e}=wl(),n=m.useRef(null),r=i=>{const a=t.map(c=>c.id),l=i.filter(c=>!a.includes(c.id));e([...t,...l])},s=i=>{const a=t.filter(l=>l.id!==i.id);e(a)};return o.jsxs(o.Fragment,{children:[o.jsxs(Qi,{colList:["Name","Singer","Like"," "],children:[t.map((i,a)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("span",{children:i.name})}),o.jsx("td",{children:i.singers.map((l,c)=>o.jsxs("span",{className:"hover:underline",children:[!!c&&", ",l.name]},c))}),o.jsx("td",{children:o.jsx("span",{children:yr(i.like)})}),o.jsx("td",{children:o.jsx(ce,{onClick:()=>s(i),size:"clear",className:"p-1",children:o.jsx(Fn,{className:"w-5"})})})]},a)),o.jsx("tr",{className:"!bg-white border-none",children:o.jsx("td",{colSpan:3,children:o.jsx("p",{className:"text-center",children:o.jsxs(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:[o.jsx(vr,{className:"w-6"}),o.jsx("span",{children:"Add song"})]})})})})]}),o.jsx(br,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(PA,{submit:r,closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()},isLoading:!1})})]})}function UK(){const{album:t}=wl(),e=m.useRef(null),n=Vt(),r=async()=>{try{if(!t)return;await Promise.all([Dm({collectionName:"Playlists",id:t.id}),t.image_file_path?jn({filePath:t.image_file_path}):()=>{}]),n("/dashboard/album")}catch{}};return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{size:"clear",onClick:()=>{var s;return(s=e.current)==null?void 0:s.open()},children:[o.jsx(Fn,{className:"w-6"}),o.jsx("span",{children:"Delete"})]}),o.jsx(Oe,{variant:"animation",ref:e,wrapped:!1,children:o.jsx(ei,{children:o.jsx(Gs,{label:`Delete album ' ${t==null?void 0:t.name} '`,close:()=>{var s;return(s=e.current)==null?void 0:s.close()},callback:r,loading:!1})})})]})}function VK({closeModal:t}){const{albumData:e,singer:n,setSinger:r,updateAlbumData:s}=wl();if(!e||!n)throw new Error("albumData or singer is undefined");const[i,a]=m.useState(e),[l,c]=m.useState(n),u=m.useRef(null),h=m.useMemo(()=>i.name!==e.name||i.like!==e.like||l!==n,[i,l]),f=m.useMemo(()=>!!(i!=null&&i.name)&&!!l&&h,[h]),p=_=>{a({...i,..._})},x=_=>{var S;c(_),(S=u.current)==null||S.close()},v=()=>{r(l),s(i),t()};if(i)return o.jsxs(o.Fragment,{children:[o.jsxs(_r,{children:[o.jsx(It,{close:t,title:"Edit album"}),o.jsx("div",{className:"flex-grow overflow-auto",children:o.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Album name:"}),o.jsx(rn,{type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:i.name,onChange:_=>p({name:_.target.value})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Singer:"}),o.jsx("div",{className:"-mt-2 -ml-2",children:o.jsxs(yl,{className:"mt-0 w-fit",children:[o.jsx("span",{children:l.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>{var _;return(_=u.current)==null?void 0:_.open()},children:o.jsx(Tt,{className:"w-5"})})})]})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),o.jsx(rn,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:i.like+"",onChange:_=>p({like:+_.target.value})})]})]})}),o.jsx("p",{className:"text-right mt-3",children:o.jsx(ce,{color:"primary",onClick:v,disabled:!f,className:"font-playwriteCU rounded-full",children:"Save"})})]}),o.jsx(br,{ref:u,children:o.jsx(Tw,{choose:x,closeModal:()=>{var _;return(_=u.current)==null?void 0:_.close()}})})]})}function HK(){const t=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{onClick:()=>{var e;return(e=t.current)==null?void 0:e.open()},children:[o.jsx(qs,{className:"w-6"}),o.jsx("span",{children:"Edit"})]}),o.jsx(br,{ref:t,children:o.jsx(VK,{closeModal:()=>{var e;return(e=t.current)==null?void 0:e.close()}})})]})}function WK({className:t="",...e}){const{theme:n}=q(),{albumData:r,singer:s,setImageFile:i}=wl(),{submit:a,isFetching:l,isValidToSubmit:c}=$K(e),u=f=>{var p;(p=f.target.files)!=null&&p.length&&i(f.target.files[0])},h=o.jsxs($w,{children:[o.jsx(ce,{className:`${n.content_bg} !p-0`,size:"clear",children:o.jsxs("label",{htmlFor:"image_upload",className:"md:px-3 p-1.5 inline-flex space-x-1 cursor-pointer ",children:[o.jsx(al,{className:"w-6"}),o.jsx("span",{children:"Change image"})]})}),e.variant==="edit"&&o.jsxs(o.Fragment,{children:[o.jsx(HK,{}),o.jsx(UK,{})]})]});return r?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`md:flex ${t}`,children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] mx-auto h-[200px] rounded-lg overflow-hidden",children:o.jsx(pt,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),o.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),e.variant==="add"&&o.jsx("div",{children:h}),e.variant==="edit"&&o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:r.name}),o.jsxs(pn,{className:"text-[#333]",children:[o.jsx("p",{className:"text-xl",children:s==null?void 0:s.name}),o.jsxs("p",{children:[r.song_ids.length," songs"]}),o.jsxs("p",{className:"mt-1 font-[500]",children:[o.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",yr(r.like)]})]}),o.jsx("div",{className:"mt-3",children:h})]})})]}),o.jsxs("div",{className:"mt-3 md:w-3/4 md:mt-0 md:ml-3 flex-grow flex flex-col space-y-2.5",children:[e.variant==="add"&&o.jsx(BK,{}),o.jsxs("div",{children:[e.variant==="add"&&o.jsx("p",{className:"text-lg mb-1",children:"Songs"}),e.variant==="edit"&&o.jsx(be,{title:"Songs"}),o.jsx(zK,{})]})]})]}),o.jsx("p",{className:"text-right mt-5",children:o.jsx(ce,{loading:l,color:"primary",onClick:a,disabled:!c,className:"font-playwriteCU rounded-full",children:"Save"})})]}):o.jsx(o.Fragment,{})}function Bw(t){return o.jsx(OK,{children:o.jsx(WK,{...t})})}function qK(){const{user:t}=ve(),{singer:e,setAlbums:n}=Ws(),r=m.useRef(null),s=i=>{n(a=>[i,...a])};return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"px-3 py-1",size:"clear",children:[o.jsx(vr,{className:"w-5"}),o.jsx("span",{children:"Add album"})]}),o.jsx(br,{ref:r,children:o.jsx(_r,{className:"w-[700px] flex flex-col",children:t&&e&&o.jsxs(o.Fragment,{children:[o.jsx(It,{title:"Add album",close:()=>{var i;return(i=r.current)==null?void 0:i.close()}}),o.jsx(Bw,{className:"flex-grow overflow-auto no-scrollbar md:overflow-hidden",variant:"add",singer:e,callback:s,user:t})]})})})]})}function GK(){const{albums:t}=Ws(),{isFetching:e}=Bu();return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(be,{title:"Albums"}),o.jsx(qK,{})]}),e&&o.jsx(he,{className:"h-[100px]"}),!e&&o.jsx(Qi,{colList:["Name",""],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(Ce,{to:`/dashboard/album/${n.id}`,children:n.name})}),o.jsx("td",{children:"-"})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(tt,{})})})})]})}function QK(){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"pb-[46px] space-y-3",children:[o.jsx(FK,{}),o.jsx(GK,{}),o.jsx(DK,{}),o.jsx(LK,{})]})})}function KK(){return o.jsx(PK,{children:o.jsx(QK,{})})}function XK({setAlbums:t}){const{user:e}=ve(),n=m.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(a=>[i,...a]),r()};if(e)return o.jsxs(o.Fragment,{children:[o.jsxs(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[o.jsx(hs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),o.jsx(Oe,{wrapped:!1,ref:n,variant:"animation",children:o.jsxs(ei,{className:"w-[800px]",children:[o.jsx(be,{title:"Add album"}),o.jsx(Bw,{className:"overflow-auto",variant:"add",user:e,callback:s})]})})]})}const YK=["All","Result"];function JK(){const[t,e]=m.useState([]),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=je($r,J("is_album","==",!0),J("name",">=",n),J("name","<=",n+"")),x=await cs(p);e(x),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},h=async()=>{try{i(!0);const f=je($r,J("is_album","==",!0),$i("created_at","desc")),p=await cs(f);e(p)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&h()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:a,setTab:l,tabs:YK,setAlbums:e}}function ZK(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...a}=JK();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Albums"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(vl,{...a}),o.jsx(XK,{setAlbums:i})]}),o.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:o.jsx(fs,{tabs:r,render:l=>l,tab:n,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(he,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Qi,{colList:["Name","Singer","Like"],children:e.length?e.map((l,c)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(Ce,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),o.jsx("td",{children:o.jsx(Ce,{to:`/dashboard/singer/${l.singers[0].id}`,children:l.singers[0].name})}),o.jsx("td",{children:yr(l.like)})]},c)):o.jsx("tr",{children:o.jsx("td",{colSpan:4,children:o.jsx(tt,{})})})})]})]})}function HE({children:t}){return o.jsx(qW,{children:t})}function eX({children:t}){return o.jsx(OW,{children:t})}function tX(){const[t,e]=m.useState(!0),[n,r]=m.useState(),s=m.useRef(!1),i=za(),a=Vt(),{setErrorToast:l}=ge(),c=async()=>{try{if(!i.id)return;const u=await ls({collectionName:"Playlists",id:i.id});if(!u.exists())return a("/dashboard/album");const h={...u.data(),id:u.id};if(!h.is_album)return a(`/dashboard/playlist/${h.id}`);r(h)}catch(u){console.log(u),l()}finally{e(!1)}};return m.useEffect(()=>{s.current||(s.current=!0,c())},[]),{album:n,isFetching:t}}function nX(){const{album:t,isFetching:e}=tX();return e?o.jsx(mr,{children:o.jsx(Tt,{className:"w-6 animate-spin"})}):t?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Edit album",className:"mb-3"}),o.jsx(Bw,{variant:"edit",album:t})]}):o.jsx(o.Fragment,{})}const Ql={home:"/",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id"},WE={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},or={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id"},rX=[{path:Ql.home,component:aH,layout:""},{path:Ql.playlist,component:pH,layout:""},{path:Ql.search,component:hW,layout:""},{path:Ql.unauthorized,component:mW,layout:""},{path:Ql.singer,component:jW,layout:""}],sX=[{path:WE.myMusic,component:SH,layout:""},{path:WE.songLyric,component:lW,layout:""}],iX=[{path:or.dashboard,component:AW,layout:""},{path:or.playlist,component:dK,layout:""},{path:or.genre,component:TK,layout:""},{path:or.singer,component:SK,layout:rb},{path:or.editSinger,component:KK,layout:rb},{path:or.playlistDetail,component:yK,layout:eX},{path:or.album,component:ZK,layout:""},{path:or.editAlbum,component:nX,layout:""},{path:or.song,component:HW,layout:""},{path:or.addSong,component:iK,layout:HE},{path:or.editSong,component:oK,layout:HE},{path:or.songLyric,component:IK,layout:""}],MA="/assets/loading-b1210647.gif";function aX(){const{user:t,loading:e}=ve(),{theme:n}=q();return e?o.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${n.container}`,children:o.jsx("img",{className:"w-[150px]",src:MA,alt:""})}):t?o.jsx(Hf,{}):o.jsx(gT,{state:{from:"/my-music"},replace:!0,to:"/login"})}function oX(){const[t,e]=m.useState(!0),[n,r]=m.useState(!1),{user:s,loading:i}=ve(),{theme:a}=q();return m.useEffect(()=>{(async()=>{await Os(1e3),r(!0),e(!1)})()},[]),i||t?o.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${a.container}`,children:o.jsx("img",{className:"w-[150px]",src:MA,alt:""})}):s&&n?o.jsx(Hf,{}):o.jsx(gT,{replace:!0,to:"/unauthorized"})}const OA=[{path:"/dashboard",title:"Dashboard",icon:o.jsx(zy,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/song",title:"Songs",icon:o.jsx(Ua,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/playlist",title:"Playlists",icon:o.jsx(mL,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/album",title:"Albums",icon:o.jsx(QD,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/singer",title:"Singers",icon:o.jsx(ZL,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/genre",title:"Genres",icon:o.jsx(OL,{className:"w-5 flex-shrink-0"})}];function lX(){const{theme:t}=q(),[e,n]=m.useState(!1),r=nr(),s="",i={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 ",itemActive:"text-[#cd1818] bg-[#f1f1f1]",icon:"w-[24px] flex-shrink-0"};return o.jsxs("div",{className:`${i.container} ${e?"w-[150px]":"w-[70px]"}`,children:[o.jsxs("div",{className:"md:mt-[60px]",children:[OA.map((a,l)=>{const c=r.pathname===a.path;return o.jsxs(Ce,{className:`
              ${c?t.content_bg:"hover:bg-black/10"}
              ${i.item} ${e?"!justify-start":""}
              ${s===a.path?i.itemActive:""}`,to:a.path,children:[a.icon,e&&o.jsx("span",{children:a.title})]},l)}),o.jsxs(Ce,{to:"/",target:"_blank",className:`${i.item} ${e?"!justify-start":""}
               
               `,children:[o.jsx(nm,{className:i.icon}),e&&o.jsx("span",{children:"Home"})]})]}),o.jsx(ce,{onClick:()=>n(a=>!a),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:e?o.jsx(_V,{className:"w-5 "}):o.jsx(EV,{className:"w-5"})})]})}function $A({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=Uj();return o.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[o.jsx("button",{onClick:r,className:`relative ${zc(!e.length)}`,children:o.jsx(oI,{className:"w-5"})}),o.jsx("button",{onClick:s,className:`relative ${zc(!n.length)}`,children:o.jsx(fD,{className:"w-5"})})]})}function cX(){const{theme:t}=q(),[e,n]=m.useState(0),[r,s]=m.useState(""),i=m.useRef(null),a=m.useRef(null),l=f=>{var p,x;s(f),(p=a.current)==null||p.close(),(x=i.current)==null||x.open()},c=()=>{var f;return(f=i.current)==null?void 0:f.close()},u=f=>{const p=f.target.scrollTop||0;n(p)},h=()=>{switch(r){case"":return o.jsx(o.Fragment,{});case"theme":return o.jsx(Ky,{close:c});case"info":return o.jsx(Qy,{close:c})}};return m.useEffect(()=>{const f=document.querySelector(".main-container");return f==null||f.addEventListener("scroll",u),()=>{f==null||f.removeEventListener("scroll",u)}},[]),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${e?" shadow-lg":""}`,children:[o.jsxs("div",{className:"flex",children:[o.jsxs(Ce,{to:"/dashboard",className:"text-xl font-[500]",children:["HD",o.jsx("span",{className:`${t.content_text} ml-[4px] uppercase`,children:"Dashboard"})]}),o.jsx($A,{className:"ml-5"})]}),o.jsx("div",{className:"flex",children:o.jsxs(pr,{children:[o.jsx(gr,{ref:a,children:o.jsx("button",{className:`flex p-2 items-center rounded-full bg-${t.alpha} ${t.content_hover_bg}`,children:o.jsx(pu,{className:"w-6"})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(CI,{openModal:l,variant:"dashboard"})})]})})]}),o.jsx(Oe,{ref:i,variant:"animation",children:h()})]})}function uX(){const[t,e]=m.useState(!1),n=m.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return m.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),o.jsxs(o.Fragment,{children:[o.jsx(pn,{colors:"third",className:`absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bottom-[80px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:OA.map((s,i)=>o.jsxs(Ce,{className:"inline-flex py-1.5 space-x-1",to:s.path,children:[s.icon,o.jsx("span",{children:s.title})]},i))}),o.jsx(ce,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] bottom-[10px] left-[10px]  p-1.5",children:o.jsx(il,{className:"w-6"})})]})}function dX({className:t="",toast:e,onClick:n}){const{theme:r}=q(),[s,i]=m.useState(!1),a={icon:"w-6",container:`transition-[transform,opacity] text-white px-3 py-1 space-x-1 rounded-md flex items-center ${r.modal_bg}`,text:"font-[500] text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},l=()=>{switch(e.variant){case"success":return o.jsx(Gy,{className:`${a.icon} text-emerald-500`});case"error":return o.jsx(xI,{className:`${a.icon} text-red-500`})}};return m.useEffect(()=>{setTimeout(()=>{i(!0)},0)},[]),o.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`${a.container} ${t} ${s?a.open:a.init} `,children:[l(),o.jsx("p",{className:a.text,children:e.desc})]})}const BA=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=ge(),[s,i]=m.useState(""),a=l=>{n(c=>c.filter(u=>u.id!=l))};return m.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),m.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),o.jsx(o.Fragment,{children:el.createPortal(o.jsx("div",{className:`fixed z-[199] ${e}`,children:o.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>o.jsx(dX,{onClick:a,toast:l},c))})}),document.getElementById("portals"))})};function hX(){const{setTheme:t,isOnMobile:e,theme:n}=q();return m.useEffect(()=>{t(Y4)},[]),o.jsx(o.Fragment,{children:o.jsx(ZT,{children:o.jsx(QW,{children:o.jsxs("div",{className:`${n.container} fixed inset-full flex ${n.text_color}`,children:[e?o.jsx(uX,{}):o.jsx(lX,{}),o.jsxs("div",{className:"flex flex-col flex-grow",children:[o.jsx(cX,{}),o.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:o.jsx(Hf,{})})]}),o.jsx(BA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),o.jsx(JT,{})]})})})})}const zA="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu";function fX({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:a,idle:l}=Ye(),c=t==="desktop"?n:s,u=t==="desktop"?r:a,h=t==="desktop"?e:i,f={item:"px-3 md:px-8 leading-[30px] font-[600] cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?f.fadeTransition:""}`,children:h.map((p,x)=>{const v=p===c;return o.jsx("li",{onClick:()=>u(p),className:`${f.item} ${v?"bg-white/20":"hover:bg-white/5"}`,children:p},x)})})}function mX(){const{user:t}=ve(),{theme:e}=q(),{activeTab:n,idle:r,setIsOpenFullScreen:s}=Ye(),{currentSongData:i}=ae(Ve),a=Vt(),l=i&&t?i.song.owner_email===t.email&&i.song.is_official===!1:!1,c=()=>{i!=null&&i.song&&(s(!1),setTimeout(()=>{a(`/my-music/lyric/${i==null?void 0:i.song.id}`)},300))},u={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${e.content_hover_bg}`,headerWrapper:"relative flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsxs("div",{className:`${u.headerWrapper} ${r?"pointer-events-none":""}`,children:[r&&i&&o.jsx("div",{className:"absolute left-4",children:n!=="Songs"&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"font-playwriteCU text-sm",children:i.song.name}),o.jsx("p",{className:"opacity-70 text-sm",children:i.song.singers.map((h,f)=>(f?", ":"")+h.name)})]})}),o.jsx(fX,{}),o.jsxs("div",{className:`absolute flex right-4 space-x-3 ${r&&u.fadeTransition}`,children:[l&&n==="Lyric"&&o.jsx(Ns,{position:"top-[calc(100%+8px)]",content:"Edit lyric",children:o.jsx("button",{onClick:()=>c(),className:`p-2 ${u.button}`,children:o.jsx(Uy,{})})}),o.jsxs(pr,{children:[o.jsx(gr,{children:o.jsx(Ns,{position:"top-[calc(100%+8px)]",content:"Setting",children:o.jsx("button",{className:`${u.button} p-2`,children:o.jsx(By,{})})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0 z-[99]",animationClassName:"origin-top-right",children:o.jsx(WI,{})})]}),o.jsx(Ns,{position:"top-[calc(100%+8px)]",content:"Close",children:o.jsx("button",{onClick:()=>s(!1),className:`p-2 ${u.button}`,children:o.jsx(uI,{})})})]})]})}const $d=.3;function pX({active:t}){const{audioRef:e}=Ye();if(!e.current)throw new Error("useSongLyric !audioRef.current");const[n,r]=m.useState(0),s=m.useRef("instant"),i=m.useRef(null),a=m.useRef(0),l=m.useRef([]),c=m.useRef(0),{loading:u,songLyrics:h}=Lj({active:t}),f=()=>{const p=e.current.currentTime>a.current?"forward":"backward";a.current=e.current.currentTime;let x=c.current;switch(p){case"forward":for(;h[x+1]&&h[x+1].start-$d<a.current+$d;)x+=1;break;case"backward":for(;h[x-1]&&h[x-1].end-$d>a.current+$d;)x-=1;break}x!==c.current&&(Math.abs(x-c.current)>5&&(s.current="instant"),c.current=x,r(x),GT(l.current[x],s.current),s.current==="instant"&&(s.current="smooth"))};return m.useEffect(()=>{f()},[t]),m.useEffect(()=>{if(!(!t||!h.length))return e.current.addEventListener("timeupdate",f),()=>{e.current.removeEventListener("timeupdate",f)}},[t,h]),m.useEffect(()=>()=>{r(0),c.current=0},[h]),{songLyrics:h,loading:u,currentIndex:n,containerRef:i,lyricRefs:l,scrollBehavior:s}}function UA({className:t,active:e}){const{playerConig:{lyricSize:n}}=Ye(),{loading:r,songLyrics:s,currentIndex:i,containerRef:a,lyricRefs:l}=pX({active:e}),c={small:"text-[16px] sm:text-[26px]",medium:"text-[20px] sm:text-[30px]",large:"text-[26px] sm:text-[46px]"},u=()=>s.map((f,p)=>{let x="coming";return i===p?x="active":p<i&&(x="done"),o.jsx(qj,{ref:v=>l.current[p]=v,status:x,text:f.text,activeColor:"scale-[1.3]",className:"leading-[1.3] mb-3 w-[70%] md:mb-5 last:mb-[50vh]"},p)}),h={container:"no-scrollbar pt-[20px] mask-image overflow-y-auto overflow-x-hidden"};return o.jsxs("div",{ref:a,className:`${h.container} ${c[n||"medium"]} ${t}`,children:[r&&o.jsx("div",{className:"relative w-full h-full",children:o.jsx(mr,{children:o.jsx(Tt,{className:"w-7 animate-spin"})})}),!r&&o.jsx(o.Fragment,{children:s.length?u():o.jsx("div",{className:"relative w-full h-full",children:o.jsx(mr,{children:o.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const Kl=.3,qE=t=>t%2!==0;function gX({active:t}){const{audioRef:e}=Ye();if(!e.current)throw new Error("useKaraoke !audioRef.current");const[n,r]=m.useState(0),s=m.useRef(null),i=m.useRef(null),a=m.useRef(null),l=m.useRef(null),c=m.useRef(0),u=m.useRef(0),h=m.useRef("paused"),f=m.useRef(!1),{songLyrics:p,loading:x,playStatus:v}=Lj({active:t}),_=m.useMemo(()=>{if(p.length){if(n<0)return{odd:"",even:""};const b=qE(n);if(!p[n+1])return{odd:"",even:""};const I=b?[n,n+1]:[n+1,n],F=p[I[0]].text.trim(),D=p[I[1]].text.trim();return{odd:F,even:D}}else return{odd:"",even:""}},[n,p]),S=b=>{b.style.animation="none"},E=(b,I,F,D)=>{var j,R;let C="running";h.current==="paused"&&(C="paused"),F.style.animation=`${b} ${(((j=I==null?void 0:I.tune)==null?void 0:j.end)||I.end)-(((R=I==null?void 0:I.tune)==null?void 0:R.start)||I.start)}s linear ${C} forwards`;const k=+D.toFixed(1);Math.abs(k)>.2&&(F.style.animationDelay=`${k}s`)},w=()=>{if(!p.length)return;const b=e.current.currentTime>=c.current?"forward":"backward";c.current=e.current.currentTime;let I=u.current;switch(b){case"forward":for(;I<p.length&&p[I+1]&&p[I+1].start-Kl<c.current+Kl;)I+=1;break;case"backward":for(;I>0&&p[I-1]&&p[I-1].end-Kl>c.current+Kl;)I-=1;break}if(I!==u.current||f.current||h.current==="paused"||h.current==="waiting"){if(f.current=!1,u.current=I,r(I),!s.current||!i.current||!l.current||!a.current)return;const F=p[I],{tune:D,text:C,cut:k}=F,j=c.current+Kl-D.start,R=C.split(" "),N=qE(I),P=Xj(N?l.current:a.current),A=Sw(R,k,D.grow),ee=N?[s.current,i.current]:[i.current,s.current],pe=Kj(A,P);E(pe,F,ee[0],-j),S(ee[1])}};return m.useEffect(()=>{h.current==="waiting"?setTimeout(()=>{h.current=v},300):h.current=v},[v]),m.useEffect(()=>{t&&(f.current=!0,v==="paused"&&w())},[t]),m.useEffect(()=>{if(!(!p.length||!t))return e.current.addEventListener("timeupdate",w),()=>{e.current.removeEventListener("timeupdate",w)}},[p,t]),m.useEffect(()=>()=>{c.current=0,u.current=-1,r(0)},[p]),{loading:x,currentIndexRef:u,oddOverlay:s,evenOverlay:i,currentIndex:n,textData:_,tempEventText:a,tempOddText:l}}function GE({text:t,overlayRef:e}){const{playStatus:n}=ae(Dn),[r,s]=m.useState(t),[i,a]=m.useState(!1),l=m.useRef(!0);m.useEffect(()=>{t&&a(!1)},[t]),m.useEffect(()=>{if(i)return;const u=()=>{s(t),a(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),m.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return o.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",o.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function xX({active:t}){const{loading:e,evenOverlay:n,oddOverlay:r,tempEventText:s,tempOddText:i,textData:a}=gX({active:t});return e?o.jsx(mr,{children:o.jsx(Tt,{className:"w-7 animate-spin"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:a.even.split(" ").map((l,c)=>o.jsx("span",{className:"leading-1",children:l},c))}),o.jsx("div",{ref:i,className:"inline-flex h-0 opacity-0",children:a.odd.split(" ").map((l,c)=>o.jsx("span",{className:"k leading-1",children:l},c))}),o.jsx(GE,{overlayRef:n,text:a.even}),o.jsx("div",{className:"mt-8"}),o.jsx(GE,{overlayRef:r,text:a.odd})]})}const VA=()=>{window.dispatchEvent(new Event("mousemove"))};function Ax(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,a=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-a))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=VA},900)),n||Math.abs(i)>r||Math.abs(a)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return a>i?setTimeout(()=>{e.scrollLeft=c-l},300):a<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function yX(){const t=an(),{isOpenFullScreen:e,idle:n}=Ye(),{currentQueueId:r}=ae(Ve),{playStatus:s}=ae(Dn),i=m.useRef(null),a=m.useRef(null),l=m.useRef("paused"),c=()=>{!(a!=null&&a.current)||!(i!=null&&i.current)||Ax(a.current,i.current,n)},u=p=>{let x=document.querySelector(".song-thumb.centered");if(!x)if(a.current)x=a.current;else return;let v;switch(p){case"ArrowRight":v=x.nextElementSibling;break;case"ArrowLeft":v=x.previousElementSibling;break}v&&i.current&&(x.classList.remove("centered"),v.classList.add("centered"),Ax(v,i.current))},h=()=>{if(!a.current)return;const p=document.querySelector(".song-thumb.centered"),x=p==null?void 0:p.getAttribute("queue-id");x&&t(rs(x))},f=p=>{if(p.key==="ArrowRight"||p.key==="ArrowLeft")return p.preventDefault(),u(p.key);p.key==="Enter"&&(p.preventDefault(),h())};return m.useEffect(()=>{e&&c()},[r,e]),m.useEffect(()=>{if(e)return document.addEventListener("keydown",f),()=>{var p;document.removeEventListener("keydown",f),(p=document.querySelector(".song-thumb.centered"))==null||p.classList.remove("centered")}},[r,e]),m.useEffect(()=>{const p=i==null?void 0:i.current;if(p)return p.onscroll=VA,()=>{p.onscroll=()=>{}}},[]),m.useEffect(()=>{l.current=s},[s]),{activeSongRef:a,containerRef:i}}function vX(){const t=an(),{activeTab:e,isOpenFullScreen:n,idle:r}=Ye(),{theme:s}=q(),{currentSongData:i}=ae(Ve),{queueSongs:a,currentQueueId:l}=ae(Ve),{activeSongRef:c,containerRef:u}=yX(),h=S=>{l!==S&&t(rs(S))},f=JS(()=>x("next"),200),p=JS(()=>x("previous"),200),x=(S="next")=>{const E=u.current;E.style.scrollBehavior="smooth",S==="next"?E.scrollLeft+=500:S==="previous"&&(E.scrollLeft-=500)},v={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:`absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/30 rounded-full ${s.content_hover_bg}`,lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},_=m.useMemo(()=>{if(i!=null&&i.song&&a.length)return a.map((S,E)=>S.queue_id===l?o.jsx(Gp,{ref:c,hasTitle:!0,onClick:()=>h(S.queue_id),active:!0,data:S},E):o.jsx(Gp,{idleClass:`${r?v.fadeTransition:""}`,hasTitle:!0,active:!1,data:S,onClick:()=>h(S.queue_id)},E))},[i==null?void 0:i.song,a,r]);return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:u,className:`song-list-container ${v.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:_}),e==="Songs"&&!r&&o.jsxs(o.Fragment,{children:[o.jsx(le,{hover:"scale",size:"clear",onClick:()=>p(),className:`${v.absoluteButton} left-[20px]`,children:o.jsx(dI,{className:"w-[30px]"})}),o.jsx(le,{hover:"scale",size:"clear",onClick:()=>f(),className:`${v.absoluteButton} right-[20px]`,children:o.jsx(rh,{className:"w-[30px]"})})]}),o.jsxs(sI,{children:[o.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:o.jsxs("div",{className:v.lyricTabContainer,children:[o.jsx(Gp,{active:!0,data:i==null?void 0:i.song}),o.jsx(UA,{className:"w-full ml-[40px] h-full",active:n&&e==="Lyric"})]})}),o.jsx("div",{className:`absolute inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:o.jsx(xX,{active:n&&e==="Karaoke"})})]})]})}function wX(){var a,l;const{isOpenFullScreen:t,idle:e,activeTab:n,playerConig:{songBackground:r}}=Ye(),{currentSongData:s}=ae(Ve),i={wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[o.jsx("div",{className:` ${i.bg}`,children:r&&o.jsx(im,{radioGroup:"",height:"100%",width:"100%",hash:((a=s==null?void 0:s.song)==null?void 0:a.blurhash_encode)||zA})}),o.jsxs("div",{className:i.container,children:[o.jsx(mX,{}),o.jsx("div",{className:i.content,children:o.jsx(vX,{})}),n!=="Songs"&&o.jsxs("p",{className:`text-center ${e&&i.fadeTransition}`,children:[((l=s==null?void 0:s.song)==null?void 0:l.name)||"...",o.jsxs("span",{className:"opacity-70 text-sm",children:[" - ",s==null?void 0:s.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function _X(){const{user:t}=ve(),[e,n]=m.useState([]),[r,s]=m.useState(!0);return{isFetching:r,recentSongs:e,getRecentSongs:async()=>{try{if(t&&t.recent_song_ids.length){const a=je(An,J(Ks(),"in",t.recent_song_ids)),l=await Nn(a);n(l)}else{const a=fn()["recent-songs"]||[];n(a)}}catch(a){console.log({message:a})}finally{s(!1)}}}}function bX({setTab:t}){const e=an(),n=m.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i}=_X(),a=[...Array(5).keys()].map(c=>o.jsx(he,{className:"h-[57px] mt-1"},c)),l=c=>{e(um({songs:[c]})),e(rs(c.queue_id)),t("Queue")};return m.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?a:o.jsx(Ys,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l})}const SX=["Queue","Recent"];function EX(){const t=an(),{theme:e}=q(),{isOpenSongQueue:n,setIsOpenSongQueue:r}=Ye(),{queueSongs:s,currentQueueId:i,isFetching:a}=ae(Ve),{resetForNewSong:l}=Js(),[c,u]=m.useState("Queue"),h=m.useCallback(v=>{v!==i&&t(rs(v))},[i]),f=m.useCallback(()=>{t(o6()),l(),r(!1)},[]),p=[...Array(5).keys()].map(v=>o.jsx(he,{className:"h-[56px] mt-1"},v)),x={mainContainer:`hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 ${e.container} border-l-[1px] border-${e.alpha} transition-[transform] duration-[.5s] linear delay-100`,songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return o.jsx(ds,{children:o.jsxs("div",{className:`${e.text_color} ${x.mainContainer} ${n?"translate-x-0---":"translate-x-full"}     `,children:[o.jsx(fs,{className:"w-fit mx-auto text-sm",tab:c,setTab:u,tabs:SX,render:v=>v}),o.jsx("div",{className:x.songListContainer,children:c==="Queue"?o.jsxs(o.Fragment,{children:[o.jsx(Ys,{isHasCheckBox:!1,songs:s,setSong:v=>h(v.queue_id),songVariant:"queue-song",getActive:(v,_)=>v.queue_id===_.queue_id}),a&&p,o.jsx("div",{className:"text-center",children:!!s.length&&o.jsxs(le,{onClick:f,size:"clear",className:`${e.content_bg} rounded-full my-5 px-3 py-1 space-x-1`,children:[o.jsx(Fn,{className:"w-6"}),o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Clear"})]})})]}):o.jsx(bX,{setTab:u})})]})})}const kX=m.memo(EX);function TX({vinylRef:t}){const{playStatus:e}=ae(Dn);m.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function IX({textRef:t,textWrapperRef:e,content:n}){const r=m.useRef(),s=m.useRef(),i=m.useRef(!1),a=m.useRef(0),l=m.useRef(0),c=m.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},h=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},f=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-a.current,l.current=Math.ceil(c.current/35))},p=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},x=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),a.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,f(),setTimeout(h,1e3),r.current=setInterval(h,l.current*1e3+3e3))};m.useEffect(()=>(x(),p),[n])}function CX({content:t,className:e}){const n=m.useRef(null),r=m.useRef(null);return IX({textRef:r,textWrapperRef:n,content:t}),o.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:o.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const HA=m.memo(CX);function RX({isOpenFullScreen:t,song:e}){const n=m.useRef(null),{theme:r}=q();TX({vinylRef:n});const s={songInfoChild:"flex flex-row"};return o.jsx("div",{className:`w-1/4  ${Uc(t)}`,children:o.jsxs("div",{className:`${s.songInfoChild} ${Uc(t)}`,children:[o.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:o.jsx(pt,{src:e==null?void 0:e.image_url,className:"rounded-full h-full object-cover"})}),o.jsxs("div",{className:"ml-2 flex-grow",children:[o.jsx("div",{className:"h-[32px]",children:o.jsx(HA,{className:"leading-[1.5] font-playwriteCU",content:(e==null?void 0:e.name)||"Name"})}),e&&o.jsx("div",{className:"leading-[1.2] text-sm opacity-[.7] line-clamp-1",children:e.singers.map((i,a)=>i.id?o.jsx(Ce,{to:`/singer/${i.id}`,className:`${r.content_hover_text}  hover:underline`,children:(a?", ":"")+i.name},a):o.jsx("span",{children:(a?", ":"")+i.name}))})]})]})})}function jX({audioEle:t,volumeLineRef:e}){const{theme:n}=q(),[r,s]=m.useState(!1),[i,a]=M0("volume",1),l=h=>{const p=h.target.getBoundingClientRect(),x=e.current;if(x){let v=+((h.clientX-p.x)/x.clientWidth).toFixed(2);v>.9?v=1:v<.05?(v=0,s(!0)):s(!1),a(v)}},c=h=>{h.preventDefault();const f=.1;let p=i;h.deltaY>0?p-f>0?p-=f:p=0:p+f<1?p+=f:p=1,a(+p.toFixed(2))},u=()=>s(!r);return m.useEffect(()=>{if(e.current&&t){const h=i*100;e.current.style.background=fw(n.content_code,h),t.volume=i,s(i===0)}},[i,n]),m.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function AX({audioEle:t}){const e=m.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=jX({audioEle:t,volumeLineRef:e}),a={before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]",volumeLineBase:"ml-1 w-full relative h-[4px] cursor-pointer rounded-full shadow-[2px_2px_10px_rgba(0,0,0,.15)]"};return o.jsxs("div",{className:"flex flex-grow items-center max-w-[120px] mr-2",children:[o.jsx("button",{onWheel:r,onClick:()=>n(),children:i?o.jsx(qL,{className:"w-6"}):o.jsx(VL,{className:"w-6"})}),o.jsx("div",{onClick:l=>s(l),ref:e,className:`${a.volumeLineBase} ${a.before}`,style:{background:"#e1e1e1"}})]})}function NX({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return o.jsx(qy,{className:`${n.icon}`});case"error":return o.jsx(tm,{className:`${n.icon}`});case"loading":case"waiting":return o.jsx(Tt,{className:`${n.icon} animate-spin`});case"paused":return o.jsx(hI,{className:`${n.icon}`})}};return o.jsx(o.Fragment,{children:o.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function PX(){var S;const{theme:t}=q(),{playerConig:{isShuffle:e,repeat:n},isOpenFullScreen:r,timelineEleRef:s,currentTimeEleRef:i}=Ye(),{currentSongData:a,queueSongs:l}=ae(Ve),{playStatus:c}=ae(Dn),{next:u,previous:h,toggleRepeat:f,toggleShuffle:p,handlePlayPause:x,handleSeek:v}=Js(),_={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-[6px] sm:h-1 flex-grow relative cursor-pointer rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`${_.buttonsContainer}`,children:[o.jsxs("button",{disabled:l.length<=1,className:`relative ${_.button} ${n!=="no"&&t.content_text}`,onClick:f,children:[o.jsx(lI,{className:_.icon}),o.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:n==="one"?"1":n==="all"?"-":""})]}),o.jsx("button",{disabled:l.length<=1,className:_.button,onClick:h,children:o.jsx(Oy,{className:_.icon})}),o.jsx(NX,{playStatus:c,handlePlayPause:x}),o.jsx("button",{disabled:l.length<=1,className:`${_.button}`,onClick:u,children:o.jsx(Vy,{className:_.icon})}),o.jsx("button",{disabled:l.length<=1,className:`${_.button} ${e&&t.content_text}`,onClick:p,children:o.jsx(cI,{className:_.icon})})]}),o.jsxs("div",{className:`${_.progressContainer} ${r?"mb-0":"mb-5 sm:mb-2"} ${c==="error"||c==="loading"?"disable":""}`,children:[o.jsx("div",{className:"w-[44px] sm:w-9",children:o.jsx("span",{ref:i,className:"text-lg sm:text-sm",children:"0:00"})}),o.jsx("div",{ref:s,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:E=>v(E),className:`${_.processLineBase}  ${_.before}`}),o.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:o.jsx("span",{className:"text-lg sm:text-sm",children:a!=null&&a.song?Ms((S=a.song)==null?void 0:S.duration):"0:00"})})]})]})}function FX(){const{theme:t}=q(),e=m.useRef(null);return m.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function DX(){const{theme:t}=q(),e=an(),{countDown:n}=ae(Dn),r=m.useRef(null),s=()=>{var a;n?e(Lt({countDown:0})):(a=r.current)==null||a.open()},i={container:"w-[54px] sm:w-[50px] flex justify-center",button:`rounded-[99px]  hover:bg-${t.alpha} p-[5px]`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:i.container,children:n?o.jsx(Ns,{content:"Clear timer",children:o.jsxs("button",{className:"group flex items-center",onClick:s,children:[o.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:n.toString().padStart(2,"0")}),o.jsx("span",{className:`hidden group-hover:block ${i.button}`,children:o.jsx(Vi,{className:"w-8 sm:w-6"})})]})}):o.jsx(Ns,{content:"Sleep timer",children:o.jsx("button",{onClick:s,className:i.button,children:o.jsx($y,{className:"w-8 sm:w-6"})})})}),o.jsx(Oe,{ref:r,variant:"animation",children:o.jsx(yI,{active:a=>e(Lt({countDown:a})),closeModal:()=>{var a;return(a=r.current)==null?void 0:a.close()}})})]})}function LX(){const{audioRef:t,idle:e}=Ye();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=q(),{isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenFullScreen:i,setIsOpenSongQueue:a}=Ye(),{currentQueueId:l,currentSongData:c}=ae(Ve),{containerRef:u}=FX(),h=nr(),f=m.useMemo(()=>h.pathname.includes("lyric"),[h]),p=()=>{s&&a(!1),i(!0)},x={wrapper:`hidden md:block border-${n.alpha} fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]`,container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 ${n.bottom_player_bg}`};return o.jsxs("div",{ref:u,className:`${x.wrapper} ${r?"border-transparent":n.image?n.bottom_player_bg:""} ${f&&"translate-y-[100%] "} `,children:[!n.image&&o.jsx("div",{className:`${x.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),o.jsxs("div",{className:`${x.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[o.jsx(RX,{song:c==null?void 0:c.song,isOpenFullScreen:r}),o.jsx("div",{className:` ${x.controlWrapper} ${zc(l===null)}`,children:o.jsx(PX,{})}),o.jsxs("div",{className:`${x.right}  ${r?"hidden":""}`,children:[o.jsx(AX,{audioEle:t.current}),o.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[o.jsx(Ns,{content:"Fullscreen mode",children:o.jsx("button",{onClick:p,className:`rounded-[99px]  hover:bg-${n.alpha}  p-[5px]`,children:o.jsx(DD,{className:"w-6"})})}),o.jsx(Ns,{content:"Queue",children:o.jsx("button",{onClick:()=>a(!s),className:`ml-1 hover:bg-${n.alpha} rounded-md p-[5px]`,children:o.jsx(DL,{className:"w-6"})})}),o.jsx("div",{className:`w-[2px] h-[26px] ml-2 bg-${n.alpha}`}),o.jsx(DX,{})]})]})]})]})}function MX({isOpenFullScreen:t}){const e=m.useRef(null);return m.useEffect(()=>{const n=e.current;n&&(t?(n.style.transform="translate(0)",n.style.zIndex="99"):(n.style.transform="translate(0, 100%)",setTimeout(()=>{n.style.zIndex="-10"},500)))},[t]),{wrapperRef:e}}function OX({imageUrl:t}){const{mobileActiveTab:e,setMobileActiveTab:n}=Ye(),r=e==="Playing";return o.jsx("div",{onClick:()=>n(r?"Lyric":"Playing"),className:` ${r?"w-full h-auto px-2 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:o.jsx(pt,{src:t,className:"w-full rounded-md"})})}function $X({children:t},e){const[n,r]=m.useState(!1),[s,i]=m.useState(!1),a=()=>{s&&i(!1),n||r(!0)},l=()=>{r(!0)},c=()=>{i(!1)},u=f=>{f.preventDefault(),f.stopPropagation(),c()};m.useImperativeHandle(e,()=>({toggle:a,close:c,open:l,setModalPersist:()=>{}})),m.useEffect(()=>{s||setTimeout(()=>{r(!1)},400)},[s]),m.useEffect(()=>{n&&setTimeout(()=>{i(!0)},100)},[n]);const h={unMountedContent:"translate-y-full ",mountedContent:"translate-y-0",unMountedLayer:"opacity-0",mountedLayer:"opacity-20"};return o.jsx(o.Fragment,{children:n&&el.createPortal(o.jsxs("div",{className:"fixed inset-0 z-[99]",children:[o.jsx("div",{onClick:u,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${s?h.mountedLayer:h.unMountedLayer}
                        `}),o.jsx("div",{className:`modal-content absolute bottom-0 left-0 right-0 duration-300 transition-[transform,opacity] z-[99]
                            ${s?h.mountedContent:h.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}const BX=m.forwardRef($X);function zX({song:t,onClick:e,active:n}){const r={itemContainer:`border-b 
    last:border-none border-white/10 rounded-md flex p-2 ${n?"bg-white/10":""}`,imageFrame:"w-[54px] h-[54px] relative rounded-md overflow-hidden flex-shrink-0"};return o.jsx(o.Fragment,{children:o.jsxs("div",{onClick:e,className:`${r.itemContainer} `,children:[o.jsx("div",{className:`${r.imageFrame}  `,children:o.jsx(pt,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx("p",{className:"text-lg line-clamp-1 text-sm",children:t.name}),o.jsx("p",{className:"opacity-70 line-clamp-1 text-sm",children:t.singers.map((s,i)=>o.jsxs("span",{children:[" ",(i?", ":"")+s.name]},i))})]})]})})}function UX({}){const t=an(),{queueSongs:e,isFetching:n,currentQueueId:r}=ae(Ve),s=[...Array(5).keys()].map(a=>o.jsx(he,{className:"h-[40px] mt-1"},a)),i=()=>o.jsx(o.Fragment,{children:e.map((a,l)=>o.jsx(zX,{song:a,active:r===a.queue_id,onClick:()=>t(rs(a.queue_id))},l))});return o.jsxs(o.Fragment,{children:[i(),n&&s]})}function VX(){const t=m.useRef(null),e=an(),{countDown:n}=ae(Dn),r=()=>{var s;n?e(Lt({countDown:0})):(s=t.current)==null||s.open()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("button",{className:Zf(!!n,"active"),onClick:r,children:n?o.jsx(xM,{className:"w-6"}):o.jsx($y,{className:"w-6"})}),o.jsx("span",{children:n?n.toString().padStart(2,"")+" songs":"Timer"})]}),o.jsx(Oe,{ref:t,variant:"animation",children:o.jsx(yI,{active:s=>e(Lt({countDown:s})),closeModal:()=>{var s;return(s=t.current)==null?void 0:s.close()}})})]})}function HX({song:t}){const e=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("button",{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:o.jsx(vr,{className:"w-6"})}),o.jsx("span",{children:"Add to playlist"})]}),o.jsx(Oe,{variant:"animation",ref:e,children:o.jsx(xw,{closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()},song:t})})]})}function WX({isLiked:t,song:e}){const{action:n,loading:r}=ww();return o.jsxs("div",{children:[o.jsx("button",{onClick:()=>n({variant:"like",song:e}),className:`${Zf(t,"active")}`,children:r?o.jsx(Tt,{className:"w-6 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(sm,{className:"w-6"}):o.jsx(xu,{className:"w-6"})})}),o.jsx("span",{children:t?"Dislike":"Like"})]})}function qX(){const{user:t}=ve(),{currentSongData:e,queueSongs:n}=ae(Ve),{toggleRepeat:r,repeat:s}=Js(),i={buttonList:"flex flex-shrink-0 overflow-auto space-x-2 [&_div]:flex [&_div]:w-[70px] [&_div]:flex-col [&_div]:items-center [&_div]:space-y-1.5 [&_div]:text-center [&_button]:p-3.5 [&_button]:bg-white/10 [&_button]:rounded-full [&_button.active]:text-[#198585] [&_span]:text-xs"};if(e)return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"h-[60vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[o.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#1f1f1f] absolute inset-0"}),o.jsxs("div",{className:i.buttonList,children:[o.jsxs("div",{children:[o.jsx("button",{disabled:n.length<=1,className:`${Zf(s!=="no","active")}`,onClick:r,children:o.jsx(lI,{className:"w-6"})}),o.jsx("span",{className:"break-word",children:s==="one"?"Repeat one":s==="all"?"Repeat all":"Play once"})]}),t&&o.jsxs(o.Fragment,{children:[o.jsx(HX,{song:e.song}),o.jsx(WX,{song:e.song,isLiked:!!(t!=null&&t.liked_song_ids.includes(e.song.id))})]}),o.jsx(VX,{})]}),o.jsx("div",{className:"flex-grow overflow-auto mt-3 border-t border-white/60 pt-3",children:e&&o.jsx(UX,{currentIndex:e.index})})]})})}function GX(){const{setIsOpenFullScreen:t}=Ye(),e=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex space-x-1 items-center",children:[o.jsx("button",{className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:o.jsx(hM,{className:"w-6"})}),o.jsx("button",{onClick:()=>t(!1),className:"p-1.5",children:o.jsx(uI,{className:"w-6"})})]}),o.jsx(BX,{ref:e,children:o.jsx(qX,{})})]})}function QX({handlePlayPause:t,playStatus:e}){const n={icon:"w-10"},r=()=>{switch(e){case"playing":return o.jsx(gI,{className:`${n.icon}`});case"error":return o.jsx(wM,{className:`${n.icon}`});case"loading":case"waiting":return o.jsx(aM,{className:`${n.icon} animate-spin`});case"paused":return o.jsx(F0,{className:`${n.icon}`})}};return o.jsx(o.Fragment,{children:o.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function KX(){var l;const{timelineEleRef:t,currentTimeEleRef:e}=Ye(),{playStatus:n}=ae(Dn),{currentSongData:r}=ae(Ve),{handleSeek:s,handlePlayPause:i}=Js(),a={buttonsContainer:"w-full flex items-center justify-between space-x-2 mt-2",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-1 flex-grow relative rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`${a.progressContainer}  ${n==="error"||n==="loading"?"disable":""}`,children:[o.jsx("div",{className:"w-[44px] sm:w-9",children:o.jsx("span",{ref:e,className:"text-lg sm:text-sm",children:"0:00"})}),o.jsx("div",{ref:t,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:c=>s(c),className:`${a.processLineBase}  ${a.before}`}),o.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:o.jsx("span",{className:"text-lg sm:text-sm",children:r!=null&&r.song?Ms((l=r.song)==null?void 0:l.duration):"0:00"})})]}),o.jsxs("div",{className:`${a.buttonsContainer}`,children:[o.jsx(QX,{playStatus:n,handlePlayPause:i}),o.jsx(GX,{})]})]})}function XX(){const{isOpenFullScreen:t,playerConig:{songBackground:e},mobileActiveTab:n}=Ye(),{currentSongData:r}=ae(Ve),s=m.useRef(null),{wrapperRef:i}=MX({isOpenFullScreen:t}),a={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"mt-auto",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0"};return o.jsx(o.Fragment,{children:o.jsxs("div",{ref:i,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[e&&o.jsx("div",{className:a.bgImage,children:o.jsx(im,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||zA})}),o.jsx("div",{className:"h-full z-10 p-4 flex flex-col",children:o.jsxs("div",{ref:s,className:a.container,children:[o.jsxs("div",{className:`${n!="Playing"?"flex items-center":"sm:flex"}`,children:[o.jsx(OX,{imageUrl:r==null?void 0:r.song.image_url}),o.jsxs("div",{className:`ml-2 ${n!="Playing"?"block":"hidden sm:block"}`,children:[o.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:r==null?void 0:r.song.name}),o.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>o.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]}),n==="Lyric"&&o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{children:o.jsx("button",{className:" p-[6px] rounded-full ml-auto  bg-white/10",children:o.jsx(By,{className:"w-6"})})}),o.jsx(xr,{appendTo:"portal",position:"left-bottom",origin:"top right",children:o.jsx(WI,{})})]})]}),o.jsx("div",{className:`mt-5 justify-between items-center ${n!="Playing"?"hidden":"flex sm:hidden"}`,children:o.jsxs("div",{className:"flex-grow",children:[o.jsx("div",{className:"h-[40px]",children:o.jsx(HA,{className:"text-xl leading-[1.5] font-playwriteCU",content:(r==null?void 0:r.song.name)||"..."})}),o.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>l.id?o.jsx(Ce,{to:`/singer/${l.id}`,children:(c?", ":"")+l.name},c):o.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]})}),o.jsx(sI,{children:o.jsx(UA,{active:t&&n==="Lyric",className:`text-left ${n==="Lyric"?"flex-1 block":"hidden"}`})}),o.jsx("div",{className:`${a.control}`,children:o.jsx(KX,{})})]})})]})})}function YX(){const{theme:t}=q(),{isOpenFullScreen:e,setIsOpenFullScreen:n}=Ye(),{playStatus:r}=ae(Dn),{currentSongData:s}=ae(Ve),{handlePlayPause:i}=Js(),a=nr(),l=m.useMemo(()=>a.pathname.includes("lyric"),[a]),c=m.useMemo(()=>{switch(r){case"playing":return o.jsx(qy,{className:"w-10"});case"error":return o.jsx(tm,{className:"w-10"});case"loading":case"waiting":return o.jsx(Tt,{className:"w-10 animate-spin"});case"paused":return o.jsx(hI,{className:"w-10"})}},[r]),u={wrapper:`block md:hidden fixed bottom-0 transition-transform w-full h-[80px] overflow-hidden border-t border-${t.alpha} z-40  px-4`,container:`absolute inset-0 ${t.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`,songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"ml-2 flex-shrink-0"};return o.jsxs("div",{className:`${u.wrapper} ${l?"translate-y-[100%]":""}`,children:[o.jsx("div",{className:`${u.container} ${e?"opacity-0 transition-opacity delay-[.3s]":""}`}),o.jsxs("div",{className:"flex justify-between items-center h-full",children:[o.jsx("div",{onClick:()=>s!=null&&s.song.name?n(!0):{},className:"mobile-current-song flex-grow",children:o.jsxs("div",{className:u.songImageWrapper,children:[o.jsx("div",{className:u.image,children:o.jsx(pt,{src:s==null?void 0:s.song.image_url,className:"rounded-full"})}),o.jsx("div",{className:"flex-grow ml-2",children:(s==null?void 0:s.song.song_url)&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"font-playwriteCU line-clamp-1",children:(s==null?void 0:s.song.name)||"..."}),o.jsx("p",{className:"opacity-70 text-sm line-clamp-1",children:s==null?void 0:s.song.singers.map((h,f)=>(f?", ":"")+h.name)})]})})]})}),o.jsx("div",{className:`${u.cta} ${!(s!=null&&s.song.name)&&"disable"}`,children:o.jsx("button",{className:"p-[4px]",onClick:i,children:c})})]})]})}function JX(t,e){const{currentSongData:n}=ae(Ve),{isOpenFullScreen:r,setIdle:s}=Ye(),[i,a]=m.useState(0),l=m.useRef(),c=m.useRef(),u=()=>{s(!1),a(Math.random())},h=()=>{clearTimeout(c.current),clearTimeout(l.current)},f=async()=>{if(!r)return;const p=document.querySelector(".song-thumb.active"),x=document.querySelector(".song-list-container");if(p&&x){const v=Ax(p,x,!0);let _=pw.focusDelay;v||(_=0),l.current=setTimeout(()=>{s(!0)},_)}};if(m.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),h()}}},[r]),m.useEffect(()=>(c.current=setTimeout(()=>{f()},t),()=>{h()}),[i]),!r)return!1}function ZX(){const t=an(),{audioRef:e,firstTimeSongLoaded:n}=Ye(),{playStatus:r,countDown:s}=ae(Dn),{handlePlayPause:i}=Js(),a=m.useRef(0),l=()=>(console.log("song end"),ot("timer",a.current-1),t(Lt({countDown:a.current-1})));m.useEffect(()=>{const c=fn().timer||0;t(Lt({countDown:c}))},[]),m.useEffect(()=>{if(!(!s||!e.current))return e.current.addEventListener("ended",l),n.current||(ot("timer",s),ot("is_timer",!0),r==="paused"&&i()),()=>{var c;(c=e.current)==null||c.removeEventListener("ended",l)}},[!!s]),m.useEffect(()=>{a.current=s},[s])}function eY(){const{isOpenFullScreen:t,playerConig:{repeat:e,isShuffle:n,isCrossFade:r,isEnableBeat:s},audioRef:i,firstTimeSongLoaded:a,startFadeWhenEnd:l,isPlayingNewSong:c,timelineEleRef:u,currentTimeEleRef:h,themeCodeRef:f,shouldSyncSongDuration:p}=Ye();if(!i.current)throw new Error("Use Control audioRef.current is undefined");const x=an(),{theme:v}=q(),{user:_,updateUserData:S}=ve(),{queueSongs:E,currentSongData:w,currentQueueId:b}=ae(Ve),{playStatus:I}=ae(Dn),{currentPlaylist:F}=ae(gl),D=m.useRef(),C=m.useRef(!1),k=m.useRef(!1),j=m.useRef(!1),R=m.useRef("paused"),N=m.useRef([]),P=nr(),{setErrorToast:A}=ge(),{next:ee,updateProgressElement:pe,play:we,pause:ze}=Js(),H=m.useMemo(()=>P.pathname.includes("edit"),[P]),X=m.useMemo(()=>fn(),[]),te=ye=>E[ye],xe=()=>{x(Lt({playStatus:"paused"}))},Ee=()=>{I!=="playing"&&(x(Lt({playStatus:"playing"})),j.current=!1)},Qe=()=>{u.current&&h.current&&(h.current.innerText="0:00",u.current.style.background="rgba(255, 255, 255, 0.15)")},Sr=ye=>{const gt=fn().volume||1;if(ye<=2){const xt=ye/2*gt;i.current.volume=xt}else if(ye<l.current){i.current.volume!=gt&&(i.current.volume=gt);return}if(ye>=l.current){const xt=(i.current.duration-ye)/2*gt;i.current.volume=xt}},sr=()=>{const ye=i.current.currentTime;R.current!=="paused"&&x(Lt({playStatus:"playing"})),pe(ye),r&&Sr(ye),ye&&Math.round(ye)%3===0&&ot("current_time",Math.round(ye))},ir=()=>{if(console.log("end"),!D.current)return;const ye=fn(),gt=ye.volume||1,xt=ye.timer;if(e==="one"&&xt&&xt!==1)return we();if(i.current.volume=gt,k.current=!0,n){let Mn=D.current.index;for(;Mn===D.current.index;)Mn=Math.round(Math.random()*E.length-1);const _n=te(Mn);return x(rs(_n.queue_id))}return xt===0&&ye.is_timer?(C.current=!0,ot("is_timer",!1)):D.current.index===E.length-1&&(e==="all"||xt>=1?C.current=!1:C.current=!0),ee()},Ln=()=>{D.current&&x(Lt({playStatus:"loading"}))},zu=()=>{if(!D.current)return;const ye=i.current.duration;if(l.current=ye-3,ot("current_queue_id",D.current.song.queue_id),C.current)return C.current=!1,x(Lt({playStatus:"paused"}));if((H||a.current)&&(x(Lt({playStatus:"paused"})),a.current)){a.current=!1,p.current=!0,pe(X.current_time||0);return}if(D.current)if(_){const gt=D.current.song.id,xt=[...N.current];if(!xt.includes(gt)){console.log("push recent songs");const _n={recent_song_ids:[...xt,gt]};S(_n),en({collectionName:"Users",data:_n,id:_.email})}}else{const gt=fn()["recent-songs"]||[];gt.find(Mn=>{var _n;return Mn.id===((_n=D.current)==null?void 0:_n.song.id)})||gt.unshift(D.current.song),ot("recent-songs",gt)}we()},Uu=()=>{x(Lt({playStatus:"waiting"}))},Ki=()=>{if(D.current){if(j.current||(j.current=!0,A("Found internet error")),!k.current)return x(Lt({playStatus:"error"}));if(E.length>1){if(D.current.index===E.length-1){x(Lt({playStatus:"error"}));return}ee()}else x(Lt({playStatus:"error"}))}};m.useEffect(()=>{_&&(N.current=_.recent_song_ids)},[_]),m.useEffect(()=>{const ye=X.current_queue_id||null;ye&&E.length?x(rs(ye)):a.current=!1},[]),m.useEffect(()=>(i.current.addEventListener("error",Ki),i.current.addEventListener("pause",xe),i.current.addEventListener("play",Ee),i.current.addEventListener("loadstart",Ln),i.current.addEventListener("loadedmetadata",zu),i.current.addEventListener("waiting",Uu),()=>{var ye,gt,xt,Mn,_n,_l;(ye=i.current)==null||ye.removeEventListener("error",Ki),(gt=i.current)==null||gt.removeEventListener("pause",xe),(xt=i.current)==null||xt.removeEventListener("play",Ee),(Mn=i.current)==null||Mn.removeEventListener("loadstart",Ln),(_n=i.current)==null||_n.removeEventListener("loadedmetadata",zu),(_l=i.current)==null||_l.addEventListener("waiting",Uu)}),[]),m.useEffect(()=>{if(!w||!b){R.current="paused",ze();return}return i.current.src=s&&w.song.beat_url?w.song.beat_url:w.song.song_url,D.current=w,()=>{Qe(),c.current=!0,p.current&&(p.current=!1)}},[w==null?void 0:w.song]),m.useEffect(()=>{if(!w){I==="paused"&&Qe();return}let ye=`${w.song.name}`;I==="paused"&&F&&w.song.queue_id.includes(F.id)&&(ye=`${F.name}`),document.title=ye,R.current=I},[I]),m.useEffect(()=>(console.log("add end event"),i.current.addEventListener("ended",ir),()=>{var ye;return(ye=i.current)==null?void 0:ye.removeEventListener("ended",ir)}),[e,n,b,E]),m.useEffect(()=>(i.current.addEventListener("timeupdate",sr),()=>{var ye;(ye=i.current)==null||ye.removeEventListener("timeupdate",sr)}),[r]),m.useEffect(()=>{t?f.current="#fff":f.current=v.content_code,pe(a.current?X.current_time:0)},[v,t]),m.useEffect(()=>{H&&I==="playing"&&ze()},[H])}function tY({children:t}){return eY(),ZX(),t}function nY(){const{isOnMobile:t}=q(),{audioRef:e}=Ye();ve(),JX(pw.focusDelay,t);const n=e.current&&o.jsxs(o.Fragment,{children:[o.jsx(wX,{}),o.jsx(kX,{}),o.jsx(LX,{})]}),r=e.current&&o.jsxs(o.Fragment,{children:[o.jsx(XX,{}),o.jsx(YX,{})]});return o.jsxs(o.Fragment,{children:[o.jsx("audio",{ref:e,className:"hidden"}),e.current&&o.jsx(tY,{children:t?r:n})]})}function rY({className:t}){const[e,n]=m.useState(!1),{theme:r}=q(),s=()=>{const a=document.querySelector(".main-container");if(!a)return;const l=a.scrollTop||0;n(l>100)},i=()=>{const a=document.querySelector(".main-container");a==null||a.scroll({behavior:"smooth",top:0})};return m.useEffect(()=>{const a=document.querySelector(".main-container");if(a)return a.addEventListener("scroll",s),()=>{a.removeEventListener("scroll",s)}},[]),o.jsx(le,{onClick:i,variant:"circle",size:"clear",className:`absolute p-[8px] hover:scale-[1.05] transition-[opacity,transform] 
         ${t||""} 
         w-[36px] 
         ${r.content_hover_bg} h-[36px] bg-${r.alpha} 
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:o.jsx(cM,{className:"w-full"})})}function sY(){const{theme:t}=q(),{user:e,loading:n}=ve(),r=nr(),s=Vt(),i=()=>{s("/dashboard")},a=[...Array(2).keys()].map(c=>o.jsxs("div",{className:"px-3 w-full h-[51px] flex items-center",children:[o.jsx(he,{className:"w-[28px] h-[28px] mr-1 flex-shrink-0"}),o.jsx(he,{className:"w-[100px] h-[30px]"})]},c)),l={container:`w-[180px] relative  flex-shrink-0 border-r-[1px] h-screen ${t.side_bar_bg} border-${t.alpha}`,navItem:`  px-3 py-2 leading-[2.2] font-playwriteCU flex items-center ${t.content_hover_text}`,icon:"w-7 mr-2",link:"w-full border-l-[4px]",activeLink:`${t.content_text} ${t.container} ${t.content_border}  `};return o.jsxs("div",{className:`hidden md:block ${l.container} ${t.text_color}`,children:[o.jsx("div",{className:"px-[10px] h-[60px] flex items-center justify-center",children:o.jsxs(Ce,{to:"/",className:"text-[24px] font-[500]",children:["HD",o.jsx("span",{className:`${t.content_text} ml-[4px]`,children:"MP3"})]})}),o.jsxs("div",{className:"flex flex-col items-start",children:[n&&a,!n&&o.jsxs(o.Fragment,{children:[o.jsx(Ce,{className:`${l.link} ${r.pathname==="/"?l.activeLink:"border-transparent"}`,to:"/",children:o.jsxs("div",{className:l.navItem,children:[o.jsx(nm,{className:l.icon}),o.jsx("span",{children:"Discover"})]})}),e&&o.jsxs(o.Fragment,{children:[o.jsx(Ce,{className:`${l.link}  ${r.pathname.includes("my-music")?l.activeLink:"border-transparent"}`,to:"/my-music",children:o.jsxs("div",{className:l.navItem,children:[o.jsx(Ua,{className:l.icon}),o.jsx("span",{children:"My Song"})]})}),e.role==="ADMIN"&&o.jsx(Ce,{to:"/dashboard",className:`${l.link} border-transparent`,children:o.jsxs("div",{onClick:i,className:` ${l.navItem}`,children:[o.jsx(zy,{className:l.icon}),o.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),o.jsx(rY,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function iY(){const[t,e]=m.useState(""),[n,r]=m.useState(!1),[s,i]=m.useState(!1),[a,l]=m.useState([]),c=m.useRef(null),u=m.useRef(null),h=m.useRef(null),f=m.useRef(!0),p=xT(),x=Fj(t,700),v=new AbortController,_=S=>{const E=document.querySelector(".popup-content"),w=S.target,b=document.querySelectorAll(".modal-content");let I=!1;b.forEach(F=>F.contains(w)?I=!0:{}),!(c.current&&u.current&&(c.current.contains(w)||I||u.current.contains(w)||E!=null&&E.contains(w)))&&i(!1)};return m.useEffect(()=>{if(!x.trim()){r(!1),l([]);return}const S=async()=>{try{r(!0);const E=je(An,J("is_official","==",!0),J("name",">=",t),J("name","<=",t+"")),w=await Nn(E);l(w)}catch(E){console.log(E)}finally{r(!1)}};return f.current?S():f.current=!0,()=>{console.log("abort"),v.abort()}},[x]),m.useEffect(()=>(s&&document.addEventListener("click",_),()=>{document.removeEventListener("click",_)}),[s]),m.useEffect(()=>(e(p[0].get("q")||""),()=>{var S;f.current=!1,(S=h.current)==null||S.blur(),i(!1)}),[p[0].get("q")]),m.useEffect(()=>{p[0].get("q")!==t&&s&&(f.current=!0)},[t,s]),{isFetching:n,searchResult:a,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:c,searchResultRef:u,inputRef:h}}function aY({songs:t}){const{handleSetSong:e}=Xs({variant:"search-bar"}),{getRecommend:n}=bw(),r=s=>{e(s.queue_id,[s]),n(s)};return o.jsx(ds,{children:t.length?o.jsx(Ys,{isHasCheckBox:!1,setSong:r,songs:t}):o.jsx(tt,{})})}function oY(){const t={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion keyword"}),o.jsx("div",{className:t.listWrapper,children:o.jsxs(Ce,{to:"/search?q=nhac-tet",children:[o.jsx(cI,{className:"w-5"}),o.jsx("span",{children:"Nhac tet"})]})})]})}function lY(){const{theme:t}=q(),e=Vt(),{isFetching:n,inputRef:r,formRef:s,searchResultRef:i,value:a,searchResult:l,setIsFocus:c,isFocus:u,setValue:h}=iY(),f={container:`relative h-[40px] flex px-3 w-[300px] ${t.text_color} shadow-md`,unFocusContainer:`bg-${t.alpha} rounded-[20px]`,focusedContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} rounded-[20px_20px_0_0]`,input:`bg-transparent outline-none  w-full ${t.type==="light"?"placeholder:text-black":"placeholder:text-white"}`,searchResultContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] overflow-hidden flex flex-col`},p=async x=>{x.preventDefault(),e(`/search?q=${a}`),c(!1)};return o.jsx(o.Fragment,{children:o.jsxs("form",{ref:s,onSubmit:p,className:`${f.container} ${u?f.focusedContainer:f.unFocusContainer}`,children:[o.jsx("button",{className:"mr-2",children:o.jsx(Hy,{className:"w-6"})}),o.jsx("input",{ref:r,value:a,onFocus:()=>c(!0),onChange:x=>h(x.target.value.trim()),placeholder:"Nhac tet...",className:f.input,type:"text"}),o.jsx("button",{type:"button",onClick:()=>h(""),className:`${a?"opacity-100":"!opacity-0"} ${zc(!a)}`,children:n?o.jsx(Tt,{className:"w-5 animate-spin"}):o.jsx(Vi,{className:"w-5"})}),o.jsx("div",{ref:i,className:`${Uc(!u)} ${f.searchResultContainer}`,children:l.length?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion results"}),o.jsx("div",{className:"overflow-auto no-scrollbar",children:o.jsx(aY,{songs:l})})]}):o.jsx(oY,{})})]})})}function cY({contentRef:t}){const{theme:e}=q(),[n,r]=m.useState(0),[s,i]=vv(Fa),[a,l]=m.useState(""),c=m.useRef(null),u=m.useRef(null),h=m.useRef(null),{action:f}=$m(),p=b=>{var I,F;l(b),(I=h.current)==null||I.toggle(),(F=c.current)==null||F.close()},x=async()=>{var b;try{await f("logout")}catch(I){console.log("signOut error",{message:I})}finally{(b=h.current)==null||b.toggle()}},v=async()=>{var b;try{(b=u.current)==null||b.close(),await f("login")}catch(I){console.log({message:I})}},_=()=>{var I;const b=((I=t.current)==null?void 0:I.scrollTop)||0;r(b)},S=o.jsx(he,{className:"h-[40px] w-[40px] rounded-full"}),E=m.useMemo(()=>{switch(a){case"":return o.jsx(o.Fragment,{});case"theme":return o.jsx(Ky,{close:()=>{var b;return(b=h.current)==null?void 0:b.toggle()}});case"info":return o.jsx(Qy,{close:()=>{var b;return(b=h.current)==null?void 0:b.toggle()}});case"confirm":return o.jsx(Gs,{close:()=>{var b;return(b=h.current)==null?void 0:b.toggle()},callback:x,loading:!1,label:"Sign out ?"})}},[a]);m.useEffect(()=>{var b;return(b=t.current)==null||b.addEventListener("scroll",_),()=>{document.removeEventListener("scroll",_)}},[]);const w={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full",menuItem:"hover:bg-white/5 rounded-[4px] w-full text-sm px-[10px] h-[44px] inline-flex items-center font-[500]",icon:"w-5 mr-1",divide:`h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-${e.alpha}`};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`hidden md:block h-[60px] fixed top-0 right-0 left-[180px] z-[20]  ${n?"shadow-lg":"bg-transparent"}`,children:[o.jsx("div",{className:`${n?"":"hidden "} absolute inset-0 ${e.container} bg-opacity-[0.9] backdrop-blur-[15px] z-[-1] `}),o.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[o.jsx($A,{className:"mr-5"}),o.jsx(lY,{}),o.jsxs("div",{className:"flex space-x-3 ml-auto",children:[o.jsxs(pr,{children:[o.jsx(gr,{ref:c,children:o.jsx(Ns,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:o.jsx("button",{className:`flex px-[6px] items-center ${w.button} bg-${e.alpha} ${e.content_hover_bg}`,children:o.jsx(pu,{className:"w-full"})})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(CI,{openModal:p,variant:"client"})})]}),o.jsxs(pr,{children:[o.jsx(gr,{ref:u,className:"flex items-center",children:o.jsx("button",{className:"flex hover:brightness-90",children:i?S:o.jsx(mx,{className:"w-[40px] h-[40px]"})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(Qs,{theme:e,children:o.jsxs("div",{className:"w-[250px] max-h-[50vh]",children:[s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[o.jsx(mx,{className:"login-trigger w-[46px] h-[46px]"}),o.jsx("div",{className:"ml-[12px]",children:o.jsx("h5",{className:"font-semibold line-clamp-1",children:s==null?void 0:s.displayName})})]}),o.jsx("div",{className:w.divide}),o.jsxs("button",{className:`${w.menuItem}`,onClick:()=>p("confirm"),children:[o.jsx(Ly,{className:w.icon}),"Log out"]})]}),!s&&o.jsxs("button",{className:`${w.menuItem}`,onClick:v,children:[o.jsx(nD,{className:w.icon}),"Log in"]})]})})})]})]})]})]}),o.jsx(Oe,{variant:"animation",ref:h,children:E})]})}function uY(){const{user:t,setUser:e}=ve(),{isDev:n}=q(),{uploadedSongs:r,setUploadedSongs:s,shouldFetchFavoriteSongs:i}=Pn(),{setIsUploading:a,isUploading:l,setUploadingSongs:c,resetUploadContext:u}=tI(),[h,f]=m.useState(""),p=m.useRef(null),{setErrorToast:x,setSuccessToast:v}=ge(),_=()=>{const E=p.current;E&&(E.value=""),u()},S=async E=>{try{if(!t)return;const w=[],b=[],I=E.target.files;if(!I.length)return;const F=[],D=[],C=Date.now(),k=P=>r.some(A=>A.size===P.size)||F.some(A=>A.size===P.size);for(let P=0;P<=I.length-1;P++){const A=I[P],ee=await AA(A);if(!ee)continue;const pe={name:ee.singer,created_at:""},we={...mf(pe),id:""},ze={name:ee.name,singers:[we],duration:Math.floor(ee.duration),size:Math.floor(A.size/1024)},H=ee.image?new Blob([ee.image]):null;H&&(b.push(H),ze.image_url=URL.createObjectURL(H));const X=gx({...ze,owner_email:t.email,distributor:t.display_name});if(k(X)){console.log(">>>duplicate");continue}F.push(X),w.push(P)}if(r.length+w.length>5)return f("You have reach the upload limit");if(!F.length)return;c(F),a(!0);for(let P=0;P<w.length;P++){const A=w[P],ee=b[P],pe={...F[P]},{filePath:we,fileURL:ze}=await hw({file:I[A],folder:"/songs/",namePrefix:t.email,msg:">>> api: upload song file"});if(ee){const xe=await Gi({blob:ee});Object.assign(pe,xe)}Object.assign(pe,{song_file_path:we,song_url:ze});const H=await qi({collectionName:"Songs",data:pe,msg:">>> api: set song doc"}),X=await Fu(H);D.push(X.id);const te={...X.data(),id:H.id,queue_id:Lu(4)};s(xe=>[...xe,te]),c(xe=>{const Ee=[...xe];return Ee.shift,Ee})}const R={liked_song_ids:[...D,...t.liked_song_ids]};await en({collectionName:"Users",data:R,id:t.email}),e({...t,...R}),i.current=!0,v(`${F.length} songs uploaded`);const N=Date.now();n&&console.log(">>> upload songs finished after",(N-C)/1e3)}catch(w){console.log({message:w}),x(h)}finally{_()}};return m.useEffect(()=>{if(!l)return;const E=document.querySelector(".temp-song");E&&E.scrollIntoView({behavior:"smooth",block:"center"})},[l]),{handleInputChange:S,inputRef:p}}function dY(){const{handleInputChange:t,inputRef:e}=uY(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return o.jsx(o.Fragment,{children:el.createPortal(o.jsx("div",{className:n.container,children:o.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function hY(){const{theme:t}=q(),e=m.useRef(null),n={page:`md:flex md:h-screen  ${t.container} ${t.text_color}`,container:"md:h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] pt-[30px] md:pt-[60px] md:overflow-auto"};return m.useEffect(()=>{const r=document.querySelector(".my-tag"),s=document.querySelector("body");s.style.backgroundColor=t.container_code,r&&r.setAttribute("content",t.container_code)},[t]),o.jsx(o.Fragment,{children:o.jsx(WF,{children:o.jsxs(ZT,{children:[o.jsxs("div",{className:`${n.page}`,children:[o.jsx(sY,{}),o.jsxs("div",{ref:e,className:n.container,children:[o.jsx(cY,{contentRef:e}),o.jsx(Hf,{})]}),o.jsx(nY,{})]}),o.jsx(BA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),o.jsx(dY,{}),o.jsx(JT,{})]})})})}function Ig({children:t}){return t}function fY(){return o.jsx(o.Fragment,{children:o.jsx(z4,{children:o.jsxs(F4,{children:[o.jsx(Wr,{path:"*",element:o.jsx(fW,{})}),o.jsx(Wr,{path:"/login",element:o.jsx(pW,{})}),o.jsxs(Wr,{element:o.jsx(hY,{}),children:[rX.map((t,e)=>{const n=t.layout||Ig,r=t.component;return o.jsx(Wr,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)}),o.jsx(Wr,{element:o.jsx(aX,{}),children:sX.map((t,e)=>{const n=t.layout||Ig,r=t.component;return o.jsx(Wr,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)})})]}),o.jsx(Wr,{element:o.jsx(oX,{}),children:o.jsx(Wr,{element:o.jsx(hX,{}),children:iX.map((t,e)=>{const n=t.layout||Ig,r=t.component;return o.jsx(Wr,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)})})})]})})})}const mY=GO({reducer:{currentPlaylist:LV,playStatus:NV,songQueue:l6},middleware:t=>t({serializableCheck:!1})});function pY(){const{setUser:t,setLoading:e,loading:n,user:r}=ve(),{getPlaylist:s}=Hj();return m.useEffect(()=>{(async()=>{Fa.onAuthStateChanged(async a=>{if(a&&a.email){const l=await ls({collectionName:"Users",id:a.email}),c=l.data(),u={email:a.email,display_name:a.displayName,photo_url:a.photoURL,liked_song_ids:c.liked_song_ids||[],recent_playlist_ids:c.recent_playlist_ids||[],recent_song_ids:c.recent_song_ids||[],liked_singer_ids:c.liked_singer_ids||[],role:c.role||"USER",liked_playlist_ids:c.liked_playlist_ids||[]};l.exists()?await s():await qi({collectionName:"Users",data:u}),t(u)}else t(null);e(!1)})})()},[]),{user:r,loading:n}}function gY({children:t}){return pY(),t}Cg.createRoot(document.getElementById("root")).render(o.jsx(sk.StrictMode,{children:o.jsx(yO,{store:mY,children:o.jsx(Q4,{children:o.jsx(LF,{children:o.jsx(X4,{children:o.jsx(OF,{children:o.jsx(zF,{children:o.jsx(gY,{children:o.jsx(fY,{})})})})})})})})}));
